<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Illustrator自動化基本編 (Adobe JavaScriptシリーズ（NextPublishing）)</title>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="/css/mainday.css" title="default">
<link rel="alternate stylesheet" href="/css/mainnight.css" title="alternate">
<script type="text/javascript" src="/js/styleswitcher.js"></script>
<script type="text/javascript" src="/js/global.js"></script>
</head>
<body>
<div class="novelpage">
<div class="novelbody">
<div id="tateyoko">
<div id="_top"></div>
<a href="/">🏠</a>&emsp;
<a href="#" onclick="setActiveStyleSheet('default'); return false;">日</a>&emsp;
<a href="#" onclick="setActiveStyleSheet('alternate'); return false;">月</a>&emsp;
<a href="#_top" onclick="myFunction()" style="cursor: pointer;">縦書き／横書き</a>
<div id="calibre_link-115">
<div>
<div>
<table class="noveltitle">
<tr>
<td colspan="2"><i><span><i>Illustrator自動化基本編 (Adobe JavaScriptシリーズ（NextPublishing）)</i></span></i></td>
</tr>
<tr>
                    
                    
      </tr>
<tr>
<td colspan="2">古籏 一浩</td>
</tr>
<tr>
<td colspan="2"> (2014)</td>
</tr>
<tr>
<td colspan="2"></td>
</tr>
</table>
<div></div>
</div>
<div>
<p>Adobe JavaScriptを使ってIllustratorを自動化する！</p>
</div>
</div>
</div>



<div id="calibre_link-685">
<section>
<div>
<h1 id="calibre_link-143"><b>はじめに</b></h1>
</div>
<p>　本書はAdobe Illustratorを制御する際に必要となる基本的な自動化のプログラムを逆引きの形で掲載しています。</p>
<p>　Illustratorはプログラムを使うことで手作業では時間のかかる処理を素早く完璧に処理させることができます。アクションだけでは難しい処理もプログラムを使えば簡単にできてしまうこともあります。</p>
<p>　プログラムがよくわからない人もいるかもしれませんが、Illustrator CS6以降ではアクションと組み合わせて使用することができるため、プログラムで得意な条件分岐だけ行わせ、その他の処理を定義したアクションで行わせるといった方法を使うこともできます。</p>
<p>　Illustratorを制御するプログラム言語としてはAppleScript、VBScript、JavaScriptがあります。AppleScriptはMac OS X/OS Xのみで動作、VBScriptはWindowsのみで動作、JavaScriptはMacOS X/OS XとWindowsの両方で動作します。本書ではMacでもWindowsでも動作させることができるJavaScriptを使っています。</p>
<p>　なお、本書ではJavaScriptに関する文法や命令および開発ツールであるESTKについては解説していません。また、Adobeアプリケーションで共通して使える機能に関しても一部を除いて掲載していません。これらについて知りたい方は以下の書籍を参照してください。</p>
<p>・ExtendScript Toolkit（ESTK）基本編</p>
<p>ISBN：9784844396130</p>
<p>・Adobe JavaScriptリファレンス</p>
<p>ISBN：9784844395959</p>
<p>　本書がIllustratorで自動化しようと考えている方々の役に立てば幸いです。</p>
<p>2014年12月　古籏一浩</p>
</section>
</div>
<div id="calibre_link-38">
<section>
<h2 id="calibre_link-144"><b>注意事項と免責事項</b></h2>
<p>　サンプルを実行した結果生じるトラブルに関しては一切の責任を負いません。また、Illustrator CC以降に関してはアップデートにより動作が変わってしまう可能性もあります。アップデートによる動作の不具合に関しては対処しかねるので、あらかじめご了解ください。また、Windows 8.1以降での動作保証は行っていません。</p>
<p>　Illustratorには非常に多くのオブジェクトと機能がありますが、それら全てについて逆引きの形式で掲載しているわけではありません。代表的な機能に関してのみ掲載しています。より詳しい機能についてはAdobe社が提供しているWeb上にあるIllustratorのJavaScriptリファレンス（英語）などを参照してください。</p>
<p>　本書で使用しているプログラムを、以下のページからサンプルとしてダウンロードすることができます。</p>
<p>
<a href="http://www.openspc2.org/download/AI/">http://www.openspc2.org/download/AI/</a>
</p>
<p>　サンプルの場所は、本書の章番号および節番号に対応しています。</p>
<p>　例えば、第2章の第3節、「2-3　スクリプトエンジンのバージョンを求める」のサンプルは、「chapter02」フォルダ内の「03」フォルダに「sample.jsx」として用意しています。</p>
<p>　1つの節で複数のサンプルを使用している場合は、対応するフォルダ内に個別のファイル名で格納しています。それぞれのファイル名は、本書内の該当する箇所に記載しています。</p>
<p>　なお、このダウンロードサービスはあくまで読者サービスの一環として実施するもので、利用期間を保証できません。</p>
</section>
</div>
<div id="calibre_link-2">
<section>
<div>
<h1 id="calibre_link-145"><b>電子書籍閲覧に関するご注意</b></h1>
</div>
<p>　本書では、プログラムリストに専用の等幅フォントを使用しています。ビューアによって以下の作業が必要になります。</p>
<p>・Kindle Paperwhiteの場合：フォント設定画面で「出版者のフォント」を選択</p>
<p>・kobo Androidアプリの場合：フォント画面で「オリジナル」を選択</p>
</section>
</div>
<div id="calibre_link-142">
<h1 id="calibre_link-764"><b>目次</b></h1><ol><li value="1"><a href="#calibre_link-143">はじめに</a><ol><li value="1"><a href="#calibre_link-144">注意事項と免責事項</a></li></ol></li><li value="2"><a href="#calibre_link-145">電子書籍閲覧に関するご注意</a></li><li value="3"><a href="#calibre_link-146">第1章　イントロダクション</a><ol><li value="1"><a href="#calibre_link-147">1-1　本書掲載プログラムについての注意事項</a></li><li value="2"><a href="#calibre_link-148">1-2　本書内の各プログラムについて</a></li><li value="3"><a href="#calibre_link-149">1-3　Illustratorのバージョンによる動作の違いについて</a></li><li value="4"><a href="#calibre_link-150">1-4　プログラム（JavaScript）を実行するには</a></li><li value="5"><a href="#calibre_link-151">1-5　プログラムが動かない場合の対処方法</a></li><li value="6"><a href="#calibre_link-152">1-6　プログラムを組み合わせると、なぜ動かないのか</a></li><li value="7"><a href="#calibre_link-153">1-7　より手軽に自動化するにはどうしたらよいか</a></li></ol></li><li value="4"><a href="#calibre_link-154">第2章　アプリケーション</a><ol><li value="1"><a href="#calibre_link-155">2-1　アプリケーション名を求める</a></li><li value="2"><a href="#calibre_link-156">2-2　バージョンを求める／指定バージョン以上でしか動作しないようにする</a></li><li value="3"><a href="#calibre_link-157">2-3　スクリプトエンジンのバージョンを求める</a></li><li value="4"><a href="#calibre_link-158">2-4　音を鳴らす／処理が終わったら音で知らせる</a></li><li value="5"><a href="#calibre_link-159">2-5　カット／コピー／ペーストする</a></li><li value="6"><a href="#calibre_link-160">2-6　取り消し（アンドゥ）／再実行（リドゥ）処理を行う</a></li><li value="7"><a href="#calibre_link-161">2-7　実行しているスクリプトのファイル名／ファイルパスを求める</a></li><li value="8"><a href="#calibre_link-162">2-8　イラストレータを終了させる</a></li><li value="9"><a href="#calibre_link-163">2-9　なるべくアラートダイアログが表示されないようにする</a></li><li value="10"><a href="#calibre_link-164">2-10　空きメモリ容量を調べる</a></li><li value="11"><a href="#calibre_link-165">2-11　プラグインにメッセージとデータを送る</a></li><li value="12"><a href="#calibre_link-166">2-12　アプリケーションのパスを取得する</a></li><li value="13"><a href="#calibre_link-167">2-13　アプリケーションのパスを取得する</a></li><li value="14"><a href="#calibre_link-168">2-14　座標系を取得する／設定する</a></li><li value="15"><a href="#calibre_link-169">2-15　ワークスペースを切り替える（CC以降）</a></li><li value="16"><a href="#calibre_link-170">2-16　ワークスペースをリセットする（CC以降）</a></li><li value="17"><a href="#calibre_link-171">2-17　ワークスペースを削除する（CC以降）</a></li><li value="18"><a href="#calibre_link-172">2-18　ワークスペースを保存する（CC以降）</a></li></ol></li><li value="5"><a href="#calibre_link-173">第3章　ドキュメント</a><ol><li value="1"><a href="#calibre_link-174">3-1　ドキュメントを開く</a></li><li value="2"><a href="#calibre_link-175">3-2　新規にドキュメントを作成する</a></li><li value="3"><a href="#calibre_link-176">3-3　詳細な設定で新規にドキュメントを作成する</a></li><li value="4"><a href="#calibre_link-177">3-4　最前面（アクティブ）のドキュメントを指定する</a></li><li value="5"><a href="#calibre_link-178">3-5　開かれているドキュメントの総数を求める</a></li><li value="6"><a href="#calibre_link-179">3-6　ドキュメントが保存されたかどうか調べる</a></li><li value="7"><a href="#calibre_link-180">3-7　ドキュメントを保存する</a></li><li value="8"><a href="#calibre_link-181">3-8　ドキュメントの一部をPNG画像として保存する</a></li><li value="9"><a href="#calibre_link-182">3-9　ドキュメントを分割してPNG形式で保存する</a></li><li value="10"><a href="#calibre_link-183">3-10　ドキュメント名を取得する</a></li><li value="11"><a href="#calibre_link-184">3-11　ドキュメントサイズを取得する</a></li><li value="12"><a href="#calibre_link-185">3-12　ドキュメントのカラーモードを調べる</a></li><li value="13"><a href="#calibre_link-186">3-13　ドキュメントの原点座標を取得する</a></li><li value="14"><a href="#calibre_link-187">3-14　トリムエリアを設定する</a></li><li value="15"><a href="#calibre_link-188">3-15　ドキュメントを閉じる</a></li><li value="16"><a href="#calibre_link-189">3-16　強制的に全てのドキュメントを保存せずに閉じる</a></li><li value="17"><a href="#calibre_link-190">3-17　選択されている図形を他のドキュメントに移動させる</a></li><li value="18"><a href="#calibre_link-191">3-18　遠近グリッドを表示する</a></li><li value="19"><a href="#calibre_link-192">3-19　遠近グリッドで、どの面がアクティブになっているか調べる</a></li><li value="20"><a href="#calibre_link-193">3-20　遠近グリッドで指定した面をアクティブにする</a></li></ol></li><li value="6"><a href="#calibre_link-194">第4章　カラー</a><ol><li value="1"><a href="#calibre_link-195">4-1　RGBカラーで指定する</a></li><li value="2"><a href="#calibre_link-196">4-2　CMYKカラーで指定する</a></li><li value="3"><a href="#calibre_link-197">4-3　グレースケールカラーで指定する</a></li><li value="4"><a href="#calibre_link-198">4-4　透明（カラーなし）を指定する</a></li><li value="5"><a href="#calibre_link-199">4-5　Labカラーで指定する</a></li><li value="6"><a href="#calibre_link-200">4-6　グラデーションカラーを指定する</a></li><li value="7"><a href="#calibre_link-201">4-7　パターンカラーを指定する</a></li><li value="8"><a href="#calibre_link-202">4-8　スポットカラーを指定する</a></li><li value="9"><a href="#calibre_link-203">4-9　オブジェクトのカラーを読み出す</a></li><li value="10"><a href="#calibre_link-204">4-10　スウォッチカラーの総数を求める</a></li><li value="11"><a href="#calibre_link-205">4-11　特定のスウォッチカラーを削除する</a></li><li value="12"><a href="#calibre_link-206">4-12　全てのスウォッチカラーを削除する</a></li><li value="13"><a href="#calibre_link-207">4-13　スウォッチパネルで選択されているスウォッチカラーを取得する</a></li><li value="14"><a href="#calibre_link-208">4-14　スウォッチカラーを追加する</a></li><li value="15"><a href="#calibre_link-209">4-15　スウォッチカラーグループの総数を求める</a></li><li value="16"><a href="#calibre_link-210">4-16　指定した名前のスウォッチカラーグループを削除する</a></li><li value="17"><a href="#calibre_link-211">4-17　全てのスウォッチカラーグループを削除する</a></li><li value="18"><a href="#calibre_link-212">4-18　スウォッチカラーグループ内のスウォッチカラーを求める</a></li><li value="19"><a href="#calibre_link-213">4-19　スウォッチカラーグループを追加する</a></li><li value="20"><a href="#calibre_link-214">4-20　スウォッチカラーグループ内にスウォッチカラーを追加する</a></li><li value="21"><a href="#calibre_link-215">4-21　スポットカラーの総数を求める</a></li><li value="22"><a href="#calibre_link-216">4-22　特定のスポットカラーを削除する</a></li><li value="23"><a href="#calibre_link-217">4-23　全てのスポットカラーを削除する</a></li><li value="24"><a href="#calibre_link-218">4-24　スポットカラーの種類を調べる</a></li><li value="25"><a href="#calibre_link-219">4-25　パターンカラーの総数を求める</a></li><li value="26"><a href="#calibre_link-220">4-26　指定した名前のパターンカラーを削除する</a></li><li value="27"><a href="#calibre_link-221">4-27　全てのパターンカラーを削除する</a></li><li value="28"><a href="#calibre_link-222">4-28　グラデーションカラーの総数を求める</a></li><li value="29"><a href="#calibre_link-223">4-29　指定した名前のグラデーションカラーを削除する</a></li><li value="30"><a href="#calibre_link-224">4-30　全てのグラデーションカラーを削除する</a></li><li value="31"><a href="#calibre_link-225">4-31　オーバープリントが設定されているか調べる</a></li></ol></li><li value="7"><a href="#calibre_link-226">第5章　フォント／書体</a><ol><li value="1"><a href="#calibre_link-227">5-1　登録フォント（書体）数を求める</a></li><li value="2"><a href="#calibre_link-228">5-2　フォント名、フォントファミリー名を求める</a></li><li value="3"><a href="#calibre_link-229">5-3　全てのフォント名を表示する</a></li><li value="4"><a href="#calibre_link-230">5-4　特定のフォント（書体）を指定する</a></li><li value="5"><a href="#calibre_link-231">5-5　ドキュメントで使用されているフォントを調べる</a></li></ol></li><li value="8"><a href="#calibre_link-232">第6章　テキストフレーム</a><ol><li value="1"><a href="#calibre_link-233">6-1　テキストフレームを作成する</a></li><li value="2"><a href="#calibre_link-234">6-2　エリアテキストを作成する</a></li><li value="3"><a href="#calibre_link-235">6-3　パステキストを作成する</a></li><li value="4"><a href="#calibre_link-236">6-4　段組を作成する</a></li><li value="5"><a href="#calibre_link-237">6-5　テキストフレームを回転する</a></li><li value="6"><a href="#calibre_link-238">6-6　テキストフレームのスケールを変更する（拡大縮小）</a></li><li value="7"><a href="#calibre_link-239">6-7　テキストフレームを複製する</a></li><li value="8"><a href="#calibre_link-240">6-8　テキストのアウトラインを作成する</a></li><li value="9"><a href="#calibre_link-241">6-9　テキストフレームの不透明度を指定する</a></li><li value="10"><a href="#calibre_link-242">6-10　テキストフレームの種類を調べる</a></li><li value="11"><a href="#calibre_link-243">6-11　テキストフレームのサイズを取得する</a></li><li value="12"><a href="#calibre_link-244">6-12　テキストフレームの前後関係（Z座標・奥行き）を変更する</a></li><li value="13"><a href="#calibre_link-245">6-13　エリアオブジェクトからポイントテキストに変換する（CC以降）</a></li><li value="14"><a href="#calibre_link-246">6-14　テキストフレーム全体の英文字のキャップスを設定する</a></li><li value="15"><a href="#calibre_link-247">6-15　テキストフレームの半角数字と記号を縦中横にし位置を微調整する</a></li><li value="16"><a href="#calibre_link-248">6-16　エリアテキストがオーバーフローしているかどうか調べる</a></li><li value="17"><a href="#calibre_link-249">6-17　ダミーの文字でテキストフレームを埋める（単独テキストフレームの場合）</a></li><li value="18"><a href="#calibre_link-250">6-18　ダミーの文字でテキストフレームを埋める（リンクされている場合）</a></li><li value="19"><a href="#calibre_link-251">6-19　選択されたテキストフレームの縦書き・横書きを切り替える</a></li><li value="20"><a href="#calibre_link-252">6-20　テキストフレームをリンクする</a></li><li value="21"><a href="#calibre_link-253">6-21　テキストフレームのリンクを解除する（CC以降）</a></li><li value="22"><a href="#calibre_link-254">6-22　他のテキストフレームとリンクしているかどうか調べる</a></li><li value="23"><a href="#calibre_link-255">6-23　選択したテキストフレームを1行ごとに分解する（横書き／スタイル無視）</a></li><li value="24"><a href="#calibre_link-256">6-24　選択したパステキストの文字を外側・内側にする</a></li></ol></li><li value="9"><a href="#calibre_link-257">第7章　パラグラフ／段落</a><ol><li value="1"><a href="#calibre_link-258">7-1　段落を作成する</a></li><li value="2"><a href="#calibre_link-259">7-2　段落を挿入する</a></li><li value="3"><a href="#calibre_link-260">7-3　段落を削除する</a></li><li value="4"><a href="#calibre_link-261">7-4　段落スタイルを作成する</a></li><li value="5"><a href="#calibre_link-262">7-5　段落スタイルを反映させる</a></li><li value="6"><a href="#calibre_link-263">7-6　行揃えを指定する</a></li><li value="7"><a href="#calibre_link-264">7-7　奇数行と偶数行で異なる段落スタイルを反映させる</a></li><li value="8"><a href="#calibre_link-265">7-8　行単位で文字サイズを指定する</a></li><li value="9"><a href="#calibre_link-266">7-9　行単位でフォント（書体）を指定する</a></li><li value="10"><a href="#calibre_link-267">7-10　行単位でベースラインを指定する</a></li><li value="11"><a href="#calibre_link-268">7-11　行単位で文字色を指定する</a></li><li value="12"><a href="#calibre_link-269">7-12　行間を指定する</a></li><li value="13"><a href="#calibre_link-270">7-13　段落の総数を取得する</a></li><li value="14"><a href="#calibre_link-271">7-14　段落スタイル名を取得する</a></li><li value="15"><a href="#calibre_link-272">7-15　段落の禁則処理名を求める</a></li><li value="16"><a href="#calibre_link-273">7-16　段落のインデントを（字下げ）指定する</a></li><li value="17"><a href="#calibre_link-274">7-17　選択されたテキストフレームの行数を表示する</a></li><li value="18"><a href="#calibre_link-275">7-18　選択されたテキストフレームの内部行数と表示行数を表示する</a></li><li value="19"><a href="#calibre_link-276">7-19　選択されたテキストフレームの表示行の右側で改行する</a></li><li value="20"><a href="#calibre_link-277">7-20　選択されたテキストフレームの空行を削除する（スタイル無視）</a></li><li value="21"><a href="#calibre_link-278">7-21　選択されたテキストフレームの空行を削除する（スタイル維持）</a></li><li value="22"><a href="#calibre_link-279">7-22　1行ずつ番号をつける</a></li></ol></li><li value="10"><a href="#calibre_link-280">第8章　テキスト／文字</a><ol><li value="1"><a href="#calibre_link-281">8-1　文字のサイズを指定する</a></li><li value="2"><a href="#calibre_link-282">8-2　行間を指定する</a></li><li value="3"><a href="#calibre_link-283">8-3　文字の色を指定する</a></li><li value="4"><a href="#calibre_link-284">8-4　文字のフォント（書体）を指定する</a></li><li value="5"><a href="#calibre_link-285">8-5　文字の長体、平体を設定する</a></li><li value="6"><a href="#calibre_link-286">8-6　文字のトラッキングを設定する</a></li><li value="7"><a href="#calibre_link-287">8-7　文字のカーニングを設定する</a></li><li value="8"><a href="#calibre_link-288">8-8　文字のベースラインを設定する</a></li><li value="9"><a href="#calibre_link-289">8-9　英文字のキャップスを設定する</a></li><li value="10"><a href="#calibre_link-290">8-10　文字のスタイル名を求める</a></li><li value="11"><a href="#calibre_link-291">8-11　選択された文字を縦中横にする</a></li><li value="12"><a href="#calibre_link-292">8-12　選択された英数字や記号を縦書き用に回転させる</a></li><li value="13"><a href="#calibre_link-293">8-13　選択された文字を割注にする</a></li><li value="14"><a href="#calibre_link-294">8-14　平仮名・片仮名と漢字に別々のフォントを指定する</a></li><li value="15"><a href="#calibre_link-295">8-15　選択されたテキストフレーム内の数値を3桁のカンマで区切る</a></li></ol></li><li value="11"><a href="#calibre_link-296">第9章　正規表現</a><ol><li value="1"><a href="#calibre_link-297">9-1　特定の文字が含まれるかどうかを調べる</a></li><li value="2"><a href="#calibre_link-298">9-2　マッチした文字の数を調べる</a></li><li value="3"><a href="#calibre_link-299">9-3　マッチした文字を取得する</a></li><li value="4"><a href="#calibre_link-300">9-4　文字を置換する</a></li><li value="5"><a href="#calibre_link-301">9-5　より高度な置換処理を行う（西暦年を平成に変換）</a></li></ol></li><li value="12"><a href="#calibre_link-302">第10章　図形</a><ol><li value="1"><a href="#calibre_link-303">10-1　四角形を描く</a></li><li value="2"><a href="#calibre_link-304">10-2　角丸四角形を描く</a></li><li value="3"><a href="#calibre_link-305">10-3　楕円形を描く</a></li><li value="4"><a href="#calibre_link-306">10-4　多角形を描く</a></li><li value="5"><a href="#calibre_link-307">10-5　星形を描く</a></li><li value="6"><a href="#calibre_link-308">10-6　直線を描く</a></li><li value="7"><a href="#calibre_link-309">10-7　連続直線を描く</a></li><li value="8"><a href="#calibre_link-310">10-8　点線を描く</a></li><li value="9"><a href="#calibre_link-311">10-9　ベジエ曲線を描く</a></li><li value="10"><a href="#calibre_link-312">10-10　半円形を描く</a></li><li value="11"><a href="#calibre_link-313">10-11　円弧を描く</a></li></ol></li><li value="13"><a href="#calibre_link-314">第11章　パス／図形</a><ol><li value="1"><a href="#calibre_link-315">11-1　パスの総数を求める</a></li><li value="2"><a href="#calibre_link-316">11-2　選択されたパスのポイントの総数を取得する</a></li><li value="3"><a href="#calibre_link-317">11-3　選択されたパスポイントの座標値を求める</a></li><li value="4"><a href="#calibre_link-318">11-4　選択されたパスポイントのハンドル座標を求める</a></li><li value="5"><a href="#calibre_link-319">11-5　ドキュメント内のパスを削除する</a></li><li value="6"><a href="#calibre_link-320">11-6　特定のレイヤー内の全てのパスを削除する</a></li><li value="7"><a href="#calibre_link-321">11-7　特定のパスポイントを削除する</a></li><li value="8"><a href="#calibre_link-322">11-8　特定のパスポイントを選択する</a></li><li value="9"><a href="#calibre_link-323">11-9　複合パスを作成する</a></li><li value="10"><a href="#calibre_link-324">11-10　ロックされていない複合パスを削除する</a></li><li value="11"><a href="#calibre_link-325">11-11　複合パスの総数を取得する</a></li><li value="12"><a href="#calibre_link-326">11-12　クリッピングパスを作成する</a></li><li value="13"><a href="#calibre_link-327">11-13　ガイドを作成する</a></li><li value="14"><a href="#calibre_link-328">11-14　前後関係（Z座標／奥行き）を変更する</a></li><li value="15"><a href="#calibre_link-329">11-15　不透明度を指定する</a></li><li value="16"><a href="#calibre_link-330">11-16　描画モードを指定する</a></li><li value="17"><a href="#calibre_link-331">11-17　孤立点があるかどうかを調べる</a></li><li value="18"><a href="#calibre_link-332">11-18　孤立点を削除する</a></li><li value="19"><a href="#calibre_link-333">11-19　選択した図形のポイントの座標をテキストフレームに表示する</a></li></ol></li><li value="14"><a href="#calibre_link-334">第12章　イメージ／画像</a><ol><li value="1"><a href="#calibre_link-335">12-1　配置された画像の数を求める</a></li><li value="2"><a href="#calibre_link-336">12-2　選択された画像を相対的に移動させる</a></li><li value="3"><a href="#calibre_link-337">12-3　選択された画像をドキュメントの指定座標（絶対座標）に移動させる</a></li><li value="4"><a href="#calibre_link-338">12-4　選択された画像を回転させる</a></li><li value="5"><a href="#calibre_link-339">12-5　選択された中で画像だけ削除する</a></li><li value="6"><a href="#calibre_link-340">12-6　画像だけ選択する</a></li><li value="7"><a href="#calibre_link-341">12-7　JPEG画像や特定の種類の画像だけ選択する</a></li><li value="8"><a href="#calibre_link-342">12-8　画像を配置する</a></li><li value="9"><a href="#calibre_link-343">12-9　連続して画像を配置する</a></li><li value="10"><a href="#calibre_link-344">12-10　選択した画像の数だけ自動的にアートボードを追加して配置する</a></li><li value="11"><a href="#calibre_link-345">12-11　配置された画像のファイルパスを取得する</a></li><li value="12"><a href="#calibre_link-346">12-12　選択された画像の座標値を取得する</a></li><li value="13"><a href="#calibre_link-347">12-13　選択された画像の幅を取得する</a></li><li value="14"><a href="#calibre_link-348">12-14　選択された画像を指定した幅にする</a></li><li value="15"><a href="#calibre_link-349">12-15　選択された画像をトレースする</a></li><li value="16"><a href="#calibre_link-350">12-16　選択した画像のまわりに枠を付ける</a></li><li value="17"><a href="#calibre_link-351">12-17　選択した画像の右下に決まった文字列を入れる</a></li><li value="18"><a href="#calibre_link-352">12-18　選択した画像に今日の日付を入れる</a></li><li value="19"><a href="#calibre_link-353">12-19　配置されている画像の修正日を入れる</a></li><li value="20"><a href="#calibre_link-354">12-20　配置されている画像の種類（拡張子）を入れる</a></li><li value="21"><a href="#calibre_link-355">12-21　選択した画像をラスタライズ（ピクセルに変換）する</a></li></ol></li><li value="15"><a href="#calibre_link-356">第13章　グループ</a><ol><li value="1"><a href="#calibre_link-357">13-1　グループ化する</a></li><li value="2"><a href="#calibre_link-358">13-2　選択されたオブジェクトをグループ化する</a></li><li value="3"><a href="#calibre_link-359">13-3　グループを解除する</a></li></ol></li><li value="16"><a href="#calibre_link-360">第14章　レイヤー</a><ol><li value="1"><a href="#calibre_link-361">14-1　レイヤーを作成する</a></li><li value="2"><a href="#calibre_link-362">14-2　レイヤーを名前で指定する</a></li><li value="3"><a href="#calibre_link-363">14-3　レイヤーを番号で指定する</a></li><li value="4"><a href="#calibre_link-364">14-4　レイヤー／サブレイヤーの総数を取得する</a></li><li value="5"><a href="#calibre_link-365">14-5　レイヤー／サブレイヤーを削除する</a></li><li value="6"><a href="#calibre_link-366">14-6　アクティブレイヤーにアクセスする</a></li><li value="7"><a href="#calibre_link-367">14-7　レイヤーをアクティブにする</a></li><li value="8"><a href="#calibre_link-368">14-8　サブレイヤーを作成する</a></li><li value="9"><a href="#calibre_link-369">14-9　サブレイヤーを削除する</a></li><li value="10"><a href="#calibre_link-370">14-10　レイヤー内にある全てのサブレイヤーを削除する</a></li><li value="11"><a href="#calibre_link-371">14-11　レイヤー／サブレイヤーの情報をテキストフレームに出力する</a></li><li value="12"><a href="#calibre_link-372">14-12　指定したレイヤーを移動させる</a></li></ol></li><li value="17"><a href="#calibre_link-373">第15章　選択</a><ol><li value="1"><a href="#calibre_link-374">15-1　選択を解除する</a></li><li value="2"><a href="#calibre_link-375">15-2　ロックされていない全ての項目を選択する</a></li><li value="3"><a href="#calibre_link-376">15-3　特定のレイヤーにある全ての項目を選択する</a></li><li value="4"><a href="#calibre_link-377">15-4　アクティブになっているアートボード上の図形を選択する</a></li><li value="5"><a href="#calibre_link-378">15-5　特定のアートボード内にある項目だけ選択する</a></li><li value="6"><a href="#calibre_link-379">15-6　ロックを解除し全ての項目を選択する</a></li><li value="7"><a href="#calibre_link-380">15-7　選択されたオブジェクトの種類を求める</a></li><li value="8"><a href="#calibre_link-381">15-8　テキストフレームだけ選択する</a></li><li value="9"><a href="#calibre_link-382">15-9　テキストフレームだけ選択を解除する</a></li><li value="10"><a href="#calibre_link-383">15-10　特定のメモ（注釈）を持つオブジェクトのみ選択する</a></li><li value="11"><a href="#calibre_link-384">15-11　特定の破線パターンのパスだけ選択する</a></li><li value="12"><a href="#calibre_link-385">15-12　選択された中でパスを削除する</a></li></ol></li><li value="18"><a href="#calibre_link-386">第16章　選択（文字／TextRange）</a><ol><li value="1"><a href="#calibre_link-387">16-1　選択されたテキストフレーム内の文字を取得する</a></li><li value="2"><a href="#calibre_link-388">16-2　選択したテキストフレーム内の文字を削除する</a></li><li value="3"><a href="#calibre_link-389">16-3　選択されたテキストフレームの特定の行を選択する</a></li><li value="4"><a href="#calibre_link-390">16-4　テキストフレーム内で任意の位置から文字を新規に選択する</a></li><li value="5"><a href="#calibre_link-391">16-5　テキストフレーム内で複数の選択範囲を指定する</a></li><li value="6"><a href="#calibre_link-392">16-6　テキストフレーム内で選択された文字の位置を求める</a></li><li value="7"><a href="#calibre_link-393">16-7　選択文字か挿入ポイントの前後に文字を追加する</a></li><li value="8"><a href="#calibre_link-394">16-8　複数のテキストフレーム内で文字を選択する</a></li><li value="9"><a href="#calibre_link-395">16-9　複数のテキストフレームで半角数値のみ選択する</a></li><li value="10"><a href="#calibre_link-396">16-10　複数のテキストフレームで英文字のみ選択する</a></li><li value="11"><a href="#calibre_link-397">16-11　複数のテキストフレームで平仮名のみ選択する</a></li><li value="12"><a href="#calibre_link-398">16-12　複数のテキストフレームで片仮名のみ選択する</a></li><li value="13"><a href="#calibre_link-399">16-13　複数のテキストフレームで特定の文字のみ選択する</a></li><li value="14"><a href="#calibre_link-400">16-14　選択された文字の色を変更する</a></li><li value="15"><a href="#calibre_link-401">16-15　選択された文字のサイズを変更する</a></li><li value="16"><a href="#calibre_link-402">16-16　半角数字を縦中横にする</a></li></ol></li><li value="19"><a href="#calibre_link-403">第17章　グラフィックスタイル</a><ol><li value="1"><a href="#calibre_link-404">17-1　グラフィックスタイルの登録数を表示する</a></li><li value="2"><a href="#calibre_link-405">17-2　選択した文字や図形にグラフィックスタイルを設定する</a></li><li value="3"><a href="#calibre_link-406">17-3　グラフィックスタイルを削除する</a></li></ol></li><li value="20"><a href="#calibre_link-407">第18章　グラフ</a><ol><li value="1"><a href="#calibre_link-408">18-1　ドキュメント内にあるグラフ数を表示する</a></li><li value="2"><a href="#calibre_link-409">18-2　ドキュメント内にあるグラフを全て削除する</a></li><li value="3"><a href="#calibre_link-410">18-3　ドキュメント内にあるグラフのオフセットを指定する</a></li></ol></li><li value="21"><a href="#calibre_link-411">第19章　シンボル</a><ol><li value="1"><a href="#calibre_link-412">19-1　登録されているシンボル数を表示する</a></li><li value="2"><a href="#calibre_link-413">19-2　特定の名前を持つシンボルを削除する</a></li><li value="3"><a href="#calibre_link-414">19-3　全てのシンボルを削除する</a></li><li value="4"><a href="#calibre_link-415">19-4　シンボルを登録する</a></li></ol></li><li value="22"><a href="#calibre_link-416">第20章　シンボルアイテム</a><ol><li value="1"><a href="#calibre_link-417">20-1　ドキュメント内にあるシンボルアイテム数を表示する</a></li><li value="2"><a href="#calibre_link-418">20-2　特定のシンボル名を持つシンボルアイテムを削除する</a></li><li value="3"><a href="#calibre_link-419">20-3　ドキュメント内にあるシンボルアイテムを全て削除する</a></li><li value="4"><a href="#calibre_link-420">20-4　シンボルをドキュメント上に表示する</a></li><li value="5"><a href="#calibre_link-421">20-5　複数のシンボルをドキュメント内にランダムに配置し回転させる</a></li></ol></li><li value="23"><a href="#calibre_link-422">第21章　メッシュグラデーション</a><ol><li value="1"><a href="#calibre_link-423">21-1　ドキュメント内にあるメッシュグラデーション適用図形の数を表示する</a></li><li value="2"><a href="#calibre_link-424">21-2　ドキュメント内にあるメッシュグラデーション適用図形を全て削除する</a></li><li value="3"><a href="#calibre_link-425">21-3　選択したメッシュグラデーションをページの右端まで複製し配置する</a></li></ol></li><li value="24"><a href="#calibre_link-426">第22章　プラグインアイテム</a><ol><li value="1"><a href="#calibre_link-427">22-1　ドキュメント内にあるプラグインアイテム数を表示する</a></li><li value="2"><a href="#calibre_link-428">22-2　ドキュメント内にあるプラグインアイテムを全て削除する</a></li></ol></li><li value="25"><a href="#calibre_link-429">第23章　ブラシ</a><ol><li value="1"><a href="#calibre_link-430">23-1　ドキュメント内にあるブラシの総数を表示する</a></li><li value="2"><a href="#calibre_link-431">23-2　選択した図形に指定したブラシを適用する</a></li></ol></li><li value="26"><a href="#calibre_link-432">第24章　プリント／印刷</a><ol><li value="1"><a href="#calibre_link-433">24-1　プリンタ一覧を取得する</a></li><li value="2"><a href="#calibre_link-434">24-2　プリントプリセットを取得する</a></li><li value="3"><a href="#calibre_link-435">24-3　アクティブドキュメントを印刷する</a></li><li value="4"><a href="#calibre_link-436">24-4　指定したプリンタで使える用紙サイズ一覧を取得する</a></li><li value="5"><a href="#calibre_link-437">24-5　プリンタの種類を調べる</a></li></ol></li><li value="27"><a href="#calibre_link-438">第25章　フォルダ</a><ol><li value="1"><a href="#calibre_link-439">25-1　現在のフォルダ（カレントフォルダ）を取得する</a></li><li value="2"><a href="#calibre_link-440">25-2　ドキュメントフォルダを取得する</a></li><li value="3"><a href="#calibre_link-441">25-3　デスクトップフォルダを取得する</a></li><li value="4"><a href="#calibre_link-442">25-4　ゴミ箱フォルダを取得する</a></li><li value="5"><a href="#calibre_link-443">25-5　テンポラリフォルダを取得する</a></li><li value="6"><a href="#calibre_link-444">25-6　フォルダ内のAIファイル一覧を取得する</a></li><li value="7"><a href="#calibre_link-445">25-7　サブフォルダ内のAIファイル一覧を取得する</a></li><li value="8"><a href="#calibre_link-446">25-8　フォルダ／サブフォルダ内にあるJPEGファイルを配置する</a></li></ol></li><li value="28"><a href="#calibre_link-447">第26章　ファイル</a><ol><li value="1"><a href="#calibre_link-448">26-1　Illustratorで開くことができるファイルを、ファイル選択ダイアログを表示して開く</a></li><li value="2"><a href="#calibre_link-449">26-2　ファイルパスを指定して開く</a></li><li value="3"><a href="#calibre_link-450">26-3　テキストファイルを読み込みエリアテキストとして配置する</a></li><li value="4"><a href="#calibre_link-451">26-4　テキストファイルで任意の位置から任意の文字数だけ読み込む</a></li><li value="5"><a href="#calibre_link-452">26-5　ファイルに選択されたエリアテキストの内容を書き込む</a></li><li value="6"><a href="#calibre_link-453">26-6　ファイルをコピーする</a></li><li value="7"><a href="#calibre_link-454">26-7　ファイルを削除する</a></li><li value="8"><a href="#calibre_link-455">26-8　ファイル名を変更する</a></li><li value="9"><a href="#calibre_link-456">26-9　ファイル名を取得する</a></li><li value="10"><a href="#calibre_link-457">26-10　ファイルのパスを求める</a></li><li value="11"><a href="#calibre_link-458">26-11　ファイルサイズを取得する</a></li><li value="12"><a href="#calibre_link-459">26-12　ファイルがエイリアス／ショートカットかどうか調べる</a></li><li value="13"><a href="#calibre_link-460">26-13　ファイルの作成日、修正日を求める</a></li><li value="14"><a href="#calibre_link-461">26-14　ファイルが存在するかどうか調べる</a></li><li value="15"><a href="#calibre_link-462">26-15　改行コードの種類を調べる</a></li><li value="16"><a href="#calibre_link-463">26-16　ファイルが書き込み禁止（ロックされている）かどうか調べる</a></li><li value="17"><a href="#calibre_link-464">26-17　親フォルダを求める</a></li><li value="18"><a href="#calibre_link-465">26-18　アプリケーションを実行する</a></li><li value="19"><a href="#calibre_link-466">26-19　スウォッチカラーなどのカラー情報をファイルに書き出す</a></li></ol></li><li value="29"><a href="#calibre_link-467">第27章　ファイル保存</a><ol><li value="1"><a href="#calibre_link-468">27-1　アクティブドキュメントを保存する</a></li><li value="2"><a href="#calibre_link-469">27-2　EPS形式で保存する</a></li><li value="3"><a href="#calibre_link-470">27-3　GIF形式で保存する</a></li><li value="4"><a href="#calibre_link-471">27-4　PNG8形式で保存する</a></li><li value="5"><a href="#calibre_link-472">27-5　PNG24形式で保存する</a></li><li value="6"><a href="#calibre_link-473">27-6　JPEG形式で保存する</a></li><li value="7"><a href="#calibre_link-474">27-7　Photoshop形式で保存する</a></li><li value="8"><a href="#calibre_link-475">27-8　PDF形式で保存する</a></li><li value="9"><a href="#calibre_link-476">27-9　SVG形式で保存する</a></li><li value="10"><a href="#calibre_link-477">27-10　TIFF形式で保存する</a></li></ol></li><li value="30"><a href="#calibre_link-478">第28章　XML／データ処理</a><ol><li value="1"><a href="#calibre_link-479">28-1　XMLデータを作成する</a></li><li value="2"><a href="#calibre_link-480">28-2　配列の参照番号を使って特定のXMLタグにアクセスする</a></li><li value="3"><a href="#calibre_link-481">28-3　child()を使って特定のXMLタグにアクセスする</a></li><li value="4"><a href="#calibre_link-482">28-4　指定したXMLタグの数を求める</a></li><li value="5"><a href="#calibre_link-483">28-5　XMLタグの属性にアクセスする</a></li><li value="6"><a href="#calibre_link-484">28-6　XMLデータをファイルから読み込む</a></li></ol></li><li value="31"><a href="#calibre_link-485">第29章　PDF</a><ol><li value="1"><a href="#calibre_link-486">29-1　ページを指定してPDFを開く</a></li><li value="2"><a href="#calibre_link-487">29-2　ドキュメントをPDFとして保存する</a></li><li value="3"><a href="#calibre_link-488">29-3　ドキュメントをパスワード付きのPDFとして保存する</a></li></ol></li><li value="32"><a href="#calibre_link-489">第30章　アートボード（CS4以降）</a><ol><li value="1"><a href="#calibre_link-490">30-1　アートボードの数を求める</a></li><li value="2"><a href="#calibre_link-491">30-2　アートボードを追加する</a></li><li value="3"><a href="#calibre_link-492">30-3　アクティブになっているアートボードを求める</a></li><li value="4"><a href="#calibre_link-493">30-4　指定したアートボードをアクティブにする</a></li><li value="5"><a href="#calibre_link-494">30-5　アートボードのサイズを取得する</a></li><li value="6"><a href="#calibre_link-495">30-6　アートボードを削除する</a></li><li value="7"><a href="#calibre_link-496">30-7　全てのアートボードにセンターマークやセーフゾーンを表示する</a></li><li value="8"><a href="#calibre_link-497">30-8　アクティブになっているアートボード内にあるパスだけ残す</a></li><li value="9"><a href="#calibre_link-498">30-9　全てのアートボードの右下に文字を入れる</a></li><li value="10"><a href="#calibre_link-499">30-10　全てのアートボードにページ番号（ノンブル）を入れる</a></li><li value="11"><a href="#calibre_link-500">30-11　指定したアートボードを選択した図形のサイズに合わせる</a></li><li value="12"><a href="#calibre_link-501">30-12　アートボードを再レイアウト（整理整頓）する</a></li></ol></li><li value="33"><a href="#calibre_link-502">第31章　マトリクス</a><ol><li value="1"><a href="#calibre_link-503">31-1　マトリクスオブジェクトを作成する</a></li><li value="2"><a href="#calibre_link-504">31-2　選択した図形のマトリクス値を表示する</a></li><li value="3"><a href="#calibre_link-505">31-3　マトリクスオブジェクトを連結する</a></li><li value="4"><a href="#calibre_link-506">31-4　選択された図形を、マトリクスを使って回転させる</a></li><li value="5"><a href="#calibre_link-507">31-5　選択された図形を、マトリクスを使って拡大縮小させる</a></li><li value="6"><a href="#calibre_link-508">31-6　選択された図形を、マトリクスを使って移動させる</a></li><li value="7"><a href="#calibre_link-509">31-7　選択した図形を傾斜させる</a></li><li value="8"><a href="#calibre_link-510">31-8　選択した図形を左右反転させる</a></li></ol></li><li value="34"><a href="#calibre_link-511">第32章　その他の自動処理</a><ol><li value="1"><a href="#calibre_link-512">32-1　スクリプトからアクションを実行する</a></li><li value="2"><a href="#calibre_link-513">32-2　アクションファイルを読み込む</a></li><li value="3"><a href="#calibre_link-514">32-3　スクリプトからメニューを実行する</a></li><li value="4"><a href="#calibre_link-515">32-4　スクリプトからエフェクト効果のダイアログを表示する</a></li><li value="5"><a href="#calibre_link-516">32-5　指定したサイズでウィンドウをキャプチャーし画像として保存する</a></li><li value="6"><a href="#calibre_link-517">32-6　1年分のカレンダーを生成する</a></li></ol></li><li value="35"><a href="#calibre_link-518">著者紹介</a></li></ol>
</div>
<div id="calibre_link-116">
<section>
<div>
<h1 id="calibre_link-146"><b>第1章　イントロダクション</b></h1>
</div>
<p>　この章では、IllustratorでJavaScriptを実行するために必要な方法や自動化に必要なプログラムの知識について説明します。</p>
</section>
</div>
<div id="calibre_link-89">
<section>
<h2 id="calibre_link-147"><b>1-1　本書掲載プログラムについての注意事項</b></h2>
<p>　本書に掲載されているプログラム（スクリプト）は個人使用、商用利用とも自由に使用することができます。ただし、本書に掲載されているプログラムを利用した際に発生する不具合等に関しては責任を負わないものとします。</p>
<p>　IllustratorではJavaScript、AppleScript、VBScriptによって制御することができますが、本書で扱っているのはJavaScriptのみです。自動化処理においてはJavaScriptのみでは対応することが難しいことがあり、AppleScriptやVBScriptおよびシェルスクリプトやOSの機能が必要になる場合があります。本書では基本編ということでJavaScriptと他のスクリプトやOSの機能に関してのサンプルおよび解説はありません。</p>
</section>
</div>
<div id="calibre_link-571">
<section>
<h2 id="calibre_link-148"><b>1-2　本書内の各プログラムについて</b></h2>
<p>　本書では、1つのプログラムについて、まずその使い方を説明しています。</p>
<p>　次にプログラムのサンプルを紹介しています。なお、本書で使用しているプログラムは、以下のページからサンプルとしてダウンロードすることができます。</p>
<p>
<a href="http://www.openspc2.org/download/AI/">http://www.openspc2.org/download/AI/</a>
</p>
<p>　ダウンロードについては、本書の「はじめに」の「注意事項と免責事項」に記載していますので、お読みください。</p>
<p>　サンプルに続き、より具体的に各プログラムを理解できるよう、プログラムの実行で表示されるメッセージや実行結果などのスクリーンショットを挿入しています。特に明記しているものを除き、スクリーンショットは、Mac OS X（10.6.8）のIllustrator CS6でキャプチャしたものです。</p>
</section>
</div>
<div id="calibre_link-680">
<section>
<h2 id="calibre_link-149"><b>1-3　Illustratorのバージョンによる動作の違いについて</b></h2>
<p>　Illustratorはバージョンによってプログラム（スクリプト）の動作が異なります。新しいバージョンになるほど機能が追加されるため、新しいバージョンで作成されたプログラムは古いバージョンでは動作しないことがあります。</p>
<table>
<caption>【表】バージョン別の主な変更点</caption>
<tbody>
<tr>
  <td>
    <span>バージョン</span>
  </td>
  <td>
    <span>変更点</span>
  </td>
</tr>
<tr>
  <td>Illustrator 9</td>
  <td>プラグインによってスクリプトの制御が可能に</td>
</tr>
<tr>
  <td>Illustrator 10</td>
  <td>標準でスクリプトの実行が可能に</td>
</tr>
<tr>
  <td>Illustrator CS</td>
  <td>テキストフレーム／テキストの扱いが変更</td>
</tr>
<tr>
  <td>Illustrator CS3</td>
  <td>CS/CS2での日本語処理の不具合修正。GUIの使用が可能に</td>
</tr>
<tr>
  <td>Illustrator CS4</td>
  <td>マルチアートボード対応</td>
</tr>
<tr>
  <td>Illustrator CS5</td>
  <td>座標系の変更（アートボード座標／ウィンドウ座標）</td>
</tr>
<tr>
  <td>Illustrator CS6</td>
  <td>スクリプトからアクションやメニューの実行が可能に</td>
</tr>
<tr>
  <td>Illustrator CC</td>
  <td>ワークスペース関連の機能追加</td>
</tr>
</tbody>
</table>
<p>　また、テキスト処理の変更や座標系の変更に伴って、古いバージョンのプログラムが動作しなくなることがあります。Illustrator CS5以降ではプログラムで新規にドキュメントを作成した場合、以下のようにアートボード座標系を設定しないと本書に掲載しているサンプルが正しく動作しないことがあります。（座標系は特に記載がない限り1枚のアートボードで原点座標はデフォルト（左上）の状態となっています。）</p>
<p>
<strong><b>app.coordinateSystem = CoordinateSystem.ARTBOARDCOORDINATESYSTEM;</b></strong>
</p>
<p>　また、pageOriginやRulerOriginなどで原点を調整した場合、描画される図形の位置は変わりますので注意してください。</p>
</section>
</div>
<div id="calibre_link-34">
<section>
<h2 id="calibre_link-150"><b>1-4　プログラム（JavaScript）を実行するには</b></h2>
<p>　Illustratorで動作するプログラムであるJavaScriptを実行する方法はいくつかあります。代表的な方法としては2つあります。</p>
<p>　まず、Illustratorのメニューから実行する方法です。バージョンに関わらず「ファイル」メニューから「スクリプト」を選択すると実行できるスクリプトの一覧が表示されます。表示されるメニュー項目のスクリプトは、Illustratorのアプリケーションがあるフォルダの中にある「プリセット」/「ja_JP」/「スクリプト」フォルダに、プログラムが書かれている.jsxファイルを入れておきます。頻繁に使うプログラムは、このようにスクリプトフォルダに入れておくとよいでしょう。</p>
<p>　ときどき使うスクリプトの場合や、一度しか実行しないような場合は「ファイル」メニューから「スクリプト」を選択し表示される「その他のスクリプト...」の項目を選択します。選択すると実行するプログラムを選択するダイアログが表示されます。プログラムを選択すると実行されます。</p>
<p>　以下にOS、バージョン別の方法を示します。</p>
<figure>
<figcaption>【図】Illustrator CS6（Mac）の場合</figcaption>
<img src="images/00389.jpeg" />
</figure>
<figure>
<figcaption>【図】Illustrator CS6（Windows）の場合</figcaption>
<img src="images/00132.jpeg" />
</figure>
<figure>
<figcaption>【図】Illustrator CC（Mac）の場合</figcaption>
<img src="images/00174.jpeg" />
</figure>
<figure>
<figcaption>【図】Illustrator CC 2014（Mac）の場合</figcaption>
<img src="images/00523.jpeg" />
</figure>
<p>　もう1つの実行方法としては、開発ツールであるESTK（ExtendScript Toolkit）を使うことです。これはプログラムの開発時に欠かせないツールで、Adobe社が開発者向けに用意したエディタ＆デバッグを行うアプリケーションです。ESTKでプログラムを入力し実行ボタンを押すことで、Illustratorでプログラムを動作させることができます。ESTKの場合、間違ってプログラムが止まらなくなってしまった場合でも強制的に停止させることができます。また、内部の状況がどうなっているのか一時停止させ確認することもできます。ESTKについて詳しく知りたい方は以下の書籍を参照してください。</p>
<p>
<strong><b>ExtendScript Toolkit（ESTK）基本編 ― Adobe JavaScriptシリーズ（NextPublishing刊）</b></strong>
</p>
<p>　この他にもOSのシェルからIllustratorのプログラムを実行したり、Adobe Bridge経由でプログラムを実行させることもできます。</p>
</section>
</div>
<div id="calibre_link-578">
<section>
<h2 id="calibre_link-151"><b>1-5　プログラムが動かない場合の対処方法</b></h2>
<p>　本書に掲載されているプログラムは、そのまま動作するものもありますが、多くは動作させるための前提条件があります。前提条件と言っても複雑なことではなく、テキストフレームが選択されている、ドキュメントが開かれている、といったことです。プログラムによっては前提条件が揃っていないとエラーで動作しないものもあります。何を選択しておけばよいかなどは、各項目の図のキャプションに書かれています。</p>
<p>　プログラムが動かない場合の対処方法はいくつかあります。プログラムを自分で入力した／書いた／変更した場合も含めると以下のような部分をチェックすることで解決への糸口が見つかることがあります。</p>
<p>
<strong><b>1. プログラムを見直す</b></strong>
</p>
<p>　基本的に動作しないのはプログラムが間違っているのが主な原因です。半角文字が全角文字になっていたり、値を間違えている、文法的に間違っている、動きそうなプログラムをコピー＆ペーストして利用しているなど原因はさまざまです。ESTKのデバッグ機能を利用してプログラムの不具合を修正してください。</p>
<p>　プログラムが動かない原因を2つに分けると「入力ミス・文法ミス」と「アルゴリズム（手順）のミス」があります。前者はESTKがエラーを出してくれますので割と早期発見が可能です。問題は後者で、アルゴリズム（手順）が悪い場合はエラーにならなくても目的の処理を行うことができないことがあります。これは、手順が正しいかどうか自分で考えて確認し、地道に実行していくしかありません。</p>
<p>
<strong><b>2. 他のユーザーアカウントで実行する</b></strong>
</p>
<p>　動作が不安定な場合は、現在のユーザーアカウントではなく、新たにアカウントを作成します。新しく作成したアカウント上でプログラムを実行することで解決できることもあります。</p>
<p>
<strong><b>3. ESTKではなくIllustratorから実行する</b></strong>
</p>
<p>　ESTKのメニューでリセットを選択してしまうと、リンクしたIllustratorのオブジェクトと連携が切れてしまい実行できないことがあります。この場合、ESTKではなくIllustratorから実行するかIllustratorを終了した後に再度Illustratorを起動してください。</p>
<p>　例えばapp.activeDocumentのようにappオブジェクトを使用していてエラーになるような場合、このような対処方法で解決できることがあります。</p>
<p>
<strong><b>4. Adobe関係のアプリケーションを全部終了させる</b></strong>
</p>
<p>　IllustratorではPhotoshopやInDesignなどで実行されたプログラムの影響を受けることがあります。特にグローバル変数・関数を利用した場合は動作が変わってしまうことがあります。このため、従来動いていたプログラムが動作しなくなったりエラーになるような場合は実行しているAdobe関係のアプリケーションを全て終了した後でIllustratorを起動してください。その後、ESTKを起動しデバッグメニューから「リセット」の項目を選択してからプログラムを実行してください。</p>
<p>　なお、このような不具合が発生する場合はIllustratorで動かすプログラムを他のアプリケーションの影響を受けないように変更する方法もあります。</p>
<p>
<strong><b>5. Illustrator/ESTKを再起動する</b></strong>
</p>
<p>　以前は動いていたプログラムが動かなくなった、プログラム実行中に原因不明のエラーが発生する、Illustratorが落ちてしまった（勝手に終了してしまった）場合はIllustratorを再起動してみてください。なお、ESTKも併用して利用している場合はESTKも再起動させてください。</p>
<p>
<strong><b>6. OSを再起動する</b></strong>
</p>
<p>　ファイルの書き込みができない、ESTKとIllustratorの組み合わせがうまく動作しないといった場合はOS（Windows/Mac OS X/OS X）を再起動してみてください。OSの再起動は最終的な手段の1つです。</p>
<p>
<strong><b>7. Illustratorを一度アンインストールし再度インストールする</b></strong>
</p>
<p>　OSの再起動でも直らない場合はIllustratorを一度アンインストールし再度インストールしてみてください。もし、可能であれば新たなマシンや環境を用意し、そこに新規にIllustratorをインストールし、その上でプログラムを実行させてみてください。</p>
<p>
<strong><b>8. あきらめる</b></strong>
</p>
<p>　一旦あきらめるのも1つの方法です。もしかしたらIllustratorのバージョンアップ、マイナーアップデートで直ってしまうこともあるためです。ただ、確実に不具合（バグ）ならばAdobeフォーラムに不具合の情報を書き込むことで、いずれ解決される可能性もあります。</p>
<p>　プログラムの作成は派手なものではなく地道に作っていくものです。すぐに自動化プログラムが作れて便利になるというものでもありません。ただ、一度動き始めてしまえば非常に強力なものになります。不具合が発生しても、あきらめずに頑張ってプログラムを作成してみてください。</p>
</section>
</div>
<div id="calibre_link-743">
<section>
<h2 id="calibre_link-152"><b>1-6　プログラムを組み合わせると、なぜ動かないのか</b></h2>
<p>　本書には多くのサンプルが掲載されています。サンプルを実行すると、それ単体では動作しますが、他のプログラムと組み合わせると動作しないことがあります。これは、本書のプログラム特有のことではなく、多くの書籍やWeb上にあるプログラムをコピー＆ペーストして利用した場合も同様です。</p>
<p>　動作するプログラム同士を組み合わせると動作しなくなる理由はいくつかあります。まず、動作する前提条件が変わってしまうことです。異なる前提条件のプログラムをコピー＆ペーストして利用すれば動かなくなるのは当然です。もちろん、運良く動く場合もあります。たとえるならシリアスなストーリー漫画の中にいきなりギャグの4コマ漫画が入り、話しが分断されてしまうような感じでしょうか。同じジャンルの漫画なのに全く違う作者の漫画を組み合わせているため、全体としてうまくないのです。</p>
<p>　また、本に掲載されているプログラムの場合は、特定の動作ポイントに絞って解説されているため本来あるべくエラー処理がなく、ちょっとした条件の違いで停止してしまうことがあります。どんな条件でもエラーで停止せずに動作するプログラムにすると長くなってしまうためページ数の関係で一部だけピックアップし掲載されることがあります。本書でも基本的にはエラー処理は、ほとんど行っていないため動作条件が変わるとエラーで停止してしまうことがあります。</p>
<p>　プログラムが動作しない理由の1つとしてIllustrator上で動作するJavaScript特有の事情もあります。例をあげて説明します。以下のプログラムはアクティブになっているドキュメント上に四角形を描きます。アクティブになっているドキュメントが存在することが前提なので、ドキュメントが1つもない場合はエラーで停止してしまいます。</p>
<p>　アクティブドキュメントを用意した後で、このプログラムを実行します。この場合エラーにならず正常に動作します。</p>
<p>アクティブになっているドキュメント上に四角形を描くサンプル（sample1.jsx）</p>
<pre><code>// 四角形を描く
var rectObj = activeDocument.pathItems.rectangle(-10, 30, 150, 100);
rectObj.fillColor = setCMYKColor(60, 0, 60, 0);
rectObj.stroked = true;     // 線を表示する
rectObj.strokeWidth = 4;    // 線の幅を指定する
rectObj.strokeColor = setCMYKColor(0, 0, 0, 100);
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
    var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}</code></pre>
<p>　次に、そのまま新規にファイルを作成した後で、以下のプログラムを実行すると、やはりアクティブになっているドキュメント上に四角形が描かれます。不思議なのはsetCMYKColor関数がないのにエラーにならず正常に動作してしまうことです。</p>
<p>setCMYKColorがない場合のサンプル（sample2.jsx）</p>
<pre><code>// 四角形を描く
var rectObj = activeDocument.pathItems.rectangle(-100, 30, 150, 100);
rectObj.fillColor = setCMYKColor(60, 0, 60, 0);
rectObj.stroked = true;     // 線を表示する
rectObj.strokeWidth = 4;    // 線の幅を指定する
rectObj.strokeColor = setCMYKColor(0, 0, 0, 100);</code></pre>
<p>　これはIllustratorのJavaScriptでは一度実行した関数や使用した変数はESTK上でリセットするかアプリケーションを再起動しない限り、ずっと残ったままになるためです。つまり使い終わったにも関わらず残ったままになるゾンビのような関数や変数があるのです。</p>
<p>　また、JavaScriptの仕様による問題もあります。例えば以下のプログラムは先ほどのプログラムの末尾にsetCMYKColorという同じ名前の関数を定義していますが、エラーにはなりません。JavaScriptでは同じ名前の関数を定義してもエラーにならず、後から定義された関数が有効になります。</p>
<p>いろいろなプログラムをコピーして使用すると同じ名前の関数を上書きしてしまい動作しなくなることがあるのは、このためです。</p>
<p>末尾にsetCMYKColorするサンプル（sample3.jsx）</p>
<pre><code>// 四角形を描く
var rectObj = activeDocument.pathItems.rectangle(-10, 30, 150, 100);
rectObj.fillColor = setCMYKColor(60, 0, 60, 0);
rectObj.stroked = true;     // 線を表示する
rectObj.strokeWidth = 4;    // 線の幅を指定する
rectObj.strokeColor = setCMYKColor(0, 0, 0, 100);
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
    var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}
// 色を設定
function setCMYKColor(){
    return 0x123456;
}</code></pre>
<p>　残ったままになるゾンビのような関数や変数、同じ名前で定義してしまうことによる不具合を解消するには、以下のようにプログラムを(function(){　〜　})();で囲みます。このようにすると、コピー＆ペーストによるプログラムの不具合を軽減できます。</p>
<p>プログラムを(function(){　〜　})();で囲むサンプル（sample4.jsx）</p>
<pre><code>// 四角形を描く
(function(){
    var rectObj = activeDocument.pathItems.rectangle(-10, 30, 150, 100);
    rectObj.fillColor = setCMYKColor(60, 0, 60, 0);
    rectObj.stroked = true;     // 線を表示する
    rectObj.strokeWidth = 4;    // 線の幅を指定する
    rectObj.strokeColor = setCMYKColor(0, 0, 0, 100);
    // CMYKカラーを設定し、CMYKカラーオブジェクトを返す
    function setCMYKColor(c,m,y,k){
        var CMYK = new CMYKColor();
        CMYK.cyan = c;
        CMYK.magenta = m;
        CMYK.yellow = y;
        CMYK.black = k;
        return CMYK;
    }
})();</code></pre>
<p>　このようにしても、組み合わせによる前提条件が一致しないと期待通りには動作しません。プログラムは推理小説のようなもので、どこか1カ所おかしくなると全体が破綻してしまうことがあります。結局のところ、どのように動作させたいかを自分で考えて、その際参考になるプログラムを本書やWebサイトから見つけて自分なりに工夫して利用するのが良い方法です。</p>
<p>　他にもトラブルが発生しやすいパターンとして繰り返し変数の重複があります。特に掲載されているプログラムをコピー＆ペーストすると繰り返し変数が重複してしまい動作がおかしくなってしまうことがあります。</p>
<p>　例えば以下の例は横方向に10個四角形を描画するプログラムです。ここではfor命令でループ変数としてiが使われています。</p>
<p>横方向に10個四角形を描画するサンプル（sample5.jsx）</p>
<pre><code>// 繰り返し処理する
for(var i=0; i&lt;10; i++){
    var rectObj = activeDocument.pathItems.rectangle(-10, i*20, 10, 10);
}</code></pre>
<p>　ここで縦方向にも繰り返そうとして以下のようにfor命令を追加してみます。このスクリプトを実行すると期待に反して四角形は斜め方向に描画されてしまいます。</p>
<p>for命令を追加する（sample6.jsx）</p>
<pre><code>// 繰り返し処理する
for(var i=0; i&lt;10; i++){
    for(var i=0; i&lt;10; i++){
        var rectObj = activeDocument.pathItems.rectangle(-20*i, i*20, 10, 10);
    }
}</code></pre>
<p>　これは繰り返しに使っている変数iが重複してしまっているためです。繰り返しに起因するトラブルの多くは変数名の間違いです。これは以下のように異なる変数名にすれば解決できます。</p>
<p>異なる変数名にするサンプル（sample7.jsx）</p>
<pre><code>// 繰り返し処理する
for(var j=0; j&lt;10; j++){
    for(var i=0; i&lt;10; i++){
        var rectObj = activeDocument.pathItems.rectangle(-20*j, i*20, 10, 10);
    }
}</code></pre>
<p>　他にもトラブルの原因はいくつかありますが、Illustratorに起因するトラブルは解決できないことがあります。</p>
</section>
</div>
<div id="calibre_link-520">
<section>
<h2 id="calibre_link-153"><b>1-7　より手軽に自動化するにはどうしたらよいか</b></h2>
<p>　自動化は簡単にできそうでできない処理もあります。全てをスクリプトを使って自動化するというのは、手慣れた人であれば可能かもしれませんが、そうでない場合予想以上に時間がかかることがあります。基本的には手作業では難しい、時間がかかる部分を自動化するのが最も効率的です。全てを完全に自動化しなくてもよいのです。</p>
<p>　Illustrator CS6以降という条件付きであれば、最初にスクリプトを使って自動化する前に以下のことを検討してみてください。</p>
<p>
<strong><b>1. 外注する</b></strong>
</p>
<p>　自動化の種類にもよりますが、トータルの時間・コストを考えた場合、外注した方が安い場合もあります。</p>
<p>
<strong><b>2. プラグインを使う</b></strong>
</p>
<p>　市販もしくはフリーのプラグインで自動化できる、効率アップするならそれでも十分です。</p>
<p>
<strong><b>3. スクリプトを検索してあれば使う</b></strong>
</p>
<p>　Webでスクリプトを検索して探すのも1つの手段です。あまり多くはありませんが、IllustratorのスクリプトがWeb上に公開されています。用途に見合ったものがあれば、それを使うのがよいでしょう。</p>
<p>
<strong><b>4. Illustratorのアクション・バッチを使う</b></strong>
</p>
<p>　複雑な条件が絡まなければIllustratorの機能であるアクションとバッチ機能を使って効率化するのがよいでしょう。特にIllustrator CS6以降ではスクリプトからアクションを呼び出して実行できるので、なるべくアクションできることはアクションでやるようにしましょう。</p>
<p>
<strong><b>5. 操作を記録するアプリケーション（キーマクロ・キーバッチ）を使う</b></strong>
</p>
<p>　メニュー操作やパネル操作が絡むとアクションだけではできないことがあります。そのような場合は、キー操作を記録するアプリケーションを利用する方法もあります。</p>
<p>　上記のいずれも駄目だった場合にはIllustratorのJavaScriptを使って自動化しましょう。「1-4」でも書きましたが、Illustrator CS6以降はアクションを呼び出して実行できますので、条件分岐だけJavaScriptで行い実際の実行はアクションで行うという役割分担が可能です。また、全てではありませんが、CS6以降はメニューから選択できる項目も呼び出して実行することができます。</p>
<p>　プログラムは一度作成してしまえば、安定して高速に動作してくれます。本書では基本編ということで、複数の機能を組み合わせたサンプルは、あまりありませんが基本的な処理だけでも役立つはずです。</p>
</section>
</div>
<div id="calibre_link-96">
<section>
<div>
<h1 id="calibre_link-154"><b>第2章　アプリケーション</b></h1>
</div>
<p>　この章では、Illustrarorに関する情報やワークスペースなどについてのサンプルを示し、解説します。これらはappオブジェクトに格納されており、必要な情報を取得することができます。</p>
</section>
</div>
<div id="calibre_link-85">
<section>
<h2 id="calibre_link-155"><b>2-1　アプリケーション名を求める</b></h2>
<p>　アプリケーション名を求めるにはappオブジェクトのnameプロパティを参照します。Adobe Illustratorの場合、バージョン名などは含まれず「Adobe Illustrator」の文字になります。スクリプトが必ずIllustrator上で動作するようにしたい場合や、他のAdobeアプリケーションと共通で処理し、一部だけIllustrator独自の処理を行うような場合に利用します。なお、返される文字列は統一されておらず、下表のようになります。</p>
<table>
<caption>【表】app.nameで返される文字列</caption>
<tbody>
<tr>
  <td>
    <span>返される文字列</span>
  </td>
  <td>
    <span>アプリケーション名</span>
  </td>
</tr>
<tr>
  <td>Adobe Illustrator</td>
  <td>イラストレーター</td>
</tr>
<tr>
  <td>Adobe Photoshop</td>
  <td>フォトショップ</td>
</tr>
<tr>
  <td>Adobe InDesign</td>
  <td>インデザイン</td>
</tr>
<tr>
  <td>bridge</td>
  <td>ブリッジ</td>
</tr>
<tr>
  <td>ExtendScript Toolkit</td>
  <td>ESTK</td>
</tr>
<tr>
  <td>undefined</td>
  <td>アフターエフェクツ（アプリケーション名は返さない）</td>
</tr>
<tr>
  <td>undefined</td>
  <td>プレミア（アプリケーション名は返さない）</td>
</tr>
<tr>
  <td>undefined</td>
  <td>メディアエンコーダー（アプリケーション名は返さない）</td>
</tr>
</tbody>
</table>
<p>アプリケーション名を求めるサンプル</p>
<pre><code>// イラストレータのみ動作させる
var aName = app.name;
alert(aName);
if (aName.indexOf("Illustrator") &gt; -1){
    alert("イラストレータなので自動処理を行います");
}else{
    alert(aName+"では動作しません");
}</code></pre>
<p>　アラートダイアログにapp.nameの内容が表示されます。</p>
<figure>
<figcaption>【図】内容の表示</figcaption>
<img src="images/00106.jpeg" />
</figure>
<p>　スクリプトを実行しているアプリケーションがIllustratorの場合は実行を行う旨のメッセージがダイアログに表示されます。</p>
<figure>
<figcaption>【図】実行を行う旨のメッセージ</figcaption>
<img src="images/00089.jpeg" />
</figure>
<p>　Photoshopで実行すると動作しない、という旨のメッセージが表示されます。</p>
<figure>
<figcaption>【図】Photoshopで実行すると動作しないというメッセージ</figcaption>
<img src="images/00473.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-629">
<section>
<h2 id="calibre_link-156"><b>2-2　バージョンを求める／指定バージョン以上でしか動作しないようにする</b></h2>
<p>　バージョンを求めるにはappオブジェクトのversionプロパティを参照します。バージョン番号は数値ではなく文字列で返されます。CCの場合は17.1.0といった文字列が返されます。マイナーバージョンなど一部だけを知りたい場合はサンプルのようにsplit()メソッドを使って.（ドット）ごとに切り分けます。split()メソッドで取り出されたものは文字列になるので、数値として比較したい場合にはparseInt()を使って整数値にしてから処理 を行います。</p>
<p>　バージョン別に処理を分ける場合はメジャーバージョンなどを取り出しif命令を使って判別します。</p>
<p>　app.versionで返されるメジャーバージョンとIllustratorの名称の対応を以下の表に示します。</p>
<table>
<caption>【表】バージョン番号との対応</caption>
<tbody>
<tr>
  <td>
    <span>バージョン番号</span>
  </td>
  <td>
    <span>Illustratorの名称</span>
  </td>
</tr>
<tr>
  <td>10</td>
  <td>Illustrator 10</td>
</tr>
<tr>
  <td>11</td>
  <td>Illustrator CS</td>
</tr>
<tr>
  <td>12</td>
  <td>Illustrator CS2</td>
</tr>
<tr>
  <td>13</td>
  <td>Illustrator CS3</td>
</tr>
<tr>
  <td>14</td>
  <td>Illustrator CS4</td>
</tr>
<tr>
  <td>15</td>
  <td>Illustrator CS5</td>
</tr>
<tr>
  <td>16</td>
  <td>Illustrator CS6</td>
</tr>
<tr>
  <td>17</td>
  <td>Illustrator CC</td>
</tr>
<tr>
  <td>18</td>
  <td>Illustrator CC 2014</td>
</tr>
</tbody>
</table>
<p>バージョンを求める／指定バージョン以上でしか動作しないようにするサンプル</p>
<pre><code>// バージョンを表示しCC以降でしか動作しないようにする
var ver = app.version;
alert(ver);
var verList = ver.split(".");
alert("メジャーバージョン："+verList[0] + "\n" +
    "マイナーバージョン："+verList[1] + "\n" +
    "リビジョン番号："+verList[2]);
if (parseInt(verList[0]) &gt;= 17){
    alert("バージョンCC以上なので処理を行います");
}else{
    alert("バージョンCCより前のバージョンでは動作しません");
}</code></pre>
<p>　バージョンに応じたメッセージがアラートダイアログに表示されます。</p>
<p>　Illustrator CS6の場合は以下のように3つのダイアログが表示されます。</p>
<figure>
<figcaption>【図】Illustrator CS6での表示（1）</figcaption>
<img src="images/00264.jpeg" />
</figure>
<figure>
<figcaption>【図】Illustrator CS6での表示（2）</figcaption>
<img src="images/00046.jpeg" />
</figure>
<figure>
<figcaption>【図】Illustrator CS6での表示（3）</figcaption>
<img src="images/00430.jpeg" />
</figure>
<p>　Illustrator CC 2014の場合は以下のように3つのダイアログが表示されます。</p>
<figure>
<figcaption>【図】Illustrator CC 2014での表示（1）</figcaption>
<img src="images/00215.jpeg" />
</figure>
<figure>
<figcaption>【図】Illustrator CC 2014での表示（2）</figcaption>
<img src="images/00007.jpeg" />
</figure>
<figure>
<figcaption>【図】Illustrator CC 2014での表示（3）</figcaption>
<img src="images/00381.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-610">
<section>
<h2 id="calibre_link-157"><b>2-3　スクリプトエンジンのバージョンを求める</b></h2>
<p>　スクリプトエンジンのバージョンを求めるにはappオブジェクトのscriptingVersionプロパティを参照します。バージョン番号は数値ではなく文字列で返されます。CCの場合は16.1といった文字列が返されます。マイナーバージョンなど一部だけを知りたい場合はサンプルのようにsplit()メソッドを使って.（ドット）ごとに切り分けます。split()メソッドで取り出されたものは文字列になるので、数値として比較したい場合にはparseInt()を使って整数値にしてから処理を行います。</p>
<p>　バージョン別に処理を分ける場合はメジャーバージョンなどを取り出しif命令を使って判別します。</p>
<p>　app.scriptingVersionで返されるメジャーバージョンとIllustratorの名称の対応を以下の表に示します。なお、CCとCC 2014のスクリプトエンジンのバージョンは同じになっていますが、CC 2014はアップデートにより値が変わる可能性があります。</p>
<table>
<caption>【表】バージョン番号</caption>
<tbody>
<tr>
  <td>
    <span>バージョン番号</span>
  </td>
  <td>
    <span>Illustratorの名称</span>
  </td>
</tr>
<tr>
  <td>13.0</td>
  <td>Illustrator CS3</td>
</tr>
<tr>
  <td>14.0</td>
  <td>Illustrator CS4</td>
</tr>
<tr>
  <td>15.0</td>
  <td>Illustrator CS5</td>
</tr>
<tr>
  <td>16.0</td>
  <td>Illustrator CS6</td>
</tr>
<tr>
  <td>16.1</td>
  <td>Illustrator CC</td>
</tr>
<tr>
  <td>16.1</td>
  <td>Illustrator CC 2014</td>
</tr>
</tbody>
</table>
<p>スクリプトエンジンのバージョンを求めるサンプル</p>
<pre><code>// スクリプトエンジンのバージョンを表示
var ver = app.scriptingVersion;
alert(ver);
var verList = ver.split(".");
alert("メジャーバージョン："+verList[0] + "\n" +
    "マイナーバージョン："+verList[1]);</code></pre>
<p>　スクリプトエンジンのバージョンがダイアログに表示されます。</p>
<figure>
<figcaption>【図】スクリプトエンジンのバージョンの表示</figcaption>
<img src="images/00169.jpeg" />
</figure>
<p>　メジャーバージョンとマイナーバージョンがダイアログに表示されます。</p>
<figure>
<figcaption>【図】メジャーバージョンとマイナーバージョンの表示</figcaption>
<img src="images/00560.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-651">
<section>
<h2 id="calibre_link-158"><b>2-4　音を鳴らす／処理が終わったら音で知らせる</b></h2>
<p>　音を鳴らすにはappオブジェクトのbeep()メソッドを使います。鳴る音はコントロールパネルやシステム環境設定で設定されている警告音(ビープ音)になります。app.bepp()では鳴らす音の種類を指定することはできません。また、連続して音を鳴らす場合、app.beep()メソッドを列記しても一度しか鳴りません。サンプルのようにアラートダイアログなどを表示すれば、前後で音を鳴らすことができます。</p>
<p>音を鳴らす／処理が終わったら音で知らせるサンプル</p>
<pre><code>// 処理が終わったらビープ音を鳴らす
for(var i=0; i&lt;100; i++){}
app.beep();
alert("処理が終了しました");
app.beep();</code></pre>
<p>　ビープ音が鳴った後にアラートダイアログが表示されます。アラートダイアログを閉じた後にも、もう一度ビープ音が鳴ります。</p>
<figure>
<figcaption>【図】ビープ音が鳴った後のアラートダイアログ</figcaption>
<img src="images/00336.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-696">
<section>
<h2 id="calibre_link-159"><b>2-5　カット／コピー／ペーストする</b></h2>
<p>　スクリプトからカット／コピー／ペーストすることができます。いずれもメソッドが用意されています。カットはapp.cut()メソッドを使います。コピーはapp.copy()メソッドを使います。ペーストはapp.paste()メソッドを使います。どのメソッドも指定できるパラメーターはありません。</p>
<p>カット／コピー／ペーストするサンプル</p>
<pre><code>// 選択されたオブジェクトをコピーし、その後ペーストする
if (activeDocument.selection.length &gt; 0){
    app.copy(); // コピーする
    // app.cut();   // カットする
    app.paste();    // ペーストする
}</code></pre>
<p>　コピーする図形を選択します。</p>
<figure>
<figcaption>【図】図形の選択</figcaption>
<img src="images/00127.jpeg" />
</figure>
<p>　選択した図形がコピーされた後、ページ中央にペーストされます。</p>
<figure>
<figcaption>【図】図形がペーストされる</figcaption>
<img src="images/00517.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-745">
<section>
<h2 id="calibre_link-160"><b>2-6　取り消し（アンドゥ）／再実行（リドゥ）処理を行う</b></h2>
<p>　スクリプトから取り消し処理を行うにはapp.undo()メソッドを使います。app.undo()メソッドは何度でも実行でき、実行するたびに以前の状態に戻ります。</p>
<p>　キー操作による取り消しやapp.undo()メソッドによる取り消しをなかったことにして、再度実行するにはapp.redo()メソッドを使います。app.redo()も何度でも実行することができます。</p>
<p>　なお、IllustratorにはPhotoshopのようなヒストリーパネル（機能）がないため、何回取り消しができるかといった情報（ヒストリー情報）を取得することはできません。</p>
<p>取り消し（アンドゥ）／再実行（リドゥ）処理を行うサンプル</p>
<pre><code>// 取り消し（アンドゥ）を行う
app.undo();
alert("取り消しました");</code></pre>
<p>　左上の文字と図形を斜め下にコピーした状態で、スクリプトを実行します。</p>
<figure>
<figcaption>【図】左上の文字と図形を斜め下にコピー</figcaption>
<img src="images/00303.jpeg" />
</figure>
<p>　取り消し処理を行ったことを示すアラートダイアログが表示されます。</p>
<figure>
<figcaption>【図】アラートダイアログの表示</figcaption>
<img src="images/00083.jpeg" />
</figure>
<p>　コピーした文字と図形が消えます。</p>
<figure>
<figcaption>【図】文字と図形が消える</figcaption>
<img src="images/00468.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-708">
<section>
<h2 id="calibre_link-161"><b>2-7　実行しているスクリプトのファイル名／ファイルパスを求める</b></h2>
<p>　実行しているスクリプトのファイル名／ファイルパスを求めるには$オブジェクトのfileNameプロパティを参照します。$.fileNameはIllustrator CS4より前のバージョンでは正常に動作しませんが、CS4以降であれば正しいファイルパスを返します。</p>
<p>実行しているスクリプトのファイル名／ファイルパスを求めるサンプル</p>
<pre><code>// 実行されているスクリプトのファイルパスを求める
var currentScriptFile = $.fileName;
alert(File.decode(currentScriptFile));</code></pre>
<p>　実行しているスクリプトファイルのパスがアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】スクリプトファイルのパスの表示</figcaption>
<img src="images/00259.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-71">
<section>
<h2 id="calibre_link-162"><b>2-8　イラストレータを終了させる</b></h2>
<p>　イラストレータを終了させるにはアプリケーションオブジェクトのquit()メソッドを使います。ドキュメントが開かれており、まだ保存されていない場合には確認のダイアログが表示されます。この時に、キャンセルボタンが押されると終了処理は行いません。quit()メソッドはファイルメニューから「終了」を選択した場合と同じ処理を行います。</p>
<p>イラストレータを終了させるサンプル</p>
<pre><code>// イラストレータを終了させる
app.quit();</code></pre>
<p>　イラストレータが終了します。保存していないドキュメントがある場合は保存するかどうかの確認ダイアログが表示されます。</p>
<figure>
<figcaption>【図】イラストレータの終了</figcaption>
<img src="images/00038.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-613">
<section>
<h2 id="calibre_link-163"><b>2-9　なるべくアラートダイアログが表示されないようにする</b></h2>
<p>　イラストレータではアプリケーションが表示するダイアログがあります。スクリプトで自動化する際はダイアログで停止してしまうのは避けたいところです。この不要なダイアログをなるべく表示しないようにするには、アプリケーションオブジェクトのuserInteractionLevelプロパティに下表に示す値を設定します。</p>
<table>
<caption>【表】アラートダイアログの扱い</caption>
<tbody>
<tr>
  <td>
    <span>表示の有無</span>
  </td>
  <td>
    <span>設定する値</span>
  </td>
</tr>
<tr>
  <td>アラートダイアログを表示する</td>
  <td>UserInteractionLevel.DISPLAYALERTS</td>
</tr>
<tr>
  <td>アラートダイアログを表示しない</td>
  <td>UserInteractionLevel.DONTDISPLAYALERTS</td>
</tr>
</tbody>
</table>
<p>なるべくアラートダイアログが表示されないようにするサンプル</p>
<pre><code>// ユーザー操作レベルを設定する
app.userInteractionLevel = UserInteractionLevel.DONTDISPLAYALERTS;</code></pre>
</section>
</div>
<div id="calibre_link-12">
<section>
<h2 id="calibre_link-164"><b>2-10　空きメモリ容量を調べる</b></h2>
<p>　空きメモリのサイズを調べるにはアプリケーションオブジェクトのfreeMemoryプロパティを調べます。ただし、Mac OS X/OS X（64bit）でのIllustrator CS6からCC 2014は空きメモリが多い場合、負数を返します。サンプルでは負数の場合はCS5までと同じように2GBまでの空きメモリとして計算し、その結果を返すようにしています。</p>
<p>空きメモリ容量を調べるサンプル</p>
<pre><code>// 空きメモリ容量を調べる
var mem = app.freeMemory;
if (mem &lt; 0){   // Mac OS X/OS X 64bit対応
    mem = (2*1024*1024*1024) + mem;
}
var kb = parseInt(mem / 1024);
var mb = parseInt(kb / 1024);
alert("空きメモリ："+mem+" Bytes\r"+kb+" KB\r"+mb+" MB");</code></pre>
<p>　Illustrator CS5までは正常な空きメモリのサイズが返されます。</p>
<figure>
<figcaption>【図】正常な空きメモリのサイズ</figcaption>
<img src="images/00424.jpeg" />
</figure>
<p>　Illustrator CS6以降では空きメモリが2G以上の場合は負数が返されてしまいます。</p>
<figure>
<figcaption>【図】Illustrator CS6以降で空きメモリが2G以上の場合</figcaption>
<img src="images/00207.jpeg" />
</figure>
<p>　暫定的に負数にならないように調整します。</p>
<figure>
<figcaption>【図】負数にならないように調整</figcaption>
<img src="images/00002.jpeg" />
</figure>
<p>　Windows 7（32bit）では正常な値が返されます。</p>
<figure>
<figcaption>【図】Windows 7（32bit）の場合</figcaption>
<img src="images/00375.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-548">
<section>
<h2 id="calibre_link-165"><b>2-11　プラグインにメッセージとデータを送る</b></h2>
<p>　プラグインにメッセージとデータを送るにはアプリケーションオブジェクトのsendScriptMessage()メソッドを使います。最初のパラメーターにプラグイン名、2番目のパラメーターにメッセージ（コマンド）、3番目のパラメーターにプラグインに送信するデータを指定します。プラグイン名はヘルプメニューのシステム情報を選択し表示されるダイアログで調べることができます。</p>
<p>プラグインにメッセージとデータを送るサンプル</p>
<pre><code>// プラグインにメッセージとデータを送る
app.sendScriptMessage("Adobe Custom Workspace" ,
    "Switch Workspace",
    '&lt;workspace="ペイント"&gt;');</code></pre>
<p>　ワークスペース変更前の画面です。</p>
<figure>
<figcaption>【図】ワークスペース変更前の画面</figcaption>
<img src="images/00058.jpeg" />
</figure>
<p>　ワークスペースが指定した種類に変更されます。</p>
<figure>
<figcaption>【図】指定した種類への変更</figcaption>
<img src="images/00555.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-712">
<section>
<h2 id="calibre_link-166"><b>2-12　アプリケーションのパスを取得する</b></h2>
<p>　アプリケーションのパスを取得するにはアプリケーションオブジェクトのpathプロパティの内容を読み出します。アプリケーションが格納されているパスはWindowsとMac OS X/OS Xでは異なります。app.pathを利用するとOSの差違を吸収することができます。</p>
<p>アプリケーションのパスを取得するサンプル</p>
<pre><code>// アプリケーションのパスを表示する
alert(app.path);
// メニューに表示されるスクリプト項目名を表示する
var scriptPath = app.path + "/Presets.localized/ja_JP/スクリプト";
var fList = (new Folder(scriptPath)).getFiles();
var txt = "";
for(var i=0; i&lt;fList.length; i++){
    txt = txt + decodeURI(fList[i].name)+"\r";
}
alert(txt);</code></pre>
<p>　アプリケーションのパスがダイアログに表示されます。</p>
<figure>
<figcaption>【図】アプリケーションのパス</figcaption>
<img src="images/00453.jpeg" />
</figure>
<p>　メニューに表示されるスクリプト項目名がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】メニューに表示されるスクリプト項目名</figcaption>
<img src="images/00123.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-118">
<section>
<h2 id="calibre_link-167"><b>2-13　アプリケーションのパスを取得する</b></h2>
<p>　アプリケーションのパスを取得するにはアプリケーションオブジェクトのpathプロパティの内容を読み出します。アプリケーションが格納されているパスはWindowsとMac OS X/OS Xでは異なります。なお、app.path内に格納されている内容はWindows 7では取得できません。</p>
<p>アプリケーションのパスを取得するサンプル</p>
<pre><code>// アプリケーションのパスを表示する
alert(app.path);
// メニューに表示されるスクリプト項目名を表示する
var scriptPath = app.path + "/Presets.localized/ja_JP/スクリプト";
var fList = (new Folder(scriptPath)).getFiles();
var txt = "";
for(var i=0; i&lt;fList.length; i++){
    txt = txt + decodeURI(fList[i].name)+"\r";
}
alert(txt);</code></pre>
<p>　アプリケーションのパスがダイアログに表示されます（Illustratro CS6 + Mac OS X/OS Xの場合）。</p>
<figure>
<figcaption>【図】Illustratro CS6 + Mac OS X/OS Xの場合</figcaption>
<img src="images/00513.jpeg" />
</figure>
<p>　アプリケーションのパスがダイアログに表示されます（Illustratro CC + Mac OS X/OS Xの場合）。</p>
<figure>
<figcaption>【図】Illustratro CC + Mac OS X/OS Xの場合</figcaption>
<img src="images/00568.jpeg" />
</figure>
<p>　アプリケーションのパスがダイアログに表示されます（Illustratro CC 2014 + Mac OS X/OS Xの場合）。</p>
<figure>
<figcaption>【図】Illustratro CC 2014 + Mac OS X/OS Xの場合</figcaption>
<img src="images/00079.jpeg" />
</figure>
<p>　アプリケーションのパスがダイアログに表示されます（Windows 7の場合）。</p>
<figure>
<figcaption>【図】Windows 7の場合</figcaption>
<img src="images/00343.jpeg" />
</figure>
<p>　メニューに表示されるスクリプト項目名がアラートダイアログに表示されます。なお、Windows 7ではフォルダ内を取得できないためアラートダイアログには何も表示されません。</p>
<figure>
<figcaption>【図】メニューに表示されるスクリプト項目名</figcaption>
<img src="images/00474.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-654">
<section>
<h2 id="calibre_link-168"><b>2-14　座標系を取得する／設定する</b></h2>
<p>　Illustrator CS4以降ではマルチアートボード機能が追加されています。その際、特定のアートボードの原点を基準にするかどうか設定することができます。どの座標系なのかはアプリケーションオブジェクトのcoordinateSystemプロパティで取得することができます。また、coordinateSystemプロパティに使用したい座標系を設定することもできます。使用できる座標系を下表に示します。</p>
<table>
<caption>【表】指定できる座標系</caption>
<tbody>
<tr>
  <td>
    <span>プロパティの設定</span>
  </td>
  <td>
    <span>座標系</span>
  </td>
</tr>
<tr>
  <td>CoordinateSystem.DOCUMENTCOORDINATESYSTEM</td>
  <td>ドキュメント座標</td>
</tr>
<tr>
  <td>CoordinateSystem.ARTBOARDCOORDINATESYSTEM</td>
  <td>アートボード座標</td>
</tr>
</tbody>
</table>
<p>　座標系を切り替える場合はexecuteMenuCommand()メソッドを使うと簡単にできます。使い方はapp.executeMenuCommand("rulerCoordinateSystem");のようにすると、実行するたびにドキュメント座標とアートボード座標が切り替わります。</p>
<p>座標系を取得する／設定するサンプル</p>
<pre><code>// 基準座標をドキュメントに設定する
alert(app.coordinateSystem);
// 3番目のアートボードをアクティブにする
activeDocument.artboards.setActiveArtboardIndex(2);
// ドキュメント座標を基準にするように設定
app.coordinateSystem = CoordinateSystem.DOCUMENTCOORDINATESYSTEM;
drawLine(100, 0, 0, 0);
// アートボード座標を基準にするように設定
app.coordinateSystem = CoordinateSystem.ARTBOARDCOORDINATESYSTEM;
drawLine(0, 0, 0, 90);
// 線を描画する関数
function drawLine(c,m,y,k){
    var rectObj = activeDocument.pathItems.rectangle(-10, 30, 150, 100);
    rectObj.fillColor = setCMYKColor(c,m,y,k);
    // CMYKカラーを設定し、CMYKカラーオブジェクトを返す
    function setCMYKColor(c,m,y,k){
        var CMYK = new CMYKColor();
        CMYK.cyan = c;
        CMYK.magenta = m;
        CMYK.yellow = y;
        CMYK.black = k;
        return CMYK;
    }
}</code></pre>
<p>　現在の座標系がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】現在の座標系</figcaption>
<img src="images/00267.jpeg" />
</figure>
<p>　座標系を変更することで四角形の描画位置が変わります。水色がドキュメント座標を基準にして描画した場合、黒色がアクティブになっているアートボードを基準にして描画した場合になります。</p>
<figure>
<figcaption>【図】基準の違いによる四角形の描画位置</figcaption>
<img src="images/00048.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-626">
<section>
<h2 id="calibre_link-169"><b>2-15　ワークスペースを切り替える（CC以降）</b></h2>
<p>　Illustrator CC以降ではアプリケーションオブジェクトのswitchWorkspace()メソッドにより手軽にワークスペースを切り替えることができます。switchWorkspace()メソッドのパラメーターに切り替えたいワークスペース名を指定します。このワークスペース名はメニューのウィンドウ＞ワークスペースで表示される項目名になります。</p>
<p>　なお、switchWorkspace()で指定したワークスペース名が存在しない場合はエラーになるのでサンプルのようにtry...catchを使ってエラー処理を行います。</p>
<p>ワークスペースを切り替えるサンプル（CC以降）</p>
<pre><code>// ワークスペースを切り替える
try{
    app.switchWorkspace("Web")
}catch(e){
    alert("そのようなワークスペースはありません");
}</code></pre>
<p>　ワークスペースを切り替える前の状態です。</p>
<figure>
<figcaption>【図】ワークスペースを切り替える前の状態</figcaption>
<img src="images/00432.jpeg" />
</figure>
<p>　スクリプトを実行するとワークスペースがWebに切り替わります。</p>
<figure>
<figcaption>【図】ワークスペースがWebに切り替わる</figcaption>
<img src="images/00218.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-750">
<section>
<h2 id="calibre_link-170"><b>2-16　ワークスペースをリセットする（CC以降）</b></h2>
<p>　Illustrator CC以降ではワークスペースをリセットすることができます。リセットするにはアプリケーションオブジェクトのresetWorkspace()メソッドを実行します。resetWorkspace()メソッドは指定できるパラメーターはありません。</p>
<p>ワークスペースをリセットするサンプル（CC以降）</p>
<pre><code>// ワークスペースをリセットする
try{
    app.resetWorkspace();
}catch(e){
    alert("CC以降でないと実行できません");
}</code></pre>
<p>　ワークスペースをリセットする前の状態です。</p>
<figure>
<figcaption>【図】ワークスペースのリセット前</figcaption>
<img src="images/00010.jpeg" />
</figure>
<p>　スクリプトを実行するとワークスペースがリセットされパネルが整然と並びます。</p>
<figure>
<figcaption>【図】ワークスペースのリセット</figcaption>
<img src="images/00385.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-50">
<section>
<h2 id="calibre_link-171"><b>2-17　ワークスペースを削除する（CC以降）</b></h2>
<p>　Illustrator CC以降では、自分用に作成したワークスペースや既存のワークスペースを削除することができます。ワークスペースを削除するにはアプリケーションオブジェクトのdeleteWorkspace()メソッドを実行します。deleteWorkspace()メソッドのパラメーターに削除したいワークスペース名を指定します。このワークスペース名はメニューのウィンドウ＞ワークスペースで表示される項目名になります。</p>
<p>　deleteWorkspace()メソッドは存在しないワークスペース名を指定した場合、エラーにはなりません。</p>
<p>ワークスペースを削除するサンプル（CC以降）</p>
<pre><code>// ワークスペースを削除する
app.deleteWorkspace("校正用WS");</code></pre>
<p>　削除する前のワークスペース名一覧です。</p>
<figure>
<figcaption>【図】ワークスペース名一覧</figcaption>
<img src="images/00313.jpeg" />
</figure>
<p>　スクリプトを実行すると「校正用WS」のワークスペースが削除されます。</p>
<figure>
<figcaption>【図】ワークスペースの削除</figcaption>
<img src="images/00563.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-586">
<section>
<h2 id="calibre_link-172"><b>2-18　ワークスペースを保存する（CC以降）</b></h2>
<p>　Illustrator CC以降では、現在のワークスペースを保存することができます。ワークスペースを保存するにはアプリケーションオブジェクトのsaveWorkspace()メソッドを実行します。saveWorkspace()メソッドのパラメーターに保存したいワークスペース名を指定します。ここで指定した名称がメニューのウィンドウ＞ワークスペースで表示される項目名になります。</p>
<p>　saveWorkspace()メソッドは、すでに存在するワークスペース名があるとエラーになります。エラーを回避するにはサンプルのようにtry...catchを使います。</p>
<p>ワークスペースを保存するサンプル（CC以降）</p>
<pre><code>// ワークスペースを保存する
try{
    app.saveWorkspace("確認用WS");
}catch(e){
    alert("すでに同名のワークスペースが存在しているため保存できません");
}</code></pre>
<p>　保存する前のワークスペース名一覧です。</p>
<figure>
<figcaption>【図】ワークスペース名一覧</figcaption>
<img src="images/00339.jpeg" />
</figure>
<p>　スクリプトを実行すると「確認用WS」のワークスペースが保存されます。</p>
<figure>
<figcaption>【図】ワークスペースの保存</figcaption>
<img src="images/00130.jpeg" />
</figure>
<p>　さらに同じスクリプトを実行すると「確認用WS」のワークスペースが存在するためエラーになります。サンプルではエラーを回避しているためアラートダイアログが表示されます。</p>
<figure>
<figcaption>【図】エラーになり、アラートダイアログが表示される</figcaption>
<img src="images/00311.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-753">
<section>
<div>
<h1 id="calibre_link-173"><b>第3章　ドキュメント</b></h1>
</div>
<p>　実際に描画するドキュメントに関するサンプルと解説です。これらはdocumentオブジェクトを操作することでカラーモードや保存処理を行うことができます。</p>
</section>
</div>
<div id="calibre_link-529">
<section>
<h2 id="calibre_link-174"><b>3-1　ドキュメントを開く</b></h2>
<p>　ドキュメントを開くにはアプリケーションオブジェクトのopen()メソッドを使います。open()メソッドのパラメーターに開きたいファイルを示すファイルオブジェクトを指定します。なお、Illustrator 9以前に作成されたAIファイルの場合、open()メソッドの2番目のパラメーターにカラーモードを指定することができます。指定できるカラーモードは下表のようになります。</p>
<table>
<caption>【表】指定できるカラーモード</caption>
<tbody>
<tr>
  <td>
    <span>パラメーター</span>
  </td>
  <td>
    <span>指定できるカラーモード</span>
  </td>
</tr>
<tr>
  <td>DocumentColorSpace.CMYK</td>
  <td>CMYKモード</td>
</tr>
<tr>
  <td>DocumentColorSpace.RGB</td>
  <td>RGBモード</td>
</tr>
</tbody>
</table>
<p>ドキュメントを開くサンプル</p>
<pre><code>// ドキュメントを開く
var file = File.openDialog("AIファイルを指定してください");
if (file){
    app.open(file);
}</code></pre>
<p>　開くAIファイルを指定します。</p>
<figure>
<figcaption>【図】AIファイルを指定</figcaption>
<img src="images/00511.jpeg" />
</figure>
<p>　AIファイルが開かれます。</p>
<figure>
<figcaption>【図】AIファイルが開かれる</figcaption>
<img src="images/00087.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-692">
<section>
<h2 id="calibre_link-175"><b>3-2　新規にドキュメントを作成する</b></h2>
<p>　新規にドキュメントを作成するにはdocumentsオブジェクトのadd()メソッドを使います。add()メソッドはパラメーターを指定しなくても新規にドキュメントを作成します。</p>
<p>　用紙サイズやカラーモードを指定する場合はadd()メソッドに3つのパラメーターを指定します。最初のパラメーターがドキュメントのカラーモードになります。RGBカラーならDocumentColorSpace.RGBを、CMYKならDocumentColorSpace.CMYKを指定します。</p>
<p>　2番目のパラメーターはドキュメントの横幅になります。3番目のパラメーターはドキュメントの縦幅になります。いずれも単位はポイントになります。指定する値は単位なしの数値になります。サンプルの場合はA4の縦サイズをパラメーターとして指定しています。</p>
<p>　add()は戻り値として新規に作成されたドキュメントオブジェクトを返しますので、より詳細な処理を後で行うことができます。</p>
<p>新規にドキュメントを作成するサンプル</p>
<pre><code>// 新規にドキュメント(A4)を作成する
var docObj = documents.add(DocumentColorSpace.CMYK, 595.28, 841.89);
alert(docObj);</code></pre>
<p>　新規にCMYKモードでA4ドキュメントが作成されます。その後、アラートダイアログにドキュメントオブジェクトの内容が表示されます。</p>
<figure>
<figcaption>【図】新規にCMYKモードでA4ドキュメントが作成される</figcaption>
<img src="images/00547.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-94">
<section>
<h2 id="calibre_link-176"><b>3-3　詳細な設定で新規にドキュメントを作成する</b></h2>
<p>　より細かい設定で新規にドキュメントを作成するにはdocumentsオブジェクトのaddDocument()メソッドを使います。addDocument()は2つのパラメーターを指定します。最初のパラメーターがスタートアッププリセット名、2番目のパラメーターがドキュメントのプリセットを格納したオブジェクトになります。</p>
<p>　プリセット値はDocumentPresetオブジェクトに格納されており、直接DocumentPresetオブジェクト内のプロパティを変更します。設定できるプロパティ名を、以下の「プリセットプロパティ名」の表に示します。また、プロパティに設定できる値も「プレビュー指定」、「解像度指定」、「グリッド」、「ルーラー（定規）単位」のそれぞれの表に示します。addDocument()は戻り値として新規に作成されたドキュメントオブジェクトを返しますので、より詳細な処理を後で行うことができます。</p>
<table>
<caption>【表】プリセットプロパティ名</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ名</span>
  </td>
  <td>
    <span>設定</span>
  </td>
</tr>
<tr>
  <td>colorMode</td>
  <td>カラーモード（DocumentColorSpace.RGBもしくはDocumentColorSpace.CMYK）</td>
</tr>
<tr>
  <td>width</td>
  <td>横幅（単位はポイント）</td>
</tr>
<tr>
  <td>height</td>
  <td>縦幅（単位はポイント）</td>
</tr>
<tr>
  <td>previewMode</td>
  <td>プレビューモード（設定値は「【表】プレビュー指定」を参照）</td>
</tr>
<tr>
  <td>rasterResolution</td>
  <td>ラスタライズ時の解像度（設定値は「【表】解像度指定」を参照）</td>
</tr>
<tr>
  <td>transparencyGrid</td>
  <td>グリッド（設定値は「【表】グリッド」を参照）</td>
</tr>
<tr>
  <td>units</td>
  <td>ルーラー（定規）の単位（設定値は「【表】ルーラー（定規）単位」を参照）</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】プレビュー指定</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ名</span>
  </td>
  <td>
    <span>設定</span>
  </td>
</tr>
<tr>
  <td>DocumentPreviewMode.DefaultPreview</td>
  <td>デフォルトプレビュー</td>
</tr>
<tr>
  <td>DocumentPreviewMode.PixelPreview</td>
  <td>ピクセルプレビュー</td>
</tr>
<tr>
  <td>DocumentPreviewMode.OverprintPreview</td>
  <td>オーバープリントプレビュー</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】解像度指定</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ名</span>
  </td>
  <td>
    <span>設定</span>
  </td>
</tr>
<tr>
  <td>DocumentRasterResolution.ScreenResolution</td>
  <td>スクリーン解像度</td>
</tr>
<tr>
  <td>DocumentRasterResolution.MediumResolution</td>
  <td>中解像度</td>
</tr>
<tr>
  <td>DocumentRasterResolution.HighResolution</td>
  <td>高解像度</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】グリッド</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ名</span>
  </td>
  <td>
    <span>設定</span>
  </td>
</tr>
<tr>
  <td>DocumentTransparencyGrid.TransparencyGridNone</td>
  <td>なし</td>
</tr>
<tr>
  <td>DocumentTransparencyGrid.TransparencyGridLight</td>
  <td>明るい</td>
</tr>
<tr>
  <td>DocumentTransparencyGrid.TransparencyGridMedium</td>
  <td>中くらい</td>
</tr>
<tr>
  <td>DocumentTransparencyGrid.TransparencyGridDark</td>
  <td>暗い</td>
</tr>
<tr>
  <td>DocumentTransparencyGrid.TransparencyGridRed</td>
  <td>赤</td>
</tr>
<tr>
  <td>DocumentTransparencyGrid.TransparencyGridOrange</td>
  <td>オレンジ</td>
</tr>
<tr>
  <td>DocumentTransparencyGrid.TransparencyGridGreen</td>
  <td>緑</td>
</tr>
<tr>
  <td>DocumentTransparencyGrid.TransparencyGridBlue</td>
  <td>青</td>
</tr>
<tr>
  <td>DocumentTransparencyGrid.TransparencyGridPurple</td>
  <td>紫</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】ルーラー（定規）単位</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ名</span>
  </td>
  <td>
    <span>設定</span>
  </td>
</tr>
<tr>
  <td>RulerUnits.Centimeters</td>
  <td>センチメートル</td>
</tr>
<tr>
  <td>RulerUnits.Inches</td>
  <td>インチ</td>
</tr>
<tr>
  <td>RulerUnits.Millimeters</td>
  <td>ミリメートル</td>
</tr>
<tr>
  <td>RulerUnits.Picas</td>
  <td>パイカ</td>
</tr>
<tr>
  <td>RulerUnits.Points</td>
  <td>ポイント</td>
</tr>
<tr>
  <td>RulerUnits.Qs</td>
  <td>Q数（級数／歯）</td>
</tr>
<tr>
  <td>RulerUnits.Pixels</td>
  <td>ピクセル</td>
</tr>
<tr>
  <td>RulerUnits.Unknown</td>
  <td>特に指定なし</td>
</tr>
</tbody>
</table>
<p>詳細な設定で新規にドキュメントを作成するサンプル</p>
<pre><code>// プリセットを設定して新規にドキュメントを作成する
var dp = DocumentPreset;
dp.colorMode = DocumentColorSpace.RGB;
dp.width = 1920;
dp.height = 1080;
dp.title = "FullHDサイズ";
dp.previewMode = DocumentPreviewMode.PixelPreview;// ピクセルプレビュー
dp.transparencyGrid = DocumentTransparencyGrid.TransparencyGridRed;// グリッド赤
dp.rasterResolution = DocumentRasterResolution.ScreenResolution;
documents.addDocument("タイトルテロップ用", dp);</code></pre>
<p>　プリセットで指定した情報を元に新規にドキュメントが作成されます。</p>
<figure>
<figcaption>【図】新規にドキュメントが作成される</figcaption>
<img src="images/00262.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-637">
<section>
<h2 id="calibre_link-177"><b>3-4　最前面（アクティブ）のドキュメントを指定する</b></h2>
<p>　最前面の（アクティブ）ドキュメントを指定するにはapp.activeDocumentまたはactiveDocumentを使います。最前面の(アクティブ)ドキュメントがない場合にactiveDocumentを使うとエラーになります。エラーを回避する場合はdocuments.lengthで開かれているドキュメントの数を調べ1以上だったら処理を行うようにします。また、try...catch()を使ってエラーの回避処理をすることもできます。</p>
<p>最前面のドキュメントを指定するサンプル</p>
<pre><code>// 最前面の（アクティブ）ドキュメントを指定する
var docObj = app.activeDocument;
alert("ドキュメント名："+docObj.name);</code></pre>
<p>　アラートダイアログにドキュメントの書類名が表示されます。</p>
<figure>
<figcaption>【図】ドキュメントの書類名が表示される</figcaption>
<img src="images/00042.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-36">
<section>
<h2 id="calibre_link-178"><b>3-5　開かれているドキュメントの総数を求める</b></h2>
<p>　開かれているドキュメントの総数を求めるにはドキュメントオブジェクトが格納されているdocuments配列の総数を調べます。配列の総数はlengthプロパティで求めることができるのでdocuments.lengthとすればドキュメントの総数を求めることができます。</p>
<p>開かれているドキュメントの総数を求めるサンプル</p>
<pre><code>// 開かれているドキュメントの総数を求める
var n = documents.length;
alert("開かれているドキュメントの総数："+n);</code></pre>
<p>　アラートダイアログに開かれているドキュメントの数が表示されます。</p>
<figure>
<figcaption>【図】開かれているドキュメントの数が表示される</figcaption>
<img src="images/00427.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-570">
<section>
<h2 id="calibre_link-179"><b>3-6　ドキュメントが保存されたかどうか調べる</b></h2>
<p>　ドキュメントが保存されたかどうか調べるにはドキュメントオブジェクトのsavedプロパティを調べます。savedプロパティの値がtrueであれば保存済み、falseであれば保存されていないことになります。また、新規にドキュメントを作成した状態ではsavedプロパティはtrue、つまり保存済みとなります。</p>
<p>ドキュメントが保存されたかどうか調べるサンプル</p>
<pre><code>// ドキュメントが保存されたかどうか調べる
var flag = activeDocument.saved;
if (flag == true){
    alert("ドキュメントは保存されています");
}else{
    alert("ドキュメントは、まだ保存されていません");
}</code></pre>
<p>　ドキュメントが保存されたかどうかがアラートダイアログに表示されます（この場合はドキュメントは保存済みか、新規作成した状態で未保存）。</p>
<figure>
<figcaption>【図】保存されたかどうかがアラートダイアログに表示される</figcaption>
<img src="images/00211.jpeg" />
</figure>
<p>　ドキュメントが保存されていない場合はアラートダイアログに保存されていない旨のメッセージが表示されます。</p>
<figure>
<figcaption>【図】ドキュメントが保存されていないことを示す</figcaption>
<img src="images/00085.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-736">
<section>
<h2 id="calibre_link-180"><b>3-7　ドキュメントを保存する</b></h2>
<p>　ドキュメントを保存するにはドキュメントオブジェクトのsave()メソッドを使います。ただし、一度もドキュメントが保存されていない場合は保存先がないためエラーになります。その場合は、saveAs()メソッドを使って保存先を指定する必要があります。saveAs()メソッドの最初のパラメーターが保存先を示すファイルオブジェクト、2番目のパラメーターが、保存形式などを示すオプションになっています。保存対象となるドキュメントは必ずしも最前面（アクティブ）である必要はありません。背面（デアクティブ）にあっても保存処理は行われます。</p>
<p>ドキュメントを保存するサンプル</p>
<pre><code>// ドキュメントをデスクトップフォルダに保存する
try{
    activeDocument.save();
}catch(e){
    var fileObj = new File(Folder.desktop.fsName + "/sample.ai");
    activeDocument.saveAs(fileObj);
}</code></pre>
<p>　ドキュメントを保存します。一度も保存されていない場合はデスクトップにsample.aiという名前でファイルが保存されます。</p>
<figure>
<figcaption>【図】ドキュメントを保存</figcaption>
<img src="images/00377.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-135">
<section>
<h2 id="calibre_link-181"><b>3-8　ドキュメントの一部をPNG画像として保存する</b></h2>
<p>　ドキュメントの一部をPNG画像として保存するにはドキュメントオブジェクトのimageCapture()メソッドを使います。imageCapture()メソッドの最初のパラメーターが保存先を示すファイルオブジェクトになります。2番目以降のパラメーターは省略可能です。2番目のパラメーターはドキュメントの保存範囲を座標で指定します。これは4カ所の座標を格納した配列形式になります。この座標は[左,上,右,下]の順番になっています。座標値の指定を間違えるとドキュメント全体が保存範囲になります。特にIllustrator CS5以降のバージョンと、それ以降では座標系が異なっている（Y座標のベクトルが逆になっています）ため注意が必要です。CS4まで動作していてCS5以降で正常に動作しなくなった場合は指定されている座標を確認してください。</p>
<p>　3番目のパラメーターは保存オプションです。以下の表に示すオプションを指定することができます。なお、imageCapture()は2番目の保存範囲を示すオプションが省略された場合は、トリムエリアツールで指定された範囲が画像として保存されます。すでに保存範囲が指定されている場合、保存先とオプションだけを指定したいのであればactiveDocument.imageCapture(fileObj,undefined,opt);のようにしてください。</p>
<table>
<caption>【表】保存オプション</caption>
<tbody>
<tr>
  <td>
    <span>保存オプション</span>
  </td>
  <td>
    <span>内容</span>
  </td>
</tr>
<tr>
  <td>antiAliasing</td>
  <td>アンチエイリアスのフラグ（trueならアンチエイリアス処理を行う）デフォルトはtrue</td>
</tr>
<tr>
  <td>matte</td>
  <td>マットカラーを使用するかどうかのフラグ（trueならマットカラーを使用） デフォルトはfalse</td>
</tr>
<tr>
  <td>matteColor</td>
  <td>マットカラー（RGB カラーオブジェクトで指定）</td>
</tr>
<tr>
  <td>resolution</td>
  <td>解像度（72.0~2400.0）デフォルトは150</td>
</tr>
<tr>
  <td>transparency</td>
  <td>背景を透明にするかどうかのフラグ（trueなら透明）デフォルトはfalse</td>
</tr>
</tbody>
</table>
<p>ドキュメントの一部をPNG画像として保存するサンプル</p>
<pre><code>// ドキュメントの一部をPNG画像として保存する
var fileObj = new File(Folder.desktop.fsName + "/aicc2.png");
var rect = [0, 0, 100, -100];// 左、上、右、下の順番で指定する
var opt = new ImageCaptureOptions();
opt.antiAliasing = true;// アンチエイリアス
opt.matte = false;// マットカラーなし
opt.resolution = 72;// DPI
opt.transparency = true;// 背景を透明にする
activeDocument.imageCapture(fileObj, rect, opt);</code></pre>
<p>　ドキュメントに文字や図形を描画しておきます。</p>
<figure>
<figcaption>【図】文字や図形を描画する</figcaption>
<img src="images/00165.jpeg" />
</figure>
<p>　スクリプトを実行するとドキュメントの左上の一部がPNG画像としてデスクトップに保存されます。</p>
<figure>
<figcaption>【図】ドキュメントの一部がPNG画像として保存される</figcaption>
<img src="images/00557.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-676">
<section>
<h2 id="calibre_link-182"><b>3-9　ドキュメントを分割してPNG形式で保存する</b></h2>
<p>　ドキュメントを分割してPNG 形式で保存するにはドキュメントオブジェクトのimageCapture()メソッドを使います。imageCapture()メソッドは保存する範囲を指定することができるので、これを利用します。この保存する範囲を少しずつ変えていくことでドキュメントを分割して保存します。</p>
<table>
<caption>【表】指定できるオプション</caption>
<tbody>
<tr>
  <td>
    <span>指定できるオプション</span>
  </td>
  <td>
    <span>内容</span>
  </td>
</tr>
<tr>
  <td>antiAliasing</td>
  <td>アンチエイリアス。trueで有効。falseで無効。</td>
</tr>
<tr>
  <td>matte</td>
  <td>マットカラーを透明部分に反映させるかどうか。trueで反映させる。falseで反映させない。trueの場合はmatteColorプロパティにカラーオブジェクトを設定する。</td>
</tr>
<tr>
  <td>matteColor</td>
  <td>マットカラーになるカラーオブジェクトを指定する。</td>
</tr>
<tr>
  <td>resolution</td>
  <td>解像度（72.0~2400 ppi）</td>
</tr>
<tr>
  <td>transparency</td>
  <td>背景を透明にするかどうか。trueで透明。falseで不透明。</td>
</tr>
</tbody>
</table>
<p>ドキュメントを分割してPNG 形式で保存するサンプル</p>
<pre><code>// ドキュメントを分割してPNG形式で保存する
var folderObj = Folder.selectDialog("分割画像を保存するフォルダを指定してください");
if (folderObj) {    // フォルダが選択された場合に処理する
    var splitX = 5; // 横の分割数
    var splitY = 3; // 縦の分割数
    var w = activeDocument.width / splitX;  // 分割画像の横幅を計算
    var h = activeDocument.height / splitY; // 分割画像の縦幅を計算
    var opt = new ImageCaptureOptions();    // オブジェクトを生成
    opt.antiAliasing = true;// アンチエイリアス
    opt.matte = false;// マットカラーなし
    opt.resolution = 72;// 解像度は72
    opt.transparency = true;// 背景を透明にする
    for(var y=1; y&lt;=splitY; y++){    // 縦の分割数だけ繰り返す
        for(var x=0; x&lt;splitX; x++){    // 横の分割数だけ繰り返す
            var fileObj = new File(folderObj.fullName+"/"+y+"_"+x+".png");// 保存ファイル名
            var rect = [x*w, -y*h+h, x*w+w, -y*h];// 左座標、上座標、右座標、下座標
            activeDocument.imageCapture(fileObj, rect, opt);    // 保存する
        }
    }
}</code></pre>
<p>　分割保存するドキュメントを用意します。</p>
<figure>
<figcaption>【図】ドキュメントを用意する</figcaption>
<img src="images/00333.jpeg" />
</figure>
<p>　スクリプトを実行すると分割ファイルの保存先を聞いてきます。保存先のフォルダを指定します。</p>
<figure>
<figcaption>【図】保存先のフォルダを指定</figcaption>
<img src="images/00125.jpeg" />
</figure>
<p>　ドキュメントが分割され複数のファイルとして保存されます。</p>
<figure>
<figcaption>【図】ドキュメントが複数のファイルとして保存される</figcaption>
<img src="images/00068.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-77">
<section>
<h2 id="calibre_link-183"><b>3-10　ドキュメント名を取得する</b></h2>
<p>　ドキュメント名を取得するにはドキュメントオブジェクトのnameプロパティを参照します。nameプロパティは読み出し専用で書き込むことはできません。</p>
<p>ドキュメント名を取得するサンプル</p>
<pre><code>// ドキュメント名を表示する
var docObj = activeDocument;
var docName = docObj.name;
alert("ドキュメント名："+docName);</code></pre>
<p>　ドキュメント名がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】ドキュメント名が表示される</figcaption>
<img src="images/00331.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-622">
<section>
<h2 id="calibre_link-184"><b>3-11　ドキュメントサイズを取得する</b></h2>
<p>　ドキュメントサイズはドキュメントオブジェクトのwidth、heightプロパティに入っています。プロパティに入っている数値で単位はついていませんが、値の単位はポイント（pt）になります。</p>
<p>　ポイントではなくミリメートルなど他の単位に変換する場合はUnitValueオブジェクトを使います。UnitValueオブジェクトのas()メソッドを使うことで任意の単位に変換することができます。</p>
<p>ドキュメントサイズを取得するサンプル</p>
<pre><code>// ドキュメントサイズを表示する
var w = activeDocument.width;
var h = activeDocument.height;
alert("ドキュメントサイズ："+w+"pt ×"+h+"pt");
// ptからmmに変換する
w = new UnitValue(w, "pt");
h = new UnitValue(h, "pt");
wMM = w.as("mm");
hMM = h.as("mm");
alert("ドキュメントサイズ："+wMM+"mm ×"+hMM+"mm");</code></pre>
<p>　ドキュメントのサイズがポイント単位で表示されます。</p>
<figure>
<figcaption>【図】サイズがポイント単位で表示される</figcaption>
<img src="images/00080.jpeg" />
</figure>
<p>　ドキュメントのサイズがミリメートル単位で表示されます。</p>
<figure>
<figcaption>【図】サイズがミリメートル単位で表示される</figcaption>
<img src="images/00265.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-21">
<section>
<h2 id="calibre_link-185"><b>3-12　ドキュメントのカラーモードを調べる</b></h2>
<p>　ドキュメントのカラーモードを調べるにはドキュメントオブジェクトのdocumentColorSpaceプロパティを参照します。返されるカラーモードは以下の表のようになります。</p>
<table>
<caption>【表】返されるカラーモードの値</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ</span>
  </td>
  <td>
    <span>返されるカラーモードの値</span>
  </td>
</tr>
<tr>
  <td>DocumentColorSpace.CMYK</td>
  <td>CMYKカラー</td>
</tr>
<tr>
  <td>DocumentColorSpace.RGB</td>
  <td>RGBカラー</td>
</tr>
</tbody>
</table>
<p>サイズがミリメートル単位で表示されサンプル</p>
<pre><code>// ドキュメントのカラーモードを調べる
var cMode = activeDocument.documentColorSpace;
alert(cMode);</code></pre>
<p>　ドキュメントのカラーモードがアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】カラーモードが表示される</figcaption>
<img src="images/00255.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-574">
<section>
<h2 id="calibre_link-186"><b>3-13　ドキュメントの原点座標を取得する</b></h2>
<p>　ドキュメントの原点座標を求めるにはドキュメントオブジェクトのpageOriginを参照します。pageOriginは配列になっており、最初の要素がX座標、2番目の要素がY座標になります。原点の位置はページツールで変更することができ、最初の状態では原点は(0,0)になっています。パスや四角形を描くメソッドの相対座標は、この原点を基準にして描画されます。また、pageOrigin配列に原点座標を代入しても原点は変更されません。</p>
<p>　pageOrigin以外にも定規の原点を示すrulerOriginがあります。アートボードが複数ある場合はactiveDocument.artboards[2].pageOrigin = [100, 50];やactiveDocument.artboards[2].rulerOrigin = [100, 50];のようにして原点座標を指定することができます。</p>
<p>ドキュメントの原点座標を求めるサンプル</p>
<pre><code>// ドキュメントの原点座標を求める
var origin = activeDocument.pageOrigin;
var px = origin[0];
var py = origin[1];
alert("原点座標：（"+px+","+py+"）");</code></pre>
<p>　ドキュメントの原点座標がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】原点座標が表示される</figcaption>
<img src="images/00036.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-686">
<section>
<h2 id="calibre_link-187"><b>3-14　トリムエリアを設定する</b></h2>
<p>　トリムエリアを設定するにはドキュメントオブジェクトのcropBoxにクリッピングしたい領域を指定します。領域は矩形座標で[左座標,上座標,右座標,下座標]の順番で指定します。</p>
<p>　Illustrator CS5以降はY座標の座標が逆になっています。このため、CS5より以前に作成したスクリプトが正常に動作しない場合はY座標の符号を反転させる必要があります。</p>
<p>トリムエリアを設定するサンプル</p>
<pre><code>// トリムエリア（ドキュメント領域のクリッピング）を作成する
var rect = [0, 50, 100, -300];// left, top, right, bottom
activeDocument.cropBox = rect;</code></pre>
<p>　スクリプトを実行する前の状態です。</p>
<figure>
<figcaption>【図】スクリプトを実行する前</figcaption>
<img src="images/00421.jpeg" />
</figure>
<p>　スクリプトを実行するとドキュメントにトリムエリアが設定されます。</p>
<figure>
<figcaption>【図】トリムエリアが設定される</figcaption>
<img src="images/00247.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-39">
<section>
<h2 id="calibre_link-188"><b>3-15　ドキュメントを閉じる</b></h2>
<p>　ドキュメントを閉じるにはドキュメントオブジェクトのclose()メソッドを使います。close()メソッドのパラメーターには、どのようにして閉じるかを指定します。以下の表に示すパラメーターを指定することができます。</p>
<p>　なお、close()メソッドでSaveOptions.PROMPTTOSAVECHANGESを指定し、ユーザーが「キャンセル」ボタンをクリックした場合、エラーが発生します。これを回避するにはサンプルのようにtry...catch()で囲みます。</p>
<table>
<caption>【表】close()メソッドに指定できるパラメーター</caption>
<tbody>
<tr>
  <td>
    <span>パラメーター</span>
  </td>
  <td>
    <span>内容</span>
  </td>
</tr>
<tr>
  <td>SaveOptions.DONOTSAVECHANGES</td>
  <td>保存せず確認のダイアログも出さずに閉じる</td>
</tr>
<tr>
  <td>SaveOptions.PROMPTTOSAVECHANGES</td>
  <td>確認のダイアログを出す</td>
</tr>
<tr>
  <td>SaveOptions.SAVECHANGES</td>
  <td>変更されていた場合は保存する</td>
</tr>
</tbody>
</table>
<p>ドキュメントを閉じるサンプル</p>
<pre><code>// アクティブドキュメントを閉じる（確認のダイアログを表示する）
try{
    activeDocument.close(SaveOptions.PROMPTTOSAVECHANGES);
}catch(e){
    alert("キャンセルされました");
}</code></pre>
<p>　ドキュメントを保存するかどうかのダイアログが表示されます。</p>
<figure>
<figcaption>【図】保存するかどうかを求められる</figcaption>
<img src="images/00443.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-519">
<section>
<h2 id="calibre_link-189"><b>3-16　強制的に全てのドキュメントを保存せずに閉じる</b></h2>
<p>　強制的に全てのドキュメントを保存せずに閉じるにはドキュメントオブジェクトのclose()メソッドのパラメーターにSaveOptions.DONOTSAVECHANGESを指定します。これをドキュメントの数だけ繰り返します。ドキュメントの数はdocuments.lengthで取得することができます。なお、繰り返し処理する場合はサンプルのように繰り返し変数を減らすようにします。増加するようにしてしまうと全てのドキュメントを閉じることはできません。</p>
<p>　また、close()メソッドのパラメーターにSaveOptions.SAVECHANGESを指定することで、全てのドキュメントを保存した後で閉じることもできます。</p>
<table>
<caption>【表】close()メソッドに指定できるパラメーター</caption>
<tbody>
<tr>
  <td>
    <span>パラメーター</span>
  </td>
  <td>
    <span>内容</span>
  </td>
</tr>
<tr>
  <td>SaveOptions.DONOTSAVECHANGES</td>
  <td>保存せず確認のダイアログも出さずに閉じる</td>
</tr>
<tr>
  <td>SaveOptions.PROMPTTOSAVECHANGES</td>
  <td>確認のダイアログを出す</td>
</tr>
<tr>
  <td>SaveOptions.SAVECHANGES</td>
  <td>変更されていた場合は保存する</td>
</tr>
</tbody>
</table>
<p>強制的に全てのドキュメントを保存せずに閉じるサンプル</p>
<pre><code>// 確認なしで全てのドキュメントを閉じる
for(var i=documents.length-1; i&gt;=0; i--){
    documents[i].close(SaveOptions.DONOTSAVECHANGES);
}</code></pre>
<p>　複数のドキュメントがありますが、スクリプトを実行すると全て閉じられます。</p>
<figure>
<figcaption>【図】全て閉じられる</figcaption>
<img src="images/00373.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-627">
<section>
<h2 id="calibre_link-190"><b>3-17　選択されている図形を他のドキュメントに移動させる</b></h2>
<p>　選択されている図形を他のドキュメントに移動させるにはmove()メソッドを使います。move()メソッドは全ての図形・文字などに用意されています。move()メソッドには2つのパラメーターを指定します。最初のパラメーターには移動先のオブジェクトを指定します。他のドキュメントに移動させるにはドキュメントオブジェクトを指定します。2番目のパラメーターには、どの位置に移動させるかを指定します。指定できるパラメーターを下表に示します。</p>
<table>
<caption>【表】move()メソッドの2番目のパラメーターに指定できる値</caption>
<tbody>
<tr>
  <td>
    <span>値</span>
  </td>
  <td>
    <span>内容</span>
  </td>
</tr>
<tr>
  <td>ElementPlacement.INSIDE</td>
  <td>内側</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEBEFORE</td>
  <td>前</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEATBEGINNING</td>
  <td>先頭</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEAFTER</td>
  <td>後</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEATEND</td>
  <td>最後</td>
</tr>
</tbody>
</table>
<p>選択されている図形を他のドキュメントに移動させるサンプル</p>
<pre><code>// 選択されている図形を他のドキュメントに移動させる
var selObj = activeDocument.selection;    // 現在のアクティブドキュメントの選択図形
var newDoc = app.documents.add(DocumentColorSpace.RGB, 595.28, 841.89);
for(var i=0; i&lt;selObj.length; i++){
    selObj[i].move(newDoc, ElementPlacement.INSIDE);    // 他のページに移動させる
}</code></pre>
<p>　他のドキュメントに移動させる図形を選択します。</p>
<figure>
<figcaption>【図】図形を選択</figcaption>
<img src="images/00348.jpeg" />
</figure>
<p>　スクリプトを実行すると新規に作成したドキュメントに移動します。元のドキュメントからは図形はなくなります。</p>
<figure>
<figcaption>【図】新規ドキュメントに移動</figcaption>
<img src="images/00139.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-26">
<section>
<h2 id="calibre_link-191"><b>3-18　遠近グリッドを表示する</b></h2>
<p>　遠近グリッドを表示するにはドキュメントオブジェクトのshowPerspectiveGrid()メソッドを実行します。表示に成功するとtrue、表示できなかった場合はfalseを返します。</p>
<p>　なお、表示した遠近グリッドを非表示にするにはhidePerspectiveGrid()メソッドを使います。showPerspectiveGrid()メソッドと同様に非表示に成功すればtrue、失敗した場合はfalseを返します。</p>
<p>遠近グリッドを表示するサンプル</p>
<pre><code>// 遠近グリッドを表示する
var flag = activeDocument.showPerspectiveGrid();
if (flag){
    alert("遠近グリッドを表示しました");
}else{
    alert("遠近グリッドを表示できませんでした");
}</code></pre>
<p>　遠近グリッドが表示されていない状態です。</p>
<figure>
<figcaption>【図】遠近グリッドが表示されていない</figcaption>
<img src="images/00527.jpeg" />
</figure>
<p>　スクリプトを実行すると処理結果が表示されます。</p>
<figure>
<figcaption>【図】処理結果が表示される</figcaption>
<img src="images/00310.jpeg" />
</figure>
<p>　遠近グリッドが表示されます。</p>
<figure>
<figcaption>【図】遠近グリッドが表示される</figcaption>
<img src="images/00540.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-90">
<section>
<h2 id="calibre_link-192"><b>3-19　遠近グリッドで、どの面がアクティブになっているか調べる</b></h2>
<p>　遠近グリッドで、どの面がアクティブになっているか調べるにはドキュメントオブジェクトのgetPerspectiveActivePlane()メソッドを実行します。返される値を下表に示します。</p>
<table>
<caption>【表】遠近グリッドの選択面を示す値</caption>
<tbody>
<tr>
  <td>
    <span>値</span>
  </td>
  <td>
    <span>内容</span>
  </td>
</tr>
<tr>
  <td>PerspectiveGridPlaneType.NOPLANE</td>
  <td>選択されていない</td>
</tr>
<tr>
  <td>PerspectiveGridPlaneType.LEFTPLANE</td>
  <td>左面</td>
</tr>
<tr>
  <td>PerspectiveGridPlaneType.RIGHTPLANE</td>
  <td>右面</td>
</tr>
<tr>
  <td>PerspectiveGridPlaneType.FLOORPLANE</td>
  <td>下面</td>
</tr>
</tbody>
</table>
<p>遠近グリッドでアクティブになっている面を調べるサンプル</p>
<pre><code>// 遠近グリッドで、どの面がアクティブになっているか調べる
activeDocument.showPerspectiveGrid();   // 遠近グリッドを表示
var pPlane = activeDocument.getPerspectiveActivePlane();
alert(pPlane);</code></pre>
<p>　遠近グリッドで右側の面がアクティブになっています。</p>
<figure>
<figcaption>【図】右側の面がアクティブ</figcaption>
<img src="images/00481.jpeg" />
</figure>
<p>　スクリプトを実行すると選択されている面を示す定数値（文字列）が表示されます。</p>
<figure>
<figcaption>【図】面を示す定数値が表示される</figcaption>
<img src="images/00249.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-572">
<section>
<h2 id="calibre_link-193"><b>3-20　遠近グリッドで指定した面をアクティブにする</b></h2>
<p>　遠近グリッドで指定した面をアクティブにするにはドキュメントオブジェクトのsetPerspectiveActivePlane()メソッドを実行します。パラメーターには以下の表に示す値を指定することができます。なお、マニュアルではsetActivePlane()と記載されていますが、setPerspectiveActivePlane()の間違いです。</p>
<table>
<caption>【表】遠近グリッドの選択面を示す値</caption>
<tbody>
<tr>
  <td>
    <span>値</span>
  </td>
  <td>
    <span>内容</span>
  </td>
</tr>
<tr>
  <td>PerspectiveGridPlaneType.NOPLANE</td>
  <td>選択なし</td>
</tr>
<tr>
  <td>PerspectiveGridPlaneType.LEFTPLANE</td>
  <td>左面</td>
</tr>
<tr>
  <td>PerspectiveGridPlaneType.RIGHTPLANE</td>
  <td>右面</td>
</tr>
<tr>
  <td>PerspectiveGridPlaneType.FLOORPLANE</td>
  <td>下面</td>
</tr>
</tbody>
</table>
<p>遠近グリッドで指定した面をアクティブにするサンプル</p>
<pre><code>// 遠近グリッドで指定した面をアクティブにする
activeDocument.showPerspectiveGrid();   // 遠近グリッドを表示
activeDocument.setPerspectiveActivePlane(
       PerspectiveGridPlaneType.FLOORPLANE);</code></pre>
<p>　遠近グリッドで指定した下側の面がアクティブになります。</p>
<figure>
<figcaption>【図】下側の面がアクティブになる</figcaption>
<img src="images/00053.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-681">
<section>
<div>
<h1 id="calibre_link-194"><b>第4章　カラー</b></h1>
</div>
<p>　この章では、図形や文字に反映されるカラーやスウォッチに関するサンプルを示し、解説します。Illustratorではさまざまなカラー方式が用意されています。</p>
</section>
</div>
<div id="calibre_link-35">
<section>
<h2 id="calibre_link-195"><b>4-1　RGBカラーで指定する</b></h2>
<p>　RGBカラーで指定するにはRGBColorオブジェクトを生成します。RGBColorオブジェクトはnew RGBColor()として生成することができます。生成されたオブジェクトのred、green、blueプロパティに0~255までの輝度を入れることで任意のRGBカラーを指定することができます。指定する輝度の値は0が最も暗く、255が最も明るくなります。値は整数値でなく小数値での指定もできます。</p>
<p>　サンプル-1ではRGBColorオブジェクトの各プロパティに値を設定しています。サンプル-2ではJavaScriptのハッシュ（連想配列）を利用して値を設定しています。ハッシュ／連想配列による指定はRGBColorオブジェクトだけでなく、他のカラーオブジェクトでも使用することができます。</p>
<p>RGBカラーで指定するサンプル-1（sample1.jsx）</p>
<pre><code>// RGBでデフォルトの塗り潰しのカラーを指定する(1)
var color = new RGBColor();
color.red = 255;
color.green = 255;
color.blue = 0;
activeDocument.defaultFillColor = color;</code></pre>
<p>RGBカラーで指定するサンプル-2（sample2.jsx）</p>
<pre><code>// RGBでデフォルトの塗り潰しのカラーを指定する(2)
var color = new RGBColor();
color["red"] = 255;
color["green"] = 255;
color["blue"] = 0;
activeDocument.defaultFillColor = color;</code></pre>
<p>　上記の「RGBカラーで指定するサンプル-1」または「サンプル-2」を実行するとデフォルトの塗り潰しのカラーが黄色になります。</p>
<figure>
<figcaption>【図】デフォルトの塗り潰しのカラーが黄色になる</figcaption>
<img src="images/000122.gif" />
</figure>
</section>
</div>
<div id="calibre_link-70">
<section>
<h2 id="calibre_link-196"><b>4-2　CMYKカラーで指定する</b></h2>
<p>　CMYKカラーで指定するにはCMYKColorオブジェクトを生成します。CMYKColorオブジェクトはnew CMYKColor()として生成することができます。生成されたオブジェクトのcyan、magenta、yellow、blackプロパティに0~100までの濃さの割合を入れることで任意のCMYKカラーを指定することができます。指定する輝度の値は0が最も薄く、100が最も濃くなります。値は整数値でなく小数値での指定もできます。</p>
<p>CMYKカラーで指定するサンプル</p>
<pre><code>// CMYKでデフォルトの塗り潰しのカラーを指定する
var color = new CMYKColor();
color.cyan = 80.25;
color.magenta = 19.69;
color.yellow = 21.5;
color.black = 10.25;
activeDocument.defaultFillColor = color;</code></pre>
<p>　デフォルトの塗り潰しのカラーが水色になります。</p>
<figure>
<figcaption>【図】デフォルトの塗り潰しのカラーが水色になる</figcaption>
<img src="images/000222.gif" />
</figure>
</section>
</div>
<div id="calibre_link-632">
<section>
<h2 id="calibre_link-197"><b>4-3　グレースケールカラーで指定する</b></h2>
<p>　グレースケール（灰色）カラーで指定するにはGrayColorオブジェクトを生成します。GrayColorオブジェクトはnew GrayColor()として生成することができます。生成されたオブジェクトのgrayプロパティに0~100までの輝度を入れます。指定する輝度の値は0が最も暗く、100が最も明るくなります。値は整数値でなく小数値での指定もできます。</p>
<p>グレースケールカラーで指定するサンプル</p>
<pre><code>// グレースケールでデフォルトの塗り潰しのカラーを指定する
var color = new GrayColor();
color.gray = 70;
activeDocument.defaultFillColor = color;</code></pre>
<p>　デフォルトの塗り潰しのカラーがグレーの70%に設定されます。</p>
<figure>
<figcaption>【図】デフォルトの塗り潰しのカラーがグレーの70%に設定される</figcaption>
<img src="images/000372.gif" />
</figure>
</section>
</div>
<div id="calibre_link-11">
<section>
<h2 id="calibre_link-198"><b>4-4　透明（カラーなし）を指定する</b></h2>
<p>　透明（カラーなし）を指定するにはNoColorオブジェクトを生成します。NoColorオブジェクトはnew NoColor()として生成することができます。NoColorには設定するプロパティはありません。生成したNoColorオブジェクトを、そのままカラー設定を行うプロパティ等に設定すれば透明に設定されます。</p>
<p>透明（カラーなし）を指定するサンプル</p>
<pre><code>// 塗り潰しのカラーを「なし」に指定する
var color = new NoColor();
activeDocument.defaultFillColor = color;</code></pre>
<p>　デフォルトの塗り潰しのカラーが透明に設定されます。</p>
<figure>
<figcaption>【図】デフォルトの塗り潰しのカラーが透明に設定される</figcaption>
<img src="images/000390.gif" />
</figure>
</section>
</div>
<div id="calibre_link-84">
<section>
<h2 id="calibre_link-199"><b>4-5　Labカラーで指定する</b></h2>
<p>　Labカラーで指定するにはLabColorオブジェクトを生成します(リファレンスによるとCIE Lab色空間)。Labカラーオブジェクトはnew LabColor()として生成することができます。生成されたオブジェクトのl(エル)、a、bプロパティに-128.0~+128.0までの値を指定することができます。lは明度、aは赤から緑までの範囲、bは黄色から青までの範囲を指定します。</p>
<p>　プログラム上ではLabカラーは生成できますが、実際にLabカラーで指定しようとするとエラーになり使用できません。Labカラーとは異なりますが、同じような輝度と赤青の色差で指定したい場合にはYCbCrカラーなどを使う方法があります。</p>
<p>Labカラーで指定するサンプル</p>
<pre><code>// Labでカラーを指定する
var color = new LabColor();
color.l = 70;
color.a = 54;
color.b = 81;</code></pre>
</section>
</div>
<div id="calibre_link-568">
<section>
<h2 id="calibre_link-200"><b>4-6　グラデーションカラーを指定する</b></h2>
<p>　グラデーションカラーを指定するにはドキュメントのグラデーションを追加またはすでにあるグラデーションを参照し、各プロパティに値を設定します。ドキュメントに新規にグラデーションを追加するにはgradients.add()とします。これでグラデーションオブジェクトが返されます。グラデーションの名前はnameプロパティに指定します。この時に、すでに存在するグラデーション名を指定するとエラーで停止します(グラデーション名はスウォッチパネルで確認できます。またエラーを回避するにはtry...catchを使います)。　グラデーションには線形と円形の2種類があります。グラデーションの種類を設定するにはグラデーションオブジェクトのtypeプロパティに下表で示すプロパティ名を設定します。</p>
<table>
<caption>【表】グラデーションの種類</caption>
<tbody>
<tr>
  <td>
    <span>グラデーションの形</span>
  </td>
  <td>
    <span>指定するプロパティ名</span>
  </td>
</tr>
<tr>
  <td>線形</td>
  <td>GradientType.LINEAR</td>
</tr>
<tr>
  <td>円形</td>
  <td>GradientType.RADIAL</td>
</tr>
</tbody>
</table>
<p>　グラデーションのカラーと色の配分割合はグラデーションオブジェクトのgradientStops配列の各プロパティに設定します。初期状態ではgradientStops配列は2つの要素を持っています。最初の要素がグラデーション開始、最後の要素がグラデーション終了に関する情報を持っています。colorプロパティにはグラデーションの色を指定します。グラデーションの位置はrampPointプロパティ、中間位置(混合)の割合はmidPointプロパティに指定します。rampPointプロパティには0.0~100.0%までの割合、midPiointプロパティは13.0~87.0までの値を指定することができます。また、グラデーションの色を増やしたい場合にはgradientStops.add()を使って追加することができます。設定したグラデーションを反映させるにはグラデーションカラーオブジェクトのgradientにグラデーションオブジェクトを設定します。</p>
<p>　CS4以降ではopacityプロパティにグラデーションカラーの不透明度を設定することができます。</p>
<p>透明（カラーなし）を指定するサンプル-1（sample1.jsx）</p>
<pre><code>// グラデーションカラーを指定する（円形）
var gradObj = activeDocument.gradients.add();
var gradColor = new GradientColor();//　グラデーションカラー
gradObj.name = "赤青グラデーション"; // 同じ名前は指定できないので注意
gradObj.type = GradientType.RADIAL;
gradObj.gradientStops[0].rampPoint = 0;//　開始位置
gradObj.gradientStops[0].midPoint = 80.0;//　中間位置
gradObj.gradientStops[0].color = setRGBColor(255,0,0);//　開始色
gradObj.gradientStops[1].rampPoint = 100.0;//　終了位置
gradObj.gradientStops[1].color = setRGBColor(0,0,255);//　終了色
gradColor.gradient = gradObj;
// RGBカラーを設定し、RGBカラーオブジェクトを返す
function setRGBColor(r,g,b){
    var RGB = new RGBColor();
    RGB.red = r;
    RGB.green = g;
    RGB.blue = b;
    return RGB;
}</code></pre>
<p>透明（カラーなし）を指定するサンプル-2（sample1.jsx）</p>
<pre><code>// グラデーションカラーを複数指定する（線形）
var gradObj = activeDocument.gradients.add();
var gradColor = new GradientColor();//　グラデーションカラー
gradObj.name = "複数色グラデーション";
gradObj.type = GradientType.LINEAR;
gradObj.gradientStops[0].rampPoint = 0;//　開始位置
gradObj.gradientStops[0].midPoint = 20.0;//　中間位置
gradObj.gradientStops[0].color = setRGBColor(255,0,0);//　開始色
gradObj.gradientStops[1].rampPoint = 100.0;//　終了位置
gradObj.gradientStops[1].color = setRGBColor(0,0,255);//　終了色
gradObj.gradientStops.add();
gradObj.gradientStops[2].rampPoint = 100.0;//　終了位置
gradObj.gradientStops[2].color = setRGBColor(0,255,255);//　終了色
gradObj.gradientStops.add();
gradObj.gradientStops[3].rampPoint = 100.0;//　終了位置
gradObj.gradientStops[3].color = setRGBColor(0,255,0);//　終了色
gradColor.gradient = gradObj;
// RGBカラーを設定し、RGBカラーオブジェクトを返す
function setRGBColor(r,g,b){
    var RGB = new RGBColor();
    RGB.red = r;
    RGB.green = g;
    RGB.blue = b;
    return RGB;
}</code></pre>
<p>　サンプル-1を実行すると青から赤に変化する円形グラデーションが追加されます。追加されたグラデーションはスウォッチパネルで確認できます。</p>
<figure>
<figcaption>【図】青から赤に変化する円形グラデーションが追加される</figcaption>
<img src="images/00175.jpeg" />
</figure>
<p>　サンプル-2を実行すると複数の色に変化する線形グラデーションが追加されます。追加されたグラデーションはスウォッチパネルで確認できます。</p>
<figure>
<figcaption>【図】複数の色に変化する線形グラデーションが追加される</figcaption>
<img src="images/00475.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-117">
<section>
<h2 id="calibre_link-201"><b>4-7　パターンカラーを指定する</b></h2>
<p>　パターンカラーを指定するにはスウォッチオブジェクトからパターンを抽出します。パターンカラーとなっていますが、既存のパターンや自分で生成したパターンの色を変更できるわけではありません。パターンをカラーと同様に設定できるという意味でのパターンカラーという名称になっています。</p>
<p>　パターンカラーは以下の表に示すような回転角度や傾斜角度などを指定することができます。設定されたパターンは塗りつぶしカラーなどに設定することができます。</p>
<table>
<caption>【表】パターンカラーに設定できる内容とプロパティ</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ</span>
  </td>
  <td>
    <span>内容</span>
  </td>
</tr>
<tr>
  <td>matrix</td>
  <td>マトリクス</td>
</tr>
<tr>
  <td>pattern</td>
  <td>パターンオブジェクト</td>
</tr>
<tr>
  <td>reflect</td>
  <td>反転(true で反転)</td>
</tr>
<tr>
  <td>reflectAngle</td>
  <td>反転角度</td>
</tr>
<tr>
  <td>rotation</td>
  <td>回転角度</td>
</tr>
<tr>
  <td>scaleFactor</td>
  <td>角度(配列要素)</td>
</tr>
<tr>
  <td>shearAngle</td>
  <td>傾斜角度</td>
</tr>
<tr>
  <td>shearAxis</td>
  <td>傾斜軸</td>
</tr>
<tr>
  <td>shiftAngle</td>
  <td>角度</td>
</tr>
<tr>
  <td>shiftDistance</td>
  <td>距離</td>
</tr>
<tr>
  <td>typename</td>
  <td>種類（パターンの場合はPatternColorの文字列になります）</td>
</tr>
</tbody>
</table>
<p>パターンカラーを指定するサンプル</p>
<pre><code>// 選択した図形にパターンを指定する
var patColor = activeDocument.swatches["木の葉"].color;
patColor.rotation = 45; // 角度は45度
patColor.shearAngle = 15;   // 傾斜は15度
activeDocument.selection[0].fillColor = activeDocument.swatches["木の葉"].color;</code></pre>
<p>　選択した最初の図形に木の葉のパターンが設定されます。</p>
<figure>
<figcaption>【図】木の葉のパターンが設定される</figcaption>
<img src="images/00344.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-30">
<section>
<h2 id="calibre_link-202"><b>4-8　スポットカラーを指定する</b></h2>
<p>　スポットカラーを指定するにはスポットカラーのオブジェクトを作成し必要なプロパティを設定します。スポットカラーを作成するには、spots.add()としてドキュメントにスポットを追加します。スポットカラー名はnameプロパティに設定することができます。スポットカラーの種類はcolorTypeで指定します。指定できるプロパティは以下の表のものになります。</p>
<table>
<caption>【表】スポットカラーに設定できる内容とプロパティ</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ</span>
  </td>
  <td>
    <span>内容</span>
  </td>
</tr>
<tr>
  <td>ColorModel.PROCESS</td>
  <td>プロセスカラー</td>
</tr>
<tr>
  <td>ColorModel.REGISTRATION</td>
  <td>レジストレーションカラー</td>
</tr>
<tr>
  <td>ColorModel.SPOT</td>
  <td>スポットカラー(特色)</td>
</tr>
</tbody>
</table>
<p>　スポットの色はcolorプロパティにカラーオブジェクトを指定します。作成したスポットカラーはスウォッチパネルに表示されます。colorTypeで設定した種類に応じてカラーアイコンが変化します。</p>
<p>スポットカラーを指定するサンプル</p>
<pre><code>// スポットカラーを指定する(new SpotColor使用)
var spObj = activeDocument.spots.add();
spObj.name = "スポットライト";
spObj.colorType = ColorModel.PROCESS;
spObj.color = setRGBColor(255, 192, 0);
var newSpotColor = new SpotColor();
newSpotColor.spot = spObj;
newSpotColor.tint = 60;
// RGBカラーを設定し、RGBカラーオブジェクトを返す
function setRGBColor(r,g,b){
    var RGB = new RGBColor();
    RGB.red = r;
    RGB.green = g;
    RGB.blue = b;
    return RGB;
}</code></pre>
<p>　スポットカラーを設定する前の状態です。</p>
<figure>
<figcaption>【図】設定前の状態</figcaption>
<img src="images/00136.jpeg" />
</figure>
<p>　スクリプトを実行するとスポットカラーが設定されます。設定されたスポットカラーはスウォッチパネルに追加されます。</p>
<figure>
<figcaption>【図】スポットカラーが設定される</figcaption>
<img src="images/00524.jpeg" />
</figure>
<p>　追加されたスウォッチをダブルクリックすると詳細情報を確認できます。</p>
<figure>
<figcaption>【図】詳細情報を確認できる</figcaption>
<img src="images/00095.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-136">
<section>
<h2 id="calibre_link-203"><b>4-9　オブジェクトのカラーを読み出す</b></h2>
<p>　オブジェクトのカラーを読み出すには塗りつぶし色の場合はfillColorプロパティ、線の色の場合はstrokeColorプロパティを参照します。これらのプロパティにはカラーオブジェクト等が入っています。カラーモードによって読み出せる値が異なります。RGBモードの場合はCMYKの値は読み出せません。同様にCMYKの場合はRGBの値が読み出せません。設定されているカラーがRGB,CMYKでなくグレーの場合はカラーオブジェクトのgrayプロパティを参照します。また、グラデーションの場合はgradientプロパティの有無、パターンの場合はpatternプロパティの有無、スポットカラーの場合はspotプロパティの有無によって設定値を読み出すことができます。</p>
<p>　なお、スポットカラーの場合はspotプロパティ（実際にはオブジェクト）に設定されているカラーの種類（colorType）や色情報（colorプロパティ）から実際に設定されているRGB値などを読み出すことができます。</p>
<p>オブジェクトのカラーを読み出すサンプル</p>
<pre><code>// 選択されたオブジェクトの塗り潰しカラーの値を表示する
var colorType = app.activeDocument.documentColorSpace;
var selObj = app.activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    if (colorType == DocumentColorSpace.RGB){// RGBモード
        var R = G = B = "透明";
        if (selObj[i].fillColor.gradient){
            R = G = B = "グラデーションカラー";
        }
        if (selObj[i].fillColor.gray){
            R = G = B = "グレー："+selObj[i].fillColor.gray;
        }
        if (selObj[i].fillColor.pattern){
            R = G = B = "パターン";
        }
        if (selObj[i].fillColor.spot){
            R = G = B = "スポットカラー";
        }
        if (selObj[i].fillColor.red || selObj[i].fillColor.green|| selObj[i].fillColor.blue){
            R = selObj[i].fillColor.red;
            G = selObj[i].fillColor.green;
            B = selObj[i].fillColor.blue;
        }
        alert("RGB Mode : R="+R+", G="+G+", B="+B);
    }else{
        var C = M = Y = K = "透明";
        if (selObj[i].fillColor.gradient){
            C = M = Y = K = "グラデーションカラー";
        }
        if (selObj[i].fillColor.gray){
            C = M = Y = K = "グレー："+selObj[i].fillColor.gray;
        }
        if (selObj[i].fillColor.pattern){
            C = M = Y = K = "パターン";
        }
        if (selObj[i].fillColor.spot){
            C = M = Y = K = "スポットカラー";
        }
        if (selObj[i].fillColor.cyan || selObj[i].fillColor.magenta || selObj[i].fillColor.yellow || selObj[i].fillColor.black){
            C = selObj[i].fillColor.cyan;
            M = selObj[i].fillColor.magenta;
            Y = selObj[i].fillColor.yellow;
            K = selObj[i].fillColor.black;
        }
        alert("CMYK Mode : C="+C+", M="+M+", Y="+Y+", K="+K);
    }
}</code></pre>
<p>　選択した図形のカラーの種類や内容がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】選択した図形のカラーの種類や内容が示される</figcaption>
<img src="images/00092.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-628">
<section>
<h2 id="calibre_link-204"><b>4-10　スウォッチカラーの総数を求める</b></h2>
<p>　スウォッチカラーの総数を求めるにはスウォッチカラーの情報を格納しているswatches配列の総数を求めます。配列の総数はlengthプロパティを参照することで求めることができます。</p>
<p>スウォッチカラーの総数を求めるサンプル</p>
<pre><code>// スウォッチカラーの総数を求める
var n = activeDocument.swatches.length;
alert("スウォッチカラーの総数："+n);</code></pre>
<p>　スウォッチカラーの総数がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】スウォッチカラーの総数が表示される</figcaption>
<img src="images/00490.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-527">
<section>
<h2 id="calibre_link-205"><b>4-11　特定のスウォッチカラーを削除する</b></h2>
<p>　指定した名前のスウォッチカラーを削除するにはスウォッチオブジェクトのremove()メソッドを使います。スウォッチオブジェクトであるswatches配列の要素番号またはスウォッチカラー名を指定しremove()メソッドを使用すると該当するスウォッチカラーが削除されます。ただし、該当するスウォッチカラーがない場合にはエラーになります。エラーを回避したい場合はサンプルのようにtry...catchを使います。</p>
<p>特定のスウォッチカラーを削除するサンプル</p>
<pre><code>// 指定した名前のスウォッチカラーを削除する
try{
    activeDocument.swatches["CMYK レッド"].remove();
}catch(e){
    alert("該当する名前のスウォッチカラーはありません");
}</code></pre>
<p>　スウォッチカラーを削除する前の状態です。</p>
<figure>
<figcaption>【図】スウォッチカラーの削除前</figcaption>
<img src="images/00266.jpeg" />
</figure>
<p>　該当するスウォッチカラーが削除されます。</p>
<figure>
<img src="images/00047.jpeg" />
</figure>
<p>　該当するスウォッチカラーがない場合はアラートダイアログが表示されます。</p>
<figure>
<figcaption>【図】該当するスウォッチカラーがない場合</figcaption>
<img src="images/00431.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-565">
<section>
<h2 id="calibre_link-206"><b>4-12　全てのスウォッチカラーを削除する</b></h2>
<p>　全てのスウォッチカラーを削除するにremoveAll()()メソッドを使います。</p>
<p>　なお、全てのスウォッチカラーを完全に削除することはできず、透明カラーなど一部のスウォッチカラーは残ったままになります。</p>
<p>全てのスウォッチカラーを削除するサンプル</p>
<pre><code>// 全てのスウォッチカラーを削除する
activeDocument.swatches.removeAll();</code></pre>
<p>　スウォッチカラーを削除する前の状態です。</p>
<figure>
<figcaption>【図】スウォッチカラーの削除前</figcaption>
<img src="images/00217.jpeg" />
</figure>
<p>　削除可能な全てのスウォッチカラーが削除されます。</p>
<figure>
<figcaption>【図】全てのスウォッチカラーが削除される</figcaption>
<img src="images/00239.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-20">
<section>
<h2 id="calibre_link-207"><b>4-13　スウォッチパネルで選択されているスウォッチカラーを取得する</b></h2>
<p>　スウォッチパネルで選択されているスウォッチカラーを取得するにはgetSelected()メソッドを使います。スウォッチカラーは複数選択できるためgetSelected()メソッドは選択されたスウォッチカラーを格納した配列を返します。</p>
<p>　選択されたスウォッチカラーの数は配列のlengthプロパティで求めることができます。また、配列要素はスウォッチカラーオブジェクトなので、nameプロパティなどを使って情報を取得することができます。</p>
<p>スウォッチパネルで選択されているスウォッチカラーを取得するサンプル</p>
<pre><code>// スウォッチパネルで選択されているスウォッチカラーを取得する
var swColor = activeDocument.swatches.getSelected();    // 選択中のスウォッチを取得
if(swColor.length == 0){
    alert("選択されていません");
}else{
    alert(swColor.length+"個のスウォッチカラーが選択されています");
    alert("最初に選択されたスウォッチカラー名："+swColor[0].name);
}</code></pre>
<p>　スウォッチパネルで何も選択していない場合には、このようなアラートダイアログが表示されます。</p>
<figure>
<figcaption>【図】スウォッチパネルで何も選択していない場合</figcaption>
<img src="images/00384.jpeg" />
</figure>
<p>　複数のスウォッチカラーを選択した場合は、このようなアラートダイアログが表示されます。</p>
<figure>
<figcaption>【図】複数のスウォッチカラーを選択した場合</figcaption>
<img src="images/00171.jpeg" />
</figure>
<p>　続いて最初に選択されたスウォッチカラーの名前が表示されます。</p>
<figure>
<figcaption>【図】最初に選択されたスウォッチカラーの名前が表示される</figcaption>
<img src="images/00562.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-576">
<section>
<h2 id="calibre_link-208"><b>4-14　スウォッチカラーを追加する</b></h2>
<p>　スウォッチカラーを追加するにはスウォッチカラーオブジェクトのadd()メソッドを使います。add()メソッドには指定できるパラメーターはなく、生成したオブジェクトのプロパティに名前やカラーを設定します。</p>
<p>スウォッチカラーを追加するサンプル</p>
<pre><code>// スウォッチカラーを追加する
for(var i=0; i&lt;16; i++){
    var swColor = activeDocument.swatches.add();
    color_RGB  = new RGBColor();
    color_RGB.red = i*16;    // 赤色を設定する
    color_RGB.green = 0;
    color_RGB.blue = 0;
    swColor.name = "JS-赤"+i;  // 名前を設定する
    swColor.color = color_RGB;  // カラーを設定する
}</code></pre>
<p>　スウォッチパネルにカラーを追加する前の状態です</p>
<figure>
<figcaption>【図】カラーを追加する前の状態</figcaption>
<img src="images/00338.jpeg" />
</figure>
<p>　暗い赤から明るい赤までのスウォッチカラーが追加されます。</p>
<figure>
<figcaption>【図】スウォッチカラーが追加される</figcaption>
<img src="images/00129.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-596">
<section>
<h2 id="calibre_link-209"><b>4-15　スウォッチカラーグループの総数を求める</b></h2>
<p>　スウォッチカラーグループの総数を求めるにはスウォッチカラーグループの情報を格納しているswatchGroups配列の総数を求めます。配列の総数はlengthプロパティを参照することで求めることができます。なお、グループはスウォッチパネル内でフォルダで表示されますが、元（ルート／フォルダに入っていない最上位階層のスウォッチ）となるスウォッチカラーグループはフォルダアイコンでは示されません。</p>
<p>スウォッチカラーグループの総数を求めるサンプル</p>
<pre><code>// スウォッチカラーグループの総数を求める
var n = activeDocument.swatchGroups.length;
alert("スウォッチカラーグループの総数："+n);</code></pre>
<p>　スウォッチカラーグループの総数がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】スウォッチカラーグループの総数が表示される</figcaption>
<img src="images/00519.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-125">
<section>
<h2 id="calibre_link-210"><b>4-16　指定した名前のスウォッチカラーグループを削除する</b></h2>
<p>　指定した名前のスウォッチカラーグループを削除するにはスウォッチグループオブジェクトのremove()メソッドを使います。スウォッチグループオブジェクトであるswatchGroups配列の要素番号またはスウォッチカラーグループ名を指定しremove()メソッドを使用すると該当するスウォッチグループが削除されます。ただし、該当するスウォッチグループオブジェクトがない場合にはエラーになります。エラーを回避したい場合はサンプルのようにtry...catchを使います。</p>
<p>指定した名前のスウォッチカラーグループを削除するサンプル</p>
<pre><code>// 指定した名前のスウォッチカラーグループを削除する
try{
    activeDocument.swatchGroups["輝き"].remove();
}catch(e){
    alert("該当する名前のスウォッチカラーグループはありません");
}</code></pre>
<p>　スウォッチカラーグループを削除する前の状態です。</p>
<figure>
<figcaption>【図】スウォッチカラーグループを削除する前</figcaption>
<img src="images/00466.jpeg" />
</figure>
<p>　該当するスウォッチカラーグループが削除されます。</p>
<figure>
<figcaption>【図】スウォッチカラーグループが削除される</figcaption>
<img src="images/00086.jpeg" />
</figure>
<p>　該当するスウォッチカラーグループがない場合はアラートダイアログが表示されます。</p>
<figure>
<figcaption>【図】該当するスウォッチカラーグループがない場合</figcaption>
<img src="images/00471.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-659">
<section>
<h2 id="calibre_link-211"><b>4-17　全てのスウォッチカラーグループを削除する</b></h2>
<p>　全てのスウォッチカラーグループを削除するにはremoveAll()メソッドを使って行います。また、グループ内に含まれるスウォッチカラーも削除されます。</p>
<p>全てのスウォッチカラーグループを削除するサンプル</p>
<pre><code>// 全てのスウォッチカラーグループを削除する
activeDocument.swatchGroups.removeAll();</code></pre>
<p>　スウォッチカラーグループを削除する前の状態です。</p>
<figure>
<figcaption>【図】グループを削除する前</figcaption>
<img src="images/00261.jpeg" />
</figure>
<p>　全てのスウォッチカラーグループが削除されます。</p>
<figure>
<figcaption>【図】全てのグループが削除される</figcaption>
<img src="images/00037.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-137">
<section>
<h2 id="calibre_link-212"><b>4-18　スウォッチカラーグループ内のスウォッチカラーを求める</b></h2>
<p>　スウォッチカラーグループ内のスウォッチカラーを求めるにはgetAllSwatches()メソッドを使います。戻り値はグループ内のスウォッチカラーオブジェクト一覧を入れた配列になります。また、グループ内のスウォッチカラーの総数はlengthプロパティを参照することで求めることができます。</p>
<p>スウォッチカラーグループ内のスウォッチカラーを求めるサンプル</p>
<pre><code>// スウォッチカラーグループ内のスウォッチカラーを求める
var swList = activeDocument.swatchGroups["グレー"].getAllSwatches();
alert("グループ[グレー]内のスウォッチ総数："+swList.length);</code></pre>
<p>　グレーのスウォッチカラーグループ内のスウォッチカラー総数がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】グループ内のスウォッチカラー総数表示される</figcaption>
<img src="images/00055.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-606">
<section>
<h2 id="calibre_link-213"><b>4-19　スウォッチカラーグループを追加する</b></h2>
<p>　スウォッチカラーグループを追加するにはスウォッチカラーグループオブジェクトのadd()メソッドを使います。add()メソッドには指定できるパラメーターはなく、生成したオブジェクトのプロパティに名前を設定します。なお、他に設定できるプロパティはありません。</p>
<p>グレーのスウォッチカラーグループ内のスウォッチカラー総数がアラートダイアログに表示されます。サンプル</p>
<pre><code>// スウォッチカラーグループを追加する
var swGroup = activeDocument.swatchGroups.add();
swGroup.name = "JSグループ";</code></pre>
<p>　スウォッチパネルにグループを追加する前の状態です。</p>
<figure>
<figcaption>【図】グループを追加する前</figcaption>
<img src="images/00134.jpeg" />
</figure>
<p>　指定した名前のグループが追加されます。</p>
<figure>
<figcaption>【図】指定した名前のグループが追加される</figcaption>
<img src="images/00224.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-1">
<section>
<h2 id="calibre_link-214"><b>4-20　スウォッチカラーグループ内にスウォッチカラーを追加する</b></h2>
<p>　スウォッチカラーをadd()メソッドで追加、生成した後にaddSwatch()メソッドを使うことでスウォッチカラーグループ内にスウォッチカラーを追加することができます。addSwatch()メソッドのパラメーターにグループ内に入れるスウォッチカラーオブジェクトを指定します。</p>
<p>スウォッチカラーグループ内にスウォッチカラーを追加するサンプル</p>
<pre><code>// スウォッチカラーグループ内にスウォッチカラーを追加する
var swGroup = activeDocument.swatchGroups.add();
swGroup.name = "緑グループ";
for(var i=0; i&lt;16; i++){
    var swColor = activeDocument.swatches.add();
    color_RGB  = new RGBColor();
    color_RGB.red = 0;    // 赤色を設定する
    color_RGB.green = i * 16;
    color_RGB.blue = 0;
    swColor.name = "JS-赤"+i;  // 名前を設定する
    swColor.color = color_RGB;  // カラーを設定する
    swGroup.addSwatch(swColor); // グループ内に追加
}</code></pre>
<p>　スウォッチカラーグループ内にスウォッチカラーを追加する前の状態です。</p>
<figure>
<figcaption>【図】カラーグループ・スウォッチカラーを追加する前</figcaption>
<img src="images/00015.jpeg" />
</figure>
<p>　暗い緑から明るい緑までのカラーグループと、その中にスウォッチカラーが追加されます。</p>
<figure>
<figcaption>【図】カラーグループとその中にスウォッチカラーが追加される</figcaption>
<img src="images/00392.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-542">
<section>
<h2 id="calibre_link-215"><b>4-21　スポットカラーの総数を求める</b></h2>
<p>　スポットカラーの総数を求めるにはスポットカラーの情報を格納しているspots配列の総数を求めます。配列の総数はlengthプロパティを参照することで求めることがで きます。</p>
<p>スポットカラーの総数を求めるサンプル</p>
<pre><code>// スポットカラーの総数を求める
var n = activeDocument.spots.length;
alert("スポットカラーの総数："+n);</code></pre>
<p>　スポットカラーの総数がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】スポットカラーの総数が表示される</figcaption>
<img src="images/00177.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-705">
<section>
<h2 id="calibre_link-216"><b>4-22　特定のスポットカラーを削除する</b></h2>
<p>　特定のスポットカラーを削除するにはスポットオブジェクトのremove()メソッドを使います。スポットオブジェクトであるspots配列の要素番号またはスポットカラー名を指定しremove()メソッドを使用すると該当するスポットカラーが削除されます。ただし、該当するスポットカラーがない場合にはエラーになります。エラーを回避したい場合はサンプルのようにtry...catchを使います。</p>
<p>特定のスポットカラーを削除するサンプル</p>
<pre><code>// 銀色の名前のスポットカラーを削除する
try{
    activeDocument.spots["銀色"].remove();
}catch(e){
    alert("該当する名前のスポットカラーはありません");
}</code></pre>
<p>　スポットカラーを削除する前の状態です。</p>
<figure>
<figcaption>【図】スポットカラーを削除する前</figcaption>
<img src="images/00325.jpeg" />
</figure>
<p>　該当するスポットカラーが削除されます。</p>
<figure>
<figcaption>【図】スポットカラーが削除される</figcaption>
<img src="images/00286.jpeg" />
</figure>
<p>　該当するスポットカラーがない場合はアラートダイアログが表示されます。</p>
<figure>
<figcaption>【図】該当するスポットカラーがない場合</figcaption>
<img src="images/00420.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-109">
<section>
<h2 id="calibre_link-217"><b>4-23　全てのスポットカラーを削除する</b></h2>
<p>　全てのスポットカラーを削除するメソッドとしてremoveAll()メソッドがあります。しかし、場合によってはうまく動作しないことがあります。このような場合はサンプルのように全てのスポットオブジェクトに対してremove()メソッドを使い削除していきます。</p>
<p>全てのスポットカラーを削除するサンプル</p>
<pre><code>// 全てのスポットカラーを削除する
var spObj = activeDocument.spots;
for(var i=spObj.length-1; i&gt;=0; i--){
    spObj[i].remove();  // 削除する
}</code></pre>
<p>　スポットカラーを削除する前の状態です。</p>
<figure>
<figcaption>【図】スポットカラーを削除する前</figcaption>
<img src="images/00526.jpeg" />
</figure>
<p>　全てのスポットカラーが削除されます。</p>
<figure>
<figcaption>【図】全てのスポットカラーが削除される</figcaption>
<img src="images/00308.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-740">
<section>
<h2 id="calibre_link-218"><b>4-24　スポットカラーの種類を調べる</b></h2>
<p>　スポットカラーの種類を調べるにはスポットオブジェクトのcolorTypeプロパティを調べます。colorTypeプロパティは以下の表に示す値を返します。</p>
<table>
<caption>【表】カラーの種類</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ</span>
  </td>
  <td>
    <span>カラーの種類</span>
  </td>
</tr>
<tr>
  <td>ColorModel.PROCESS</td>
  <td>プロセスカラー(グローバルのチェック入)</td>
</tr>
<tr>
  <td>ColorModel.REGISTRATION</td>
  <td>レジストレーションカラー</td>
</tr>
<tr>
  <td>ColorModel.SPOT</td>
  <td>スポットカラー</td>
</tr>
</tbody>
</table>
<p>スポットカラーの種類を調べるサンプル</p>
<pre><code>// スポットカラーの種類を調べる
var spotObj = activeDocument.spots;
for(var i=0; i&lt;spotObj.length; i++){
    alert(spotObj[i].colorType);
}</code></pre>
<p>　全てのスポットカラーの種類がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】全てのスポットカラーの種類が表示される（レジストレーションカラー）</figcaption>
<img src="images/00094.jpeg" />
</figure>
<figure>
<figcaption>【図】全てのスポットカラーの種類が表示される（プロセスカラー）</figcaption>
<img src="images/00328.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-132">
<section>
<h2 id="calibre_link-219"><b>4-25　パターンカラーの総数を求める</b></h2>
<p>　パターンカラーの総数を求めるにはパターンカラーの情報を格納しているpatterns配列の総数を求めます。配列の総数はlengthプロパティを参照することで求めることがで きます。</p>
<p>パターンカラーの総数を求めるサンプル</p>
<pre><code>// パターンカラーの総数を求める
var n = activeDocument.patterns.length;
alert("パターンカラーの総数："+n);
</code></pre>
<p>　パターンカラーの総数がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】パターンカラーの総数が表示される</figcaption>
<img src="images/00458.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-590">
<section>
<h2 id="calibre_link-220"><b>4-26　指定した名前のパターンカラーを削除する</b></h2>
<p>　指定した名前のパターンカラーを削除するにはパターンオブジェクトのremove()メソッドを使います。パターンオブジェクトであるpatterns配列の要素番号またはパターンカラー名を指定しremove()メソッドを使用すると該当するパターンカラーが削除されます。ただし、該当するパターンカラーがない場合にはエラーになります。エラーを回避したい場合はサンプルのようにtry...catchを使います。</p>
<p>指定した名前のパターンカラーを削除するサンプル</p>
<pre><code>// 指定した名前のパターンカラーを削除する
try{
    activeDocument.patterns["木の葉"].remove();
}catch(e){
    alert("該当する名前のパターンカラーはありません");
}</code></pre>
<p>　スクリプトを実行する前の状態です。</p>
<figure>
<figcaption>【図】スクリプトを実行する前の状態です。</figcaption>
<img src="images/00586.jpeg" />
</figure>
<p>　スクリプトを実行すると指定した名前のパターンカラーが削除されます。</p>
<figure>
<figcaption>【図】指定した名前のパターンカラーが削除される</figcaption>
<img src="images/00434.jpeg" />
</figure>
<p>　削除対象となるパターンカラーがない場合はアラートダイアログが表示されます。</p>
<figure>
<figcaption>【図】削除対象となるパターンカラーがない場合</figcaption>
<img src="images/00220.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-755">
<section>
<h2 id="calibre_link-221"><b>4-27　全てのパターンカラーを削除する</b></h2>
<p>　全てのパターンカラーを削除するにはremoveAll()メソッドを使います。</p>
<p>全てのパターンカラーを削除するサンプル</p>
<pre><code>// 全てのパターンカラーを削除する
activeDocument.patterns.removeAll();</code></pre>
<p>　スクリプトを実行する前の状態です。</p>
<figure>
<figcaption>【図】スクリプトを実行する前の状態</figcaption>
<img src="images/00011.jpeg" />
</figure>
<p>　スクリプトを実行するとパターンカラーが全て削除されます。</p>
<figure>
<figcaption>【図】パターンカラーが全て削除される</figcaption>
<img src="images/00388.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-523">
<section>
<h2 id="calibre_link-222"><b>4-28　グラデーションカラーの総数を求める</b></h2>
<p>　グラデーションカラーの総数を求めるにはグラデーションカラーの情報を格納しているgradients配列の総数を求めます。配列の総数はlengthプロパティを参照することで求めることがで きます。</p>
<p>グラデーションカラーの総数を求めるサンプル</p>
<pre><code>// グラデーションカラーの総数を求める
var n = activeDocument.gradients.length;
alert("グラデーションカラーの総数："+n);</code></pre>
<p>　グラデーションカラーの総数がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】グラデーションカラーの総数が表示される</figcaption>
<img src="images/00073.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-653">
<section>
<h2 id="calibre_link-223"><b>4-29　指定した名前のグラデーションカラーを削除する</b></h2>
<p>　指定した名前のグラデーションカラーを削除するにはグラデーションオブジェクトのremove()メソッドを使います。グラデーションオブジェクトであるgradients配列の要素番号またはグラデーションカラー名を指定しremove()メソッドを使用すると該当するグラデーションカラーが削除されます。ただし、該当するグラデーションカラーがない場合にはエラーになります。エラーを回避したい場合はサンプルのようにtry...catchを使います。</p>
<p>指定した名前のグラデーションカラーを削除するサンプル</p>
<pre><code>// 指定した名前のグラデーションカラーを削除する
try{
    activeDocument.gradients["色あせた空"].remove();
}catch(e){
    alert("該当する名前のグラデーションカラーはありません");
}</code></pre>
<p>　スクリプトを実行する前の状態です。</p>
<figure>
<figcaption>【図】スクリプトを実行する前</figcaption>
<img src="images/00109.jpeg" />
</figure>
<p>　スクリプトを実行すると指定した名前のグラデーションカラーが削除されます。</p>
<figure>
<figcaption>【図】指定した名前のグラデーションカラーが削除される</figcaption>
<img src="images/00140.jpeg" />
</figure>
<p>　try...catchを使用すると、該当するグラデーションカラーがない場合でもエラーエラーを回避してアラートを表示させることができます。</p>
<figure>
<figcaption>【図】try...catchでエラーを回避してアラートを表示させる</figcaption>
<img src="images/00399.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-58">
<section>
<h2 id="calibre_link-224"><b>4-30　全てのグラデーションカラーを削除する</b></h2>
<p>　全てのグラデーションカラーを削除するにはremoveAll()メソッドを使います。</p>
<p>全てのグラデーションカラーを削除するサンプル</p>
<pre><code>// 全てのグラデーションカラーを削除する
activeDocument.gradients.removeAll();</code></pre>
<p>　スクリプトを実行する前の状態です。</p>
<figure>
<figcaption>【図】スクリプトを実行する前の状態</figcaption>
<img src="images/00522.jpeg" />
</figure>
<p>　スクリプトを実行するとグラデーションカラーが全て削除されます。</p>
<figure>
<figcaption>【図】スクリプトを実行するとグラデーションカラーが全て削除される</figcaption>
<img src="images/00306.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-598">
<section>
<h2 id="calibre_link-225"><b>4-31　オーバープリントが設定されているか調べる</b></h2>
<p>　オーバープリントが設定されているか調べるには、オーバープリントに関するプロパティ値を調べます。オーバープリントはパス図形、文字、画像に設定することができます。オーバープリントはパス、文字、画像とも異なるプロパティ名になっていますので、それぞれ別個に繰り返し処理を書く必要があります。なお、画像に関しては線のオーバープリントがないのでプロパティは存在しません。また、文字はテキストフレーム全体ではなく1文字ごとに設定できるため、サンプルのように文字数分だけ繰り返し調べる必要があります。</p>
<table>
<caption>【表】パス図形のオーバープリントのプロパティ名</caption>
<tbody>
<tr>
  <td>
    <span>調べる内容</span>
  </td>
  <td>
    <span>プロパティ</span>
  </td>
</tr>
<tr>
  <td>線</td>
  <td>strokeOverprint</td>
</tr>
<tr>
  <td>塗り</td>
  <td>fillOverprint</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】画像のオーバープリントのプロパティ名</caption>
<tbody>
<tr>
  <td>
    <span>調べる内容</span>
  </td>
  <td>
    <span>プロパティ</span>
  </td>
</tr>
<tr>
  <td>塗り</td>
  <td>overprint</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】文字のオーバープリントのプロパティ名</caption>
<tbody>
<tr>
  <td>
    <span>調べる内容</span>
  </td>
  <td>
    <span>プロパティ</span>
  </td>
</tr>
<tr>
  <td>線</td>
  <td>overprintStroke</td>
</tr>
<tr>
  <td>塗り</td>
  <td>overprintFill</td>
</tr>
</tbody>
</table>
<p>オーバープリントが設定されているか調べるサンプル</p>
<pre><code>// オーバープリントが設定されているか調べる(パス、文字、画像)
var flagFill = 0;   // 見つかった塗りの個数を入れるカウンタ変数
var flagStroke = 0; // 見つかった線の個数を入れるカウンタ変数
// パスのオーバープリント状態を調べる
var pObj = activeDocument.pathItems;
for(var i=0; i&lt;pObj.length; i++){
    if (pObj[i].fillOverprint == true){
        flagFill = flagFill + 1;
    }
    if (pObj[i].strokeOverprint == true){
        flagStroke = flagStroke + 1;
    }
}
// 埋め込み画像のオーバープリント状態を調べる
var rObj = activeDocument.rasterItems;
for(var i=0; i&lt;rObj.length; i++){
    if (rObj[i].overprint == true){
        flagFill = flagFill + 1;
    }
}
// 文字のオーバープリント状態を調べる
var txtObj = activeDocument.textFrames;
for(var i=0; i&lt;txtObj.length; i++){
    for(var j=0; j&lt;txtObj[i].contents.length; j++){
        if (txtObj[i].characters[j].overprintFill == true){
            flagFill = flagFill + 1;
        }
        if (txtObj[i].characters[j].overprintStroke == true){
            flagStroke = flagStroke + 1;
        }
    }
}
// 結果を表示する
if (flagFill){
    alert("塗りのオーバープリントが"+flagFill+"ヶ所あります");
}
if (flagStroke){
    alert("線のオーバープリントが"+flagStroke+"ヶ所あります");
}
if ((flagFill == 0) &amp;&amp; (flagStroke == 0)){
    alert("塗りと線のオーバープリントはありませんでした");
}</code></pre>
<p>　オーバープリントが設定されているか調べるドキュメントを用意します。</p>
<figure>
<figcaption>【図】調べるドキュメントを用意する</figcaption>
<img src="images/00088.jpeg" />
</figure>
<p>　スクリプトを実行すると結果がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】調べた結果が表示される（塗り）</figcaption>
<img src="images/00472.jpeg" />
</figure>
<figure>
<figcaption>【図】調べた結果が表示される（線）</figcaption>
<img src="images/00263.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-759">
<section>
<div>
<h1 id="calibre_link-226"><b>第5章　フォント／書体</b></h1>
</div>
<p>　文字に反映するフォント／書体に関するサンプルと解説です。アプリケーションで使用できるフォントやドキュメント内で使用されているフォントを取得することができます。</p>
</section>
</div>
<div id="calibre_link-535">
<section>
<h2 id="calibre_link-227"><b>5-1　登録フォント（書体）数を求める</b></h2>
<p>　Illustratorで使える登録フォント（書体）数を求めるにはアプリケーションオブジェクトのtextFonts配列を参照します。textFontsは配列なのでlengthプロパティを参照すればフォントの総数を求めることができます。</p>
<p>登録フォント（書体）数を求めるサンプル</p>
<pre><code>// フォント（書体）の総数を表示する
var fontList = app.textFonts;
alert("フォントの総数："+fontList.length);</code></pre>
<p>　Illustratorで使えるフォント（書体）の総数がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】Illustratorで使えるフォントの総数が表示される</figcaption>
<img src="images/00045.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-698">
<section>
<h2 id="calibre_link-228"><b>5-2　フォント名、フォントファミリー名を求める</b></h2>
<p>　フォント名、フォントファミリー名を求めるにはアプリケーションオブジェクトのtextFonts配列に格納されたフォントオブジェクトのnameプロパティを参照します。フォントファミリー名の場合はfamilyプロパティを参照します。フォントスタイル名の場合はstyleプロパティを参照します。</p>
<p>　なお、IllustrarorのJavaScriptではこれ以外のフォントの情報を取得することはできません。</p>
<p>フォント名、フォントファミリー名を求めるサンプル</p>
<pre><code>// フォント（書体）の情報を表示する
var fontList = app.textFonts;
var index = 0;
alert("フォント名："+fontList[index].name + "\n" +
    "フォントファミリー名："+fontList[index].family + "\n" +
    "フォントスタイル名："+fontList[index].style);</code></pre>
<p>　フォント（書体）の情報がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】フォントの情報が表示される</figcaption>
<img src="images/00429.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-101">
<section>
<h2 id="calibre_link-229"><b>5-3　全てのフォント名を表示する</b></h2>
<p>　全てのフォント名を表示するにはアプリケーションオブジェクトのtextFonts配列に格納されたフォントオブジェクトのfamilyプロパティとstyleプロパティを参照します。登録されているフォントの数はtextFonts.lengthで求めることができます。</p>
<p>全てのフォント名を表示するサンプル</p>
<pre><code>// フォント一覧をテキストフレーム内に表示する
var txt = "";
for(var i=0; i&lt;app.textFonts.length; i++){
    txt = txt + app.textFonts[i].family + " " + app.textFonts[i].style+"\r";
}
// テキストフレームを生成しフォント（書体）一覧を表示する
var txtObj = app.activeDocument.textFrames.add();
txtObj.contents = txt;
txtObj.top = -10;   // 位置を調整
txtObj.left = 10;</code></pre>
<p>　フォント（書体）一覧がテキストフレーム内に表示されます。</p>
<figure>
<figcaption>【図】フォントの一覧が表示される</figcaption>
<img src="images/00214.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-643">
<section>
<h2 id="calibre_link-230"><b>5-4　特定のフォント（書体）を指定する</b></h2>
<p>　特定のフォント（書体）を指定するにはアプリケーションオブジェクトのtextFonts配列に格納されたフォントオブジェクトを段落オブジェクトなどに設定します。フォントはtextFonts配列の添え字に指定したいフォント名を指定します。フォント名が日本語であっても内部では英文字名になっています。このため、日本語書体名の場合は英語名で指定する必要があります。例えばMac OS Xの場合、「ヒラギノ明朝 Pro W3」は「HiraMinPro-W3」となります。</p>
<p>特定のフォント（書体）を指定するサンプル</p>
<pre><code>// テキストフレーム内の最初の段落にTimes-Boldフォントを設定する
var textObj = activeDocument.textFrames.add();// テキストフレームを生成する
textObj.contents = "Adobe Illustrator\rAdobe Photoshop\rAdobe InDesign";
textObj.top = -20;  // 位置調整
textObj.left = 10;
var fName = app.textFonts["Times-Bold"];// Times-Boldフォント
// 最初の段落にフォントを設定
textObj.paragraphs[0].characterAttributes.textFont = fName;</code></pre>
<p>　テキストフレームの最初の段落のフォント（書体）がTimes-Boldに設定されます。</p>
<figure>
<figcaption>【図】フォントがTimes-Boldに設定される</figcaption>
<img src="images/00006.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-724">
<section>
<h2 id="calibre_link-231"><b>5-5　ドキュメントで使用されているフォントを調べる</b></h2>
<p>　ドキュメントで使用されているフォントを調べるには1文字ずつ処理します。文字属性のtextFontオブジェクトに使用されているフォントの名前や種類が格納されています（下表参照）。完全なフォント名であればnameプロパティから読み出すことができます。なお、各プロパティで得られるのは英語名であり「小塚明朝 Pr6N」のような日本語書体名でない点には注意が必要です。</p>
<p>　どの書体が使われているかを手軽に調べるにはJavaScriptのハッシュ／連想配列を利用します。フォント名を連想配列のキーとして使用することで、すでに使用されていたかどうかを調べることができます。例えばfontList["ゴシック"]とした場合、ゴシックが一度も使われていなければfontList["ゴシック"]の値はundefinedになります。この場合、1を入れておきます。すると、次に調べた際、同じゴシックが使われていた場合、fontList["ゴシック"]の値は1になります。サンプルではフォントを使用したかどうかだけでなく、何文字使用されていたかも表示するようになっています。</p>
<table>
<caption>【表】textFontオブジェクトのプロパティ</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ</span>
  </td>
  <td>
    <span>読みだす内容</span>
  </td>
</tr>
<tr>
  <td>family</td>
  <td>フォントファミリー名</td>
</tr>
<tr>
  <td>name</td>
  <td>完全なフォント名</td>
</tr>
<tr>
  <td>style</td>
  <td>スタイル（太字、斜体）名</td>
</tr>
</tbody>
</table>
<p>ドキュメントで使用されているフォントを調べるサンプル</p>
<pre><code>// ドキュメントで使用されているフォントを調べる
var fontList = [];
var tfObj = activeDocument.textFrames;
for(var i=0; i&lt;tfObj.length; i++){
    var trObj = tfObj[i].story.textRange;
    for(var j=0; j&lt;trObj.contents.length; j++){
        var fontName = trObj.characters[j].textFont.name;
        if (!fontList[fontName]){
            fontList[fontName] = 1;
        }else{
            fontList[fontName] = fontList[fontName] + 1;
        }
    }
}
// 結果を新規ドキュメント（A4縦、アートボード数：１）を作成して表示する
var docObj = documents.add(DocumentColorSpace.RGB, 595.28, 841.89, 1);
var txtObj = docObj.textFrames.add();
txtObj.top = 820;   // 左上にY座標を設定
txtObj.left = 10;
var result = "";
for(var i in fontList){ // 得られたフォントの数だけ繰り返す
    result = result + i + " : "+fontList[i] + "\r";
}
txtObj.contents = result;   // 結果を表示する</code></pre>
<p>　使用されているフォントを調べたいドキュメントを表示します。</p>
<figure>
<figcaption>【図】フォントを調べたいドキュメントを表示する</figcaption>
<img src="images/00049.jpeg" />
</figure>
<p>　スクリプトを実行すると新規にドキュメントが作成され、使用されているフォント名と使用されている数が表示されます。</p>
<figure>
<figcaption>【図】使用されているフォント名と使用されている数が表示される</figcaption>
<img src="images/00537.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-580">
<section>
<div>
<h1 id="calibre_link-232"><b>第6章　テキストフレーム</b></h1>
</div>
<p>　この章では、文字を表示するテキストフレームオブジェクトに関するサンプルを示し、解説します。エリアテキストやポイントテキストなどを操作することができます。</p>
</section>
</div>
<div id="calibre_link-607">
<section>
<h2 id="calibre_link-233"><b>6-1　テキストフレームを作成する</b></h2>
<p>　テキストフレームを作成するにはドキュメントオブジェクトに対してtextFrames.add()とします。add()メソッドは新規に作成したテキストフレームオブジェクトを返します。返されたテキストフレームオブジェクトを変数に入れておくことで、表示する位置やサイズ、テキスト内容を、後から変数を介して手軽に操作できるようになります。</p>
<p>　また、add()とした場合はポイントテキストが作成されます。エリアテキスト、パステキストを作成するには別のメソッドを使う必要があります。Illustrator CC以降ではエリアテキストとポイントテキストを切り替える（変換する）こともできます。</p>
<p>　テキストフレームを作成すると原点（ドキュメントの左上）に作成されます。位置を指定する場合はleft、topプロパティかposition配列で指定します。相対的に位置を指定する場合はtranslate()メソッドを使って行います。</p>
<p>　テキストフレームに表示する文字はテキストフレームオブジェクトのcontentsプロパティに文字を入れます。文字のサイズや書体などを変更する場合は、段落オブジェクトか文字オブジェクトの属性を設定する必要があります。</p>
<p>テキストフレームを作成するサンプル</p>
<pre><code>// テキストフレームを作成する
var txtObj = activeDocument.textFrames.add();
txtObj.left = 10;   // X座標を10ptの位置にする
txtObj.top = -50;   // Y座標を上から50ptの位置にする
txtObj.contents = "イラストレーター自動化";</code></pre>
<p>　ドキュメントの座標(10, 50)にテキストフレームが作成され文字が表示されます。図ではわかりやすくするために選択状態にしてあります。</p>
<figure>
<figcaption>【図】ドキュメントの座標にテキストフレームが作成される</figcaption>
<img src="images/00559.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-97">
<section>
<h2 id="calibre_link-234"><b>6-2　エリアテキストを作成する</b></h2>
<p>　エリアテキストを作成するには、あらかじめ文字列を流し込む（表示する）領域のパスを作成しておきます。次にドキュメントオブジェクトのareaText()メソッドを使いエリアテキストを作成します。この時、areaText()メソッドのパラメーターには領域（エリア）を示すオブジェクトを指定します。</p>
<p>エリアテキストを作成するサンプル</p>
<pre><code>// エリアテキストを作成する
var rect = activeDocument.pathItems.rectangle(-50, 10, 100, 80);  // Y,X,横幅,縦幅
var txtObj = activeDocument.textFrames.areaText(rect);
txtObj.contents = "イラストレーターをプログラムを使って自動化します。";</code></pre>
<p>　エリアテキストが作成され、その中に文字が表示されます。図ではわかりやすくするために選択状態にしてあります。</p>
<figure>
<figcaption>【図】エリアテキストが作成され、その中に文字が表示される</figcaption>
<img src="images/00335.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-141">
<section>
<h2 id="calibre_link-235"><b>6-3　パステキストを作成する</b></h2>
<p>　パステキストを作成するにはドキュメントオブジェクトのpathText()メソッドを使います。パラメーターにはパスを示すオブジェクトを指定します。</p>
<p>　パステキストを作成するには、あらかじめ文字列を沿わせるためのパスを作成しておきます。次にドキュメントオブジェクトのpathText()メソッドを使いパステキストを作成します。この時、pathText()メソッドのパラメーターに文字列を沿わせるためのパスを示すオブジェクトを指定します。</p>
<p>パステキストを作成するサンプル</p>
<pre><code>// パステキストを作成する
var rect = activeDocument.pathItems.rectangle(-100, 80, 120, 60);   // Y,X,横幅,縦幅
var txtObj = activeDocument.textFrames.pathText(rect);
txtObj.contents = "アドビイラストレーターをプログラムを使って自動化します";</code></pre>
<p>　四角いパステキストが作成され、その外側に沿うように文字が表示されます。図ではわかりやすくするために選択状態にしてあります。</p>
<figure>
<figcaption>【図】四角いパステキストが作成され、その外側に文字が表示される</figcaption>
<img src="images/00052.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-87">
<section>
<h2 id="calibre_link-236"><b>6-4　段組を作成する</b></h2>
<p>　段組を作成するにはテキストフレームでエリアテキストを作成します。段組はポイントテキストやパステキストでは段組設定は反映されません。段組数はテキストフレームオブジェクトのcolumnCountプロパティに設定します。3を設定すると3段組みになります。段と段の間隔はテキストフレームオブジェクトのcolumnGutterにポイントで指定します。</p>
<p>段組を作成するサンプル</p>
<pre><code>// 3段組のテキストフレームを作成する
var rect = activeDocument.pathItems.rectangle(-50, 10, 210, 60);   // Y,X,横幅,縦幅
var txtObj = activeDocument.textFrames.areaText(rect);
txtObj.columnCount = 3;
txtObj.columnGutter = 10;
txtObj.contents = "イラストレーターは簡単に段組を作成することができます。プログラムからも作成可能です。";</code></pre>
<p>　3段組のテキストフレームが作成され、その中に文字が表示されます。図ではわかりやすくするために選択状態にしてあります。</p>
<figure>
<figcaption>【図】3段組のテキストフレームが作成される</figcaption>
<img src="images/00102.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-630">
<section>
<h2 id="calibre_link-237"><b>6-5　テキストフレームを回転する</b></h2>
<p>　テキストフレームを回転するにはテキストフレームオブジェクトのrotate()メソッドを使います。rotate()は最大6つのパラメーターを指定できますが、単純に回転させるだけであればパラメーターを1つだけ指定します。最初のパラメーターが回転角度になっています。角度は正数なら反時計回り、負数なら時計回りになります。つまり45を指定すれば反時計回りに45度回転、-45であれば時計回りに45度回転します。</p>
<p>　rotate()メソッドには、角度以外のオプションがありますが、いずれも省略することができます。オプションで指定できるパラメーターの順番と内容を下表に示します。</p>
<table>
<caption>【表】パラメーターで指定できる順番と内容</caption>
<tbody>
<tr>
  <td>
    <span>指定できる順番</span>
  </td>
  <td>
    <span>内容</span>
  </td>
</tr>
<tr>
  <td>1番目</td>
  <td>回転角度</td>
</tr>
<tr>
  <td>2番目</td>
  <td>回転時の位置を変更するかどうか。trueなら変更する。</td>
</tr>
<tr>
  <td>3番目</td>
  <td>パターンも回転させるかどうか。trueならパターンも回転する。</td>
</tr>
<tr>
  <td>4番目</td>
  <td>グラデーションも回転させるかどうか。trueならグラデーションも回転する。</td>
</tr>
<tr>
  <td>5番目</td>
  <td>線のパターンも回転させるかどうか。trueなら線のパターンも回転する。</td>
</tr>
<tr>
  <td>6番目</td>
  <td>回転の基準位置（次の表を参照）</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】回転の基準位置</caption>
<tbody>
<tr>
  <td>
    <span>パラメーター</span>
  </td>
  <td>
    <span>基準位置</span>
  </td>
</tr>
<tr>
  <td>Transformation.BOTTOM</td>
  <td>下中央</td>
</tr>
<tr>
  <td>Transformation.BOTTOMLEFT</td>
  <td>左下</td>
</tr>
<tr>
  <td>Transformation.BOTTOMRIGHT</td>
  <td>右下</td>
</tr>
<tr>
  <td>Transformation.CENTER</td>
  <td>中央</td>
</tr>
<tr>
  <td>Transformation.LEFT</td>
  <td>左中央</td>
</tr>
<tr>
  <td>Transformation.RIGHT</td>
  <td>右中央</td>
</tr>
<tr>
  <td>Transformation.TOP</td>
  <td>上中央</td>
</tr>
<tr>
  <td>Transformation.TOPLEFT</td>
  <td>左上</td>
</tr>
<tr>
  <td>Transformation.TOPRIGHT</td>
  <td>右上</td>
</tr>
<tr>
  <td>Transformation.DOCUMENTORIGIN</td>
  <td>ドキュメントの原点</td>
</tr>
</tbody>
</table>
<p>テキストフレームを回転するサンプル</p>
<pre><code>// テキストフレームの回転角度を指定する
var txtObj = activeDocument.textFrames.add();
txtObj.contents = "イラストレーターで自動化処理";
txtObj.left = 20;
txtObj.top = -100;
txtObj.rotate(45, true, false, false, false, Transformation.CENTER);      // 中心を基準にして45度に回転</code></pre>
<p>　テキストフレームが作成され、反時計回りに45度回転します。</p>
<figure>
<figcaption>【図】テキストフレームが作成され、反時計回りに45度回転する</figcaption>
<img src="images/00118.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-27">
<section>
<h2 id="calibre_link-238"><b>6-6　テキストフレームのスケールを変更する（拡大縮小）</b></h2>
<p>　テキストフレームのスケールを変更するにはテキストフレームオブジェクトのresize()メソッドを使います。resize()は最大8つのパラメーターを指定できますが、単純にリサイズするだけであれば最初のパラメーターの2つを指定します。最初のパラメーターが横の拡大縮小率、2番目のパラメーターが縦の拡大縮小率になります。スケール値（拡大縮小率）は100が100%を示しているため、50を指定すれば半分のサイズに、200を指定すれば2倍のサイズになります。</p>
<p>　resize()メソッドには横方向と縦方向以外のオプションがありますが、いずれも省略することができます。オプションで指定できるパラメーターの順番と内容を下表に示します。</p>
<table>
<caption>【表】パラメーターで指定できる順番と内容</caption>
<tbody>
<tr>
  <td>
    <span>指定できる順番</span>
  </td>
  <td>
    <span>内容</span>
  </td>
</tr>
<tr>
  <td>1番目</td>
  <td>横方向・X方向の拡大縮小率（100が等倍）</td>
</tr>
<tr>
  <td>2番目</td>
  <td>縦方向・Y方向の拡大縮小率（100が等倍）</td>
</tr>
<tr>
  <td>3番目</td>
  <td>スケール変更時に位置を変更するかどうか。trueなら変更する。</td>
</tr>
<tr>
  <td>4番目</td>
  <td>パターンも拡大縮小させるかどうか。trueならパターンも拡大縮小する。</td>
</tr>
<tr>
  <td>4番目</td>
  <td>グラデーションも拡大縮小させるかどうか。trueならグラデーションも拡大縮小する。</td>
</tr>
<tr>
  <td>5番目</td>
  <td>線のパターンも拡大縮小させるかどうか。trueなら線のパターンも拡大縮小する。</td>
</tr>
<tr>
  <td>6番目</td>
  <td>拡大縮小の基準位置（次の表を参照）</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】拡大縮小の基準位置</caption>
<tbody>
<tr>
  <td>
    <span>パラメーター</span>
  </td>
  <td>
    <span>基準位置</span>
  </td>
</tr>
<tr>
  <td>Transformation.BOTTOM</td>
  <td>下中央</td>
</tr>
<tr>
  <td>Transformation.BOTTOMLEFT</td>
  <td>左下</td>
</tr>
<tr>
  <td>Transformation.BOTTOMRIGHT</td>
  <td>右下</td>
</tr>
<tr>
  <td>Transformation.CENTER</td>
  <td>中央</td>
</tr>
<tr>
  <td>Transformation.LEFT</td>
  <td>左中央</td>
</tr>
<tr>
  <td>Transformation.RIGHT</td>
  <td>右中央</td>
</tr>
<tr>
  <td>Transformation.TOP</td>
  <td>上中央</td>
</tr>
<tr>
  <td>Transformation.TOPLEFT</td>
  <td>左上</td>
</tr>
<tr>
  <td>Transformation.TOPRIGHT</td>
  <td>右上</td>
</tr>
<tr>
  <td>Transformation.DOCUMENTORIGIN</td>
  <td>ドキュメントの原点</td>
</tr>
</tbody>
</table>
<p>テキストフレームのスケールを変更（拡大縮小）するサンプル</p>
<pre><code>// テキストフレームのスケールを指定する
var txtObj = activeDocument.textFrames.add();
txtObj.contents = "イラストレーターで自動化処理";
txtObj.resize(50, 300);        // 横 : 50%、縦：300%
txtObj.top = -20;
txtObj.left = 10;</code></pre>
<p>
<br />
</p>
<p>　テキストフレームが作成され、長体になった文字が表示されます。</p>
<figure>
<figcaption>【図】テキストフレームが作成され、長体になった文字が表示される</figcaption>
<img src="images/00277.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-562">
<section>
<h2 id="calibre_link-239"><b>6-7　テキストフレームを複製する</b></h2>
<p>　テキストフレームを複製するにはテキストフレームオブジェクトのduplicate()メソッドを使います。2つのパラメーターを指定できますが、何も指定しなくても複製は行われます。duplicate()メソッドは複製したテキストフレームオブジェクトを返します。</p>
<p>テキストフレームを複製するサンプル</p>
<pre><code>// 選択されたテキストフレームだけを複製する
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    if (selObj[i].typename == "TextFrame"){
        var txtObj = selObj[i].duplicate();
        txtObj.translate(20, -20);
    }
}</code></pre>
<p>　テキストフレームを選択します。</p>
<figure>
<figcaption>【図】テキストフレームを選択</figcaption>
<img src="images/00059.jpeg" />
</figure>
<p>　スクリプトを実行するとテキストフレームだけが複製され、それぞれのテキストフレームの右下に配置されます。複製されたテキストフレームは複製元と同じように選択状態になります。</p>
<figure>
<figcaption>【図】テキストフレームだけが複製される</figcaption>
<img src="images/00131.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-730">
<section>
<h2 id="calibre_link-240"><b>6-8　テキストのアウトラインを作成する</b></h2>
<p>　テキストのアウトラインを作成するにはテキストフレームオブジェクトのcreateOutline()メソッドを使います。パラメーターはありません。createOutline()メソッドの戻り値はパスではなく、グループオブジェクトになります。</p>
<p>テキストのアウトラインを作成するサンプル</p>
<pre><code>// 選択されたテキストフレームのアウトラインを作成する
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    if (selObj[i].typename == "TextFrame"){
        selObj[i].createOutline();
    }
}</code></pre>
<p>　テキストフレームを選択します。</p>
<figure>
<figcaption>【図】テキストフレームを選択</figcaption>
<img src="images/00228.jpeg" />
</figure>
<p>　スクリプトを実行するとテキストフレーム内の文字のアウトラインが作成されます。</p>
<figure>
<figcaption>【図】テキストフレーム内の文字のアウトラインが作成される</figcaption>
<img src="images/00529.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-591">
<section>
<h2 id="calibre_link-241"><b>6-9　テキストフレームの不透明度を指定する</b></h2>
<p>　テキストフレームの不透明度を指定するにはテキストフレームオブジェクトのopacityに0~100までの数値を指定します。25を指定すると25%の不透明度になります。0が完全な透明で100が完全な不透明になります。</p>
<p>テキストフレームの不透明度を指定するサンプル</p>
<pre><code>// テキストフレームの不透明度を指定する
var txtObj = activeDocument.textFrames.add();
txtObj.contents = "イラストレーター自動化";
txtObj.opacity = 50;     // 50%の不透明度
txtObj.top = -40;　
txtObj.left = 20;</code></pre>
<p>　テキストフレームが作成され不透明度が50%に設定されます。</p>
<figure>
<figcaption>【図】テキストフレームが作成され不透明度が50%に設定される</figcaption>
<img src="images/00396.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-635">
<section>
<h2 id="calibre_link-242"><b>6-10　テキストフレームの種類を調べる</b></h2>
<p>　テキストフレームの種類を調べるにはテキストフレームオブジェクトのkindプロパティを調べます。kindプロパティは下表のいずれかの値になります。なお、kindプロパティは読み出し専用で設定することはできません。</p>
<table>
<caption>【表】テキストフレームの種類</caption>
<tbody>
<tr>
  <td>
    <span>kindプロパティ</span>
  </td>
  <td>
    <span>テキストフレームの種類</span>
  </td>
</tr>
<tr>
  <td>TextType.AREATEXT</td>
  <td>エリアテキスト</td>
</tr>
<tr>
  <td>TextType.PATHTEXT</td>
  <td>パステキスト</td>
</tr>
<tr>
  <td>TextType.POINTTEXT</td>
  <td>ポイントテキスト</td>
</tr>
</tbody>
</table>
<p>　テキストフレームの種類を変更するにはconvertAreaObjectToPointObject()メソッドまたはconvertPointObjectToAreaObject()メソッドを使います。convertAreaObjectToPointObject()はエリアテキストからポイントテキストに、convertPointObjectToAreaObject()メソッドはポイントテキストからエリアテキストに変換します。なお、これらのメソッドはIllustrator CC以降で動作します。それより前のバージョンでは変換するためのメソッドは用意されていません。</p>
<p>テキストフレームの種類を調べるサンプル</p>
<pre><code>// 選択されたテキストフレームの種類を調べる
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    alert(selObj[i].kind);
}</code></pre>
<p>　選択したテキストフレームの種類がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】テキストフレームの種類が表示される</figcaption>
<img src="images/00184.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-673">
<section>
<h2 id="calibre_link-243"><b>6-11　テキストフレームのサイズを取得する</b></h2>
<p>　テキストフレームのサイズを取得するには、いくつかの方法があります。左側の座標はleftプロパティで、上側の座標はtopプロパティ、横幅はwidthプロパティ、縦幅はheightプロパティで取得することができます。他には座標を配列形式で格納しているオブジェクトがあり、配列から座標値を取得することができ、以下の3種類があります。</p>
<table>
<caption>【表】取得できる座標の種類</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ</span>
  </td>
  <td>
    <span>取得できる座標の種類</span>
  </td>
</tr>
<tr>
  <td>controlBounds</td>
  <td>線幅やコントロールを含む</td>
</tr>
<tr>
  <td>geometricBounds</td>
  <td>線幅を含まない</td>
</tr>
<tr>
  <td>visibleBounds</td>
  <td>線幅を含む</td>
</tr>
</tbody>
</table>
<p>　格納されている座標の順序は下表のようになります。controlBounds、geometricBounds、visibleBoundsのいずれも同じ順序で座標値が格納されています。</p>
<table>
<caption>座標の順序</caption>
<tbody>
<tr>
  <td>
    <span>配列の参照番号</span>
  </td>
  <td>
    <span>座標</span>
  </td>
</tr>
<tr>
  <td>0</td>
  <td>左側の座標</td>
</tr>
<tr>
  <td>1</td>
  <td>上側の座標</td>
</tr>
<tr>
  <td>2</td>
  <td>右側の座標</td>
</tr>
<tr>
  <td>3</td>
  <td>下側の座標</td>
</tr>
</tbody>
</table>
<p>テキストフレームのサイズを取得するサンプル</p>
<pre><code>// 選択されたテキストフレームのサイズを取得する
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var left = selObj[i].left;
    var top = selObj[i].top;
    var width = selObj[i].width;
    var height = selObj[i].height;
    // ジオメトリック座標
    var gBox = selObj[i].geometricBounds;
    var gLeft = gBox[0];
    var gTop = gBox[1];
    var gRight = gBox[2];
    var gBottom = gBox[3];
    // コントロール座標
    var cBox = selObj[i].controlBounds;
    var cLeft = cBox[0];
    var cTop = cBox[1];
    var cRight = cBox[2];
    var cBottom = cBox[3];
    // 結果を表示
    var text = "の座標\rLeft : "+left+"\rTop : "+top+"\r\rの幅\rwidth : "+width+"\rheight : "+height;
    text = text + "\r\rのGeometric Bounds\r";
    text = text + "left : "+gLeft+"\rtop : "+gTop+"\rright : "+gRight+"\rbottom : "+gBottom;
    text = text + "\r\rのControl Bounds\r";
    text = text + "left : "+cLeft+"\rtop : "+cTop+"\rright : "+cRight+"\rbottom : "+cBottom;
    alert(text);
}</code></pre>
<p>　テキストフレームを選択します。</p>
<figure>
<figcaption>【図】テキストフレームを選択</figcaption>
<img src="images/00571.jpeg" />
</figure>
<p>　取得した座標値がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】取得した座標値が表示される</figcaption>
<img src="images/00350.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-567">
<section>
<h2 id="calibre_link-244"><b>6-12　テキストフレームの前後関係（Z座標・奥行き）を変更する</b></h2>
<p>　テキストフレームの前後関係（Z座標・奥行き）を変更するにはmove()メソッドを使います。move()の最初のパラメーターには位置を変更するための基準となるオブジェクトを指定します。これはグループオブジェクトやドキュメントオブジェクトなどになります。</p>
<p>　move()の2番目のパラメーターには下表に示す値を指定できます。オブジェクトメニューのアレンジにある「最前面へ」「最背面へ」はドキュメントオブジェクトを基準にして処理を行います。</p>
<table>
<caption>【表】前後関係の指定</caption>
<tbody>
<tr>
  <td>
    <span>パラメーター</span>
  </td>
  <td>
    <span>前後関係の指定</span>
  </td>
</tr>
<tr>
  <td>ElementPlacement.INSIDE</td>
  <td>内側</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEATBEGINNING</td>
  <td>最前面へ</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEATEND</td>
  <td>最背面へ</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEBEFORE</td>
  <td>前へ</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEAFTER</td>
  <td>後へ</td>
</tr>
</tbody>
</table>
<p>テキストフレームの前後関係（Z座標・奥行き）を変更するサンプル</p>
<pre><code>// テキストフレームを最前面に移動させる
var text1 = drawText(140, -100, setCMYKColor(100,0,0,0));
var text2 = drawText(100, -120, setCMYKColor(0,100,0,0));
var text3 = drawText(60, -140, setCMYKColor(100,100,0,0));
var text4 = drawText(20, -160, setCMYKColor(100,0,100,0));
text2.move(app.activeDocument, ElementPlacement.PLACEATBEGINNING);
// 文字を描く
function drawText(x,y, color){
    var txtObj = activeDocument.textFrames.add();
    txtObj.contents = "Illustrator";
    txtObj.paragraphs[0].size = 52;
    txtObj.paragraphs[0].fillColor = color;
    txtObj.paragraphs[0].textFont = app.textFonts["Arial-Black"];
         txtObj.translate(x,y);
         return txtObj;
}
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
         var CMYK = new CMYKColor();
         CMYK.cyan = c;
         CMYK.magenta = m;
         CMYK.yellow = y;
         CMYK.black = k;
         return CMYK;
}</code></pre>
<p>　テキストフレームが4つ作成されマゼンタ（紫色）の文字が最前面に移動、表示されます。</p>
<figure>
<figcaption>【図】テキストフレームが4つ作成される</figcaption>
<img src="images/00444.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-733">
<section>
<h2 id="calibre_link-245"><b>6-13　エリアオブジェクトからポイントテキストに変換する（CC以降）</b></h2>
<p>　テキストフレームをエリアオブジェクトからポイントテキストに変換するにはconvertAreaObjectToPointObject()メソッドを使います。convertAreaObjectToPointObject()メソッドには指定できるパラメーターはありません。</p>
<p>　ポイントテキストからエリアオブジェクトに変換したい場合はconvertPointObjectToAreaObject()メソッドを使います。</p>
<p>エリアオブジェクトからポイントテキストに変換するサンプル（CC以降）</p>
<pre><code>// すべてのテキストフレームをエリアオブジェクトからポイントテキストに変換する
var docObj = app.activeDocument;
for(var i=0; i&lt;docObj.textFrames.length; i++){
    docObj.textFrames[i].convertAreaObjectToPointObject();
}</code></pre>
<p>　選択されているテキストフレームはエリアオブジェクト（エリア内文字）になっています。</p>
<figure>
<figcaption>【図】選択されているテキストフレーム</figcaption>
<img src="images/00579.jpeg" />
</figure>
<p>　スクリプトを実行するとポイントテキストに変換されます。</p>
<figure>
<figcaption>【図】ポイントテキストに変換される</figcaption>
<img src="images/00514.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-131">
<section>
<h2 id="calibre_link-246"><b>6-14　テキストフレーム全体の英文字のキャップスを設定する</b></h2>
<p>　テキストフレーム全体の英文字のキャップスを設定するにはテキストフレームのtextRangeオブジェクトのchangeCaseTo()メソッドを使います。パラメーターには下表に示す値を指定することができます。</p>
<p>　サンプルではテキストフレーム全体に反映するようになっていますが、選択された文字や特定の位置にある文字だけを対象にすることもできます。また、「テキスト／文字」の章の「英文字のキャップスを設定する」にも類似のプログラムがありますので参考にしてください。</p>
<table>
<caption>【表】指定可能な値</caption>
<tbody>
<tr>
  <td>
    <span>パラメーター</span>
  </td>
  <td>
    <span>設定</span>
  </td>
</tr>
<tr>
  <td>CaseChangeType.UPPERCASE</td>
  <td>全て大文字</td>
</tr>
<tr>
  <td>CaseChangeType.LOWERCASE</td>
  <td>全て小文字</td>
</tr>
<tr>
  <td>CaseChangeType.SENTENCECASE</td>
  <td>先頭1文字だけ大文字</td>
</tr>
<tr>
  <td>CaseChangeType.TITLECASE</td>
  <td>単語の先頭1文字だけ大文字で2文字目以降は小文字</td>
</tr>
</tbody>
</table>
<p>テキストフレーム全体の英文字のキャップスを設定するサンプル</p>
<pre><code>// テキストフレーム全体の英文字のキャップスを設定する
var txtObj = activeDocument.textFrames.add();
txtObj.top = -20;
txtObj.left = 10;
txtObj.contents = "Adobe illustrator CC 2014 : creative cloud　2014";
txtObj.textRange.changeCaseTo(CaseChangeType.TITLECASE);</code></pre>
<p>　単語の先頭だけが大文字になり、他は小文字になります。</p>
<figure>
<figcaption>【図】単語の先頭だけが大文字になり、他は小文字になる</figcaption>
<img src="images/00097.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-672">
<section>
<h2 id="calibre_link-247"><b>6-15　テキストフレームの半角数字と記号を縦中横にし位置を微調整する</b></h2>
<p>　テキストフレームの半角数字と記号を縦中横にし位置を微調整するには正規表現のreplace()メソッドを利用します。replace()メソッドは文字列の置換処理を行いますが、2番目のパラメーターに関数を指定することで置換処理だけでなく、さまざまな文字属性の変更処理を行うことができます。</p>
<p>　正規表現で縦中横にしたい文字列を指定したら、文字属性のbaselineDirectionプロパティにBaselineDirectionType.TateChuYokoを入れます。これにより文字が縦中横になります。縦中横にした文字の位置を調整するにはtateChuYokoHorizontalプロパティとtateChuYokoVerticalプロパティに値を設定します。tateChuYokoHorizontalは横方向の位置調整、tateChuYokoVerticalプロパティは縦方向の位置調整になります。　なお、このサンプルでの縦中横の処理方法は縦中横にする文字が多くなると処理に時間がかかるようになります。より高速に処理する場合は「第16章　選択（文字／TextRange）」の「16-16　半角数字を縦中横にする」の項目を参照してください。</p>
<p>テキストフレームの半角数字と記号を縦中横にし位置を微調整するサンプル</p>
<pre><code>// 選択したテキストフレームで半角数字と記号を縦中横にし位置を微調整する
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var trObj = selObj[i].textRange;    // テキストフレームのTextRangeオブジェクト
    trObj.contents.replace(/[\d{1,}|%|\$]/g, function(str, ptr){
        for(var j=0; j&lt;str.length; j++){    // 縦中横にしたい文字数だけ繰り返す
            trObj.characters[ptr+j].baselineDirection = BaselineDirectionType.TateChuYoko;    // 縦中横にする
            trObj.characters[ptr+j].tateChuYokoHorizontal = 2;  // 水平位置を調整する
            trObj.characters[ptr+j].tateChuYokoVertical = -1;   // 垂直位置を調整する
        }
        return str;
    });
}</code></pre>
<p>　縦中横にするテキストフレームを選択します。</p>
<figure>
<figcaption>【図】縦中横にするテキストフレームを選択</figcaption>
<img src="images/00483.jpeg" />
</figure>
<p>　スクリプトを実行すると半角英数と$と%の記号が縦中横になります。</p>
<figure>
<figcaption>【図】スクリプトの実行後</figcaption>
<img src="images/00272.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-75">
<section>
<h2 id="calibre_link-248"><b>6-16　エリアテキストがオーバーフローしているかどうか調べる</b></h2>
<p>　エリアテキストがオーバーフローしているかどうか調べるにはparagraphs配列内の文字数とlines配列内ｎ文字数を比較します。paragraphsでの段落は内部での行数を示し、linesでは実際に表示されている行数を示します。この2つの配列内の文字数が同じならばオーバーフローしていない、異なる場合はオーバーフローしていることになります。</p>
<p>エリアテキストがオーバーフローしているかどうか調べるサンプル</p>
<pre><code>// エリアテキストがオーバーフローしているかどうか調べる
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var p = 0;
    var n = 0;
    for(var j=0; j&lt;selObj[i].paragraphs.length; j++){   // 論理行数内の文字数をカウント
        var p = p + selObj[i].paragraphs[j].characters.length;
    }
    for(var j=0; j&lt;selObj[i].lines.length; j++){    // 表示行数内の文字数をカウント
        var n = n + selObj[i].lines[j].characters.length;
    }
    if (p != n){
        alert("このエリアテキストはオーバーフローしています");
    }else{
        alert("このエリアテキストはオーバーフローしていません");
    }
}</code></pre>
<p>　オーバーフローしていないテキストフレームを選択します。</p>
<figure>
<figcaption>【図】オーバーフローしていないテキストフレームを選択</figcaption>
<img src="images/00054.jpeg" />
</figure>
<p>　スクリプトを実行するとオーバーフローしていない旨のメッセージが表示されます。</p>
<figure>
<figcaption>【図】オーバーフローしていない旨のメッセージ</figcaption>
<img src="images/00439.jpeg" />
</figure>
<p>　次にオーバーフローしているテキストフレームを選択します。</p>
<figure>
<figcaption>【図】オーバーフローしているテキストフレームを選択</figcaption>
<img src="images/00223.jpeg" />
</figure>
<p>　スクリプトを実行するとオーバーフローしていることを示すメッセージが表示されます。</p>
<figure>
<figcaption>【図】オーバーフローしていることを示すメッセージ</figcaption>
<img src="images/00289.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-619">
<section>
<h2 id="calibre_link-249"><b>6-17　ダミーの文字でテキストフレームを埋める（単独テキストフレームの場合）</b></h2>
<p>　ダミーの文字で単独のテキストフレーム（エリアテキスト）を埋めるにはテキストフレームのcontentsプロパティにダミーで表示する文字を追加していきます。追加した結果、テキストフレームがオーバーフローしていたら追加処理を終了します。オーバーフローするまでダミーテキストの追加を行います。このような条件を満たすまで繰り返すにはwhile()を使います。</p>
<p>　サンプルではオーバーフローをチェックするcheckOverflow関数を用意し、指定されたテキストフレームがオーバーフローするかどうかを返すようにしています。オーバーフローしている場合はtrue、そうでない場合はfalseを返します。この関数からの戻り値に応じてダミーテキストを追加するかどうかの判断を行います。</p>
<p>ダミーの文字でテキストフレームを埋めるサンプル（単独テキストフレームの場合）</p>
<pre><code>// 選択されたテキストフレームをダミーテキストで埋める
var dummyText = "ダミーテキストです";    // とりあえず表示しておく文字列
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    // オーバーフローするまで繰り返す。
    while(!checkOverflow(selObj[i])){
        selObj[i].contents = selObj[i].contents + dummyText;
    }
}
// オーバーフローをチェックする関数
function checkOverflow(txtObj){
    var p = 0;
    var n = 0;
    for(var j=0; j&lt;txtObj.paragraphs.length; j++){   // 論理行数内の文字数をカウント
        var p = p + txtObj.paragraphs[j].characters.length;
    }
    for(var j=0; j&lt;txtObj.lines.length; j++){    // 表示行数内の文字数をカウント
        var n = n + txtObj.lines[j].characters.length;
    }
    if (p != n){
        return true;
    }
    return false;
}</code></pre>
<p>　ダミーテキストを追加するテキストフレームを選択します。</p>
<figure>
<figcaption>【図】テキストフレームを選択</figcaption>
<img src="images/00391.jpeg" />
</figure>
<p>　テキストフレームにダミーテキストが追加されます。</p>
<figure>
<figcaption>【図】ダミーテキストが追加される</figcaption>
<img src="images/00176.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-17">
<section>
<h2 id="calibre_link-250"><b>6-18　ダミーの文字でテキストフレームを埋める（リンクされている場合）</b></h2>
<p>　複数のテキストフレームがリンクされている場合にダミーの文字で埋めるには一工夫する必要があります。これは、リンクされているテキストフレームでは単独のテキストフレームのようにparagraphsとlinesを利用してオーバーフローしているかどうかを調べることができないためです。</p>
<p>　Illustratorでは次のテキストフレームにリンクされている場合、テキストフレームオブジェクトのnextFrameプロパティに次のテキストフレームオブジェクトが入ります。しかし、このプロパティはリンクするためのものであり、今回のような用途には使えません。特に最後にリンクされたテキストフレームを取得できないため、サンプルではテキストフレームオブジェクトにmyIDというプロパティを追加し、IDを割り当ててます。IDを元にして最後のテキストフレームを求めます。</p>
<p>　次に新たなテキストフレーム（エリアテキスト）を作成し、最後のテキストフレームにリンクします。オーバーフローしているかどうかは、追加したテキストフレームのcontentsプロパティで判断します。contentsプロパティに何か文字があればオーバーフローしたことになります。オーバーフローしたら追加したテキストフレームを削除します。</p>
<p>　これで、ダミーテキストをリンクされたテキストフレームに流し込むことができます。なお、サンプルを実行する際はリンクされているテキストフレームを全て選択してから実行する必要があります。</p>
<p>ダミーの文字でテキストフレームを埋めるサンプル（リンクされている場合）</p>
<pre><code>// 選択されたリンクテキストフレームをダミーテキストで埋める
var dummyText = "ダミーテキストです";    // とりあえず表示しておく文字列
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    selObj[i].myID = i;   // ID番号を割り当てる
}
var firstTextFrame = selObj[0]; // 最初のテキストフレームを入れる変数
var lastTextFrame = selObj[0];  // 最後のテキストフレームを入れる変数
// 最初のテキストフレームを求める
while(firstTextFrame.previousFrame){
    firstTextFrame = firstTextFrame.previousFrame;
}
// 追加したIDを元に最終のテキストフレームを求める
while(lastTextFrame.myID != lastTextFrame.nextFrame.myID){
    lastTextFrame = lastTextFrame.nextFrame;
}
// オーバーフローをチェックするためのテキストフレームを追加する
var rect = activeDocument.pathItems.rectangle(-50, 10, 100, 80);  // Y,X,横幅,縦幅
var endTextFrame = activeDocument.textFrames.areaText(rect);
lastTextFrame.nextFrame = endTextFrame; // 最終のテキストフレームにリンクする
// 追加したテキストフレームがオーバーフローするまで繰り返す
while(!endTextFrame.contents){
    firstTextFrame.contents = firstTextFrame.contents + dummyText;
}
endTextFrame.remove();  // 追加した最終テキストフレームを削除する</code></pre>
<p>　ダミーテキストを追加するテキストフレームを選択します。この場合、リンクされているテキストフレーム全てを選択する必要があります。</p>
<figure>
<figcaption>【図】テキストフレームを選択</figcaption>
<img src="images/00567.jpeg" />
</figure>
<p>　リンクされているテキストフレームにダミーテキストが追加されます。</p>
<figure>
<figcaption>【図】ダミーテキストが追加される</figcaption>
<img src="images/00345.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-551">
<section>
<h2 id="calibre_link-251"><b>6-19　選択されたテキストフレームの縦書き・横書きを切り替える</b></h2>
<p>　選択されたテキストフレームの縦書き・横書きを切り替えるにはorientationを読み出します。組方向を示す値は下表のようになっています。この値に応じて横組みなら縦組みにし、縦組みなら横組みにします。orientationにTextOrientation.VERTICALを入れれば縦組みになります。</p>
<p>　なお、テキストフレームがリンクされている場合、リンクされているテキストフレームの組方向が変わります。</p>
<table>
<caption>【表】orientationの値</caption>
<tbody>
<tr>
  <td>
    <span>値</span>
  </td>
  <td>
    <span>結果</span>
  </td>
</tr>
<tr>
  <td>TextOrientation.HORIZONTAL</td>
  <td>横組み</td>
</tr>
<tr>
  <td>TextOrientation.VERTICAL</td>
  <td>縦組み</td>
</tr>
</tbody>
</table>
<p>選択されたテキストフレームの縦書き・横書きを切り替えるサンプル</p>
<pre><code>// 選択されたテキストフレームの縦書き・横書きを切り替える
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var f = selObj[i].orientation;  // 文字の組方向を取得する
    if (f == TextOrientation.HORIZONTAL){
        selObj[i].orientation = TextOrientation.VERTICAL;   // 縦書きにする
    }else{
        selObj[i].orientation = TextOrientation.HORIZONTAL; // 横書きにする
    }
}</code></pre>
<p>　テキストフレームを選択します。</p>
<figure>
<figcaption>【図】テキストフレームを選択</figcaption>
<img src="images/00137.jpeg" />
</figure>
<p>　文字の組方向が変わります。</p>
<figure>
<figcaption>【図】組方向が変わる</figcaption>
<img src="images/00525.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-719">
<section>
<h2 id="calibre_link-252"><b>6-20　テキストフレームをリンクする</b></h2>
<p>　リンク元のテキストフレームオブジェクトのnextFrameプロパティにリンクしたいテキストフレームオブジェクトを入れます。すでに、入っている文字列は連結され消えることはありません。</p>
<p>テキストフレームをリンクするサンプル</p>
<pre><code>// 作成したテキストフレームをリンクする
var rect = activeDocument.pathItems.rectangle(-20, 10, 100, 90);  // Y,X,横幅,縦幅
var tfObj1 = activeDocument.textFrames.areaText(rect);
var rect = activeDocument.pathItems.rectangle(-20, 140, 150, 90);  // Y,X,横幅,縦幅
var tfObj2 = activeDocument.textFrames.areaText(rect);
tfObj1.contents = "テキストフレームをリンクすることで、雑誌のようなレイアウトも簡単にできます。";
tfObj2.contents = "イラストレーターもCS4からマルチページ対応したので100ページまでの本が作成できます。";
tfObj1.nextFrame = tfObj2;</code></pre>
<p>　2つのテキストフレームが作成されリンクされます。両方のテキストフレームに入っていた文字は連結され流し込まれます。</p>
<figure>
<figcaption>【図】2つのテキストフレームが作成されリンクされる</figcaption>
<img src="images/00365.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-123">
<section>
<h2 id="calibre_link-253"><b>6-21　テキストフレームのリンクを解除する（CC以降）</b></h2>
<p>　Illustrator CC以降ではテキストの種類を変換する機能を利用すると簡単にテキストフレームのリンクを解除することができます。リンクを解除するにはテキストフレームをエリアテキストからポイントテキストに変換した後、再度エリアテキストに変換に変換します。これでテキストフレームのリンクが解除されます。</p>
<p>テキストフレームのリンクを解除するサンプル（CC以降）</p>
<pre><code>// 選択したテキストフレームのリンクを解除する
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    selObj[i].convertAreaObjectToPointObject(); // エリアテキストからポイントテキストに変換
    selObj[i].convertPointObjectToAreaObject(); // ポイントテキストからエリアテキストに変換
}</code></pre>
<p>　テキストフレームを選択します。</p>
<figure>
<figcaption>【図】テキストフレームを選択</figcaption>
<img src="images/00093.jpeg" />
</figure>
<p>　テキストフレームのリンクが解除されます。</p>
<figure>
<figcaption>【図】リンクが解除される</figcaption>
<img src="images/00476.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-658">
<section>
<h2 id="calibre_link-254"><b>6-22　他のテキストフレームとリンクしているかどうか調べる</b></h2>
<p>　他のテキストフレームとリンクしているかどうか調べるにはpreviousFrameプロパティとnextFrameプロパティを参照します。previousFrameプロパティは現在のテキストフレームよりも前にリンクされているテキストフレームを示します。ただし、nextFrameプロパティはpreviousFrameプロパティとは異なり次のテキストフレームを示しているわけではありません。</p>
<p>　nextFrameプロパティは最後にリンクされているテキストフレームでは自分自身を示します。nextFrameプロパティは次にリンクしたいテキストフレームを代入するためのプロパティです。このため、次のテキストフレームにリンクしているかどうかを手軽に調べることができません。previousFrameは前に続くテキストフレームが存在しない場合nullを返しますが、nextFrameは常にテキストフレームオブジェクトを返します。</p>
<p>　そこで次のテキストフレームとリンクしているかどうか調べるために全てのテキストフレームにIDを割り当てます。このIDが異なれば次のフレームにリンクしている、同じならリンクしていないというように判断します。</p>
<p>他のテキストフレームとリンクしているかどうか調べるサンプル</p>
<pre><code>// 次のテキストフレームにリンクしているか調べる
for(var i=0; i&lt;activeDocument.textFrames.length; i++){
    activeDocument.textFrames[i].myID = i;  // 一時的に全てのテキストフレームにIDを割り当てる
}
var selObj = activeDocument.selection;  // 選択されたテキストフレームを調べる
for(var i=0; i&lt;selObj.length; i++){
    if (selObj[i].typename != "TextFrame"){
        continue;   // テキストフレーム以外は処理しない
    }
    if(selObj[i].myID != selObj[i].nextFrame.myID){ // IDを比較する
        alert("次のテキストフレームにリンクしています");
    }else{
        alert("次のテキストフレームにリンクしていません");
    }
}</code></pre>
<p>　単独のテキストフレームを選択します。</p>
<figure>
<figcaption>【図】テキストフレームを選択</figcaption>
<img src="images/00269.jpeg" />
</figure>
<p>　リンクしていないことを示すアラートダイアログが表示されます。</p>
<figure>
<figcaption>【図】アラートダイアログが表示される</figcaption>
<img src="images/00050.jpeg" />
</figure>
<p>　リンクされている最後のテキストフレームを選択します。</p>
<figure>
<figcaption>【図】最後のテキストフレームを選択</figcaption>
<img src="images/00433.jpeg" />
</figure>
<p>　これ以上リンクしていないので、リンクしていないことを示すアラートダイアログが表示されます。</p>
<figure>
<figcaption>【図】アラートダイアログが表示される</figcaption>
<img src="images/00219.jpeg" />
</figure>
<p>　次のテキストフレームに続いているテキストフレームを選択します。</p>
<figure>
<figcaption>【図】続いているテキストフレームを選択</figcaption>
<img src="images/00004.jpeg" />
</figure>
<p>　次のテキストフレームが存在するのでリンクしていることを示すアラートダイアログが表示されます。</p>
<figure>
<figcaption>【図】アラートダイアログが表示される</figcaption>
<img src="images/00580.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-63">
<section>
<h2 id="calibre_link-255"><b>6-23　選択したテキストフレームを1行ごとに分解する（横書き／スタイル無視）</b></h2>
<p>　1行の内容が入っているlines配列から、文字列を読み出します。読み出した内容を新規に作成したテキストフレームのcontentsプロパティに入れます。行間は全体の縦幅を行数で除算し求めます。求めた座標を新規に作成したテキストフレームのleft、topプロパティに入れます。</p>
<p>　なお、このサンプルは設定されている文字のサイズや行間、スタイルなどは全て削除されます。すでにスタイルなどが設定されているエリアテキストを1行ごと分解したい場合は、このような方法は使えません。</p>
<p>選択したテキストフレームを1行ごとに分解するサンプル（横書き／スタイル無視）</p>
<pre><code>// 選択したテキストフレームを1行ごとに分解する（横書き／スタイル無視）
var selObj = activeDocument.selection;  // 選択されたテキストフレームを調べる
for(var i=0; i&lt;selObj.length; i++){
    var lead = selObj[i].height / selObj[i].lines.length;   // 行間を求める
    for(var j=0; j&lt;selObj[i].lines.length; j++){
        var txtObj = activeDocument.textFrames.add();   // 新規にテキストフレームを削除する
        txtObj.left = selObj[i].left;   // X座標を設定する
        txtObj.top = selObj[i].top - j * lead;  // Y座標を設定する
        txtObj.contents = selObj[i].lines[j].contents;
    }
    selObj[i].remove();   // テキストフレームを削除する
}</code></pre>
<p>　1行ごと分解するテキストフレームを選択します。</p>
<figure>
<figcaption>【図】テキストフレームを選択</figcaption>
<img src="images/00359.jpeg" />
</figure>
<p>　エリアテキストが分解され、1行単位になります。</p>
<figure>
<figcaption>【図】エリアテキストが分解される</figcaption>
<img src="images/00143.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-603">
<section>
<h2 id="calibre_link-256"><b>6-24　選択したパステキストの文字を外側・内側にする</b></h2>
<p>　選択したパステキストの文字を外側・内側にするにはtextPathオブジェクトのpolarityプロパティに以下の表に示す値を指定します。</p>
<table>
<caption>【表】polarityプロパティに指定できる値</caption>
<tbody>
<tr>
  <td>
    <span>値</span>
  </td>
  <td>
    <span>結果</span>
  </td>
</tr>
<tr>
  <td>PolarityValues.POSITIVE</td>
  <td>通常（パスの外側）</td>
</tr>
<tr>
  <td>PolarityValues.NEGATIVE</td>
  <td>反対方向（パスの内側）</td>
</tr>
</tbody>
</table>
<p>選択したパステキストの文字を外側・内側にするサンプル</p>
<pre><code>// 選択したパステキストの文字を内側にする
var selObj = activeDocument.selection;  // 選択されたテキストパス
for(var i=0; i&lt;selObj.length; i++){
    selObj[i].textPath.polarity = PolarityValues.NEGATIVE;  // 内側にする
}</code></pre>
<p>　テキストパスを選択します。</p>
<figure>
<figcaption>【図】テキストパスを選択</figcaption>
<img src="images/00539.jpeg" />
</figure>
<p>　文字の配置方向が逆（外側から内側）になります。</p>
<figure>
<figcaption>【図】配置方向が逆になる</figcaption>
<img src="images/00178.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-763">
<section>
<div>
<h1 id="calibre_link-257"><b>第7章　パラグラフ／段落</b></h1>
</div>
<p>　この章では、テキストフレーム内にある段落／行に関するサンプルを示し、解説します。段落／行単位で文字の属性などを変更することができます。</p>
</section>
</div>
<div id="calibre_link-541">
<section>
<h2 id="calibre_link-258"><b>7-1　段落を作成する</b></h2>
<p>　段落を作成するにはテキストフレームオブジェクトに対してparagraphs.add()とします。add()メソッドは新規に作成した段落オブジェクトを返します。add()メソッドには3つのパラメーターを指定できます。最初のパラメーターが段落に挿入する文字になります。2番目はテキストフレームオブジェクトを指定します。特に指定するテキストフレームオブジェクトがない場合はundefinedを指定します。3番目のパラメーターは最初のパラメーターで指定した文字を段落のどこに配置するかを示します。配置先の指定は下表の値を指定できます。なお、2番目と3番目のパラメーターは省略することができます。</p>
<table>
<caption>【表】配置先の指定</caption>
<tbody>
<tr>
  <td>
    <span>3番目のパラメーター</span>
  </td>
  <td>
    <span>配置</span>
  </td>
</tr>
<tr>
  <td>ElementPlacement.INSIDE</td>
  <td>内側</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEATBEGINNING</td>
  <td>段落の先頭</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEATEND</td>
  <td>段落最後</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEBEFORE</td>
  <td>段落前</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEAFTER</td>
  <td>段落後</td>
</tr>
</tbody>
</table>
<p>段落を作成するサンプル</p>
<pre><code>// 段落を作成する
var txtObj = activeDocument.textFrames.add();
txtObj.top = -20;
txtObj.left = 10;
var prObj1 = txtObj.paragraphs.add("最初の段落です");  // 段落を作成
var prObj2 = txtObj.paragraphs.add("2番目の段落です");
// 2番目の段落の前に文字を追加する
prObj2.paragraphs.add("【追加する段落】", undefined, ElementPlacement.PLACEATBEGINNING);</code></pre>
<p>　テキストフレーム内に3つの段落が作成されます。</p>
<figure>
<figcaption>【図】テキストフレーム内に3つの段落が作成される</figcaption>
<img src="images/00108.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-661">
<section>
<h2 id="calibre_link-259"><b>7-2　段落を挿入する</b></h2>
<p>　段落を挿入するにはテキストフレームオブジェクトに対してparagraphs.addBefore()とします。addBefore()メソッドのパラメーターには段落前に挿入する文字列を指定します。</p>
<p>　現在の段落の後に新たに段落を追加する場合はadd()、前に挿入する場合はaddBefore()メソッドという使い分けをすることもできます。</p>
<p>段落を挿入するサンプル</p>
<pre><code>// addBeforeを使って段落を作成する
var txtObj = activeDocument.textFrames.add();
txtObj.top = -20;
txtObj.left = 10;
var prObj1 = txtObj.paragraphs.add("最初の段落です");
var prObj2 = txtObj.paragraphs.addBefore("2番目の段落です");</code></pre>
<p>　2番目に作成した段落が最初の段落の前に挿入されます。</p>
<figure>
<figcaption>【図】2番目に作成した段落が最初の段落の前に挿入される</figcaption>
<img src="images/00492.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-66">
<section>
<h2 id="calibre_link-260"><b>7-3　段落を削除する</b></h2>
<p>　段落を削除するにはremove()メソッドを使います。削除したい段落の行数をparagraphs配列の番号として指定しremove()メソッドを実行します。これで、指定した順番の段落が削除されます。</p>
<p>段落を削除するサンプル</p>
<pre><code>// 最初の段落を削除する
var txtObj = activeDocument.selection[0];// 選択された最初のテキストフレーム
var prObj = txtObj.paragraphs[0];// 最初の段落
prObj.remove();</code></pre>
<p>　スクリプト実行前の状態です。</p>
<figure>
<figcaption>【図】スクリプト実行前の状態</figcaption>
<img src="images/00283.jpeg" />
</figure>
<p>　最初の段落が削除されます。</p>
<figure>
<figcaption>【図】最初の段落が削除される</figcaption>
<img src="images/00063.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-609">
<section>
<h2 id="calibre_link-261"><b>7-4　段落スタイルを作成する</b></h2>
<p>　段落スタイルを作成するにはドキュメントオブジェクトに対してparagraphStyles.add()とします。add()メソッドのパラメーターには作成したい段落スタイルの名前を文字列で指定します。ただし、すでに指定した段落スタイルが存在する場合はエラーで停止します。エラーを回避したい場合にはサンプルのようにtry...catchを使います。既存の段落スタイルを読み出すにはparagraphStyles["センタリング"]のようにスタイル名を指定します。</p>
<p>　add()メソッドにより作成された段落スタイルオブジェクトには、いくつかのプロパティがあります。これらのプロパティに対して値をなどを設定していきます。作成した段落スタイルを実際の段落に反映させるにはapplyTo()メソッドを使います。このメソッドの最初のパラメーターに適用したい段落オブジェクトを指定します。2番目のパラメーターはスタイルを上書きするかどうかのフラグです。trueを指定すると上書きになり既存の段落スタイルは書き換わります。falseを指定すると段落スタイルは上書きされません。</p>
<p>段落スタイルを作成するサンプル</p>
<pre><code>// 段落スタイルを作成する
var txtObj = activeDocument.textFrames.add();
txtObj.contents = "イラストレーター自動化";
txtObj.top = -20;
txtObj.left = 100;
try{
    // スタイルを新規に作成する
    var psObj = activeDocument.paragraphStyles.add("センタリング");
}catch(e){
    // すでにスタイルが存在する場合は既存のスタイルを読み出す
    var psObj = activeDocument.paragraphStyles["センタリング"];
}
var paraAttrObj = psObj.paragraphAttributes;
paraAttrObj.justification = Justification.CENTER;// センタリング（中揃え）
psObj.applyTo(txtObj.paragraphs[0], true);</code></pre>
<p>　段落スタイルが作成される前の状態です。</p>
<figure>
<figcaption>【図】段落スタイルが作成される前</figcaption>
<img src="images/00340.jpeg" />
</figure>
<p>　新たに段落スタイル「センタリング」が作成されます。</p>
<figure>
<figcaption>【図】段落スタイル「センタリング」が作成される</figcaption>
<img src="images/00234.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-6">
<section>
<h2 id="calibre_link-262"><b>7-5　段落スタイルを反映させる</b></h2>
<p>　段落スタイルを反映させるにはドキュメントオブジェクトのparagraphStyles配列から反映させたい段落スタイルオブジェクトを読み出します。これはparagraphStyles["段落スタイル名"]のように指定します。paragraphStyles配列から読み出した段落スタイルオブジェクトのapplyTo()メソッドを使って、指定された段落に対してスタイルを設定します。なお、指定した段落スタイルがない場合にはエラーになります。</p>
<p>　applyTo()メソッドの最初のパラメーターに適用したい段落オブジェクトを指定します。2番目のパラメーターはスタイルを上書きするかどうかのフラグです。trueを指定すると上書きになり既存の段落スタイルは書き換わります。falseを指定すると段落スタイルは上書きされません。</p>
<p>段落スタイルを反映させるサンプル</p>
<pre><code>// 段落スタイルを反映させる
var txtObj = activeDocument.selection[0];// 選択されたテキストフレーム
try {
    var psObj = activeDocument.paragraphStyles["タイトル"];
    psObj.applyTo(txtObj.paragraphs[0], true);// 最初の段落に対して適用
}catch(e){
    alert("指定された段落スタイルがありません");
}</code></pre>
<p>　スクリプトを実行する前の状態です。</p>
<figure>
<figcaption>【図】スクリプトを実行する前</figcaption>
<img src="images/00116.jpeg" />
</figure>
<p>　選択したテキストフレームの最初の行の段落スタイルが変更されます。</p>
<figure>
<figcaption>【図】最初の行の段落スタイルが変更される</figcaption>
<img src="images/000402.gif" />
</figure>
</section>
</div>
<div id="calibre_link-545">
<section>
<h2 id="calibre_link-263"><b>7-6　行揃えを指定する</b></h2>
<p>　行揃えを指定するには段落オブジェクトのjustificationプロパティに行揃え方法を指定します。paragraphs配列で行揃えを変更する段落を指定することで、1行ずつ異なる行揃えを指定することができます。</p>
<p>　一括してテキストフレームの全ての段落の行揃えを指定する場合はtextRangeオブジェクトのjustificationプロパティに行揃え方法を指定します。行揃えを示すプロパティを下表に示します。</p>
<table>
<caption>【表】指定できる行揃え</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ</span>
  </td>
  <td>
    <span>行揃え方法</span>
  </td>
</tr>
<tr>
  <td>Justification.LEFT</td>
  <td>左揃え</td>
</tr>
<tr>
  <td>Justification.CENTER</td>
  <td>中央揃え（センタリング）</td>
</tr>
<tr>
  <td>Justification.RIGHT</td>
  <td>右揃え</td>
</tr>
<tr>
  <td>Justification.FULLJUSTIFY</td>
  <td>均等配置（両端揃え）</td>
</tr>
<tr>
  <td>Justification.FULLJUSTIFYLASTLINELEFT</td>
  <td>均等配置（最終行左揃え）</td>
</tr>
<tr>
  <td>Justification.FULLJUSTIFYLASTLINECENTER</td>
  <td>均等配置（最終行中央揃え）</td>
</tr>
<tr>
  <td>Justification.FULLJUSTIFYLASTLINERIGHT</td>
  <td>均等配置（最終行右揃え）</td>
</tr>
</tbody>
</table>
<p>行揃えを指定するサンプル</p>
<pre><code>// 行揃えを指定する
var txtObj = activeDocument.textFrames.add();
txtObj.left = 100;
txtObj.top = -20;
txtObj.contents = "イラストレーター\rCC 2014";
txtObj.paragraphs[0].justification = Justification.CENTER;// 先頭の段落のみ中揃え</code></pre>
<p>　先頭の段落だけが中揃え（センタリング）されます。</p>
<figure>
<figcaption>【図】先頭の段落だけが中揃えされる</figcaption>
<img src="images/00188.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-707">
<section>
<h2 id="calibre_link-264"><b>7-7　奇数行と偶数行で異なる段落スタイルを反映させる</b></h2>
<p>　段落スタイルを反映させるには、あらかじめ奇数行と偶数行の段落スタイルを定義しておきます。あとは段落の数だけ（paragraphs.length）繰り返し処理を行います。偶数行か奇数行かはfor命令で使われるループ変数の値を調べます。変数の値との論理積（下表参照）や剰余を利用することで奇数か偶数かを知ることができます。サンプルでは変数と1との論理積を求めることで奇数行か偶数行かを判断しています。剰余を利用する場合はi % 2のようにして演算し結果が1なら奇数ということになります。</p>
<p>　段落スタイルを反映させるには段落オブジェクトのapplyTo()メソッドを使います。最初のパラメーターに適用する段落を、2番目にはtrueを指定します。</p>
<p>　なお、paragraphsではなくlinesを指定した場合、見た目の行でスタイルは反映されず、内部での行単位でのスタイルになります。つまりparagraphsを指定した場合と同じになります。</p>
<table>
<caption>【表】論理積（数値をビット列[1か0]にした際に演算した結果）</caption>
<tbody>
<tr>
  <td>
    <span>計算式</span>
  </td>
  <td>
    <span>結果</span>
  </td>
</tr>
<tr>
  <td>0 &amp; 0</td>
  <td>0</td>
</tr>
<tr>
  <td>0 &amp; 1</td>
  <td>0</td>
</tr>
<tr>
  <td>1 &amp; 0</td>
  <td>0</td>
</tr>
<tr>
  <td>1 &amp; 1</td>
  <td>1</td>
</tr>
</tbody>
</table>
<p>
<strong><b>例：</b></strong>7をビット列に直すと0111。1は0001。それぞれのビットで論理積を取ると0001。つまり1になり奇数。6なら0110のビット列。0001との論理積を取ると0000で0。つまり偶数。</p>
<p>奇数行と偶数行で異なる段落スタイルを反映させるサンプル</p>
<pre><code>// 奇数行と偶数行で異なる段落スタイルを反映させる
var txtObj = activeDocument.selection[0];// 選択されたテキストフレーム
try {
    var evenPsObj = activeDocument.paragraphStyles["偶数行スタイル"];
    var oddPsObj = activeDocument.paragraphStyles["奇数行スタイル"];
    for(var i=0; i&lt;txtObj.paragraphs.length; i++){
        if (i &amp; 1){ // 奇数の場合
            evenPsObj.applyTo(txtObj.paragraphs[i], true);// スタイルを適用
        }else{  // 偶数の場合
            oddPsObj.applyTo(txtObj.paragraphs[i], true);// スタイルを適用
        }
    }
}catch(e){
    alert("指定された段落スタイルがありません");
}</code></pre>
<p>　スクリプトを実行する前の状態です。</p>
<figure>
<figcaption>【図】スクリプトを実行する前</figcaption>
<img src="images/00574.jpeg" />
</figure>
<p>　選択したテキストフレームの最初の行の段落スタイルが変更されます。</p>
<figure>
<figcaption>【図】最初の行の段落スタイルが変更される</figcaption>
<img src="images/00353.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-112">
<section>
<h2 id="calibre_link-265"><b>7-8　行単位で文字サイズを指定する</b></h2>
<p>　行単位で文字サイズを指定するにはparagraphs配列で対象となる行を指定します。paragraphs[0]であれば最初の段落、paragraphs[1]であれば2番目の段落になります。なお、paragraphs[-1]としても最終行は対象となりません（最終行からの逆指定はできません）。</p>
<p>　文字サイズは段落オブジェクトのsizeプロパティに値を指定すれば行単位で設定されます。値はポイントで単位を付加する必要はありません。</p>
<p>行単位で文字サイズを指定するサンプル</p>
<pre><code>// 行単位で文字サイズを指定する
var txtObj = app.activeDocument.textFrames.add();
txtObj.top = -20;
txtObj.left = 10;
txtObj.paragraphs.add("フォトショップ");
txtObj.paragraphs.add("イラストレーター");
txtObj.paragraphs.add("インデザイン");
txtObj.paragraphs[1].size = 24;</code></pre>
<p>　2番目の行の文字サイズが変わります。</p>
<figure>
<figcaption>【図】2番目の行の文字サイズが変わる</figcaption>
<img src="images/00575.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-739">
<section>
<h2 id="calibre_link-266"><b>7-9　行単位でフォント（書体）を指定する</b></h2>
<p>　行単位でフォント（書体）を指定するにはparagraphs配列で対象となる行を指定します。paragraphs[0]であれば最初の段落、paragraphs[1]であれば2番目の段落になります。なお、paragraphs[-1]としても最終行は対象となりません（最終行からの逆指定はできません）。</p>
<p>　フォントは段落オブジェクトのtextFontプロパティにapp.textFonts配列内にあるフォントを指定すれば行単位で設定されます。存在しないフォント名を指定した場合、textFontに設定しようとするとはエラーになります。</p>
<p>行単位でフォント（書体）を指定するサンプル</p>
<pre><code>// 行単位でフォントを指定する
var txtObj = app.activeDocument.textFrames.add();
txtObj.top = -20;
txtObj.left = 10;
txtObj.paragraphs.add("Photoshop");
txtObj.paragraphs.add("Illustrator");
txtObj.paragraphs.add("InDesign");
txtObj.paragraphs.add("AfterEffects");
txtObj.paragraphs[1].textFont = app.textFonts["Arial-Black"];
txtObj.paragraphs[2].textFont = app.textFonts["Times-Bold"];</code></pre>
<p>　2番目と3番目の文字のフォントが変わります。</p>
<figure>
<figcaption>【図】2番目と3番目の文字のフォントが変わる</figcaption>
<img src="images/00534.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-24">
<section>
<h2 id="calibre_link-267"><b>7-10　行単位でベースラインを指定する</b></h2>
<p>　行単位でベースラインを指定するにはparagraphs配列で対象となる行を指定します。paragraphs[0]であれば最初の段落、paragraphs[1]であれば2番目の段落になります。なお、paragraphs[-1]としても最終行は対象となりません（最終行からの逆指定はできません）。</p>
<p>　ベースラインは段落オブジェクトのbaselineShiftプロパティに値を設定します。</p>
<p>行単位でベースラインを指定するサンプル</p>
<pre><code>// 行単位でベースラインを指定する
var txtObj = app.activeDocument.textFrames.add();
txtObj.top = -20;
txtObj.left = 10;
txtObj.paragraphs.add("フォトショップ");
txtObj.paragraphs.add("イラストレーター");
txtObj.paragraphs.add("インデザイン");
txtObj.paragraphs[1].baselineShift = 10;</code></pre>
<p>　2番目の段落のベースラインが変更されます。</p>
<figure>
<figcaption>【図】2番目の段落のベースラインが変更される</figcaption>
<img src="images/00297.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-595">
<section>
<h2 id="calibre_link-268"><b>7-11　行単位で文字色を指定する</b></h2>
<p>　行単位で文字色を指定するにはparagraphs配列で対象となる行を指定します。paragraphs[0]であれば最初の段落、paragraphs[1]であれば2番目の段落になります。なお、paragraphs[-1]としても最終行は対象となりません（最終行からの逆指定はできません）。</p>
<p>　文字色は段落オブジェクトのfillColorプロパティにカラーオブジェクトを指定します。なお、行単位でなく1文字ごとにカラーを設定する場合はcharacters配列のfillColorプロパティにカラーオブジェクトを指定します。</p>
<p>行単位で文字色を指定するサンプル</p>
<pre><code>// 行単位で文字色を指定する
var txtObj = app.activeDocument.textFrames.add();
txtObj.top = -20;
txtObj.left = 10;
txtObj.paragraphs.add("イラストレーター");
txtObj.paragraphs.add("フォトショップ");
txtObj.paragraphs.add("インデザイン");
txtObj.paragraphs[0].fillColor = setCMYKColor(0, 100,0, 0);
txtObj.paragraphs[1].fillColor = setCMYKColor(100, 0,　100, 0);
txtObj.paragraphs[2].fillColor = setCMYKColor(0, 0, 100, 0);
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
    var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}</code></pre>
<p>　1行ごと異なる文字色が設定されます。</p>
<figure>
<figcaption>【図】1行ごと異なる文字色が設定される</figcaption>
<img src="images/00101.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-114">
<section>
<h2 id="calibre_link-269"><b>7-12　行間を指定する</b></h2>
<p>　行間を指定するにはparagraphs配列で対象となる行を指定します。段落オブジェクトのautoLeadingプロパティにfalseを設定してからleadingプロパティに行間を指定します。この行間の値の単位はポイントになります。</p>
<p>　行間を自動にするにはautoLeadingプロパティにtrueを設定します。</p>
<p>行間を指定するサンプル</p>
<pre><code>// 最初の行の行間を指定する
var txtObj = app.activeDocument.textFrames.add();
txtObj.top = -20;
txtObj.left = 10;
txtObj.paragraphs.add("イラストレーター");
txtObj.paragraphs.add("フォトショップ");
txtObj.paragraphs.add("インデザイン");
txtObj.paragraphs.add("ブリッジ");
txtObj.paragraphs[0].autoLeading = false;   // 行間指定時はfalseにする
txtObj.paragraphs[0].leading = 50;</code></pre>
<p>　1行目の行間が大きく広がります。</p>
<figure>
<figcaption>【図】1行目の行間が大きく広がる</figcaption>
<img src="images/00488.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-720">
<section>
<h2 id="calibre_link-270"><b>7-13　段落の総数を取得する</b></h2>
<p>　段落の総数を取得するには段落オブジェクト（paragraphs）のlengthプロパティを参照します。paragraphsは配列なのでlengthによって段落数を求めることができます。ここでの段落は見た目の段落数ではなく、改行コード（またはテキストの末端を加えた数）の総数になります。</p>
<p>段落の総数を取得するサンプル</p>
<pre><code>// 選択されたテキストフレームの段落の総数を表示する
if (activeDocument.selection.length &gt; 0){
    var n = activeDocument.selection[0].paragraphs.length;
    alert("段落の数は："+n);
}</code></pre>
<p>　選択したテキストフレームの総段落数がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】選択したテキストフレームの総段落数が表示される</figcaption>
<img src="images/00276.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-556">
<section>
<h2 id="calibre_link-271"><b>7-14　段落スタイル名を取得する</b></h2>
<p>　段落スタイル名を取得するには段落オブジェクト(paragraphs)のparagraphStyles配列を参照します。段落スタイル名はparagraphStyles配列に格納されているparagraphStylesオブジェクトのnameプロパティを参照します。</p>
<p>段落スタイル名を取得するサンプル</p>
<pre><code>// 選択されたテキストフレームの最初の段落のスタイルを表示する
if (activeDocument.selection.length &gt; 0){
    var prObjList = activeDocument.selection[0].paragraphs[0].paragraphStyles;
    var sName = prObjList[0].name;
    alert("最初の段落のスタイル名は："+sName);
}</code></pre>
<p>　選択したテキストフレームの最初のスタイル名がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】選択したテキストフレームの最初のスタイル名が表示される</figcaption>
<img src="images/00043.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-28">
<section>
<h2 id="calibre_link-272"><b>7-15　段落の禁則処理名を求める</b></h2>
<p>　段落の禁則処理名を求めるには段落オブジェクト(paragraphs)のkinsokuプロパティを参照します。禁則処理は段落ごとに設定できるため段落ごとに読み出す必要があります。また、禁則処理が設定されている場合に返される文字はHardのように英単語になります。禁則処理が「なし」になっている場合はkinsokuプロパティ自体が存在しないためアクセス時にエラーになります。これを回避するにはサンプルのようにtry...catchを使う必要があります。</p>
<table>
<caption>【表】禁則処理名</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ</span>
  </td>
  <td>
    <span>禁則処理の種類</span>
  </td>
</tr>
<tr>
  <td>Hard</td>
  <td>強い禁則</td>
</tr>
<tr>
  <td>Soft</td>
  <td>弱い禁則</td>
</tr>
</tbody>
</table>
<p>段落の禁則処理名を求めるサンプル</p>
<pre><code>// 選択されたテキストフレームの最初の段落の禁則処理名を表示する
if (activeDocument.selection.length &gt; 0){
    try{
        var kName = activeDocument.selection[0].paragraphs[0].kinsoku;
    }catch(e){
        var kName = "なし";   // エラーの場合は禁則処理が設定されていない
    }
    alert("段落の禁則処理："+kName);
}</code></pre>
<p>　選択したテキストフレームの最初の禁則処理名がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】選択したテキストフレームの最初の禁則処理名が表示される</figcaption>
<img src="images/00204.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-668">
<section>
<h2 id="calibre_link-273"><b>7-16　段落のインデントを（字下げ）指定する</b></h2>
<p>　段落のインデントを指定するにはparagraphs配列で対象となる行を指定します。最初の行だけにインデントを指定するにはfirstLineIndentプロパティに値を指定します（単位はポイント）。</p>
<p>　段落の左側のインデントを指定する場合はleftIndentプロパティに指定します。右側のインデントの場合はrightIndentプロパティに値を指定します。</p>
<p>段落のインデントを指定するサンプル</p>
<pre><code>// 最初の行のインデント（字下げ）を指定する
var txtObj = activeDocument.textFrames.add();
txtObj.top = -20;
txtObj.left = 10;
txtObj.paragraphs.add("イラストレーター");
txtObj.paragraphs.add("フォトショップ");
txtObj.paragraphs.add("インデザイン");
txtObj.paragraphs.add("ブリッジ");
txtObj.paragraphs[0].firstLineIndent = 150;</code></pre>
<p>　最初の行が字下げされます。</p>
<figure>
<figcaption>【図】最初の行が字下げされる</figcaption>
<img src="images/00227.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-43">
<section>
<h2 id="calibre_link-274"><b>7-17　選択されたテキストフレームの行数を表示する</b></h2>
<p>　選択されたテキストフレームの行数を表示するにはparagraphs配列の数を調べます。つまりparagraphs.lengthとすると行数を求めることができます。見た目には1行しかない場合でも改行コードが末尾にある場合、さらに1行がカウントされ2行となります。</p>
<p>　また、テキストフレームがリンクされ他のテキストフレームに文字が流れ込んでいる場合、表示されている行数と内部での行数が異なることがあります。この内部の行数を取得したい場合はテキストフレームオブジェクトのstoryオブジェクトのparagraphs配列の数を調べます。</p>
<p>選択されたテキストフレームの行数を表示するサンプル</p>
<pre><code>// 選択されたテキストフレームの行数を表示する
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var count1 = selObj[i].paragraphs.length;
    var count2 = selObj[i].story.paragraphs.length;
    alert("行数："+count1+"\rStory行数："+count2);
}</code></pre>
<p>　リンクされていない単独のテキストフレームを選択します。</p>
<figure>
<figcaption>【図】リンクされていない単独のテキストフレームを選択する</figcaption>
<img src="images/00275.jpeg" />
</figure>
<p>　リンクされていないので行数、Story行数とも同じ結果になります。</p>
<figure>
<figcaption>【図】リンクされていないので行数、Story行数とも同じ結果になる</figcaption>
<img src="images/00395.jpeg" />
</figure>
<p>　リンクされているテキストフレームを選択します。</p>
<figure>
<figcaption>【図】リンクされているテキストフレームを選択する</figcaption>
<img src="images/00270.jpeg" />
</figure>
<p>　表示されている行数と内部の行数が表示されます。リンクされているので単独のテキストフレームとは異なる行数が表示されます。</p>
<figure>
<figcaption>【図4】表示されている行数と内部の行数が表示される</figcaption>
<img src="images/00570.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-577">
<section>
<h2 id="calibre_link-275"><b>7-18　選択されたテキストフレームの内部行数と表示行数を表示する</b></h2>
<p>　Illustratorでは内部での行数を示すparagraphs配列と実際に表示されている行数を示すlines配列があります。内部での行数はparagraphs.length、表示行数はlines.lengthとすることで、それぞれの行数を取得することができます。</p>
<p>選択されたテキストフレームの内部行数と表示行数を表示するサンプル</p>
<pre><code>// 選択されたテキストフレームの内部行数と表示行数を表示する
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var count1 = selObj[i].paragraphs.length;
    var count2 = selObj[i].lines.length;
    alert("行数："+count1+"\r表示行数："+count2);
}</code></pre>
<p>　テキストフレームを選択します。</p>
<figure>
<figcaption>【図】テキストフレームを選択する</figcaption>
<img src="images/00349.jpeg" />
</figure>
<p>　内部での行数と実際に表示されている行数がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】内部での行数と実際に表示されている行数が表示される</figcaption>
<img src="images/00142.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-742">
<section>
<h2 id="calibre_link-276"><b>7-19　選択されたテキストフレームの表示行の右側で改行する</b></h2>
<p>　選択されたテキストフレームの表示行の右側で改行するにはlines配列とadd()メソッドを使います。1行ごとにadd()メソッドを使い改行コードを追加します。改行コードはadd("\r")とすることで追加されます。</p>
<p>　単純にlinesで示される行に改行を追加していくと空行ができてしまいます。この空行を削除するにはlines配列で示されるオブジェクトのremove()メソッドではなくparagraphs配列で示されるオブジェクトのremove()メソッドを使います。このようにしないと改行が削除されません。なお、サンプルでは空行を全て削除してしまいますので注意が必要です。空行を削除したくない場合は「// 空行を削除~」以後のforを含めて6行を削除してください。</p>
<p>選択されたテキストフレームの表示行の右側で改行するサンプル</p>
<pre><code>// 選択されたテキストフレームの表示行の右側で改行する
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    for(var j=selObj[i].lines.length-1; j&gt;=0; j--){
        selObj[i].lines[j].characters.add("\r");
    }
    // 空行を削除。表示行数分繰り返し削除は内部行数にする
    for(var j=0; j&lt;selObj[i].lines.length; j++){
        var text = selObj[i].lines[j].contents; // 1行の内容を読み出す
        if (text == ""){
            selObj[i].paragraphs[j].remove();   // 内部行数を削除する
        }
    }
}</code></pre>
<p>　テキストフレームを選択します。</p>
<figure>
<figcaption>【図】テキストフレームを選択する</figcaption>
<img src="images/00528.jpeg" />
</figure>
<p>　見た目の行の末尾で改行されます。</p>
<figure>
<figcaption>【図】見た目の行の末尾で改行される</figcaption>
<img src="images/00505.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-104">
<section>
<h2 id="calibre_link-277"><b>7-20　選択されたテキストフレームの空行を削除する（スタイル無視）</b></h2>
<p>　選択されたテキストフレームの空行を削除するには正規表現のreplace()メソッドを使います。マッチする文字に/\r+/gを指定すると複数の改行が対象になります。置換後の文字列は\rを指定することで不要な空行が削除されます。</p>
<p>　なお、このサンプルは段落などに設定されたスタイルは削除されてしまうので注意が必要です。スタイルを設定する前に使用するなど用途は限定されます。</p>
<p>選択されたテキストフレームの空行を削除するサンプル（スタイル無視）</p>
<pre><code>// 選択されたテキストフレームの空行を削除する（スタイル無視）
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    selObj[i].contents = selObj[i].contents.replace(/\r+/g, "\r");
}</code></pre>
<p>　テキストフレームを選択します。</p>
<figure>
<figcaption>【図】テキストフレームを選択します。</figcaption>
<img src="images/00096.jpeg" />
</figure>
<p>　スクリプトを実行すると空行が削除されます。ただし、スタイルも削除されます。</p>
<figure>
<figcaption>【図】空行が削除され、スタイルも削除される</figcaption>
<img src="images/00482.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-645">
<section>
<h2 id="calibre_link-278"><b>7-21　選択されたテキストフレームの空行を削除する（スタイル維持）</b></h2>
<p>　スタイルを維持したまま選択されたテキストフレームの空行を削除するには1行ごと内容を読み出します。段落の内容は段落オブジェクトのcontentsプロパティに入っています。contentsプロパティから読み出した内容が空文字なら段落オブジェクトのremove()メソッドを使って削除します。この時、段落の末尾から処理を行います。なお、Illustratorで最終段落に改行が入っていない場合、paragraphs.lengthと実際の行数が異なるためサンプルのようにtry...catchを使ってエラーを回避する必要があります。</p>
<p>選択されたテキストフレームの空行を削除するサンプル（スタイル維持）</p>
<pre><code>// 選択されたテキストフレームの空行を削除する（スタイル維持）
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    // 空行を削除。表示行数分繰り返し削除は内部行数にする
    for(var j=selObj[i].paragraphs.length-1; j&gt;=0; j--){
        try {
            var text = selObj[i].paragraphs[j].contents; // 1行の内容を読み出す
            if (text == ""){    // 空行かどうか調べる
                selObj[i].paragraphs[j].remove();   // 段落を削除する
            }
        }catch(e){} // 最終行に改行コードがない場合にエラーなので無視するだけでよい
    }
}</code></pre>
<p>　テキストフレームを選択します。</p>
<figure>
<figcaption>【図】テキストフレームを選択する</figcaption>
<img src="images/00271.jpeg" />
</figure>
<p>　スタイルを維持したまま空行が削除されます。</p>
<figure>
<figcaption>【図】スタイルを維持したまま空行が削除される</figcaption>
<img src="images/00285.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-45">
<section>
<h2 id="calibre_link-279"><b>7-22　1行ずつ番号をつける</b></h2>
<p>　行頭に1行ずつ番号をつけるにはlines配列の数だけ繰り返します。行の内容はcontentsプロパティに入っているので読み出し番号を追加した後で書き戻します。</p>
<p>　サンプルでは0002のように4桁に数値になるようにしていますが、これは「n = ("0000" + n).slice(-4);」の0000と-4の部分で桁数を調整できます。また、このような桁数調整が不要な場合は、この行ごと削除してください。</p>
<p>　なお、行番号を追加することで行数が変化するため実行前には横幅を広げておく必要があります。</p>
<p>1行ずつ番号をつけるサンプル</p>
<pre><code>// 1行ずつ番号をつける
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    for(var j=0; j&lt;selObj[i].lines.length; j++){    // 行数分繰り返す
        var n = j + 1;  // 番号を算出
        n = ("0000" + n).slice(-4); // 4桁にする
        selObj[i].lines[j].contents = n + "　" + selObj[i].lines[j].contents;
    }
}</code></pre>
<p>　テキストフレームを選択します。</p>
<figure>
<figcaption>【図】テキストフレームを選択する</figcaption>
<img src="images/00082.jpeg" />
</figure>
<p>　段落ごとに番号がつきます。</p>
<figure>
<figcaption>【図】段落ごとに番号がつく</figcaption>
<img src="images/00451.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-581">
<section>
<div>
<h1 id="calibre_link-280"><b>第8章　テキスト／文字</b></h1>
</div>
<p>　この章では、文字と文字の属性に関するサンプルを示し、解説します。文字のサイズやフォント、縦書き処理などを行うことができます。</p>
</section>
</div>
<div id="calibre_link-122">
<section>
<h2 id="calibre_link-281"><b>8-1　文字のサイズを指定する</b></h2>
<p>　文字のサイズを指定するにはテキストフレームオブジェクトのcharacters配列を使います。この配列には1文字ごとの文字オブジェクトが格納されており、sizeプロパティに文字サイズを指定します。文字サイズの単位はpt（ポイント）です。</p>
<p>文字のサイズを指定するサンプル</p>
<pre><code>// 1文字目を18pt、2文字目を24ptにする、3文字目を9.5ptにする
var txtObj = activeDocument.textFrames.add();
txtObj.top = -20;
txtObj.left = 10;
txtObj.contents = "イラストレーター";
txtObj.characters[0].size = 18;       // 1文字目は18pt
txtObj.characters[1].size = 24;       // 2文字目は24pt
txtObj.characters[2].size = 9.5;      // 3文字目は9.5pt</code></pre>
<p>　先頭3文字のサイズが変化します。</p>
<figure>
<figcaption>【図】先頭3文字のサイズが変化する</figcaption>
<img src="images/00236.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-110">
<section>
<h2 id="calibre_link-282"><b>8-2　行間を指定する</b></h2>
<p>　行間を指定するには段落オブジェクトのcharacters配列を使います。この配列には1文字ごとの文字オブジェクトが格納されており、leadingプロパティに行間をpt単位で指定します。その際、自動行送りを解除しておく必要があります。自動行間送りはautoLeadingプロパティで設定します。trueを設定すると自動行送りになり、falseを指定すると解除されます。</p>
<p>　なお、行間は文字単位で指定し、一番行間の広いものが使われます。</p>
<p>行間を指定するサンプル</p>
<pre><code>// 選択したテキストフレームの1段落目の行間を24ptにし、2段落目の行間を自動にする
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    // 1段落目の処理
    for(var j=0; j&lt;selObj[i].paragraphs[0].characters.length; j++){
        selObj[i].paragraphs[0].characters[j].autoLeading = false;  // 自動行間送り解除
        selObj[i].paragraphs[0].characters[j].leading = 24; // 24pt
    }
    // 2段落目の処理
    for(var j=0; j&lt;selObj[i].paragraphs[1].characters.length; j++){
        selObj[i].paragraphs[1].characters[j].autoLeading = true; // 自動行間送り設定
    }
}</code></pre>
<p>　テキストフレームを選択します。行間は全て36ptになっています。</p>
<figure>
<figcaption>【図】テキストフレームを選択する</figcaption>
<img src="images/00022.jpeg" />
</figure>
<p>　スクリプトを実行します。先頭行は24ptの行送りになっています。</p>
<figure>
<figcaption>【図】先頭行は24ptの行送りになっている</figcaption>
<img src="images/00213.jpeg" />
</figure>
<p>　2行目は自動行送りになっています。</p>
<figure>
<figcaption>【図】2行目は自動行送りになっている</figcaption>
<img src="images/00191.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-532">
<section>
<h2 id="calibre_link-283"><b>8-3　文字の色を指定する</b></h2>
<p>　文字の色を指定するにはテキストフレームオブジェクトのcharacters配列を使います。この配列には1文字ごとの文字オブジェクトが格納されており、fillColorプロパティに文字の色を指定します。fillColorは文字の塗りつぶされた部分の色を示すプロパティです。線の色はstrokeColorになります。ただし、線の設定がないか線幅が0の場合は色を指定しても表示されません。このため、文字の線を表示するには文字オブジェクトのstrokedにtrueを設定した後でstrokeWeightに線幅を指定します。線の色は最初に設定しても後から設定しても反映されます。</p>
<p>文字の色を指定するサンプル</p>
<pre><code>// 文字の塗りと線の色を指定する
var txtObj = activeDocument.textFrames.add();
txtObj.top = -20;
txtObj.left = 10;
txtObj.contents = "イラストレーター";
txtObj.characters[0].stroked = true;
txtObj.characters[0].strokeColor = setCMYKColor(0,100,0,0);   // マゼンタで縁取り
txtObj.characters[0].fillColor = setCMYKColor(0,0,100,0);   // イエローで塗り
txtObj.characters[0].strokeWeight = 0.25;   // 線幅は0.25pt
// CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
    var color = new CMYKColor();
    color.cyan = c;
    color.magenta = m;
    color.yellow = y;
    color.black = k;
    return color;
}</code></pre>
<p>　先頭の文字の塗りと線の色が設定されます。</p>
<figure>
<figcaption>【図】先頭の文字の塗りと線の色が設定される</figcaption>
<img src="images/00577.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-575">
<section>
<h2 id="calibre_link-284"><b>8-4　文字のフォント（書体）を指定する</b></h2>
<p>　文字のフォントを指定するにはアプリケーションオブジェクトのtextFonts配列に格納されたフォントオブジェクトを文字属性のtextFontに指定します。フォント名が日本語であっても内部では英文字名になっています。このため、日本語書体名の場合は英語名で指定する必要があります。例えばMacOS X /OS Xの場合、「ヒラギノ明朝Pro W3」は「HiraMinPro-W3」となります。</p>
<p>文字のフォント（書体）を指定するサンプル</p>
<pre><code>// 文字のフォントを設定する
var txtObj = activeDocument.textFrames.add();
txtObj.top = -20;
txtObj.left = 10;
txtObj.contents = "Illustrator";
var fName = app.textFonts["Times-Bold"];     // Times-Boldフォント
for(var i=0; i&lt;5; i++){ // 先頭5文字だけフォントを変更する
    txtObj.characters[i].characterAttributes.textFont = fName;
}</code></pre>
<p>　先頭の5文字だけフォントが変更されます。</p>
<figure>
<figcaption>【図】先頭の5文字だけフォントが変更される</figcaption>
<img src="images/00356.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-7">
<section>
<h2 id="calibre_link-285"><b>8-5　文字の長体、平体を設定する</b></h2>
<p>　文字の長体、平体を設定するにはテキストフレームオブジェクトのcharacters配列を使います。この配列には1文字ごとの文字オブジェクトが格納されており、horizontalScaleプロパティに倍率（スケール）を設定することで文字に長体、平体を設定することができます。正体（100%）の場合は100となり、半分ならば50、横が2倍サイズなら200の値になります。長体なら100より小さい数を、平体なら100より大きい値を指定します。</p>
<p>文字の長体、平体を設定するサンプル</p>
<pre><code>// 1文字目を長体、2文字目を平体にする
var txtObj = activeDocument.textFrames.add();
txtObj.top = -20;
txtObj.left = 10;
txtObj.contents = "イラストレーター";
txtObj.characters[0].horizontalScale = 50;   // 1文字目は50%
txtObj.characters[1].horizontalScale = 200;   // 2文字目は200%</code></pre>
<p>　1文字目と2文字目の文字の幅が変わります。</p>
<figure>
<figcaption>【図】1文字目と2文字目の文字の幅が変わる</figcaption>
<img src="images/00148.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-31">
<section>
<h2 id="calibre_link-286"><b>8-6　文字のトラッキングを設定する</b></h2>
<p>　文字のトラッキングを設定するにはテキストフレームオブジェクトのcharacters配列を使います。この配列には1文字ごとの文字オブジェクトが格納されており、trackingプロパティにトラッキングの値を設定することができます。trackingプロパティに指定できる値はIllustratorの文字パネルのトラッキングで指定できる値の範囲と同じになります。</p>
<p>　文字の空き調整は他にも以下の表に示すプロパティがあります。</p>
<table>
<caption>【表】文字の空き調整</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ</span>
  </td>
  <td>
    <span>設定内容</span>
  </td>
</tr>
<tr>
  <td>akiLeft</td>
  <td>左側のアキ</td>
</tr>
<tr>
  <td>akiRight</td>
  <td>右側のアキ</td>
</tr>
</tbody>
</table>
<p>文字のトラッキングを設定するサンプル</p>
<pre><code>// 文字のトラッキングを設定する
var txtObj = activeDocument.textFrames.add();
txtObj.top = -20;
txtObj.left = 10;
txtObj.contents = "イラストレーター";
txtObj.characters[0].tracking = -500;   // -500にする
txtObj.characters[1].tracking = 500;   // 200にする</code></pre>
<p>　1文字目と2文字目の文字のトラッキングが変わります。</p>
<figure>
<figcaption>【図】1文字目と2文字目の文字のトラッキングが変わる</figcaption>
<img src="images/00521.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-76">
<section>
<h2 id="calibre_link-287"><b>8-7　文字のカーニングを設定する</b></h2>
<p>　文字のカーニングを設定するにはテキストフレームオブジェクトのcharacters配列を使います。この配列には1文字ごとの文字オブジェクトが格納されており、kerningプロパティにカーニングの値を設定することができます。kerningプロパティに指定できる値はIllustratorの文字パネルのトラッキングで指定できる値の範囲と同じになります。</p>
<p>　文字の空き調整は他にも以下の表に示すプロパティがあります。</p>
<table>
<caption>【表】文字の空き調整</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ</span>
  </td>
  <td>
    <span>設定内容</span>
  </td>
</tr>
<tr>
  <td>akiLeft</td>
  <td>左側のアキ</td>
</tr>
<tr>
  <td>akiRight</td>
  <td>右側のアキ</td>
</tr>
</tbody>
</table>
<p>文字のカーニングを設定するサンプル</p>
<pre><code>// 文字のカーニングを設定する
var txtObj = activeDocument.textFrames.add();
txtObj.top = -20;
txtObj.left = 10;
txtObj.contents = "イラストレーター";
txtObj.characters[1].kerning = 1000;   // 1000にする</code></pre>
<p>　2文字目の文字のカーニングが変わります。</p>
<figure>
<figcaption>【図】2文字目の文字のカーニングが変わる</figcaption>
<img src="images/00412.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-731">
<section>
<h2 id="calibre_link-288"><b>8-8　文字のベースラインを設定する</b></h2>
<p>　文字のベースラインを設定するにはテキストフレームオブジェクトのcharacters配列を使います。この配列には1文字ごとの文字オブジェクトが格納されており、baselineShiftプロパティにベースラインの値を設定することができます。baselineShiftプロパティに指定できる値はIllustratorの文字パネルのベースラインで指定できる値の範囲と同じになります。</p>
<p>文字のベースラインを設定するサンプル</p>
<pre><code>// 文字のベースラインを設定する
var txtObj = activeDocument.textFrames.add();
txtObj.top = -20;
txtObj.left = 10;
txtObj.contents = "イラストレーター";
txtObj.characters[2].baselineShift = 10;     // 10にする</code></pre>
<p>　3文字目の文字のベースラインが変わります。</p>
<figure>
<figcaption>【図】3文字目の文字のベースラインが変わる</figcaption>
<img src="images/00104.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-130">
<section>
<h2 id="calibre_link-289"><b>8-9　英文字のキャップスを設定する</b></h2>
<p>　英文字のキャップスを設定するには文字または段落のcapitalizationプロパティに下表に示す値を設定します。</p>
<table>
<caption>【表】指定可能な値</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ</span>
  </td>
  <td>
    <span>設定内容</span>
  </td>
</tr>
<tr>
  <td>FontCapsOption.ALLCAPS</td>
  <td>全て大文字</td>
</tr>
<tr>
  <td>FontCapsOption.ALLSMALLCAPS</td>
  <td>全て小文字</td>
</tr>
<tr>
  <td>FontCapsOption.NORMALCAPS</td>
  <td>通常</td>
</tr>
<tr>
  <td>FontCapsOption.SMALLCAPS</td>
  <td>小文字を大文字にし、小さくする</td>
</tr>
</tbody>
</table>
<p>英文字のキャップスを設定するサンプル</p>
<pre><code>// 文字のキャップスを設定する
var txtObj = activeDocument.textFrames.add();
txtObj.top = -20;
txtObj.left = 10;
txtObj.contents = "Adobe illustrator CC 2014";
for(var i=0; i&lt;10; i++){
    txtObj.characters[i].capitalization = FontCapsOption.ALLCAPS;     // 全部大文字
}</code></pre>
<p>　先頭から10文字分の英文字が大文字になります。</p>
<figure>
<figcaption>【図】先頭から10文字分の英文字が大文字になる</figcaption>
<img src="images/00407.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-670">
<section>
<h2 id="calibre_link-290"><b>8-10　文字のスタイル名を求める</b></h2>
<p>　文字のスタイル名を求めるには文字オブジェクト(characters)のcharacterStyles配列を参照します。文字スタイル名はcharacterStyles配列に格納されているcharacterStylesオブジェクトのnameプロパティを参照します。</p>
<p>文字のスタイル名を求めるサンプル</p>
<pre><code>// 選択されたテキストフレームの最初の文字のスタイルを求める
var sList = activeDocument.selection[0].characters[0].characterStyles;
var sName = sList[0].name;
alert("最初の文字のスタイル名："+sName);</code></pre>
<p>　最初の1文字目のスタイルがアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】最初の1文字目のスタイルが表示される</figcaption>
<img src="images/00281.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-588">
<section>
<h2 id="calibre_link-291"><b>8-11　選択された文字を縦中横にする</b></h2>
<p>　選択された文字を縦中横にするには文字の属性であるbaselineDirectionプロパティにBaselineDirectionType.TateChuYokoを設定します。baselineDirectionプロパティには以下の値を設定することができます。</p>
<table>
<caption>【表】文字の表示方向</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ</span>
  </td>
  <td>
    <span>設定内容</span>
  </td>
</tr>
<tr>
  <td>BaselineDirectionType.Standard</td>
  <td>標準（通常の文字組の流れ。縦組みの場合は英文字は縦餓鬼用に回転した状態になる）</td>
</tr>
<tr>
  <td>BaselineDirectionType.TateChuYoko</td>
  <td>縦中横</td>
</tr>
<tr>
  <td>BaselineDirectionType.VerticalRotated</td>
  <td>時計回りに90度回転（欧文回転。英文字は横倒しになる）</td>
</tr>
</tbody>
</table>
<p>選択された文字を縦中横にするサンプル</p>
<pre><code>// 選択された文字を縦中横にする
var selObj = activeDocument.selection;
selObj.baselineDirection = BaselineDirectionType.TateChuYoko;</code></pre>
<p>　縦中横にしたい文字を選択します。</p>
<figure>
<figcaption>【図】縦中横にしたい文字を選択</figcaption>
<img src="images/00061.jpeg" />
</figure>
<p>　スクリプトを実行すると選択した文字が縦中横になります。</p>
<figure>
<figcaption>【図】選択した文字が縦中横になる</figcaption>
<img src="images/00446.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-617">
<section>
<h2 id="calibre_link-292"><b>8-12　選択された英数字や記号を縦書き用に回転させる</b></h2>
<p>　選択された英数字や記号を縦書き用に回転させるには文字の属性であるbaselineDirectionプロパティにBaselineDirectionType.Standardを設定します。BaselineDirectionType.VerticalRotatedではなくBaselineDirectionType.Standardを設定する点に注意してください。</p>
<p>　baselineDirectionプロパティには以下の値を設定することができます。</p>
<table>
<caption>【表】文字の表示方向</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ</span>
  </td>
  <td>
    <span>設定内容</span>
  </td>
</tr>
<tr>
  <td>BaselineDirectionType.Standard</td>
  <td>標準（通常の文字組の流れ。縦組みの場合は英文字は縦餓鬼用に回転した状態になる）</td>
</tr>
<tr>
  <td>BaselineDirectionType.TateChuYoko</td>
  <td>縦中横</td>
</tr>
<tr>
  <td>BaselineDirectionType.VerticalRotated</td>
  <td>時計回りに90度回転（欧文回転。英文字は横倒しになる）</td>
</tr>
</tbody>
</table>
<p>選択された英数字や記号を縦書き用に回転させるサンプル</p>
<pre><code>// 選択された英数字や記号を縦書き用に回転させる
var selObj = activeDocument.selection;
selObj.baselineDirection = BaselineDirectionType.Standard;</code></pre>
<p>　縦書きで英文字を通常の表示にしたい文字を選択します。日本語など他の文字が含まれていても問題ありません。</p>
<figure>
<figcaption>【図】縦書きで英文字を通常の表示にしたい文字を選択する</figcaption>
<img src="images/00230.jpeg" />
</figure>
<p>　スクリプトを実行すると選択した英数字が縦書きに調整されます。</p>
<figure>
<figcaption>【図】選択した英数字が縦書きに調整される</figcaption>
<img src="images/00039.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-601">
<section>
<h2 id="calibre_link-293"><b>8-13　選択された文字を割注にする</b></h2>
<p>　選択された文字を割注にするには文字の属性であるwariChuEnabledプロパティにtrueを設定します。falseを設定すると割注は解除されます。</p>
<p>選択された文字を割注にするサンプル</p>
<pre><code>// 選択された文字を割注にする
var selObj = activeDocument.selection;
selObj.wariChuEnabled = true;</code></pre>
<p>　割注にしたい文字を選択します。</p>
<figure>
<figcaption>【図】割注にしたい文字を選択する</figcaption>
<img src="images/00398.jpeg" />
</figure>
<p>　スクリプトを実行すると選択した文字が割注として設定されます。</p>
<figure>
<figcaption>【図】選択した文字が割注として設定される</figcaption>
<img src="images/00185.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-646">
<section>
<h2 id="calibre_link-294"><b>8-14　平仮名・片仮名と漢字に別々のフォントを指定する</b></h2>
<p>　平仮名・片仮名と漢字に別々のフォントを指定するにはreplace()メソッドを使います。replace()メソッドの1番目のパラメーターに対象となる文字の正規表現を指定します。平仮名と片仮名の場合は「[ぁ-ん|ァ-ン]+」のように指定します。漢字の場合は「一-龠]+」となります。文字のフォントを変更するにはcharacters配列のtextFontプロパティにフォントオブジェクトを設定します。フォントオブジェクトはapp.textFonts["KozMinPro-Regular"]のようにしてtextFonts()メソッドを使って指定します。</p>
<p>　なお、平仮名、片仮名で特殊なものは、サンプルのような正規表現では処理できません。特殊な仮名まで指定する場合は「選択（文字／TextRange）」の「複数のテキストフレームで平仮名のみ選択する」「複数のテキストフレームで片仮名のみ選択する」を参照してください。</p>
<p>平仮名・片仮名と漢字に別々のフォントを指定するサンプル</p>
<pre><code>// 平仮名・片仮名と漢字に別々のフォントを指定する
var fontKana = app.textFonts["KozMinPro-Regular"];   // 小塚明朝Pro-R
var fontKanji = app.textFonts["KozGoPro-Medium"];   // 小塚ゴシックPro-M
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    // 平仮名と片仮名のフォントを変更する
    selObj[i].contents.replace(/[ぁ-ん|ァ-ン]+/g, function(str, ptr){
        for(var j=0; j&lt;str.length; j++){
            selObj[i].characters[ptr+j].textFont = fontKana;
        }
        return str;
    });
    // 漢字のフォントを変更する
    selObj[i].contents.replace(/[一-龠]+/g, function(str, ptr){
        for(var j=0; j&lt;str.length; j++){
            selObj[i].characters[ptr+j].textFont = fontKanji;
        }
        return str;
    });
}</code></pre>
<p>　フォントを設定するテキストフレームを選択します。</p>
<figure>
<figcaption>【図】フォントを設定するテキストフレームを選択する</figcaption>
<img src="images/00572.jpeg" />
</figure>
<p>　平仮名・片仮名と漢字で別々のフォントが設定されます。</p>
<figure>
<figcaption>【図】平仮名・片仮名と漢字で別々のフォントが設定される</figcaption>
<img src="images/00480.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-703">
<section>
<h2 id="calibre_link-295"><b>8-15　選択されたテキストフレーム内の数値を3桁のカンマで区切る</b></h2>
<p>　選択されたテキストフレーム内の数値を3桁のカンマで区切るには正規表現のreplace()メソッドを使います。正規表現を使い数値にマッチするようにします。数値にマッチさせるには\d+と指定します。replace()メソッドの2番目のパラメーターに関数を指定し、その関数内で、3桁ごとにカンマで区切る処理を行います。3桁ごとに区切る処理は関数にしてあり、4桁ごとに区切ったり、区切る文字を変更することもできます。</p>
<p>　3桁ごとに区切った処理を行った後にreturnで変更した文字を返します。最後にcontentsプロパティに代入すれば数値だけが3桁で区切られます。</p>
<p>選択されたテキストフレーム内の数値を3桁のカンマで区切るサンプル</p>
<pre><code>// 選択されたテキストフレーム内の数値を3桁のカンマで区切る
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    if (selObj[i].typename != "TextFrame"){ continue; } // テキストフレーム以外は処理しない
    // 正規表現で数値を検索する
    selObj[i].contents = selObj[i].contents.replace(/\d+/g, function (str, ptr){
        return formatNum(str);
    });
}
// 3桁ごとにカンマ(,)を入れる
function formatNum(num){  
    var str = new String(num);  
    var n = "";  
    var sp = 3; // 3桁の場合。4桁で処理する場合は4にする
    var spStr = ",";    // 区切る文字を指定する
    var count = 0;  
    for (var i=str.length-1; i&gt;=0; i--){  
        n = str.charAt(i) + n;  
        count++;  
        if (((count % sp) == 0) &amp;&amp; (i != 0)) n = spStr + n;  
    }  
    return n;  
}</code></pre>
<p>　数値を3桁ごとに区切りたいテキストフレームを選択します。テキストフレーム以外が選択されていても問題ありません。</p>
<figure>
<figcaption>【図】数値を3桁ごとに区切りたいテキストフレームを選択する</figcaption>
<img src="images/00076.jpeg" />
</figure>
<p>　数値が3桁ごとに区切られます。</p>
<figure>
<figcaption>【図】数値が3桁ごとに区切られる</figcaption>
<img src="images/00278.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-752">
<section>
<div>
<h1 id="calibre_link-296"><b>第9章　正規表現</b></h1>
</div>
<p>　この章では、高度な文字列処理を行う正規表現に関するサンプルを示し、解説します。複雑な文字の検索や置換などを行うことができます。</p>
</section>
</div>
<div id="calibre_link-741">
<section>
<h2 id="calibre_link-297"><b>9-1　特定の文字が含まれるかどうかを調べる</b></h2>
<p>　特定の文字が含まれるかどうかを調べるには正規表現のmatch()メソッドを使います。match()メソッドのパラメーターには調べたい文字列を/と/で囲んで指定します。この文字列は正規表現のルールを使うことができます。文字列は正規表現オブジェクトなので/～/の代わりにnew RegExp("CC2014")のように指定することもできます。</p>
<p>　match()メソッドはマッチした文字があれば結果を配列に入れて返します。もし、マッチする文字がない場合にはnullを返します。文字が含まれるかどうかはmatch()メソッドからの戻り値を調べればよいことになります。nullなら見つからなかった、配列なら見つかったということになります。</p>
<p>　macth()メソッドの2番目のパラメーターには以下の表に示すオプション（検索条件）を指定することができます。オプションを同時に指定したい場合はmatch(/sample/gim)やnew RegExp("sample","gim")のようにします。</p>
<table>
<caption>【表】指定できるオプション（検索条件）</caption>
<tbody>
<tr>
  <td>
    <span>オプション</span>
  </td>
  <td>
    <span>検索条件</span>
  </td>
</tr>
<tr>
  <td>g</td>
  <td>グローバルマッチ／全文検索する</td>
</tr>
<tr>
  <td>i</td>
  <td>英語の大文字小文字を無視する</td>
</tr>
<tr>
  <td>m</td>
  <td>行・段落単位で処理する（行頭・行末マッチの処理が変わる）</td>
</tr>
</tbody>
</table>
<p>特定の文字が含まれるかどうかを調べるサンプル</p>
<pre><code>// 選択されたテキストフレームに「2014」という文字が含まれるか調べる
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var text = selObj[i].contents;   // テキストフレーム内の文字を読み出し
    var result = text.match(/2014/);
    if(result){
        alert("文字が含まれています");
    }else{
        alert("文字は含まれていませんでした");
    }
}</code></pre>
<p>　選択されたテキストフレームに文字があるかどうかを調べ、結果をアラートダイアログに表示します。</p>
<figure>
<figcaption>【図】テキストフレームに文字があるかどうかの結果が表示される</figcaption>
<img src="images/00314.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-140">
<section>
<h2 id="calibre_link-298"><b>9-2　マッチした文字の数を調べる</b></h2>
<p>　マッチした文字の数を調べるには正規表現のmatch()メソッドを使います。個数を調べる場合、match()メソッドのオプションでグローバルマッチを指定します。macth()メソッドは検索した結果を配列で返すためlengthプロパティの値が、そのまま一致した数になります。</p>
<p>マッチした文字の数を調べるサンプル</p>
<pre><code>// 選択されたテキストフレームに「2014」という文字がいくつ含まれるか調べる
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var text = selObj[i].contents;   // テキストフレーム内の文字を読み出し
    var result = text.match(/2014/g);   // グローバルマッチにして調べる
    if(result){
        alert(result.length+"個ありました");
    }else{
        alert("文字は含まれていませんでした");
    }
}</code></pre>
<p>　選択されたテキストフレームに含まれていた該当する文字の総数をアラートダイアログに表示します。</p>
<figure>
<figcaption>【図】選択されたテキストフレームに含まれていた該当する文字の総数が表示される</figcaption>
<img src="images/00307.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-735">
<section>
<h2 id="calibre_link-299"><b>9-3　マッチした文字を取得する</b></h2>
<p>　マッチした文字を取得するにはmatch()メソッドが返す配列内容を参照します。配列にはマッチした順番に該当する文字列が入ります。配列なのでresult[2]のように番号を使って指定し、マッチした文字列を読み出すことができます。サンプルでは201で始まる4桁の数字のみマッチする検索を行い結果を表示します。</p>
<p>マッチした文字を取得するサンプル</p>
<pre><code>// 選択されたテキストフレームで「201」で始まる4文字を検索し結果を表示する
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var txt = "";   // 結果を入れる変数を用意する
    var text = selObj[i].contents;   // テキストフレーム内の文字を読み出し
    var result = text.match(/201\d/g);   // 201で始まる4文字の数字にマッチ
    if(result){
        for(var j=0; j&lt;result.length; j++){
            txt = txt + result[j] + "\r";
        }
    }else{
          alert("文字は含まれていませんでした");
     }
}
var txtObj = activeDocument.textFrames.add();   // 表示するテキストフレームを作成する
txtObj.top = -10;
txtObj.contents = txt;</code></pre>
<p>　選択されたテキストフレームに含まれていた該当する文字の一覧をドキュメント上に表示します。</p>
<figure>
<figcaption>【図】選択されたテキストフレームに含まれていた該当する文字の一覧が表示される</figcaption>
<img src="images/000487.gif" />
</figure>
</section>
</div>
<div id="calibre_link-81">
<section>
<h2 id="calibre_link-300"><b>9-4　文字を置換する</b></h2>
<p>　文字を置換するにはreplace()メソッドを使います。replace()メソッドには2つのパラメーターを指定できます。最初のパラメーターが正規表現文字列になります。例えばAで始まる3文字にマッチさせる場合は/A../と指定します。2番目のパラメーターは置換後の文字列になります。ただし、2番目のパラメーターに関数を指定した場合は、関数からの戻り値が置換文字になります。</p>
<p>文字を置換するサンプル</p>
<pre><code>// 選択されたテキストフレーム内の全ての「2014」の文字を「2015」に置換する
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var text = selObj[i].contents;     // テキストフレーム内の文字を読み出す
    selObj[i].contents = text.replace(/2014/g, "2015"); // 置換する
}</code></pre>
<p>　テキストフレームを選択します。</p>
<figure>
<figcaption>【図】テキストフレームを選択する</figcaption>
<img src="images/00274.jpeg" />
</figure>
<p>　該当する文字が置換されます。</p>
<figure>
<figcaption>【図】該当する文字が置換される</figcaption>
<img src="images/00057.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-625">
<section>
<h2 id="calibre_link-301"><b>9-5　より高度な置換処理を行う（西暦年を平成に変換）</b></h2>
<p>　replace()メソッドを使うと、より高度な置換処理を行うことができます。通常replace()メソッドの最初のパラメーターに検索対象となる正規表現の文字を指定し、2番目のパラメーターに置換する文字列を指定します。より高度な置換処理を行うにはreplace()メソッドの2番目のパラメーターに関数を指定します。関数を指定すると、関数からの戻り値が置換文字列となります。関数には最初のパラメーターに正規表現でマッチした文字列、2番目のパラメーターにはマッチした文字列内での位置、最後のパラメーターには全体の文字列が渡されます。</p>
<p>　サンプルでは選択したテキストフレーム内にある4桁の数値を西暦年数と見なして平成の年数に置換します。また、その際、数値の前に平成の文字を付加します。</p>
<p>より高度な置換処理を行う（西暦年を平成に変換する）サンプル</p>
<pre><code>// 西暦4桁を平成2桁の年号に変換する
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var text = selObj[i].contents;   // テキストフレーム内の文字を読み出す
    selObj[i].contents = text.replace(/\d{4}/g, function(str, ptr){
        var year = parseInt(str);   // 4桁の整数値にする
        year = year - 1988; // 平成に変換する
        return "平成"+year;
    });
}</code></pre>
<p>　西暦年数4桁が含まれるテキストフレームを選択します。</p>
<figure>
<figcaption>【図】西暦年数4桁が含まれるテキストフレームを選択する</figcaption>
<img src="images/00257.jpeg" />
</figure>
<p>　西暦年数が平成の年数に置換されます。</p>
<figure>
<figcaption>【図】西暦年数が平成の年数に置換される</figcaption>
<img src="images/00226.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-25">
<section>
<div>
<h1 id="calibre_link-302"><b>第10章　図形</b></h1>
</div>
<p>　この章では、Illustratorで描画できる基本図形に関するサンプルを示し、解説します。四角形や直線、ベジエ曲線などを描画することができます。なお、複雑な図形に関しては次章のパス／図形を参照してください。</p>
</section>
</div>
<div id="calibre_link-78">
<section>
<h2 id="calibre_link-303"><b>10-1　四角形を描く</b></h2>
<p>　四角形を描くにはドキュメントオブジェクトのpathItems.rectangle()メソッドを使います。rectangle()のパラメーターは以下の書式が示すように5つあります（5つ目は予備で用意されているだけで使用されていません）。最初のパラメーターがY座標、2番目のパラメーターがX座標、3番目のパラメーターが横幅、4番目のパラメーターが縦幅になります。いずれも数値で指定します。その際の単位はポイントになります。</p>
<p>
<strong><b>【書式】</b></strong>
</p>
<p>
<span>rectangle(Y座標, X座標, 横幅, 縦幅, 予備)</span>
</p>
<p>四角形を描くサンプル</p>
<pre><code>// 四角形を描く
var rectObj = activeDocument.pathItems.rectangle(-10, 30, 150, 100);
rectObj.fillColor = setCMYKColor(60, 0, 60, 0);
rectObj.stroked = true;       // 線を表示する
rectObj.strokeWidth = 4;   // 線の幅を指定する
rectObj.strokeColor = setCMYKColor(0, 0, 0, 100);
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
    var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}</code></pre>
<p>　四角形が描画されます。</p>
<figure>
<figcaption>【図】実行後の描画</figcaption>
<img src="images/000016.gif" />
</figure>
</section>
</div>
<div id="calibre_link-726">
<section>
<h2 id="calibre_link-304"><b>10-2　角丸四角形を描く</b></h2>
<p>　角丸四角形を描くにはドキュメントオブジェクトのpathItems.roundedRectangle()メソッドを使います。roundedRectangle()のパラメーターは以下の書式が示すように7つあります（7つ目は予備で用意されているだけで使用されていません）。最最初のパラメーターがY座標、2番目のパラメーターがX座標、3番目のパラメーターが横幅、4番目のパラメーターが縦幅、5番目のパラメーターが横の角丸半径、6番目のパラメーターが縦の角丸半径になります。いずれも数値で指定し単位はポイントになります。</p>
<p>
<strong><b>【書式】</b></strong>
</p>
<p>
<span>roundedRectangle(Y座標, X座標, 横幅, 縦幅, 横の角丸半径, 縦の角丸半径, 予備)</span>
</p>
<p>角丸四角形を描くサンプル</p>
<pre><code>// 角丸四角形を描く
var rectObj = activeDocument.pathItems.roundedRectangle(-20, 40, 150, 100, 20, 10);
rectObj.fillColor = setCMYKColor(60, 0, 60, 0);
rectObj.stroked = true;       // 線を表示する
rectObj.strokeWidth = 4;   // 線の幅を指定する
rectObj.strokeColor = setCMYKColor(0, 0, 0, 100);
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
    var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}</code></pre>
<p>　角丸四角形が描画されます。</p>
<figure>
<figcaption>【図】実行後の描画</figcaption>
<img src="images/000393.gif" />
</figure>
</section>
</div>
<div id="calibre_link-8">
<section>
<h2 id="calibre_link-305"><b>10-3　楕円形を描く</b></h2>
<p>　楕円形を描くにはドキュメントオブジェクトのpathItems.ellipse()メソッドを使います。ellipse()のパラメーターは以下の書式が示すように6つあります（5つ目は予備で用意されているだけで使用されていません。デフォルトではfalseが指定されています）。最初のパラメーターがY座標、2番目のパラメーターがX座標、3番目のパラメーターが横幅、4番目のパラメーターが縦幅、5番目のパラメーターが予備、6番目の内側に描くか外側に描くかを指定するフラグになります。1~4番目のパラメーターは数値で指定し単位はポイントになります。5番目のパラメーターはfalseを指定します。6番目は楕円をどのように描くかを指定するフラグです。trueを指定すると指定した幅の内側に収まるように描かれます。falseを指定すると、指定した四角形の角の点が楕円の円弧に接するように描かれます。</p>
<p>
<strong><b>【書式】</b></strong>
</p>
<p>
<span>ellipse(Y座標, X座標, 横幅, 縦幅, 予備, 描画方法)</span>
</p>
<p>円形を描くサンプル</p>
<pre><code>// 楕円形を描く
var ellipseObj = activeDocument.pathItems.ellipse(20, 10, 150, 100, false, true);
ellipseObj.fillColor = setCMYKColor(60, 0, 60, 0);
ellipseObj.stroked = true;     // 線を表示する
ellipseObj.strokeWidth = 4;   // 線の幅を指定する
ellipseObj.strokeColor = setCMYKColor(0, 0, 0, 100);
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
    var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}</code></pre>
<p>　楕円形が描画されます。</p>
<figure>
<figcaption>【図】実行後の描画</figcaption>
<img src="images/000180.gif" />
</figure>
</section>
</div>
<div id="calibre_link-663">
<section>
<h2 id="calibre_link-306"><b>10-4　多角形を描く</b></h2>
<p>　多角形を描くにはドキュメントオブジェクトのpathItems.polygon()メソッドを使います。polygon()のパラメーターは以下の書式が示すように5つあります（5つ目は予備で用意されているだけで使用されていません。デフォルトではfalseが指定されています）。最初のパラメーターが多角形の中心のX座標、2番目のパラメーターが中心のY座標、3番目のパラメーターが半径、4番目のパラメーターが頂点数になります。いずれもパラメーターは数値で指定します。単位はポイントになります。</p>
<p>
<strong><b>【書式】</b></strong>
</p>
<p>
<span>polygon(中心X座標, 中心Y座標, 半径, 頂点数, 予備)</span>
</p>
<p>多角形を描くサンプル</p>
<pre><code>// 多角形を描く
var polygonObj = activeDocument.pathItems.polygon(100, -80, 50, 6);
polygonObj.fillColor = setCMYKColor(60, 0, 60, 0);
polygonObj.stroked = true;     // 線を表示する
polygonObj.strokeWidth = 4;   // 線の幅を指定する
polygonObj.strokeColor = setCMYKColor(0, 0, 0, 100);
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
    var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}</code></pre>
<p>　多角形が描画されます。</p>
<figure>
<figcaption>【図】実行後の描画</figcaption>
<img src="images/000569.gif" />
</figure>
</section>
</div>
<div id="calibre_link-67">
<section>
<h2 id="calibre_link-307"><b>10-5　星形を描く</b></h2>
<p>　星形を描くにはドキュメントオブジェクトのpathItems.star()メソッドを使います。star()のパラメーターは以下の書式が示すように6つあります（6つ目は予備で用意されているだけで使用されていません。デフォルトではfalseが指定されています）。最初のパラメーターが星形の中心のX座標、2番目のパラメーターが中心のY座標、3番目のパラメーターが外側の半径、4番目のパラメーターが内側の半径、5番目のパラメーターが頂点数になります。いずれもパラメーターは数値で指定します。単位はポイントになります。</p>
<p>
<strong><b>【書式】</b></strong>
</p>
<p>
<span>star(中心X座標, 中心Y座標, 外側半径, 内側半径, 頂点数, 予備)</span>
</p>
<p>星形を描くサンプル</p>
<pre><code>// 星形を描く
var starObj = activeDocument.pathItems.star(100, -80, 50, 30, 6);
starObj.fillColor = setCMYKColor(60, 0, 60, 0);
starObj.stroked = true;       // 線を表示する
starObj.strokeWidth = 4;   // 線の幅を指定する
starObj.strokeColor = setCMYKColor(0, 0, 0, 100);
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
    var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}</code></pre>
<p>　星形が描画されます。</p>
<figure>
<figcaption>【図】実行後の描画</figcaption>
<img src="images/000546.gif" />
</figure>
</section>
</div>
<div id="calibre_link-522">
<section>
<h2 id="calibre_link-308"><b>10-6　直線を描く</b></h2>
<p>　直線を描くにはドキュメントオブジェクトのpathItems.add()メソッドを使います。このadd()メソッドはパスオブジェクトを生成し返します。ただし、生成した時点ではパスポイントもアンカーも何もありません。そこでsetEntirePath()メソッドを使ってパスポイントを追加していきます。setEntirePath()には配列形式で作成したいポイントを[X座標, Y座標]として指定します。作成したいパスポイントの数だけ[X座標, Y座標]を指定します。</p>
<p>直線を描くサンプル</p>
<pre><code>// 直線を描く
var lineObj = activeDocument.pathItems.add();
lineObj.setEntirePath([[30, -10],[200, -100]]);
lineObj.stroked = true;       // 線を表示する。塗りは指定しないと「なし」に設定される
lineObj.strokeWidth = 2;
lineObj.strokeColor = setCMYKColor(0, 100, 0, 0);
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
    var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}</code></pre>
<p>　直線が描画されます。</p>
<figure>
<figcaption>【図】実行後の描画</figcaption>
<img src="images/000549.gif" />
</figure>
</section>
</div>
<div id="calibre_link-9">
<section>
<h2 id="calibre_link-309"><b>10-7　連続直線を描く</b></h2>
<p>　連続直線を描くにはドキュメントオブジェクトのpathItems.add()メソッドを使います。基本的に前項の直線を描く方法と同じです。setEntirePath()には配列形式で作成したいポイントを[X座標, Y座標]として複数指定することで連続した直線を描くことができます。</p>
<p>連続直線を描くサンプル</p>
<pre><code>// 連続直線を描く
var lineObj = activeDocument.pathItems.add();
lineObj.setEntirePath([[30, -10],[200, -100], [150, -200], [0, -150]]);
lineObj.filled = false; // 塗りを「なし」にする
lineObj.stroked = true;       // 線を表示する
lineObj.strokeWidth = 2;
lineObj.strokeColor = setCMYKColor(0, 0, 0, 100);
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
    var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}</code></pre>
<p>　連続した直線が描画されます。</p>
<figure>
<figcaption>【図】実行後の描画</figcaption>
<img src="images/000114.gif" />
</figure>
</section>
</div>
<div id="calibre_link-547">
<section>
<h2 id="calibre_link-310"><b>10-8　点線を描く</b></h2>
<p>　点線を描くには直線や四角形を描いた後にstrokeDashesプロパティに配列形式で線分（実線）と間隔を交互に指定していきます。例えば[4, 2]を指定すると4ポイントの線分、2ポイントの間隔に設定されます。配列には最大で6つまでのパラメーターを指定できます。これはIllustratorの線パネルの破線設定と全く同じです。逆に破線を実線に戻したい場合にはstrokeDashesプロパティに[ ]を指定します。つまり空の配列を指定すれば実線になります。</p>
<p>点線を描くサンプル</p>
<pre><code>// 点線を描く
var lineObj = activeDocument.pathItems.add();
lineObj.setEntirePath([[30, -10],[200, -100], [150, -200], [0, -150]]);
lineObj.filled = false; // 塗りを「なし」にする
lineObj.stroked = true;      // 線を表示する
lineObj.strokeWidth = 2;
lineObj.strokeColor = setCMYKColor(0, 0, 0, 100);
lineObj.strokeDashes = [20, 5, 10, 2];  // 線分20、間隔5、線分10、間隔2に設定する
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
    var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}</code></pre>
<p>　点線が描画されます。</p>
<figure>
<figcaption>【図】実行後の描画</figcaption>
<img src="images/000501.gif" />
</figure>
</section>
</div>
<div id="calibre_link-711">
<section>
<h2 id="calibre_link-311"><b>10-9　ベジエ曲線を描く</b></h2>
<p>　ベジエ曲線を描くにはドキュメントオブジェクトのpathItems.add()メソッドを使います。このadd()メソッドはパスオブジェクトを生成し返します。ベジエ曲線の場合、生成されたパスオブジェクトのpathPoints.add()メソッドを使ってアンカーポイントを作成します。add()はパスポイントオブジェクトを返すので、このパスポイントオブジェクトに対して必要な設定を行います。</p>
<p>　アンカーポイントの位置はパスポイントオブジェクトのanchorプロパティに[X座標, Y座標]の配列形式で指定します。パスポイントオブジェクトの左右のハンドル（Illustratorで曲線の傾きを制御する●の位置）はleftDirection、rightDirectionのプロパティで設定します。設定値はアンカーポイントと同じ[X座標, Y座標]の配列形式で指定します。ポイントの種類はpointTypeプロパティに下表で示す2種類のうちどちらかを指定します。</p>
<table>
<caption>【表】ポイントの種類</caption>
<tbody>
<tr>
  <td>
    <span>プロパティの指定</span>
  </td>
  <td>
    <span>ポイントの種類</span>
  </td>
</tr>
<tr>
  <td>PointType.SMOOTH</td>
  <td>スムース</td>
</tr>
<tr>
  <td>PointType.CORNER</td>
  <td>コーナー</td>
</tr>
</tbody>
</table>
<p>ベジエ曲線を描くサンプル</p>
<pre><code>// ベジエ曲線を描く
var bezierObj = activeDocument.pathItems.add();
bezierObj.stroked = true;   // 線を表示する
bezierObj.filled = false;     // 塗りは「なし」
bezierObj.strokeWidth = 2;     // 2ポイントの太さ
bezierObj.strokeColor = setCMYKColor(0, 0, 0, 100);
bezierObj.strokeDashes = [];
// パスポイント1の生成
var pathObj = bezierObj.pathPoints.add();
pathObj.anchor = [0, 0];    // (0,0)に開始座標を設定
pathObj.leftDirection = [-10, -50];
pathObj.rightDirection = [50, -200];
pathObj.pointType = PointType.SMOOTH;
// パスポイント2の生成
pathObj = bezierObj.pathPoints.add();
pathObj.anchor = [300, -200];   // (300, -200)に終了座標を設定
pathObj.leftDirection = [200, -250];
pathObj.rightDirection = [350, -200];
pathObj.pointType = PointType.SMOOTH;// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
    var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}</code></pre>
<p>　ベジエ曲線が描画されます。</p>
<figure>
<figcaption>【図】実行後の描画</figcaption>
<img src="images/000290.gif" />
</figure>
</section>
</div>
<div id="calibre_link-700">
<section>
<h2 id="calibre_link-312"><b>10-10　半円形を描く</b></h2>
<p>　半円形を描くには円形（楕円形）を描いた後にパスポイントを1つ削除します。円形を描いた場合、4つのパスポイントが生成されるので、そのうちのどれか1つを削除すれば半円形になります。その後、円形オブジェクトのclosedプロパティにfalseを設定すると半円形が描かれます。ただし、ハンドルの座標は再設定していないのでパスを閉じた場合には直線にはなりません。直線にしたい場合には座標を適切に設定する必要があります。</p>
<p>半円形を描くサンプル</p>
<pre><code>// 半円形を描く
var ellipseObj = activeDocument.pathItems.ellipse(0, 0, 100, 100, false, true);
ellipseObj.fillColor = setCMYKColor(60, 0, 60, 0);
ellipseObj.stroked = true;     // 線を表示する
ellipseObj.strokeWidth = 2;
ellipseObj.strokeColor = setCMYKColor(0, 0, 0, 100);
ellipseObj.pathPoints[3].remove();  // 最後のポイントを削除する
ellipseObj.closed = false;     // パスを閉じない
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
    var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}</code></pre>
<p>　半円形が描画されます。</p>
<figure>
<figcaption>【図】実行後の描画</figcaption>
<img src="images/000070.gif" />
</figure>
</section>
</div>
<div id="calibre_link-615">
<section>
<h2 id="calibre_link-313"><b>10-11　円弧を描く</b></h2>
<p>　円弧を描くには円形（楕円形）を描いた後にパスポイントを2つ削除します。円形を描いた場合、4つのパスポイントが生成されるので、そのうち2つを削除すれば円弧になります。その際、削除するたびにパスポイント配列が更新されます。サンプルでは配列で同じ参照番号を指定していますが、削除後に1つずつポイントがずれるため結果的に3番目と4番目のポイントが削除されることになります。あとはオブジェクトのclosedプロパティにfalseを設定すると閉じられたパスとなり円弧が描かれます。</p>
<p>円形を描くサンプル</p>
<pre><code>// 円弧を描く
var ellipseObj = activeDocument.pathItems.ellipse(-20, 40, 100, 100, false, true);
ellipseObj.fillColor = new NoColor();
ellipseObj.stroked = true;     // 先にtrueを設定した後で線幅を指定しないとダメ
ellipseObj.strokeWidth = 2;
ellipseObj.strokeColor = setCMYKColor(0, 0, 0, 100);
ellipseObj.pathPoints[2].remove();  // 3番目を削除する
ellipseObj.pathPoints[2].remove();  // 1つずれるので、これが最後のポイントになる。これを削除する
ellipseObj.closed = false;     // パスを閉じない
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
    var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}</code></pre>
<p>　円弧が描画されます。</p>
<figure>
<figcaption>【図】実行後の描画</figcaption>
<img src="images/000455.gif" />
</figure>
</section>
</div>
<div id="calibre_link-14">
<section>
<div>
<h1 id="calibre_link-314"><b>第11章　パス／図形</b></h1>
</div>
<p>　この章では、複雑な図形を描くために必要なパスとパスの属性に関するサンプルを示し、解説します。パスに関するさまざまな処理を行うことができます。</p>
</section>
</div>
<div id="calibre_link-549">
<section>
<h2 id="calibre_link-315"><b>11-1　パスの総数を求める</b></h2>
<p>　パスの総数を求めるにはドキュメントオブジェクトのpathItems配列の長さを求めます。pathItemsにはドキュメント内の全てのパスの情報が格納されています。パスが含まれるレイヤーが非表示になっていてもロックされていても関係なく求めることができます。</p>
<p>　特定のレイヤーのパスの総数を求める場合はlayerオブジェクトのpathItems配列の長さを求めます。アクティブになっているレイヤーのパスの総数を求める場合はサンプルのようにactiveDocument.activeLayerのpathItems.lengthを参照します。</p>
<p>パスの総数を求めるサンプル</p>
<pre><code>// パスの総数を求める
var pObj1 = activeDocument.pathItems;
var pObj2 = activeDocument.activeLayer.pathItems;
alert("パスの総数："+pObj1.length + "\rアクティブレイヤーのパスの総数："+pObj2.length);</code></pre>
<p>　ドキュメント全体のパスの総数とアクティブになっているレイヤーのパスの総数がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】ドキュメント全体のパスの総数と、レイヤーのパスの総数が表示される</figcaption>
<img src="images/00241.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-715">
<section>
<h2 id="calibre_link-316"><b>11-2　選択されたパスのポイントの総数を取得する</b></h2>
<p>　選択されたパスのポイントの総数を取得するには、最初に選択されたオブジェクトがパスかどうかを調べます。パスかどうかを調べるには選択されたオブジェクトのtypenameプロパティを参照します。このtypenameの文字列がPathItemであれば選択されたオブジェクトはパスであるということになります。</p>
<p>　パスオブジェクトであればpathPoints配列にパスの情報が入っているのでlengthプロパティを参照すればパスポイントの総数を求めることができます。なお、パスポイントの総数だけを求めるだけで曲線の傾きを制御する（指定する）ハンドルの座標や総数は、この方法では求めることはできません。</p>
<p>選択されたパスのポイントの総数を取得するサンプル</p>
<pre><code>// 選択されたパスのポイントの総数を取得する
var selObj = activeDocument.selection;
    for(var i=0; i&lt;selObj.length; i++){
    if (selObj[i].typename == "PathItem"){
        alert((i+1)+"番目のパスポイントの総数："+selObj[i].pathPoints.length);
    }
}</code></pre>
<p>　選択されたパスのポイントの総数がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】選択されたパスのポイントの総数が表示される</figcaption>
<img src="images/00028.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-121">
<section>
<h2 id="calibre_link-317"><b>11-3　選択されたパスポイントの座標値を求める</b></h2>
<p>　選択されたパスポイントの座標値を求めるにはpathPoints配列内にあるanchor配列を参照します。anchor配列には[x, y]の順番で座標値が格納されています。この座標値は単位設定に関係なくポイント(pt)の単位になります。</p>
<p>選択されたパスポイントの座標値を求めるサンプル</p>
<pre><code>// 選択されたパスのパスポイントの座標値を表示する
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    if (selObj[i].typename == "PathItem"){
        for(var j=0; j&lt;selObj[i].pathPoints.length; j++){
            var x = selObj[i].pathPoints[j].anchor[0];
            var y = selObj[i].pathPoints[j].anchor[1];
            alert("パスポイントの座標値：("+x+", "+y+")");
        }
    }
}</code></pre>
<p>　選択したパスの座標が次々とアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】選択したパスの座標（1）</figcaption>
<img src="images/00410.jpeg" />
</figure>
<figure>
<figcaption>【図】選択したパスの座標（2）</figcaption>
<img src="images/00195.jpeg" />
</figure>
<figure>
<figcaption>【図】選択したパスの座標（3）</figcaption>
<img src="images/00582.jpeg" />
</figure>
<figure>
<figcaption>【図】選択したパスの座標（4）</figcaption>
<img src="images/00361.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-656">
<section>
<h2 id="calibre_link-318"><b>11-4　選択されたパスポイントのハンドル座標を求める</b></h2>
<p>　選択されたパスポイントのハンドル座標(以下の図1の赤丸と青丸の座標)を求めるにはpathPoints配列内にあるleftDirection配列とrightDirection配列を参照します。どちらの配列にも[x, y]の順番で座標値が格納されています。この座標値は単位設定に関係なくポイント(pt)の単位になります。ハンドルの傾き（回転角度）などの情報は取得できないため、そのような情報が必要な場合は自前で計算する必要があります。</p>
<figure>
<figcaption>【図】座標値とプロパティ</figcaption>
<img src="images/00153.jpeg" />
</figure>
<p>選択されたパスポイントのハンドル座標を求めるサンプル</p>
<pre><code>// 選択されたパスのパスポイントのハンドル座標を表示する
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    if (selObj[i].typename == "PathItem"){
        for(var j=0; j&lt;selObj[i].pathPoints.length; j++){
            var leftX = selObj[i].pathPoints[j].leftDirection[0];   // 左ハンドルの座標値
            var leftY = selObj[i].pathPoints[j].leftDirection[1];
            var rightX = selObj[i].pathPoints[j].rightDirection[0]; // 右ハンドルの座標
            var rightY = selObj[i].pathPoints[j].rightDirection[1];
            alert("左("+leftX+", "+leftY+")、右("+rightX+", "+rightY+")");
        }
    }
}</code></pre>
<p>　選択したパスのハンドル座標が次々とアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】選択したパスのハンドル座標（1）</figcaption>
<img src="images/00542.jpeg" />
</figure>
<figure>
<figcaption>【図】選択したパスのハンドル座標（2）</figcaption>
<img src="images/00319.jpeg" />
</figure>
<figure>
<figcaption>【図】選択したパスのハンドル座標（3）</figcaption>
<img src="images/00502.jpeg" />
</figure>
<figure>
<figcaption>【図】選択したパスのハンドル座標（4）</figcaption>
<img src="images/00495.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-61">
<section>
<h2 id="calibre_link-319"><b>11-5　ドキュメント内のパスを削除する</b></h2>
<p>　ドキュメント内のパスを削除するには、activeDocument.pathItemsのremoveAll()メソッドを使います。ただし、レイヤーで非表示になっているパスに関しては削除されません。このようなパスも削除するにはfor命令を使って全てのパスを走査しロック解除後にremove()メソッドを使って削除します。サブレイヤーも含めて処理する場合は再帰を使って処理する必要があります。</p>
<p>ドキュメント内のパスを削除するサンプル</p>
<pre><code>// レイヤーロックされていないパスを全て削除する
activeDocument.pathItems.removeAll();</code></pre>
<p>　ドキュメント内にパスを描いておきます。</p>
<figure>
<figcaption>【図】ドキュメント内にパスを描いておく</figcaption>
<img src="images/00284.jpeg" />
</figure>
<p>　レイヤーロックされていないパスが全て削除されます。パス以外の画像などは削除されません。</p>
<figure>
<figcaption>【図】レイヤーロックされていないパスが全て削除される</figcaption>
<img src="images/00064.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-37">
<section>
<h2 id="calibre_link-320"><b>11-6　特定のレイヤー内の全てのパスを削除する</b></h2>
<p>　特定のレイヤー内の全てのパスを削除するには、activeDocument.layers["対象レイヤー名"].pathItemsのremoveAll()メソッドを使います。ただし、レイヤーがロックされていたり非表示になっている場合やパスがロックされていると削除できません。</p>
<p>　なお、以下のサンプルではレイヤーと同じ階層のパスのみが削除され他のレイヤーやサブレイヤーのパスは削除されません。</p>
<p>特定のレイヤー内の全てのパスを削除するサンプル</p>
<pre><code>// レイヤー 1にある全てのパスを削除する
try{
    var layObj = activeDocument.layers["レイヤー 1"];
    if (layObj.locked == true){
        alert("レイヤーがロックされているので削除できません");
    }
    if (layObj.visible == false){
        alert("レイヤーが表示されていないので削除できません");
    }
    layObj.pathItems.removeAll();   // レイヤー上のパスを全て削除する
}catch(e){
    alert("指定されたレイヤーがありません");
}</code></pre>
<p>　レイヤー 1にパスを描いておきます。</p>
<figure>
<figcaption>【図】レイヤー 1にパスを描いておく</figcaption>
<img src="images/00450.jpeg" />
</figure>
<p>　レイヤー 1にあるパスが全て削除されます。レイヤー 1の中にあるサブレイヤーにあるパスは削除されません。</p>
<figure>
<figcaption>【図】レイヤー 1にあるパスが全て削除される</figcaption>
<img src="images/00235.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-640">
<section>
<h2 id="calibre_link-321"><b>11-7　特定のパスポイントを削除する</b></h2>
<p>　特定のパスポイントを削除するにはオブジェクトのpathPoints配列で削除したいポイントを指定した後、remove()メソッドを使います。pathPoints[0]とすれば最初のパスポイントを指定したことになります。pathPoints[1]であれば2番目のパスポイントになります。</p>
<p>特定のパスポイントを削除するサンプル</p>
<pre><code>// 円形を描いた後に最初のパスポイントを削除する
var ellipseObj = activeDocument.pathItems.ellipse(0, 0, 100, 100, false, true);
ellipseObj.fillColor = setCMYKColor(60, 0, 60, 0);
ellipseObj.stroked = true;  // 先にtrueを設定した後で線幅を指定する
ellipseObj.strokeWidth = 2;
ellipseObj.strokeColor = setCMYKColor(0, 0, 0, 100);
ellipseObj.pathPoints[0].remove();  // 最初のパスポイントを削除する
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}</code></pre>
<p>　正円を描画した後に最初のパスポイントが削除されます。</p>
<figure>
<figcaption>【図】正円を描画した後に最初のパスポイントが削除される</figcaption>
<img src="images/00021.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-538">
<section>
<h2 id="calibre_link-322"><b>11-8　特定のパスポイントを選択する</b></h2>
<p>　特定のパスポイントを選択するにはオブジェクトのpathPoints配列で選択したいポイントを指定した後、selectedプロパティにPathPointSelection.ANCHORPOINTを入れます。他には以下の部分を選択できます。</p>
<table>
<caption>【表】選択するポイント等の指定</caption>
<tbody>
<tr>
  <td>
    <span>指定</span>
  </td>
  <td>
    <span>選択される部分</span>
  </td>
</tr>
<tr>
  <td>PathPointSelection.ANCHORPOINT</td>
  <td>アンカーポイント</td>
</tr>
<tr>
  <td>PathPointSelection.LEFTDIRECTION</td>
  <td>左ハンドル</td>
</tr>
<tr>
  <td>PathPointSelection.LEFTRIGHTPOINT</td>
  <td>左右のポイント</td>
</tr>
<tr>
  <td>PathPointSelection.NOSELECTION</td>
  <td>選択しない</td>
</tr>
<tr>
  <td>PathPointSelection.RIGHTDIRECTION</td>
  <td>右ハンドル</td>
</tr>
</tbody>
</table>
<p>特定のパスポイントを選択するサンプル</p>
<pre><code>// 円形を描いた後に2番目のパスポイントを削除する
var ellipseObj = activeDocument.pathItems.ellipse(-30, 30, 100, 100, false, true);
ellipseObj.fillColor = setCMYKColor(60, 0, 60, 0);
ellipseObj.stroked = true;  // 先にtrueを設定した後で線幅を指定する
ellipseObj.strokeWidth = 2;
ellipseObj.strokeColor = setCMYKColor(0, 0, 0, 100);
// 左右のアンカーポイントを選択
ellipseObj.pathPoints[1].selected = PathPointSelection.RIGHTDIRECTION;
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}</code></pre>
<p>　正円を描画した後に上のパスポイントの右のハンドルが選択されます。</p>
<figure>
<figcaption>【図】正円を描画した後に上のパスポイントの右のハンドルが選択される</figcaption>
<img src="images/00403.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-702">
<section>
<h2 id="calibre_link-323"><b>11-9　複合パスを作成する</b></h2>
<p>　複合パスを作成するにはドキュメントオブジェクトのcompoundPathItemsオブジェクトのadd()メソッドを使います。add()には指定できるパラメーターはありません。add()により作成された複合パスに対して図形を作成し、複合図形を構築していきます。</p>
<p>複数の図形が重なった場合、その部分をくりぬくかどうかは描画する図形のevenoddプロパティで設定することができます。evenoddプロパティにtrueを指定すると重なった部分をくりぬいた状態にすることができます。このくりぬきの判定にはワインディング規則（※1）か奇遇規則（※2）に従います。</p>
<p>　サンプルでは複合パスを作成し、その複合パスに2つの四角形を作成しています。2つ目の四角形はくりぬくためにevenoddプロパティにtrueを指定しています。evenoddプロパティは後から設定することもできます。つまりプログラムによって自由にくり抜いて表示したり重ねて表示することが可能です。</p>
<p>
<strong><b>※1</b></strong>　パスの描画の向き（ベクトル方向）によって内部か外部かを判定するものです。つまり円であれば時計回りに描くか、反時計回りに描くかによって描画すべき部分か、そうでないかを判定します。同じ方向（ベクトル）に描かれていればくりぬかれず、異なる方向であればくりぬかれることになります。</p>
<p>
<strong><b>※2　</b></strong>奇遇規則はくりぬくかどうかを調べる位置から任意の方向に向かって直線上に移動していった時、何回パスと交差するかで内部か外部かを判定するものです。奇数なら内部（塗りつぶし）、偶数なら外部（くりぬき）である、という判定方法です。</p>
<p>複合パスを作成するサンプル</p>
<pre><code>// 複合パスを作成する
var compObj = activeDocument.compoundPathItems.add();
// 1つめの四角形を描く
var rectObj = compObj.pathItems.rectangle(-20, 10, 150, 100);
// 2つめの四角形を描く
rectObj = compObj.pathItems.rectangle (-40, 50, 70, 60);
rectObj.fillColor = setCMYKColor(0, 0, 100, 0);
rectObj.strokeColor = setCMYKColor(0, 0, 0, 100);
rectObj.stroked = true;
rectObj.strokeWidth = 6;
rectObj.evenodd = true; // trueを設定し外側の四角形を内側の四角形でくりぬく
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}</code></pre>
<p>　中がくり抜かれた四角形が描画されます。</p>
<figure>
<figcaption>【図】中がくり抜かれた四角形が描画される</figcaption>
<img src="images/00190.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-106">
<section>
<h2 id="calibre_link-324"><b>11-10　ロックされていない複合パスを削除する</b></h2>
<p>　複合パスを削除するには複合パスオブジェクトのremove()メソッドを使います。ただし、remove()メソッドはロックされているものやロックされたレイヤー上にあるものは削除できないことがあります。remove()メソッドを使って削除する場合は、compoundPathItems配列の先頭から処理するのではなく末尾から処理するようにしてください。そうしないと削除した時点で配列内容が変化してしまい正しく削除されない複合パスが発生してしまうためです。特定のレイヤー上にある複合パスを削除する場合はactiveDocument.layers["レイヤー 2"].compoundPathItemsとして該当の複合パスにアクセスしremove()メソッドを使います。</p>
<p>ロックされていない複合パスを削除するサンプル</p>
<pre><code>// 複合パスを削除（ロックされたもの、ロックレイヤー上のものは除く）
var compObj = activeDocument.compoundPathItems;
for(var i=compObj.length-1; i&gt;-1; i--){
    try{
        compObj[i].remove();
    }catch(e){}
}</code></pre>
<p>　ドキュメント上にはテキストや画像、各種パスがあります。</p>
<figure>
<figcaption>【図】ドキュメント上にテキスト、画像、各種パスがある</figcaption>
<img src="images/00576.jpeg" />
</figure>
<p>　スクリプトを実行すると、表示されているパスのうち、ロックされていない複合パスのみが削除されます。</p>
<figure>
<figcaption>【図】ロックされていない複合パスが削除される</figcaption>
<img src="images/00355.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-697">
<section>
<h2 id="calibre_link-325"><b>11-11　複合パスの総数を取得する</b></h2>
<p>　複合パスの総数を取得するにはcompoundPathItemsオブジェクトのlengthプロパティを調べます。ドキュメント全体の複合パスの総数を調べるにはドキュメントオブジェクトに対してcompoundPathItems.lengthとします。特定のレイヤーであればlayers[0].compoundPathItems.length、layers["レイヤー 2"].compoundPathItems.lengthのように指定します。アクティブのレイヤーの場合はactiveLayer.compoundPathItems.lengthとして複合パスの総数を取得することができます。</p>
<p>複合パスの総数を取得するサンプル</p>
<pre><code>// 複合パスの総数を表示する
var compObj1 = activeDocument.compoundPathItems;
var compObj2 = activeDocument.layers[0].compoundPathItems;
var compObj3 = activeDocument.activeLayer.compoundPathItems;
alert("ドキュメント内の複合パスの総数："+compObj1.length + "\r" +
    "一番上のレイヤーの複合パスの総数："+compObj2.length + "\r" +
    "アクティブレイヤーの複合パスの総数："+compObj3.length);</code></pre>
<p>　ドキュメント全体や特定のレイヤーにある複合パスの総数が、アラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】ドキュメント全体や特定のレイヤーにある複合パスの総数が表示される</figcaption>
<img src="images/00147.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-746">
<section>
<h2 id="calibre_link-326"><b>11-12　クリッピングパスを作成する</b></h2>
<p>　クリッピングパスを作成するには、グループオブジェクトを作成します。そのグループオブジェクト内にテキストフレームや図形を作成します。最後にクリッピングパスとして使用する図形を作成しグループオブジェクトのclippedプロパティをtrueにします。なお、クリッピングパスとして使用する図形は最前面にあればよく、必ずしもグループオブジェクトで最後に作成する必要はありません。その場合、作成した後でmove()メソッドを使ってグループ内の一番手前になるように処理してください。同様に既存のパスを利用する場合は、グループオブジェクト内に移動させればクリッピングパスとして使用することができます。</p>
<p>クリッピングパスを作成するサンプル</p>
<pre><code>// クリッピングパスを作成する
var clipObj = activeDocument.groupItems.add();  // グループを作成する
var txtObj = clipObj.textFrames.add();  // グループ内にテキストフレームを作成する
txtObj.contents = "アドビイラストレーター";
txtObj.translate(80, -90);  // テキストフレームを(80, -90)に移動
txtObj.paragraphs[0].size = 10; // 文字サイズは10pt
txtObj.paragraphs[0].justification = Justification.CENTER;  // 中央寄せ（センタリング）
var starObj = clipObj.pathItems.star(80, -90, 50, 20, 5);   // 星形を作成
clipObj.clipped = true; // クリッピングする</code></pre>
<p>　文字が星形の中にクリッピングされた状態で表示されます。</p>
<figure>
<figcaption>【図】文字が星形の中にクリッピングされた状態で表示される</figcaption>
<img src="images/00535.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-583">
<section>
<h2 id="calibre_link-327"><b>11-13　ガイドを作成する</b></h2>
<p>　ガイドを作成するには、あらかじめパスを作成しておきます。作成したパスオブジェクトのguidesプロパティにtrueを設定することでガイドとして処理されます。ガイドを解除するにはfalseを設定します。なお、ガイドとして使用するだけであれば線の幅や色などを設定する必要はありません。ガイド設定をすると自動的にガイドの色で表示されます。</p>
<p>ガイドを作成するサンプル</p>
<pre><code>// ガイドを作成する（グリッド状に作成）
var stepY = 20;  // ガイドの間隔（縦）
var stepX = 20;  // ガイドの間隔（横）
var w = activeDocument.width;   // ドキュメントの横幅
var h = activeDocument.height;  // ドキュメントの縦幅
for(var y=0; y&lt;h; y+=stepY){    // 縦方向の直線を描画
    drawGuideLine(0,-y, w,-y);
}
for(var x=0; x&lt;w; x+=stepX){    // 横方向の直線を描画
    drawGuideLine(x,0,x,-h);
}
// 指定された座標間に直線を描く
function drawGuideLine(x1,y1,x2,y2){
    var lineObj = activeDocument.pathItems.add();
    lineObj.setEntirePath([[x1, y1],[x2,y2]]);
    lineObj.guides = true;     // ガイドとして作成する
    lineObj.locked = true;     // ロックする
}</code></pre>
<p>　グリッド状（マス目状）のガイドが表示されます。</p>
<figure>
<figcaption>【図】グリッド状のガイドが表示される</figcaption>
<img src="images/00400.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-749">
<section>
<h2 id="calibre_link-328"><b>11-14　前後関係（Z座標／奥行き）を変更する</b></h2>
<p>　前後関係（Z座標／奥行き）を変更するにはパスオブジェクトのmove()メソッドを使います。move()メソッドの最初のパラメーターには位置を変更するための基準となるオブジェクトを指定します。これはグループオブジェクトやドキュメントオブジェクトなどになります。</p>
<p>　move()の2番目のパラメーターには下表に示す値を指定できます。Illustratorのオブジェクトメニューのアレンジにある「最前面へ」「最背面へ」はドキュメントオブジェクトを基準にして処理を行います。</p>
<table>
<caption>【表】基準位置</caption>
<tbody>
<tr>
  <td>
    <span>パラメーターの値</span>
  </td>
  <td>
    <span>移動場所</span>
  </td>
</tr>
<tr>
  <td>ElementPlacement.INSIDE</td>
  <td>内側</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEATBEGINNING</td>
  <td>最前面へ</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEATEND</td>
  <td>最背面へ</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEBEFORE</td>
  <td>前へ</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEAFTER</td>
  <td>後へ</td>
</tr>
</tbody>
</table>
<p>前後関係（Z座標／奥行き）を変更するサンプル</p>
<pre><code>// 図形を最前面に移動させる
var rect1 = drawRect(140, -100, setCMYKColor(100,0,0,0));   // 水色
var rect2 = drawRect(100, -130, setCMYKColor(0,100,0,0));   // 紫色
var rect3 = drawRect(60, -160, setCMYKColor(100,100,0,0));  // 青色
var rect4 = drawRect(20, -190, setCMYKColor(100,0,100,0));  // 緑色
// 2番目の紫色の四角形を最前面に移動する
rect2.move(activeDocument, ElementPlacement.PLACEATBEGINNING);
// 四角形を描く
function drawRect(x,y, color){
    var rectObj = activeDocument.pathItems.rectangle (y, x, 150, 100);
    rectObj.fillColor = color;
    return rectObj;
}
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
    var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}</code></pre>
<p>　4つの四角形が描画され、紫色の四角形が最前面（最も手前）に移動します。</p>
<figure>
<figcaption>【図】4つの四角形が描画され、紫色の四角形が最前面に移動する</figcaption>
<img src="images/00103.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-120">
<section>
<h2 id="calibre_link-329"><b>11-15　不透明度を指定する</b></h2>
<p>　不透明度を指定するにはオブジェクトのopacityプロパティに0~100までの数値を指定します。25を指定すると25%の不透明度になります。値は0が完全な透明になり、100であれば完全な不透明になります。</p>
<p>不透明度を指定するサンプル</p>
<pre><code>// 四角形の不透明度を指定する
var rectObj1 = activeDocument.pathItems.rectangle (-20, 10, 150, 100);
rectObj1.fillColor = setCMYKColor(0, 50, 100, 0);
rectObj1.stroked = false;     // 線は「なし」
rectObj1.opacity = 20;  // 20%の不透明度
var rectObj2 = activeDocument.pathItems.rectangle (-70, 60, 150, 100);
rectObj2.fillColor = setCMYKColor(0, 50, 100, 0);
rectObj2.stroked = false;     // 線は「なし」
rectObj2.opacity = 40;  // 40%の不透明度
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
    var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}</code></pre>
<p>　2つの四角形が、それぞれ異なる不透明度で重なって表示されます。</p>
<figure>
<figcaption>【図】2つの四角形が、それぞれ異なる不透明度で重なって表示される</figcaption>
<img src="images/00489.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-689">
<section>
<h2 id="calibre_link-330"><b>11-16　描画モードを指定する</b></h2>
<p>　描画モードを指定するにはオブジェクトのblendingModeプロパティに、下表に示すプロパティを設定します。</p>
<table>
<caption>【表】指定できる描画モード</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ名</span>
  </td>
  <td>
    <span>内容</span>
  </td>
</tr>
<tr>
  <td>BlendModes.COLORBLEND</td>
  <td>カラー</td>
</tr>
<tr>
  <td>BlendModes.COLORBURN</td>
  <td>焼き込みカラー</td>
</tr>
<tr>
  <td>BlendModes.COLORDODGE</td>
  <td>覆い焼きカラー</td>
</tr>
<tr>
  <td>BlendModes.DARKEN</td>
  <td>比較（暗）</td>
</tr>
<tr>
  <td>BlendModes.DIFFERENCE</td>
  <td>差の絶対値</td>
</tr>
<tr>
  <td>BlendModes.EXCLUSION</td>
  <td>除外</td>
</tr>
<tr>
  <td>BlendModes.HARDLIGHT</td>
  <td>ハードライト</td>
</tr>
<tr>
  <td>BlendModes.HUE</td>
  <td>色相</td>
</tr>
<tr>
  <td>BlendModes.LIGHTEN</td>
  <td>比較（明）</td>
</tr>
<tr>
  <td>BlendModes.LUMINOSITY</td>
  <td>輝度</td>
</tr>
<tr>
  <td>BlendModes.MULTIPLY</td>
  <td>乗算</td>
</tr>
<tr>
  <td>BlendModes.NORMAL</td>
  <td>通常／ノーマル</td>
</tr>
<tr>
  <td>BlendModes.OVERLAY</td>
  <td>オーバーレイ</td>
</tr>
<tr>
  <td>BlendModes.SATURATIONBLEND</td>
  <td>彩度</td>
</tr>
<tr>
  <td>BlendModes.SCREEN</td>
  <td>スクリーン</td>
</tr>
<tr>
  <td>BlendModes.SOFTLIGHT</td>
  <td>ソフトライト</td>
</tr>
</tbody>
</table>
<p>描画モードを指定するサンプル</p>
<pre><code>// 四角形の描画モードを指定する
var rectObj1 = activeDocument.pathItems.rectangle(-20, 10, 150, 100);
rectObj1.fillColor = setCMYKColor(80, 0, 80, 0);
rectObj1.stroked = false;     // 線は「なし」
rectObj1.blendingMode = BlendModes.NORMAL;   // 通常モードにする
var rectObj2 = activeDocument.pathItems.rectangle(-70, 60, 150, 100);
rectObj2.fillColor = setCMYKColor(0, 80, 0, 0);
rectObj2.stroked = false;     // 線は「なし」
rectObj2.blendingMode = BlendModes.MULTIPLY;   // 乗算モードにする
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
    var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}</code></pre>
<p>　2つの四角形が、それぞれ異なる描画モードで表示されます。</p>
<figure>
<figcaption>【図】2つの四角形が、それぞれ異なる描画モードで表示される</figcaption>
<img src="images/00280.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-22">
<section>
<h2 id="calibre_link-331"><b>11-17　孤立点があるかどうかを調べる</b></h2>
<p>　孤立点があるかどうか調べるにはドキュメント内に含まれる全てのパスのpathPointsの数を調べます。pathPointsが1なら他にポイント（点）がないので、孤立点となります。孤立点を選択状態にするには、パスのロック解除と所属するレイヤーのロック解除をし、さらに表示状態にします。その後、パスオブジェクトのselectedプロパティにtrueを指定します。</p>
<p>孤立点があるかどうかを調べるサンプル</p>
<pre><code>// 孤立点があるかどうか調べ、あれば選択状態にする
var pObj = activeDocument.pathItems;
var count = 0;
for(var i=0; i&lt;pObj.length; i++){
    if(pObj[i].pathPoints.length == 1){
        count = count + 1;  // 孤立点の数をカウントする
        pObj[i].layer.locked = false;   // レイヤーのロックを解除
        pObj[i].layer.visible = true;   // レイヤーを表示する
        pObj[i].locked = false; // ロックを解除する
        pObj[i].selected = true;    // 選択状態にする
    }
}
if (count &gt; 0){
    alert("孤立点が"+count+"個あったので選択しました");
}else{
    alert("孤立点はありませんでした");
}</code></pre>
<p>　ロックされ非表示になっているレイヤー2の中に孤立点があります。</p>
<figure>
<figcaption>【図】非表示になっているレイヤー2の中に孤立点がある</figcaption>
<img src="images/00060.jpeg" />
</figure>
<p>　孤立点がある場合は選択したことを示すアラートダイアログが表示されます。</p>
<figure>
<figcaption>【図】孤立点があったかどうかがアラートダイアログに表示されます。</figcaption>
<img src="images/00445.jpeg" />
</figure>
<p>　孤立点が選択された状態になります。</p>
<figure>
<figcaption>【図】孤立点が選択された状態になる</figcaption>
<img src="images/00229.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-129">
<section>
<h2 id="calibre_link-332"><b>11-18　孤立点を削除する</b></h2>
<p>　孤立点を削除するにはドキュメント内に含まれる全てのパスのpathPointsの数を調べます。pathPointsが1なら他にポイント（点）がないので、孤立点となります。孤立点を削除にするにはパスのロック解除と所属するレイヤーのロック解除をし、さらに表示状態にします。その後、パスオブジェクトのremove()メソッドを使い削除します。</p>
<p>孤立点を削除するサンプル</p>
<pre><code>// 孤立点を削除する
var pObj = activeDocument.pathItems;
var count = 0;
for(var i=pObj.length-1; i&gt;=0; i--){
    if(pObj[i].pathPoints.length == 1){
        count = count + 1;  // 孤立点の数をカウントする
        pObj[i].layer.locked = false;   // レイヤーのロックを解除
        pObj[i].layer.visible = true;   // レイヤーを表示する
        pObj[i].locked = false; // ロックを解除する
        pObj[i].remove();   // 孤立点を削除する
    }
}
if (count &gt; 0){
    alert("孤立点が"+count+"個あったので削除しました");
}else{
    alert("孤立点はありませんでした");
}</code></pre>
<p>　ドキュメント内に複数の孤立点があります。</p>
<figure>
<figcaption>【図】複数の孤立点がある</figcaption>
<img src="images/00203.jpeg" />
</figure>
<p>　削除したかどうかがアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】削除したかどうかが表示される</figcaption>
<img src="images/00589.jpeg" />
</figure>
<p>　孤立点が削除されます。</p>
<figure>
<figcaption>【図】孤立点が削除される</figcaption>
<img src="images/00369.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-620">
<section>
<h2 id="calibre_link-333"><b>11-19　選択した図形のポイントの座標をテキストフレームに表示する</b></h2>
<p>　選択した図形のポイントの座標をテキストフレームに表示するパスオブジェクトのpathPointsから座標値を求めます。pathPointsは配列になっており、ポイントの数だけ情報が格納されています。ポイントの座標値は、そのポイントがある座標値と曲線処理に必要な座標値（左右）があります。ポイントの座標値を表示する場合はanchor配列を参照します。anchor配列はXY座標値が格納されておりanchor[0]にX座標、anchor[1]にY座標が格納されています。</p>
<p>　なお、ベジエ曲線で制御される制御点の座標はleftDirection配列とrightDirection配列から読み出すことができます。どちらもanchor配列と同じようにleftDirection[0]、rightDirection[0]にX座標、leftDirection[1]、rightDirection[1]にY座標が格納されています。</p>
<p>選択した図形のポイントの座標をテキストフレームに表示するサンプル</p>
<pre><code>// 選択した図形のポイントの座標をテキストフレームに表示する
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    if(selObj[i].typename!= "PathItem"){ continue; }    // パス以外は処理しない
    for(var j=0; j&lt;selObj[i].pathPoints.length; j++){
        var left = selObj[i].pathPoints[j].anchor[0];
        var top = selObj[i].pathPoints[j].anchor[1];
        left = left.toFixed(2); // 小数点以下2桁までにする
        top = top.toFixed(2);   // 小数点以下2桁までにする
        drawText(left, top);    // テキストフレームを追加し座標値を表示
    }
}
// テキストフレームを追加し座標値を表示する
function drawText(left, top){
    var tfObj = activeDocument.textFrames.add();
    tfObj.contents = "("+left+", "+top+")";
    tfObj.left = left;
    tfObj.top = top;
    tfObj.paragraphs[0].justification = Justification.CENTER;   // 中央揃え（センタリング）
    tfObj.paragraphs[0].characterAttributes.size = 9;   // 9ptに設定
}</code></pre>
<p>　座標値を表示したい図形を選択します。</p>
<figure>
<figcaption>【図】座標値を表示したい図形を選択する</figcaption>
<img src="images/00159.jpeg" />
</figure>
<p>　図形（パスで構成された図形のみ）のポイント付近に座標値が表示されます。</p>
<figure>
<figcaption>【図】図形（パスで構成された図形のみ）のポイント付近に座標値が表示されます。</figcaption>
<img src="images/00550.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-727">
<section>
<div>
<h1 id="calibre_link-334"><b>第12章　イメージ／画像</b></h1>
</div>
<p>　この章では、Illustratorに配置またはリンクされた画像に関するサンプルを示し、解説します。画像の移動やトレースなど画像に関するさまざまな処理を行うことができます。</p>
</section>
</div>
<div id="calibre_link-74">
<section>
<h2 id="calibre_link-335"><b>12-1　配置された画像の数を求める</b></h2>
<p>　リンクで配置された画像の数を求めるにはplacedItems配列の長さを調べます。配列の長さはlengthプロパティを使えば取得することができます。つまりplacedItems.lengthとすればドキュメント上に配置された画像の総数を求めることができます。ロックされた画像やレイヤー上に配置されロックされた、不可視状態にある画像も総数に含まれます。</p>
<p>　同様にリンクされた画像ではなく埋め込まれた画像の枚数を調べるにはrasterItems配列の長さを調べます。</p>
<p>配置された画像の数を求めるサンプル</p>
<pre><code>// リンク画像と埋め込み画像の数を表示する
var linkNum = activeDocument.placedItems.length;
var embedNum = activeDocument.rasterItems.length;
alert("リンク画像数："+linkNum+"\r埋め込み画像数："+embedNum);</code></pre>
<p>　リンクされた画像と埋め込み画像の総数がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】リンクされた画像と埋め込み画像の総数が表示される</figcaption>
<img src="images/00327.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-557">
<section>
<h2 id="calibre_link-336"><b>12-2　選択された画像を相対的に移動させる</b></h2>
<p>　選択された画像を相対的に移動させるには選択されたオブジェクトが画像かどうかを調べた後、translate()メソッドを使って移動させます。選択されたオブジェクトが画像かどうかはtypenameプロパティで調べることができます。typenameプロパティの文字がRasterItemまたはPlacedItemであれば選択されたオブジェクトが画像ということになります。</p>
<p>　画像の場合、移動させるにはtranslate()メソッドを使い、最初のパラメーターに横の移動量、2番目のパラメーターに縦の移動量を指定します。移動は相対的に移動するため、特定の座標に移動させる場合にはオブジェクトのposition配列に座標値を設定する必要があります。</p>
<p>3番目以降のパラメーターはオブジェクト、塗りつぶしパターン、グラデーションも処理するかどうかをフラグ（trueまたはfalse）を指定します。なお、3番目以降のパラメーターは省略することができます。</p>
<p>選択された画像を相対的に移動させるサンプル</p>
<pre><code>// 選択された画像を相対的に移動させる
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var selType = selObj[i].typename;
    if ((selType == "RasterItem")|| (selType == "PlacedItem")){
        selObj[i].translate(50, -30);
    }
}</code></pre>
<p>
<br />
</p>
<p>　画像を選択します。</p>
<figure>
<figcaption>【図】画像を選択する</figcaption>
<img src="images/00354.jpeg" />
</figure>
<p>　スクリプトを実行すると選択された画像が移動します。</p>
<figure>
<figcaption>【図】選択された画像が移動する</figcaption>
<img src="images/00506.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-667">
<section>
<h2 id="calibre_link-337"><b>12-3　選択された画像をドキュメントの指定座標（絶対座標）に移動させる</b></h2>
<p>　選択された画像をドキュメントの指定座標（絶対座標）に移動させるには選択されたオブジェクトが画像かどうかを調べた後、translate()メソッドを使って移動させます。選択されたオブジェクトが画像かどうかはtypenameプロパティで調べることができます。typenameプロパティの文字がRasterItemまたはPlacedItemであれば選択されたオブジェクトが画像ということになります。</p>
<p>　ドキュメント上の絶対座標に移動させるにはleftプロパティとtopプロパティにX座標、Y座標を設定します。設定する値は単位なしの数値になります。また、一括して座標を設定する場合はposition配列を使うか、app.getTranslationMatrix()のマトリクスを利用します。</p>
<p>選択された画像をドキュメントの指定座標（絶対座標）に移動させるサンプル</p>
<pre><code>// 選択された画像をドキュメント上の絶対座標に移動させる
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var selType = selObj[i].typename;
    if ((selType == "RasterItem")|| (selType == "PlacedItem")){
        selObj[i].left = 50;    // X座標
        selObj[i].top = -30;    // Y座標
    }
}</code></pre>
<p>　画像を選択します。</p>
<figure>
<figcaption>【図】画像を選択する</figcaption>
<img src="images/00294.jpeg" />
</figure>
<figure>
<figcaption>【図】画像が指定した絶対座標に移動する</figcaption>
<img src="images/00072.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-18">
<section>
<h2 id="calibre_link-338"><b>12-4　選択された画像を回転させる</b></h2>
<p>　選択された画像を回転させるには選択されたオブジェクトが画像かどうかを調べた後、rotate()メソッドを使って回転させます。選択されたオブジェクトが画像かどうかはtypenameプロパティで調べることができます。typenameプロパティの文字がRasterItemまたはPlacedItemであれば選択されたオブジェクトが画像ということになります。</p>
<p>　画像を回転させるにはrotate()メソッドを使い、最初のパラメーターに回転角度を指定します。反時計回りに19.69度回転させたいのであればrotate(19.69)と指定します。rotate()は最初のパラメーターだけが必須で、他のパラメーターは省略することができます。なお、rotate()の2番目のパラメーターは位置を変更するかどうかのフラグ、3番目のパラメーターは塗りつぶしパターンも回転させるかどうかのフラグ、4番目のパラメーターはグラデーションも回転させるかどうかのフラグ、5番目のパラメーターは線のパターンも回転させるかどうかのフラグになっています。なお、6番目のパラメーターは、どの位置を基準にして回転させるかを指定し下表のプロパティを指定します。</p>
<table>
<caption>【表】回転位置の指定</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ</span>
  </td>
  <td>
    <span>回転の基準</span>
  </td>
</tr>
<tr>
  <td>Transformation.BOTTOM</td>
  <td>下を基準にして回転</td>
</tr>
<tr>
  <td>Transformation.BOTTOMLEFT</td>
  <td>左下を基準にして回転</td>
</tr>
<tr>
  <td>Transformation.BOTTOMRIGHT</td>
  <td>右下を基準にして回転</td>
</tr>
<tr>
  <td>Transformation.CENTER</td>
  <td>中央を基準にして回転</td>
</tr>
<tr>
  <td>Transformation.DOCUMENTORIGIN</td>
  <td>文書の原点を基準にして回転</td>
</tr>
<tr>
  <td>Transformation.LEFT</td>
  <td>左を基準にして回転</td>
</tr>
<tr>
  <td>Transformation.RIGHT</td>
  <td>右を基準にして回転</td>
</tr>
<tr>
  <td>Transformation.TOP</td>
  <td>上を基準にして回転</td>
</tr>
<tr>
  <td>Transformation.TOPLEFT</td>
  <td>左上を基準にして回転</td>
</tr>
<tr>
  <td>Transformation.TOPRIGHT</td>
  <td>右上を基準にして回転</td>
</tr>
</tbody>
</table>
<p>選択された画像を回転させるサンプル</p>
<pre><code>// 選択された画像を回転させる
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var tp = selObj[i].typename;
    if ((tp == "RasterItem")|| (tp == "PlacedItem")){
        selObj[i].rotate(45, true,true,true,true,Transformation.BOTTOMRIGHT);
    }
}</code></pre>
<p>　画像を選択します。</p>
<figure>
<figcaption>【図】画像を選択する</figcaption>
<img src="images/00273.jpeg" />
</figure>
<p>　スクリプトを実行すると選択された画像が回転します。</p>
<figure>
<figcaption>【図】画像が回転する</figcaption>
<img src="images/00246.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-128">
<section>
<h2 id="calibre_link-339"><b>12-5　選択された中で画像だけ削除する</b></h2>
<p>　パスや画像などさまざまなものが選択された中で画像だけを削除するには、選択されたオブジェクトが画像かどうかを調べる必要があります。画像かどうかは選択されたオブジェクトのtypenameプロパティを調べます。このtypenameプロパティがRatsterItemまたはPlacedItemの文字であれば選択されたものは画像ということになります。あとはremove()メソッドを使って画像を削除します。</p>
<p>選択された中で画像だけ削除するサンプル</p>
<pre><code>// 選択された中で画像を削除する
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var selType = selObj[i].typename;
    if ((selType == "RasterItem") || (selType == "PlacedItem")){
        selObj[i].remove();
    }
}</code></pre>
<p>　図形やテキストなどを選択します。</p>
<figure>
<figcaption>【図】図形やテキストなどを選択する</figcaption>
<img src="images/00032.jpeg" />
</figure>
<p>　スクリプトを実行すると画像だけが削除されます。</p>
<figure>
<figcaption>【図】画像だけが削除される</figcaption>
<img src="images/00415.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-616">
<section>
<h2 id="calibre_link-340"><b>12-6　画像だけ選択する</b></h2>
<p>　画像だけ選択するにはplacedItems配列とrasterItems配列に格納された画像オブジェクトのselectedプロパティにtrueを指定します。ただし、ロックされた画像やロックされたレイヤー上にある画像は選択できません。ロックされた画像を選択しようとするとエラーになるため、サンプルのようにtry...catchを使ってエラーを回避する必要があります。</p>
<p>画像だけ選択するサンプル</p>
<pre><code>// 画像だけ選択する
// リンク画像の選択処理
var images = activeDocument.placedItems;
for (var i=0; i&lt;images.length; i++){
    try {
    images[i].selected = true;  // 選択状態にする
    }catch(e){}
}
// 埋め込み画像の選択処理
images = activeDocument.rasterItems;
for (var i=0; i&lt;images.length; i++){
    try {
    images[i].selected = true;  // 選択状態にする
    }catch(e){}
}</code></pre>
<p>　画像だけが選択されます。</p>
<figure>
<figcaption>【図】画像だけが選択される</figcaption>
<img src="images/00105.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-684">
<section>
<h2 id="calibre_link-341"><b>12-7　JPEG画像や特定の種類の画像だけ選択する</b></h2>
<p>　JPEG画像だけ選択するにはplacedItems配列とrasterItems配列に格納された画像オブジェクトのファイル名を参照します。画像オブジェクトはfileプロパティにファイルオブジェクトが格納されています。ファイル名は、このファイルオブジェクトのnameプロパティに入っています。このファイル名の拡張子がjpgの場合に画像オブジェクトのselectedプロパティにtrueを指定します。ただし、ロックされた画像やロックされたレイヤー上にあるJPEG画像は選択できません。</p>
<p>　なお、ファイルの種類は元ファイルの拡張子で判断しているので、ファイル名に拡張子がない場合は正しく動作しません。</p>
<p>　サンプルではリンク画像と埋め込み画像を別々に処理しています。用途に応じてリンク画像、埋め込み画像の部分だけを抜き出して使用することもできます。</p>
<p>JPEG画像や特定の種類の画像だけ選択するサンプル</p>
<pre><code>// JPEG画像だけ選択する
activeDocument.selection = null;// 全ての選択を解除
// リンク画像を対象に処理する
var images = activeDocument.placedItems;
for (var i=0; i&lt;images.length; i++){
    var ext = images[i].file.name.split(".");
    if (ext[ext.length-1].toLowerCase() == "jpg"){
        try {
            images[i].selected = true;
        }catch(e){}
    }
}
// 埋め込み画像を対象に処理する
images = activeDocument.rasterItems;
for (var i=0; i&lt;images.length; i++){
    var ext = images[i].file.name.split(".");
    if (ext[ext.length-1].toLowerCase() == "jpg"){
        try {
            images[i].selected = true;
        }catch(e){}
    }
}</code></pre>
<p>　スクリプトを実行する前の状態です。PNG画像とJPEG画像が含まれています。</p>
<figure>
<figcaption>【図】PNG画像とJPEG画像が含まれている</figcaption>
<img src="images/00305.jpeg" />
</figure>
<p>　JPEG画像だけが選択されます。</p>
<figure>
<figcaption>【図】JPEG画像だけが選択される</figcaption>
<img src="images/00366.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-88">
<section>
<h2 id="calibre_link-342"><b>12-8　画像を配置する</b></h2>
<p>　画像を配置するにはplacedItemオブジェクトのadd()メソッドを使います。指定できるパラメーターはありません。ドキュメント上に配置する画像はadd()メソッドにより作成されたplacedItemオブジェクトのfileプロパティにファイルオブジェクトを指定します。</p>
<p>画像を配置するサンプル</p>
<pre><code>// 画像を配置する
var fileObj = File.openDialog ("配置画像を選択してください", "*", false);
if (fileObj != null){
    var myImage = activeDocument.placedItems.add();
    myImage.file = fileObj;
}</code></pre>
<p>　画像を選択します。</p>
<figure>
<figcaption>【図】画像を選択する</figcaption>
<img src="images/00156.jpeg" />
</figure>
<p>　ダイアログで選択した画像が配置されます。</p>
<figure>
<figcaption>【図】選択した画像が配置される</figcaption>
<img src="images/00545.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-552">
<section>
<h2 id="calibre_link-343"><b>12-9　連続して画像を配置する</b></h2>
<p>　ユーザーが選択した画像を連続して配置するにはFile.openDialog()メソッドとplacedItemオブジェクトのadd()メソッドを使います。add()メソッドにより画像を配置した後に、fileプロパティに選択した画像のファイルオブジェクトを指定します。</p>
<p>　ユーザーがキャンセルするまで連続して処理を行うにはwhile命令を使います。whileは()内の条件式を満たしている間だけ繰り返し処理を行います。この時にtrueを指定すると無限に繰り返し処理（無限ループ）を行います。File.openDialog()でキャンセルボタンが押された場合はbreakを使い無限ループから抜けます。</p>
<p>連続して画像を配置するサンプル</p>
<pre><code>// キャンセルされるまで連続して画像を配置する
while(true){
    var fileObj = File.openDialog ("配置画像を選択してください", "*", false);
    if (!fileObj){ break; } // キャンセルされたら繰り返しを終了
    var myImage = activeDocument.placedItems.add(); // 画像を配置
    myImage.file = fileObj;
}</code></pre>
<p>　ファイル選択ダイアログで画像を選択します。キャンセルするまで画像を選択することができます。</p>
<figure>
<figcaption>【図】ファイル選択ダイアログで画像を選択する</figcaption>
<img src="images/00323.jpeg" />
</figure>
<p>　キャンセルするとダイアログで選択した画像が連続して配置されます。なお、サンプルではドキュメント中央に配置されてしまうため、この図では分かりやすいように画像を移動させてあります。</p>
<figure>
<figcaption>【図】キャンセルするとダイアログで選択した画像が連続して配置される</figcaption>
<img src="images/00113.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-29">
<section>
<h2 id="calibre_link-344"><b>12-10　選択した画像の数だけ自動的にアートボードを追加して配置する</b></h2>
<p>　選択した画像の数だけ自動的にアートボードを追加して配置するには、いくつかの機能を組み合わせます。まず、配置する画像ファイルはFile.openDialog()メソッドを使いユーザーに選択させます。選択した画像はplacedItems.add()メソッドを使って配置します。その後、アートボード内に収まるように拡大縮小率（スケール）を計算し画像の幅を設定します。</p>
<p>　画像を配置したらartboards.add()メソッドを使ってアートボードを追加します。追加したアートボードの数をカウントする変数を用意しておき、最大数を超えるまで画像の配置とアートボードの追加を行います。</p>
<p>　なお、以下のサンプルで配置した画像をアートボードサイズに合わせる場合は、以下の行を削除してください。</p>
<p>
<span>if ((myImage.width &lt; width) &amp;&amp; (myImage.height &lt; height)){ ratio = 1; }</span>
</p>
<p>　サイズ調整する必要がない場合は、以下の行を削除してください。</p>
<p>
<span>var ratioW = width / myImage.width; // 横の比率を計算</span>
</p>
<p>
<span>var ratioH = height / myImage.height;   // 縦の比率を計算</span>
</p>
<p>
<span>if (ratioW &lt; ratioH){   // 比率に応じて調整</span>
</p>
<p>
<span>　　ratio = ratioW;</span>
</p>
<p>
<span>}else{</span>
</p>
<p>
<span>　　ratio = ratioH;</span>
</p>
<p>
<span>}</span>
</p>
<p>
<span>// サイズ調整するかどうかの判断</span>
</p>
<p>
<span>if ((myImage.width &lt; width) &amp;&amp; (myImage.height &lt; height)){ ratio = 1; }</span>
</p>
<p>
<span>myImage.width = myImage.width * ratio;</span>
</p>
<p>
<span>myImage.height = myImage.height * ratio;</span>
</p>
<p>選択した画像の数だけ自動的にアートボードを追加して配置するサンプル</p>
<pre><code>// 選択した画像の数だけアートボードを追加する
var width = 595.28;    // アートボードの横幅(A4縦)
var height = 841.89;    // アートボードの縦幅(A4縦)
var top = 0;    // 上の座標値（単位はポイント）
var left = 0;  // 左の座標値（単位はポイント）
var bottom = -841.89;  // 下の座標値（単位はポイント）
var right = left + width;    // 右の座標値（単位はポイント）
var maxCountW = 4;  // 横の最大アートボード数
var maxCountH = 3;  // 縦の最大アートボード数
var countW = 0; // すでに最初に1つアートボードが存在するため2に設定
var countH = 1;
while(true){
    var fileObj = File.openDialog("画像ファイルを選択してください");
    if (!fileObj){ break; } // キャンセルされたら終了
    var myImage = activeDocument.placedItems.add(); // 画像を配置
    myImage.file = fileObj;
    myImage.top = top;  // X座標値を設定
    myImage.left = left;    // Y座標値を設定
    var ratioW = width / myImage.width; // 横の比率を計算
    var ratioH = height / myImage.height;   // 縦の比率を計算
    if (ratioW &lt; ratioH){   // 比率に応じて調整
        ratio = ratioW;
    }else{
        ratio = ratioH;
    }
    // サイズ調整するかどうかの判断
    if ((myImage.width &lt; width) &amp;&amp; (myImage.height &lt; height)){ ratio = 1; }
    myImage.width = myImage.width * ratio;
    myImage.height = myImage.height * ratio;
    left = left + width;    // 横一列に配置する
    right = right + width;    // 横一列に配置する
    countW = countW + 1;
    if (countW &gt;= maxCountW){ // 最大の横の枚数を超えた場合
        countW = 0;
        left = 0;   // アートボードのX座標を0に初期化する
        right = left + width;    // アートボードの右側の座標を計算
        top = top - height; // アートボードの上側の座標を計算
        bottom = bottom - height;   // アートボードの下側の座標を計算
        countH = countH + 1;
        if (countH &gt; maxCountH){    // 最大の縦幅を超えた場合
            alert("設定されている最大アートボード数を超えました");
            break;  // 終了
        }
    }
    activeDocument.artboards.add([left, top, right, bottom]);   // アートボードを追加
}</code></pre>
<p>　配置する画像を連続して選択します。</p>
<figure>
<figcaption>【図】配置する画像を連続して選択する</figcaption>
<img src="images/00500.jpeg" />
</figure>
<p>　選択した画像の数だけアートボードが追加されます。</p>
<figure>
<figcaption>【図】選択した画像の数だけアートボードが追加される</figcaption>
<img src="images/00170.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-15">
<section>
<h2 id="calibre_link-345"><b>12-11　配置された画像のファイルパスを取得する</b></h2>
<p>　配置された画像のファイルパスを取得するにはplacedItems配列またはrasterItems配列を参照します。配列内の画像オブジェクトのfileオブジェクトを参照しファイル名を取得します。ファイルオブジェクトなのでnameとすれば画像ファイル名だけが、fullNameとすればパスを含んだ画像ファイル名を取得することができます。取得したファイルパスを変数に追加していきます。全て取得し終わったらテキストフレームを作成し、変数の内容を入れるとファイルパス一覧が表示されます。</p>
<p>　なお、サンプルではMac OS X/OS Xの日本語ファイル名が正しく表示されない不具合を解消するためのconvertKana関数を使用しています。この関数はWindowsでは不要です。Windowsの場合はconvertKana(fileObj.fullName)となっている部分をdecodeURI(fileObj.fullName)としてください。</p>
<p>配置された画像のファイルパスを取得するサンプル</p>
<pre><code>// リンク画像のファイルパスを表示する
var txt = "\r";
var images = activeDocument.placedItems;
for (var i=0; i&lt;images.length; i++){
    var fileObj = images[i].file;
    txt = txt + convertKana(fileObj.fullName) + "\r";
}
activeDocument.textFrames.add().contents = txt;
// ------------------------------------------------------------------
// 日本語ファイル名を変換する関数 (Mac OS X/OS Xのみ。Windowsは不要)
// ------------------------------------------------------------------
function convertKana(filename){
    var dakuten = "%E3%82%99";
    var handakuten = "%E3%82%9A";
    filename = convertKanaSub(File.encode(filename),dakuten,1);
    filename = convertKanaSub(filename,handakuten,2);
    return File.decode(filename);
    // 日本語ファイル名変換サブ処理
    function convertKanaSub(srcName, code, count){
        srcName = srcName.replace(/%E3%82%BF%E3%82%99/g, "%E3%83%80"); // ダだけ特殊処理
        var text = srcName.split(code); // 濁点
        for (var i=0; i&lt;text.length-1; i++){
            var str = text[i];
            if (str == "") continue;
            var body = str.substring(0,str.length-2);
            var footL = str.substring(str.length-2, str.length);
            var hexL = eval("0x"+footL) + count;
            hexL = hexL.toString(16).toUpperCase();
            text[i] = body+hexL;
        }
        return text.join("");
    }
}</code></pre>
<p>　画像のファイルパスがドキュメント上に表示されます。</p>
<figure>
<figcaption>【図】画像のファイルパスがドキュメント上に表示される</figcaption>
<img src="images/00069.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-127">
<section>
<h2 id="calibre_link-346"><b>12-12　選択された画像の座標値を取得する</b></h2>
<p>　選択された画像の座標値を取得するには画像オブジェクトのvisibleBoundsまたはgeometricBoundsを参照します。どちらも配列形式で「左座標, 上座標, 右座標, 下座標」の順番で座標値が格納されています。visibleBoundsとgeometricBoundsの違いは線幅を含めるかどうかです。visibleBoundsは線幅も含めた座標値を返します。geometricBoundsは線幅は除いた座標値を返します。画像の場合は線幅は指定できないため、どちらを使っても同じになります。</p>
<p>選択された画像の座標値を取得するサンプル</p>
<pre><code>// 選択された画像の座標値を表示する
var selObj = activeDocument.selection;
for (var i=0; i&lt;selObj.length; i++){
    alert("visibleBounds : "+selObj[i].visibleBounds + "\r" +
    "geometricBounds : "+selObj[i].geometricBounds);
}</code></pre>
<p>　選択した画像の座標値がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】選択した画像の座標値がアラートダイアログに表示される</figcaption>
<img src="images/00454.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-614">
<section>
<h2 id="calibre_link-347"><b>12-13　選択された画像の幅を取得する</b></h2>
<p>　選択された画像の幅を取得するには画像オブジェクトの幅を示すプロパティを読み出します。横幅はwidthプロパティ、縦幅はheightプロパティに入っています。</p>
<p>　なお、幅を取得するにはマトリクスやバウンディングボックスを利用する方法もあります。</p>
<p>選択された画像の幅を取得するサンプル</p>
<pre><code>// 選択された画像の幅を取得する
var selObj = activeDocument.selection;
for (var i=0; i&lt;selObj.length; i++){
    var w = selObj[i].width;  // 横幅
    var h = selObj[i].height;  // 縦幅
    alert("横幅："+w+", 縦幅："+h);
}</code></pre>
<p>　画像を選択します。</p>
<figure>
<figcaption>【図】画像を選択する</figcaption>
<img src="images/00240.jpeg" />
</figure>
<p>　スクリプトを実行すると画像の横幅と縦幅がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】画像の横幅と縦幅が表示される</figcaption>
<img src="images/00027.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-721">
<section>
<h2 id="calibre_link-348"><b>12-14　選択された画像を指定した幅にする</b></h2>
<p>　選択された画像を指定した幅にするには画像オブジェクトの幅を示すプロパティに値を入れます。横幅はwidthプロパティ、縦幅はheightプロパティに設定します。</p>
<p>　なお、幅を調整するにはマトリクスやバウンディングボックスを利用する方法もあります。</p>
<p>選択された画像を指定した幅にするサンプル</p>
<pre><code>// 選択された画像を指定した幅にする
var selObj = activeDocument.selection;
for (var i=0; i&lt;selObj.length; i++){
    selObj[i].width = 100;  // 横幅を100ptにする
    selObj[i].height = 50;  // 縦幅を50ptにする
}</code></pre>
<p>　画像を選択します。</p>
<figure>
<figcaption>【図】画像を選択する</figcaption>
<img src="images/00409.jpeg" />
</figure>
<p>　スクリプトを実行すると指定した幅になります。</p>
<figure>
<figcaption>【図】指定した幅になる</figcaption>
<img src="images/00461.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-589">
<section>
<h2 id="calibre_link-349"><b>12-15　選択された画像をトレースする</b></h2>
<p>　選択された画像をトレースするには、選択されたオブジェクトが画像かどうかを調べる必要があります。画像かどうかは選択されたオブジェクトのtypenameプロパティを調べます。このtypenameプロパティがRatsterItemまたはPlacedItemの文字であれば選択された図形は画像ということになります。あとはtrace()メソッドを使って画像をトレースします。trace()メソッドにはオプションはなく、実行後にはトレースオブジェクトを返します。各種トレースオプションなどを設定する場合は、trace()メソッドによって返されたトレースオブジェクトのプロパティに必要な値などを指定します。</p>
<p>選択された画像をトレースするサンプル</p>
<pre><code>// 選択された画像をトレースする
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var selType = selObj[i].typename;
    if ((selType == "PlacedItem") || (selType == "RasterItem")){
        selObj[i].trace();
    }
}</code></pre>
<p>　トレースする画像を選択します。</p>
<figure>
<figcaption>【図】トレースする画像を選択する</figcaption>
<img src="images/00581.jpeg" />
</figure>
<p>　スクリプトを実行すると選択した画像がトレースされベクトルデータ（パス）になります。</p>
<figure>
<figcaption>【図】選択した画像がトレースされベクトルデータ（パス）になる</figcaption>
<img src="images/00435.jpeg" />
</figure>
<p>　画像を選択するとトレースされている状態が把握できます。</p>
<figure>
<figcaption>【図】画像を選択するとトレースされている状態が把握できる</figcaption>
<img src="images/00152.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-699">
<section>
<h2 id="calibre_link-350"><b>12-16　選択した画像のまわりに枠を付ける</b></h2>
<p>　選択した画像のまわりに枠を付けるには、枠となる四角形をpathItems.rectangle()メソッドを使って生成します。その際、選択した画像のgeometricBounds配列から読み出した座標値を四角形に設定します。</p>
<p>　サンプルは画像のまわりに枠を付けるだけでなく、選択した図形やテキスト全てに枠を付けることができます。</p>
<p>選択した画像のまわりに枠を付けるサンプル</p>
<pre><code>// 選択した画像のまわりに枠を付ける
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var sRect = selObj[i].geometricBounds;  // 選択した図形の座標値
    var x = sRect[0];
    var y = sRect[1];
    var w = sRect[2] - x;   // 横幅を求める
    var h = y - sRect[3];   // 縦幅を求める
    var rectObj = activeDocument.pathItems.rectangle(y, x, w, h);
    rectObj.filled = false;// 塗りを「なし」にする
    rectObj.stroked = true;// 線を表示する
    rectObj.strokeWidth = 10;   // 線の幅を指定する
    rectObj.strokeColor = setCMYKColor(0, 100, 0, 0);
}
// CMYKカラーを設定し、CMYKカラーオブジェクトを返す
function setCMYKColor(c,m,y,k){
    var CMYK = new CMYKColor();
    CMYK.cyan = c;
    CMYK.magenta = m;
    CMYK.yellow = y;
    CMYK.black = k;
    return CMYK;
}</code></pre>
<p>　枠を付けたい画像や図形を選択します。</p>
<figure>
<figcaption>【図】枠を付けたい画像や図形を選択する</figcaption>
<img src="images/00541.jpeg" />
</figure>
<p>　スクリプトを実行すると画像や図形に枠が付きます。</p>
<figure>
<figcaption>【図】画像や図形に枠が付く</figcaption>
<img src="images/00318.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-734">
<section>
<h2 id="calibre_link-351"><b>12-17　選択した画像の右下に決まった文字列を入れる</b></h2>
<p>　選択した画像の右下に決まった文字列を入れるにはテキストフレームをtextFrames.add()を使って生成し、contentsプロパティに表示する文字列を入れます。あとは、文字のサイズや色などを設定します。画像の右下にテキストフレームを配置するには選択された画像の座標をgeometricBoundsから読み出しテキストフレームの座標値として設定します。なお、テキストフレームの高さは文字のサイズを変更した後に求める必要があります。</p>
<p>選択した画像の右下に決まった文字列を入れるサンプル</p>
<pre><code>// 選択した画像の右下に決まった文字列を入れる
var myText = "(c) K.Furuhata";  // 表示する文字列
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var txtObj = activeDocument.textFrames.add();
    txtObj.contents = myText;    // 表示する文字
    txtObj.paragraphs[0].size = 18; // 文字サイズ
    txtObj.paragraphs[0].fillColor = setRGBColor(255, 0, 0);    // 文字の色
    txtObj.left = selObj[i].geometricBounds[2]; // X座標
    txtObj.top = selObj[i].geometricBounds[3] + txtObj.geometricBounds[1];  // Y座標
    txtObj.paragraphs[0].justification = Justification.RIGHT;   // 右揃えにする
}
// RGBカラーを設定し、RGBカラーオブジェクトを返す
function setRGBColor(r, g, b){
    var RGB = new RGBColor();
    RGB.red = r;
    RGB.green = g;
    RGB.blue = b;
    return RGB;
}</code></pre>
<p>　文字列を入れたい画像を選択します。</p>
<figure>
<figcaption>【図】文字列を入れたい画像を選択する</figcaption>
<img src="images/00110.jpeg" />
</figure>
<p>　スクリプトを実行すると画像の右下に文字列が表示されます。</p>
<figure>
<figcaption>【図】画像の右下に文字列が表示される</figcaption>
<img src="images/00494.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-133">
<section>
<h2 id="calibre_link-352"><b>12-18　選択した画像に今日の日付を入れる</b></h2>
<p>　選択した画像に今日の日付を入れるには、new Date()として今日現在の日付情報を持ったオブジェクトを生成します。これにより生成されたDateオブジェクトから年月日の情報を読み出します。どのようなメソッドで日付情報が読み出せるかを下表に示します。</p>
<p>　日付を表示するテキストフレームをtextFrames.add()を使って生成し、contentsプロパティに表示する文字列を入れます。あとは、文字のサイズや色などを設定します。画像の右下にテキストフレームを配置するには選択された画像の座標をgeometricBoundsから読み出しテキストフレームの座標値として設定します。なお、テキストフレームの高さは文字のサイズを変更した後に求める必要があります。</p>
<table>
<caption>【表】Dateオブジェクトの主なメソッド</caption>
<tbody>
<tr>
  <td>
    <span>メソッド</span>
  </td>
  <td>
    <span>結果</span>
  </td>
</tr>
<tr>
  <td>getFullYear()</td>
  <td>西暦4桁の年数を返す</td>
</tr>
<tr>
  <td>getMonth()</td>
  <td>現在の月より1少ない値を返す</td>
</tr>
<tr>
  <td>getDate()</td>
  <td>現在の日にちを返す</td>
</tr>
<tr>
  <td>getDay()</td>
  <td>現在の曜日を0~6までの数値にして返す</td>
</tr>
<tr>
  <td>getHours()</td>
  <td>現在の時間（0~23）を返す</td>
</tr>
<tr>
  <td>getMinutes()</td>
  <td>現在の分（0~59）を返す</td>
</tr>
<tr>
  <td>getSeconds()</td>
  <td>現在の秒（0~59）を返す</td>
</tr>
</tbody>
</table>
<p>選択した画像に今日の日付を入れるサンプル</p>
<pre><code>// 選択した画像の右下に今日の日付を入れる
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var dateObj = new Date();   // 今日の日付を求める
    var Y = dateObj.getFullYear();
    var M = dateObj.getMonth() + 1;
    var D = dateObj.getDate();
    var txtObj = activeDocument.textFrames.add();
    txtObj.contents = Y+"年"+M+"月"+D+"日";    // 表示する文字
    txtObj.paragraphs[0].size = 18; // 文字サイズ
    txtObj.paragraphs[0].fillColor = setRGBColor(255, 0, 0);    // 文字の色
    txtObj.left = selObj[i].geometricBounds[2]; // X座標
    txtObj.top = selObj[i].geometricBounds[3] + txtObj.geometricBounds[1];  // Y座標
    txtObj.paragraphs[0].justification = Justification.RIGHT;   // 右揃えにする
}
// RGBカラーを設定し、RGBカラーオブジェクトを返す
function setRGBColor(r, g, b){
    var RGB = new RGBColor();
    RGB.red = r;
    RGB.green = g;
    RGB.blue = b;
    return RGB;
}</code></pre>
<p>　今日の日付を入れたい画像を選択します。</p>
<figure>
<figcaption>【図】今日の日付を入れたい画像を選択する</figcaption>
<img src="images/00210.jpeg" />
</figure>
<p>　スクリプトを実行すると画像の右下に今日の日付が表示されます。</p>
<figure>
<figcaption>【図】画像の右下に今日の日付が表示される</figcaption>
<img src="images/00440.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-674">
<section>
<h2 id="calibre_link-353"><b>12-19　配置されている画像の修正日を入れる</b></h2>
<p>　リンク画像と埋め込み画像のfileプロパティにはリンク／埋め込んだ画像のファイルオブジェクトが入っています。ファイルオブジェクトのmodifiedプロパティには修正日を示すDateオブジェクトが入っています。このDateオブジェクトを下表のメソッドを使って日付を読み出します。</p>
<p>　次にテキストフレームをtextFrames.add()を使って生成し、contentsプロパティに修正日を入れます。あとは、文字のサイズや色などを設定します。画像の右下にテキストフレームを配置するには選択された画像の座標をgeometricBoundsから読み出しテキストフレームの座標値として設定します。なお、テキストフレームの高さは文字のサイズを変更した後に求める必要があります。</p>
<p>　画像の修正日ではなく作成日を表示したい場合はmodifiedプロパティから読み出すのではなくcreatedプロパティから読み出します。</p>
<table>
<caption>【表】Dateオブジェクトの主なメソッド</caption>
<tbody>
<tr>
  <td>
    <span>メソッド</span>
  </td>
  <td>
    <span>結果</span>
  </td>
</tr>
<tr>
  <td>getFullYear()</td>
  <td>西暦4桁の年数を返す</td>
</tr>
<tr>
  <td>getMonth()</td>
  <td>現在の月より1少ない値を返す</td>
</tr>
<tr>
  <td>getDate()</td>
  <td>現在の日にちを返す</td>
</tr>
<tr>
  <td>getDay()</td>
  <td>現在の曜日を0~6までの数値にして返す</td>
</tr>
<tr>
  <td>getHours()</td>
  <td>現在の時間（0~23）を返す</td>
</tr>
<tr>
  <td>getMinutes()</td>
  <td>現在の分（0~59）を返す</td>
</tr>
<tr>
  <td>getSeconds()</td>
  <td>現在の秒（0~59）を返す</td>
</tr>
</tbody>
</table>
<p>配置されている画像の修正日を入れるサンプル</p>
<pre><code>// 配置されている画像の右下に画像の修正日を入れる
writeDate(activeDocument.placedItems);  // リンク画像
writeDate(activeDocument.rasterItems);  // 埋め込み画像
// 画像の右下に修正日を入れる
function writeDate(imgObj){
    for(var i=0; i&lt;imgObj.length; i++){
        var dateObj = imgObj[i].file.modified;    // 修正日
        var Y = dateObj.getFullYear();
        var M = dateObj.getMonth() + 1;
        var D = dateObj.getDate();
        var txtObj = activeDocument.textFrames.add();
        txtObj.contents = Y+"年"+M+"月"+D+"日";    // 表示する文字
        txtObj.paragraphs[0].size = 18; // 文字サイズ
        txtObj.paragraphs[0].fillColor = setRGBColor(255, 0, 0);    // 文字の色
        txtObj.left = imgObj[i].geometricBounds[2]; // X座標
        txtObj.top = imgObj[i].geometricBounds[3] + txtObj.geometricBounds[1];  // Y座標
        txtObj.paragraphs[0].justification = Justification.RIGHT;   // 右揃えにする
    }
    // RGBカラーを設定し、RGBカラーオブジェクトを返す
    function setRGBColor(r, g, b){
        var RGB = new RGBColor();
        RGB.red = r;
        RGB.green = g;
        RGB.blue = b;
        return RGB;
    }
}</code></pre>
<p>　ドキュメント上に画像を配置しておきます。</p>
<figure>
<figcaption>【図】ドキュメント上に画像を配置しておく</figcaption>
<img src="images/00465.jpeg" />
</figure>
<p>　スクリプトを実行すると画像の右下に画像の修正日が表示されます。</p>
<figure>
<figcaption>【図】画像の右下に画像の修正日が表示される</figcaption>
<img src="images/00149.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-678">
<section>
<h2 id="calibre_link-354"><b>12-20　配置されている画像の種類（拡張子）を入れる</b></h2>
<p>　画像の種類を調べるにはファイル名の拡張子から求めます。リンク画像と埋め込み画像のfileプロパティにはリンク／埋め込んだ画像のファイルオブジェクトが入っています。ファイルオブジェクトのnameプロパティに拡張子を含むファイル名が入っています。拡張子は.（ドット／ピリオド）で区切られているのでsplit(".")として分割します。分割すると結果は配列要素になります。配列要素の最後の要素が拡張子になります。</p>
<p>　次にテキストフレームをtextFrames.add()を使って生成し、contentsプロパティに取得した拡張子の文字を入れます。あとは、文字のサイズや色などを設定します。画像の右下にテキストフレームを配置するには選択された画像の座標をgeometricBoundsから読み出しテキストフレームの座標値として設定します。なお、テキストフレームの高さは文字のサイズを変更した後に求める必要があります。</p>
<p>　拡張子ではなくファイル名を表示する場合はファイルオブジェクトのnameプロパティを、そのままcontentsプロパティに入れます。ファイルパスまで含める場合はfullNameプロパティをcontentsプロパティに入れます。</p>
<p>配置されている画像の種類（拡張子）を入れるサンプル</p>
<pre><code>// 配置されている画像の右下に画像の種類（拡張子）を入れる
writeExt(activeDocument.placedItems);  // リンク画像
writeExt(activeDocument.rasterItems);  // 埋め込み画像
// 画像の右下に種類（拡張子）を入れる
function writeExt(imgObj){
    for(var i=0; i&lt;imgObj.length; i++){
        var filename = imgObj[i].file.name;    // 拡張子を含むファイル名
        var fstr = filename.split("."); // .で分割
        var ext = fstr[fstr.length - 1];    // 拡張子
        var txtObj = activeDocument.textFrames.add();
        txtObj.contents = ext;    // 表示する文字
        txtObj.paragraphs[0].size = 18; // 文字サイズ
        txtObj.paragraphs[0].fillColor = setRGBColor(255, 0, 0);    // 文字の色
        txtObj.left = imgObj[i].geometricBounds[2]; // X座標
        txtObj.top = imgObj[i].geometricBounds[3] + txtObj.geometricBounds[1];  // Y座標
        txtObj.paragraphs[0].justification = Justification.RIGHT;   // 右揃えにする
    }
    // RGBカラーを設定し、RGBカラーオブジェクトを返す
    function setRGBColor(r, g, b){
        var RGB = new RGBColor();
        RGB.red = r;
        RGB.green = g;
        RGB.blue = b;
        return RGB;
    }
}</code></pre>
<p>　ドキュメント上に画像を配置しておきます。</p>
<figure>
<figcaption>【図】ドキュメント上に画像を配置しておく</figcaption>
<img src="images/00120.jpeg" />
</figure>
<p>　スクリプトを実行すると画像の右下に画像の種類（拡張子）が表示されます。</p>
<figure>
<figcaption>【図】画像の右下に画像の種類（拡張子）が表示される</figcaption>
<img src="images/00250.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-102">
<section>
<h2 id="calibre_link-355"><b>12-21　選択した画像をラスタライズ（ピクセルに変換）する</b></h2>
<p>　選択した画像をラスタライズするにはドキュメントオブジェクトのrasterize()メソッドを使います。rasterize()メソッドの最初のパラメーターにラスタライズしたい画像オブジェクトを指定します。他にも2つのパラメーターを指定することができますが、必須なのは最初のパラメーターだけです。ラスタライズは選択した図形の表示されている幅で行われます。高解像度の画像であっても配置されているサイズが小さければ、そのサイズに合わせたラスタライズ処理が行われます。</p>
<p>　rasterize()メソッドの2番目のパラメーターはラスタライズする範囲を配列形式で指定します。これは[左座標, 上座標, 右座標, 下座標]の順番で指定します。この座標はドキュメントの座標（アートボードの座標）であり、画像の左上を基準にした座標ではありません。</p>
<p>　rasterize()メソッドの3番目のパラメーターはラスタライズオプションです。オプションはnew RasterizeOptions()としてオブジェクトを生成し、そのプロパティに値を設定します。</p>
<p>　なお、rasterize()メソッドは画像だけでなく文字や図形などにも使用することができます。</p>
<table>
<caption>【表】ラスタライズオプションのプロパティ名と内容</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ名</span>
  </td>
  <td>
    <span>内容</span>
  </td>
</tr>
<tr>
  <td>antiAliasingMethod</td>
  <td>アンチエイリアスの種類（表「アンチエイリアスの種類」を参照）</td>
</tr>
<tr>
  <td>backgroundBlack</td>
  <td>背景を黒色にするかどうか。trueで黒、falseで白色。</td>
</tr>
<tr>
  <td>clippingMask</td>
  <td>クリッピングマスクを適用するかどうか。trueで適用。</td>
</tr>
<tr>
  <td>colorModel</td>
  <td>カラーモデル（表「カラーモデル」を参照）</td>
</tr>
<tr>
  <td>convertSpotColors</td>
  <td>スポットカラーをプロセスカラーに変換するかどうか。trueで変換する。</td>
</tr>
<tr>
  <td>convertTextToOutlines</td>
  <td>ラスタライズ処理の前に文字をアウトライン化するかどうか。trueでする。</td>
</tr>
<tr>
  <td>includeLayers</td>
  <td>レイヤー属性（合成モード）を考慮するかどうか。trueでする。</td>
</tr>
<tr>
  <td>padding</td>
  <td>余白。初期値は0。</td>
</tr>
<tr>
  <td>resolution</td>
  <td>解像度。72.0~2400.0の範囲。初期値は300.0。</td>
</tr>
<tr>
  <td>transparency</td>
  <td>背景を透明にするかどうか。trueで透明。falseで不透明。</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】アンチエイリアスの種類</caption>
<tbody>
<tr>
  <td>
    <span>パラメーター</span>
  </td>
  <td>
    <span>設定</span>
  </td>
</tr>
<tr>
  <td>AntiAliasingMethod.None</td>
  <td>なし</td>
</tr>
<tr>
  <td>AntiAliasingMethod.ARTOPTIMIZED</td>
  <td>アート（図形）に最適（スーパーサンプリング）</td>
</tr>
<tr>
  <td>AntiAliasingMethod.TYPEOPTIMIZED</td>
  <td>文字に最適</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】カラーモデル</caption>
<tbody>
<tr>
  <td>
    <span>パラメーター</span>
  </td>
  <td>
    <span>設定</span>
  </td>
</tr>
<tr>
  <td>RasterizationColorModel.DEFAULTCOLORMODEL</td>
  <td>デフォルトのカラーモード（ドキュメントのカラーモード）</td>
</tr>
<tr>
  <td>RasterizationColorModel.BITMAP</td>
  <td>モノクロ2階調</td>
</tr>
<tr>
  <td>RasterizationColorModel.GRAYSCALE</td>
  <td>グレースケール</td>
</tr>
</tbody>
</table>
<p>選択した画像をラスタライズ（ピクセルに変換）するサンプル</p>
<pre><code>// 選択した画像をラスタライズする
var selObj = activeDocument.selection;
var opt = new RasterizeOptions();
opt.resolution = 72;    // ラスタライズ解像度
for(var i=0; i&lt;selObj.length; i++){
    activeDocument.rasterize(selObj[i], [0, 0, 200, -120], opt);  // ラスタライズ
}</code></pre>
<p>　ドキュメント上に画像を配置します。</p>
<figure>
<figcaption>【図】ドキュメント上に画像を配置する</figcaption>
<img src="images/00370.jpeg" />
</figure>
<p>　スクリプトを実行すると画像がラスタライズされます。</p>
<figure>
<figcaption>【図】画像がラスタライズされる</figcaption>
<img src="images/00346.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-587">
<section>
<div>
<h1 id="calibre_link-356"><b>第13章　グループ</b></h1>
</div>
<p>　この章では、文字や図形、画像などをまとめて扱うことができるグループに関するサンプルを示し、解説します。</p>
</section>
</div>
<div id="calibre_link-554">
<section>
<h2 id="calibre_link-357"><b>13-1　グループ化する</b></h2>
<p>　グループ化するするにはドキュメントオブジェクトのgroupItemsオブジェクトのadd()メソッドを使います。add()メソッドはグループオブジェクトを返します。このグループオブジェクトに対してtextFrames.add()やpathItems.add()を使ってグループ化する項目（オブジェクト）を作成していきます。</p>
<p>　グループ化した場合、座標の移動や図形の回転などはグループオブジェクトのみに対して行うことで、グループ化した図形全体を移動させたりすることができます。もちろん、グループ化した図形に対して個別に座標などを設定することもできます。</p>
<p>グループ化するサンプル</p>
<pre><code>// 2つのテキストフレームをグループ化する
var grObj = activeDocument.groupItems.add();    // グループオブジェクトを生成
var txtObj1 = grObj.textFrames.add();   // グループオブジェクト内に生成する
var txtObj2 = grObj.textFrames.add();
txtObj1.contents = "テキストフレーム、その１";
txtObj2.contents = "テキストフレーム、その２";
txtObj1.top = -20;  // テキストフレーム1のY座標を設定する
txtObj2.top = -40;  // テキストフレーム2のY座標を設定する
grObj.left = 50;    // グループ全体のX座標を設定する</code></pre>
<p>　2つのテキストフレームがグループ化されます。</p>
<figure>
<figcaption>【図】2つのテキストフレームがグループ化される</figcaption>
<img src="images/00138.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-722">
<section>
<h2 id="calibre_link-358"><b>13-2　選択されたオブジェクトをグループ化する</b></h2>
<p>　グループ化するするにはドキュメントオブジェクトのgroupItemsオブジェクトのadd()メソッドを使います。add()メソッドはグループオブジェクトを返します。</p>
<p>　選択された図形をグループ化するには選択された図形のmove()メソッドを使います。move()メソッドの最初のパラメーターにグループオブジェクトを指定します。2番目のパラメーターにオブジェクトのグループ内で、どこに移動させるかを指定します。移動先は下表に示す値を指定することができます。</p>
<table>
<caption>【表】move()メソッドで指定できる移動先の値</caption>
<tbody>
<tr>
  <td>
    <span>指定できる移動先の値</span>
  </td>
  <td>
    <span>移動先</span>
  </td>
</tr>
<tr>
  <td>ElementPlacement.INSIDE</td>
  <td>指定した図形の内側</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEBEFORE</td>
  <td>指定した図形の前</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEATBEGINNING</td>
  <td>指定した図形の先頭</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEAFTER</td>
  <td>指定した図形の後</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEATEND</td>
  <td>指定した図形の末尾</td>
</tr>
</tbody>
</table>
<p>選択されたオブジェクトをグループ化するサンプル</p>
<pre><code>// 選択されたオブジェクトをグループ化する
var grObj = activeDocument.groupItems.add();    // グループオブジェクトを生成する
var selObj = activeDocument.selection;  // 選択されたオブジェクトが入った配列
for(var i=0; i&lt;selObj.length; i++){
    // 選択された図形をグループオブジェクトの末尾に追加する
    selObj[i].move(grObj, ElementPlacement.PLACEATEND);
}</code></pre>
<p>　グループ化したい図形を選択します。</p>
<figure>
<figcaption>【図】グループ化したい図形を選択する</figcaption>
<img src="images/00316.jpeg" />
</figure>
<p>
<br />
</p>
<p>　スクリプトを実行すると選択した図形がグループ化されます。</p>
<figure>
<figcaption>【図】選択した図形がグループ化される</figcaption>
<img src="images/00291.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-747">
<section>
<h2 id="calibre_link-359"><b>13-3　グループを解除する</b></h2>
<p>　グループを解除するにはグループオブジェクトのpageItemsオブジェクトのmove()メソッドを使います。move()メソッドの最初のパラメーターにactiveDocumentを指定することでグループ化が1段階だけ解除されます。完全にグループ化を解除するには、グループ化した回数分（入れ子になっている数だけ）グループ解除を行う必要があります。なお、グループ化を解除してもグループオブジェクトは残ったままになります。</p>
<p>　より手軽にグループを解除することもできます。CS6以降ではapp.executeMenuCommand("ungroup");とすることで選択されているグループオブジェクトのグループを解除することができます。また、CS6以降ではapp.doScript()メソッドを使ってアクションを呼び出して実行することができるため、アクションにグループ解除する処理を登録しておき呼び出してグループ解除させることもできます（「32-1　スクリプトからアクションを実行する」を参照）。</p>
<p>グループを解除するサンプル</p>
<pre><code>// 選択されたグループ化を1段階だけ解除する
var selObj = activeDocument.selection;
for(var i=selObj[0].pageItems.length-1; i&gt;0; i--){
    // 選択された図形のグループ化を解除する
    selObj[0].pageItems[i].move(activeDocument, ElementPlacement.PLACEATEND);
}</code></pre>
<p>　選択した図形は外枠の四角形とそれ以外でグループ化されています。</p>
<figure>
<figcaption>【図】図形が外枠の四角形とそれ以外でグループ化されている</figcaption>
<img src="images/00411.jpeg" />
</figure>
<p>　スクリプトを実行すると選択した図形のグループ化が1段階だけ解除されます。</p>
<figure>
<figcaption>【図】選択した図形のグループ化が1段階だけ解除される</figcaption>
<img src="images/00477.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-584">
<section>
<div>
<h1 id="calibre_link-360"><b>第14章　レイヤー</b></h1>
</div>
<p>　この章では、レイヤーに関するサンプルを示し、解説します。レイヤーおよびサブレイヤーなどに関する様々な処理を行うことができます。</p>
</section>
</div>
<div id="calibre_link-98">
<section>
<h2 id="calibre_link-361"><b>14-1　レイヤーを作成する</b></h2>
<p>　レイヤーを作成するにはドキュメントオブジェクトに対してlayers.add()とします。アクティブになっているドキュメントの場合はactiveDocument.layers.add()とすれば新規にレイヤーが作成されます。layers.add()は作成したレイヤーオブジェクトを返します。新規に作成したレイヤーの名前を設定するには、作成されたレイヤーオブジェクトのnameプロパティに名前を設定します。</p>
<p>　また、図形を選択した際に表示される選択カラーはレイヤーオブジェクトのcolorプロパティにRGBColorオブジェクトを指定します。</p>
<p>レイヤーを作成するサンプル</p>
<pre><code>// レイヤーを作成する
var layObj = activeDocument.layers.add();
layObj.name = "下絵レイヤー";
// カラーを設定する
var color = new RGBColor();
color.red = 255;
color.green = 128;
color.blue = 0;
// レイヤーカラーとして設定する
layObj.color = color;</code></pre>
<p>　レイヤーを作成する前の状態です。</p>
<figure>
<figcaption>【図】レイヤーを作成する前の状態</figcaption>
<img src="images/00065.jpeg" />
</figure>
<p>　スクリプトを実行すると新たにレイヤーが生成され、選択カラーがオレンジ色に設定されます。</p>
<figure>
<figcaption>【図】レイヤーが生成される</figcaption>
<img src="images/00051.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-605">
<section>
<h2 id="calibre_link-362"><b>14-2　レイヤーを名前で指定する</b></h2>
<p>　レイヤーを名前で指定するにはJavaScriptのハッシュ／連想配列の機能を使います。layers配列に数値ではなく取得したいレイヤー名を指定します。該当するレイヤー名がない場合はエラーで停止します。停止させたくない場合はサンプルのようにtry...catch()で囲んでエラー回避処理を行います。</p>
<p>　レイヤー名に英文字が含まれる場合、大文字と小文字は区別されないので注意が必要です。</p>
<p>　なお、レイヤーを生成するadd()メソッドでは、実行している環境（国・地域）ごとに新規レイヤーの名前が異なります。多国語に対応させる場合はレイヤーを生成した後に英数字の名前を指定し、その名前をlayers[]に指定してください。また、レイヤーの順番を示す番号で対応させる方法もあります。</p>
<p>レイヤーを名前で指定するサンプル</p>
<pre><code>// レイヤーを名前で指定する
try{
    var layObj = activeDocument.layers["レイヤー 2"];
    alert("レイヤー情報を取得しました");
}catch(e){
    alert("該当するレイヤーはありません");
}</code></pre>
<p>　レイヤーが存在する場合、情報が取得されたことを示すアラートダイアログが表示されます。</p>
<figure>
<figcaption>【図】情報が取得されたことを示す</figcaption>
<img src="images/00315.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-0">
<section>
<h2 id="calibre_link-363"><b>14-3　レイヤーを番号で指定する</b></h2>
<p>　レイヤーを番号で指定するにはlayers配列に数値0からレイヤー総数-1を指定します。このレイヤー数は同じ階層でのレイヤー数です。サブレイヤーなど異なる階層の場合は、レイヤー総数にカウントされません。</p>
<p>　番号は0がレイヤーパネルでの一番上にあるレイヤーになり、数値が大きくなるほど下のレイヤーになります。</p>
<p>レイヤーを番号で指定するサンプル</p>
<pre><code>// レイヤーを番号で指定する
var layObjTop = activeDocument.layers[0];
var layObjBottom = activeDocument.layers[activeDocument.layers.length-1];
alert("一番上のレイヤー名："+layObjTop.name +
    "\r一番下のレイヤー名：" +  layObjBottom.name);</code></pre>
<p>　最初の階層の一番上のレイヤー名と一番下のレイヤー名がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】レイヤー名が表示される</figcaption>
<img src="images/00447.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-718">
<section>
<h2 id="calibre_link-364"><b>14-4　レイヤー／サブレイヤーの総数を取得する</b></h2>
<p>　レイヤー／サブレイヤーの総数を取得するにはlayers.lengthとします。layersは配列なのでlengthプロパティを使うことで要素の数、つまり全てのレイヤーの枚数を取得することができます。レイヤーが入れ子になっている場合（サブレイヤー）は、レイヤーオブジェクト内にあるlayers配列を参照します。layers配列の長さ（length）が0でなければ、さらに入れ子になっているレイヤー（サブレイヤー）があるということになります。</p>
<p>レイヤー／サブレイヤーの総数を取得するサンプル</p>
<pre><code>// レイヤー／サブレイヤーの総数を取得する
var n = activeDocument.layers.length;
var ns = activeDocument.layers[0].layers.length;
alert("レイヤー総数：" + n +"\rサブレイヤー総数：" +  ns);</code></pre>
<p>　一番上の階層にあるレイヤー総数と最初のレイヤーに含まれるサブレイヤーの総数がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】サブレイヤーの総数が表示される</figcaption>
<img src="images/00013.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-704">
<section>
<h2 id="calibre_link-365"><b>14-5　レイヤー／サブレイヤーを削除する</b></h2>
<p>　レイヤー／サブレイヤーを削除するにはレイヤーオブジェクトのremove()メソッドを使います。サンプルのように番号を使って削除するレイヤーを指定することもできますし、名前を使って指定することもできます。なお、同じ名前のレイヤー名がある場合、同じ階層のレイヤーのみ対象になります。つまり、activeDocument.layers["AICC"].remove()とした場合、最初の階層にあるAICCのレイヤーだけが削除され、他のレイヤー内に含まれる同名のサブレイヤーは削除されません。</p>
<p>　削除するレイヤーにサブレイヤーが含まれる場合、サブレイヤーも全て削除されます。</p>
<p>　レイヤー名に英文字が含まれる場合、大文字と小文字を区別しない点に注意してください。</p>
<p>レイヤー／サブレイヤーを削除するサンプル</p>
<pre><code>// レイヤーを削除する
var layObj1 = activeDocument.layers[2];
layObj1.remove();
try{
    var layObj2 = activeDocument.layers["レイヤー 11"];
    layObj2.remove();
}catch(e){}    // 該当レイヤーがない場合は何もしない</code></pre>
<p>　スクリプトを実行する前のレイヤーの状態です。</p>
<figure>
<figcaption>【図】スクリプトを実行する前のレイヤー</figcaption>
<img src="images/00100.jpeg" />
</figure>
<p>　スクリプトを実行すると最初の階層の上から3番目にあるレイヤーと、"レイヤー 11"の名前を持つレイヤーが削除されます。</p>
<figure>
<figcaption>【図】レイヤーが削除される</figcaption>
<img src="images/00173.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-108">
<section>
<h2 id="calibre_link-366"><b>14-6　アクティブレイヤーにアクセスする</b></h2>
<p>　アクティブレイヤーにアクセスするにはドキュメントオブジェクトのactiveLayerプロパティに対してアクセスを行います。アクティブなレイヤーというだけで一般的なlayerオブジェクトと変わりません。つまり使えるプロパティやメソッドは一般的なレイヤーオブジェクトと同じです。</p>
<p>アクティブレイヤーにアクセスするサンプル</p>
<pre><code>// アクティブなレイヤー名を表示する
var aLayerObj = app.activeDocument.activeLayer;
alert("アクティブレイヤー名："+aLayerObj.name);</code></pre>
<p>　アクティブになっているレイヤー名がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】レイヤー名が表示される</figcaption>
<img src="images/00564.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-611">
<section>
<h2 id="calibre_link-367"><b>14-7　レイヤーをアクティブにする</b></h2>
<p>　レイヤーをアクティブにするにはドキュメントオブジェクトのactiveLayerプロパティにアクティブにしたいレイヤーオブジェクトを入れます。サブレイヤーをアクティブにしたい場合はサブレイヤーのレイヤーオブジェクトを入れます。</p>
<p>　レイヤーをアクティブにしないようにすることはできません。レイヤーパネルではアクティブレイヤーがなくても内部では直前にアクティブになっていたレイヤーがアクティブレイヤーとなっています。</p>
<p>レイヤーをアクティブにするサンプル</p>
<pre><code>// 特定の名前のレイヤーをアクティブにする
try{
    var layObj = app.activeDocument.layers["Copyright"];
    app.activeDocument.activeLayer = layObj;    // アクティブなレイヤーとして設定
}catch(e){}</code></pre>
<p>　スクリプトを実行する前のレイヤー状態です。</p>
<figure>
<figcaption>【図】スクリプトを実行する前のレイヤー</figcaption>
<img src="images/00341.jpeg" />
</figure>
<p>　レイヤー名Copyrightがアクティブになります。</p>
<figure>
<figcaption>【図】レイヤー名Copyrightがアクティブになる</figcaption>
<img src="images/00012.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-602">
<section>
<h2 id="calibre_link-368"><b>14-8　サブレイヤーを作成する</b></h2>
<p>　サブレイヤーを作成する（レイヤー内にレイヤーを作成する）にはレイヤーオブジェクトに対してlayers.add()とします。layers.add()は作成したサブレイヤーオブジェクトを返します。新規に作成したサブレイヤーの名前を設定するには、作成されたレイヤーオブジェクトのnameプロパティに名前を設定します。サブレイヤー内にさらにレイヤーを作成するにはlayers.add()とします。</p>
<p>サブレイヤーを作成するサンプル</p>
<pre><code>// サブレイヤーを作成する（レイヤー内にレイヤーを作成する）
var layObj = activeDocument.layers.add();
layObj.name = "親レイヤー";
var subLayObj = layObj.layers.add();
subLayObj.name = "新しいサブレイヤーです";
var subLayObj2 = subLayObj.layers.add();
subLayObj2.name = "さらに入れ子のサブレイヤーです";</code></pre>
<p>　スクリプトを実行する前のレイヤーの状態です。</p>
<figure>
<figcaption>【図】スクリプトを実行する前のレイヤー</figcaption>
<img src="images/00135.jpeg" />
</figure>
<p>　新たにレイヤーが生成され、その中にさらにサブレイヤーが作成されます。</p>
<figure>
<figcaption>【図】新しいレイヤーとサブレイヤーが作成される</figcaption>
<img src="images/00463.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-546">
<section>
<h2 id="calibre_link-369"><b>14-9　サブレイヤーを削除する</b></h2>
<p>　サブレイヤーを削除するには削除したいサブレイヤーに対してremove()メソッドを使います。サブレイヤーもレイヤーオブジェクトなのでlayers["レイヤーの名前"]、layers[2]といった指定ができます。レイヤーを名前で指定する際、英大文字小文字は区別されないので注意が必要です。</p>
<p>サブレイヤーを削除するサンプル</p>
<pre><code>// 一番上のレイヤー内にある特定の名前のサブレイヤーを削除する
var parentLayerObj = app.activeDocument.layers[0];// 一番上のレイヤー
try{
    var subLayObj = parentLayerObj.layers["Mask"];
    subLayObj.remove();
}catch(e){}</code></pre>
<p>　スクリプト実行前のレイヤーの状態です。</p>
<figure>
<figcaption>【図】スクリプト実行前のレイヤー</figcaption>
<img src="images/00383.jpeg" />
</figure>
<p>　一番上のレイヤー内にあるレイヤー名"mask"のレイヤーが削除されます。大文字小文字を区別しないためスクリプトでMaskを指定してもmaskのレイヤーが削除されます。なお、該当するレイヤー名がない場合は削除されません。</p>
<figure>
<figcaption>【図】サブレイヤーが削除される</figcaption>
<img src="images/00520.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-710">
<section>
<h2 id="calibre_link-370"><b>14-10　レイヤー内にある全てのサブレイヤーを削除する</b></h2>
<p>　レイヤー内にある全てのサブレイヤーを削除するレイヤー内に含まれるサブレイヤーの数だけremove()メソッドを使います。その際、for()を使って繰り返し処理を行いますが、最後のサブレイヤーから削除するようにします。先頭から削除するとサブレイヤーが完全に削除されません。</p>
<p>レイヤー内にある全てのサブレイヤーを削除するサンプル</p>
<pre><code>// 一番上のレイヤー内にある全てのサブレイヤーを削除する
var parentLayerObj = app.activeDocument.layers[0];// 一番上のレイヤー
for(var i=parentLayerObj.layers.length-1; i&gt;=0; i--){
    parentLayerObj.layers[i].remove();  // サブレイヤーを削除
}</code></pre>
<p>　スクリプトを実行する前のレイヤーの状態です。</p>
<figure>
<figcaption>【図】スクリプトを実行する前のレイヤー</figcaption>
<img src="images/00041.jpeg" />
</figure>
<p>　一番上のレイヤー内にあるサブレイヤーが全て削除されます。</p>
<figure>
<figcaption>【図】サブレイヤーが全て削除される</figcaption>
<img src="images/00166.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-723">
<section>
<h2 id="calibre_link-371"><b>14-11　レイヤー／サブレイヤーの情報をテキストフレームに出力する</b></h2>
<p>　レイヤー／サブレイヤーの情報をテキストフレームに出力するには再帰を使います。これはレイヤー内にレイヤーが含まれる（サブレイヤー）ためです。このため、関数を作成し、サブレイヤーがある場合には、さらに関数を呼び出すようにします。</p>
<p>　サンプルではレイヤーの名前を出力していますが、他の情報を出力することもできます。なお、階層の深さに応じてインデント（字下げ）するようになっています。</p>
<p>レイヤー／サブレイヤーの情報をテキストフレームに出力するサンプル</p>
<pre><code>// レイヤーの階層をテキストフレームに出力する
var layerData = "";
getLayerInfo(activeDocument, 0);
// 結果を出力する
var txtObj = activeDocument.textFrames.add();
txtObj.left = 10;   // X座標を10ptの位置にする
txtObj.top = -10;   // Y座標を上から10ptの位置にする
txtObj.contents = layerData;
// レイヤーの名前を再帰を使って取得する
function getLayerInfo(layObj, indent){
    for(var i=0; i&lt;layObj.layers.length; i++){
        var name = layObj.layers[i].name;
        layerData = layerData + space(indent) + name + "\r";
        getLayerInfo(layObj.layers[i], indent+1);
    }
    // インデントの数だけ全角空白を返す
    function space(n){
        var spc = "";
        for(var i=0; i&lt;n; i++){
            spc = spc + "　";
        }
        return spc;
    }
}</code></pre>
<p>　レイヤー階層は、このようになっています。</p>
<figure>
<figcaption>【図】レイヤー階層の状態</figcaption>
<img src="images/00300.jpeg" />
</figure>
<p>　レイヤーの名前が生成したテキストフレーム内に表示され、階層に応じてインデント（字下げ）されます。</p>
<figure>
<figcaption>【図】レイヤーの名前がテキストフレーム内に表示される</figcaption>
<img src="images/00422.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-3">
<section>
<h2 id="calibre_link-372"><b>14-12　指定したレイヤーを移動させる</b></h2>
<p>　指定したレイヤーを移動させるにはmove()メソッドを使います。move()メソッドの最初のパラメーターには移動基準となるレイヤーオブジェクトを指定します。2番目のパラメーターには、どこに移動させるかを指定します。指定できる移動先の値を下表に示します。</p>
<table>
<caption>【表】move()メソッドで指定できる移動先の値</caption>
<tbody>
<tr>
  <td>
    <span>パラメーター</span>
  </td>
  <td>
    <span>移動先</span>
  </td>
</tr>
<tr>
  <td>ElementPlacement.INSIDE</td>
  <td>指定したレイヤーの内側</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEBEFORE</td>
  <td>指定したレイヤーの前</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEATBEGINNING</td>
  <td>指定したレイヤーのサブレイヤーの先頭</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEAFTER</td>
  <td>指定したレイヤーの後</td>
</tr>
<tr>
  <td>ElementPlacement.PLACEATEND</td>
  <td>指定したレイヤーのサブレイヤーの最後</td>
</tr>
</tbody>
</table>
<p>指定したレイヤーを移動させるサンプル</p>
<pre><code>// 指定したレイヤーを移動させる
var sLayer = activeDocument.layers["レイヤー 3"];   // 移動させたいレイヤー
var bottomLayer = activeDocument.layers[activeDocument.layers.length-1];    // 一番下のレイヤー
sLayer.move(bottomLayer, ElementPlacement.PLACEAFTER);  // 一番下に移動</code></pre>
<p>　レイヤーを移動させる前の状態です。</p>
<figure>
<figcaption>【図】レイヤーを移動させる前</figcaption>
<img src="images/00553.jpeg" />
</figure>
<p>　レイヤー3が一番下に移動します。</p>
<figure>
<figcaption>【図】レイヤー3が一番下に移動する</figcaption>
<img src="images/00380.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-53">
<section>
<div>
<h1 id="calibre_link-373"><b>第15章　選択</b></h1>
</div>
<p>　この章では、図形とテキストフレームの選択に関するサンプルを示し、解説します。特定の条件にもとづいて図形やテキストフレームの選択や解除を行うことができます。</p>
</section>
</div>
<div id="calibre_link-539">
<section>
<h2 id="calibre_link-374"><b>15-1　選択を解除する</b></h2>
<p>　選択を解除するにはselection配列にnullを入れます。これにより選択されている状態が解除されます。テキストフレーム内で文字が選択されている場合も問題なく選択が解除されます。また、テキストフレーム内の文字の選択を解除する場合はdeSelect()メソッドを使うこともできます。</p>
<p>選択を解除するサンプル</p>
<pre><code>// アクティブドキュメントの選択を解除する
activeDocument.selection = null;</code></pre>
<p>　文字やパスを選択します。</p>
<figure>
<figcaption>【図】文字やパスを選択する</figcaption>
<img src="images/00168.jpeg" />
</figure>
<p>　スクリプトを実行すると選択が解除されます。</p>
<figure>
<figcaption>【図】選択が解除される</figcaption>
<img src="images/00329.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-758">
<section>
<h2 id="calibre_link-375"><b>15-2　ロックされていない全ての項目を選択する</b></h2>
<p>　ドキュメント上に配置されている文字や画像などはpageItems配列に全て入っています。項目を選択するにはselectedプロパティにtrueを設定します。ただし、ロックされている項目がある場合（レイヤーのロックでも同様）はselectedプロパティにtrueを設定するとエラーで停止するためtry...catchを使ってエラーを回避します。</p>
<p>ロックされていない全ての項目を選択するサンプル</p>
<pre><code>// ロックされていない全ての項目を選択する
for(var i=0; i&lt;activeDocument.pageItems.length; i++){
    try{
        activeDocument.pageItems[i].selected = true;
    }catch(e){
        // ロックされているので何もしない
    }
}</code></pre>
<p>　ロックされていないパスやテキストなどが全て選択されます。</p>
<figure>
<figcaption>【図】ロックされていないパスやテキストなどが全て選択される</figcaption>
<img src="images/00459.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-560">
<section>
<h2 id="calibre_link-376"><b>15-3　特定のレイヤーにある全ての項目を選択する</b></h2>
<p>　特定のレイヤーに配置されている文字や画像などはレイヤーオブジェクト内にあるpageItems配列に全て入っています。項目を選択するにはselectedプロパティにtrueを設定します。ただし、ロックされている項目がある場合（レイヤーのロックでも同様）はselectedプロパティにtrueを設定するとエラーで停止するためtry...catchを使ってエラーを回避します。</p>
<p>特定のレイヤーにある全ての項目を選択するサンプル</p>
<pre><code>// 特定のレイヤーにある全ての項目を選択する
for(var i=0; i&lt;activeDocument.layers["telop"].pageItems.length; i++){
    try{
        activeDocument.layers["telop"].pageItems[i].selected = true;
    }catch(e){
        // ロックされているので何もしない
    }
}</code></pre>
<p>　ロックされていないパスやテキストなどが全て選択されます。</p>
<figure>
<figcaption>【図】ロックされていないパスやテキストなどが全て選択される</figcaption>
<img src="images/00437.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-93">
<section>
<h2 id="calibre_link-377"><b>15-4　アクティブになっているアートボード上の図形を選択する</b></h2>
<p>　アクティブになっているアートボード上の図形を選択するにはドキュメントオブジェクトのselectObjectsOnActiveArtboard()メソッドを使います。選択できた場合はtrue、選択に失敗した場合はfalseを返します。</p>
<p>アクティブになっているアートボード上の図形を選択するサンプル</p>
<pre><code>// アクティブになっているアートボード上の図形を選択する
var flag = activeDocument.selectObjectsOnActiveArtboard();
if (flag == true){
    alert("選択しました");
}else{
    alert("選択できませんでした");
}</code></pre>
<p>　アートボードを選択します。</p>
<figure>
<figcaption>【図】アートボードを選択する</figcaption>
<img src="images/00183.jpeg" />
</figure>
<p>　実行結果がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】実行結果がアラートダイアログに表示される</figcaption>
<img src="images/00347.jpeg" />
</figure>
<p>　「アートボード 3」上にある図形や文字が選択されます。</p>
<figure>
<figcaption>【図】「アートボード 3」上にある図形や文字が選択される</figcaption>
<img src="images/00232.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-99">
<section>
<h2 id="calibre_link-378"><b>15-5　特定のアートボード内にある項目だけ選択する</b></h2>
<p>　特定のアートボード内にある項目だけ選択するにはartboards配列を使います。artboards配列に選択したいアートボードの番号を指定します。次にアートボードの範囲をartboardRect配列から読み出します。</p>
<p>　ページ内にある項目の座標をgeometricBounds配列から読み出しアートボードの座標値と比較します。完全にアートボード内に収まっている場合はselectedプロパティにtrueを設定します。ただし、ロックされている項目がある場合（レイヤーのロックでも同様）はselectedプロパティにtrueを設定するとエラーで停止するためtry...catchを使ってエラーを回避します。</p>
<p>　サンプルでの方法はアートボード内で特定の座標範囲内にある図形を選択する場合にも応用できます。なお、アクティブになっているアートボード内の項目を選択するにはselectObjectsOnActiveArtboard()メソッドを使います（「15-4　アクティブになっているアートボード上の図形を選択する」を参照）。</p>
<p>特定のアートボード内にある項目だけ選択するサンプル</p>
<pre><code>// 特定のアートボード内にある項目だけ選択する
activeDocument.selection = null;    // 全ての選択を解除する
// アートボードのインデックス番号
var abIndex = 1;
// 指定されたアートボードのサイズを求める
var rect = activeDocument.artboards[abIndex].artboardRect;
var ax1 = rect[0];
var ay1 = -rect[1];
var ax2 = rect[2];
var ay2 = -rect[3];
var p = activeDocument.pageItems;
for(var i=p.length-1; i&gt;=0; i--){
    var geo = p[i].geometricBounds;
    if (!geo){ continue; }
    var x1 = geo[0];
    var y1 = -geo[1];
    var x2 = geo[2];
    var y2 = -geo[3];
    // アートボード内に完全に座標値が収まっているか調べる
    if((x1&gt;=ax1) &amp;&amp; (y1&gt;=ay1)&amp;&amp;(x2&lt;=ax2)&amp;&amp;(y2&lt;=ay2)) {
        try{
            p[i].selected = true;   // 選択する
        }catch(e){
            // ロックされている場合に何か処理を行う場合はここにプログラムを書く
        }
    }
}</code></pre>
<p>　特定のアートボードに配置されているパスや画像などが全て選択されます。</p>
<figure>
<figcaption>【図】2番目（アートボード2）のアートボードに配置されているパスや画像などが全て選択される</figcaption>
<img src="images/00119.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-642">
<section>
<h2 id="calibre_link-379"><b>15-6　ロックを解除し全ての項目を選択する</b></h2>
<p>　ロックを解除し全ての項目を選択するには、あらかじめロックされているレイヤーのロックを解除します。レイヤーはサブレイヤーなど入れ子になっていることがあるため、再帰を使って繰り返しロックを解除していきます。ロックされているかどうかはlockedプロパティで確認できます。trueならロックされており、falseならロックされていません。lockedプロパティにfalseを設定すればロックは解除されます。</p>
<p>　その後、pageItems配列に全て入っているパスなどの図形のオブジェクトのselectedプロパティにtrueを設定します。図形がロックされている場合はロックを解除した後に選択します。何らかの不具合に備えてtry...catchを使ってエラーが出ないようにしてあります。</p>
<p>ロックを解除し全ての項目を選択するサンプル</p>
<pre><code>// オブジェクト・レイヤーロックを解除し全ての項目を選択する
layerUnlock(activeDocument);
var p = activeDocument.pageItems;
for(var i=0; i&lt;p.length; i++){
    try{
        p[i].selected = true;   // 選択する
    }catch(e){
        p[i].locked = false;    // ロック解除
        p[i].selected = true;   // 選択する
    }
}
// レイヤーロック解除
function layerUnlock(lay){
    for(var i=0; i&lt;lay.layers.length; i++){
        lay.layers[i].locked = false;   // レイヤーロックを解除
        if (lay.layers.length &gt; 0){
            layerUnlock(lay.layers[i]); // 再帰で入れ子になっているサブレイヤーを処理
        }
    }
}</code></pre>
<p>　画像やテキスト、レイヤーなどがロックされています。</p>
<figure>
<figcaption>【図】画像やテキスト、レイヤーなどがロックされている</figcaption>
<img src="images/00034.jpeg" />
</figure>
<p>
<br />
</p>
<p>　スクリプトを実行するとロックされているパスやテキストであってもロックが解除され全てのパス・図形などが選択されます。</p>
<figure>
<figcaption>【図】ロックが解除され全てのパス・図形などが選択される</figcaption>
<img src="images/00428.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-44">
<section>
<h2 id="calibre_link-380"><b>15-7　選択されたオブジェクトの種類を求める</b></h2>
<p>　選択されたオブジェクトの種類を求めるにはselection配列に入っているオブジェクトのtypenameプロパティを参照します。ただし、テキストフレーム内の文字を選択した場合にはtypenameプロパティがないためエラーになります。このため、try...catchを使ってエラーを回避します。選択オブジェクトが存在するのにtypenameプロパティがない、ということはテキストフレーム内の文字が選択されている、ということになります。</p>
<table>
<caption>【表】オブジェクトの種類</caption>
<tbody>
<tr>
  <td>
    <span>typenameの内容</span>
  </td>
  <td>
    <span>説明</span>
  </td>
</tr>
<tr>
  <td>MeshItem</td>
  <td>グラデーションメッシュ</td>
</tr>
<tr>
  <td>PluginItem</td>
  <td>シンボルスプレーで描いた図形。ライブトレースした画像。</td>
</tr>
<tr>
  <td>PathItem</td>
  <td>四角形や円形などパスを使って描いた図形</td>
</tr>
<tr>
  <td>TextFrame</td>
  <td>テキストフレーム</td>
</tr>
<tr>
  <td>GraphItem</td>
  <td>グラフ</td>
</tr>
<tr>
  <td>PlacedItem</td>
  <td>リンク画像</td>
</tr>
<tr>
  <td>RasterItem</td>
  <td>埋め込まれた画像</td>
</tr>
<tr>
  <td>TextRange</td>
  <td>選択された文字</td>
</tr>
<tr>
  <td>GroupItem</td>
  <td>グループ化されたもの</td>
</tr>
<tr>
  <td>SymbolItem</td>
  <td>シンボル</td>
</tr>
</tbody>
</table>
<p>選択されたオブジェクトの種類を求めるサンプル</p>
<pre><code>// 選択されたオブジェクトの種類を表示する
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    try{
        alert("種類："+selObj[i].typename);
    }catch(e){
        alert(selObj.typename);   // 文字が選択されていた場合
    }
}</code></pre>
<p>　選択したオブジェクトの種類がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】選択したオブジェクトの種類が表示される</figcaption>
<img src="images/00448.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-579">
<section>
<h2 id="calibre_link-381"><b>15-8　テキストフレームだけ選択する</b></h2>
<p>　テキストフレームだけ選択するにはtextFrames配列に格納されているテキストフレームオブジェクトのselectedプロパティにtrueを指定します。テキストフレームがロックされたレイヤーにある場合、selectedプロパティにtrueを指定するとエラーで停止します。これを回避するにはtry...catchを使います。</p>
<p>　テキストフレームではなく画像やグループオブジェクトを選択するにはtextFramesの部分をpathItemsやgroupItemsに変更します。どのようなオブジェクトが指定できるかを下表に示します。</p>
<table>
<caption>【表】指定できるオブジェクト名</caption>
<tbody>
<tr>
  <td>
    <span>オブジェクト名</span>
  </td>
  <td>
    <span>オブジェクトの種類</span>
  </td>
</tr>
<tr>
  <td>compoundPathItem</td>
  <td>複合パス</td>
</tr>
<tr>
  <td>graphItem</td>
  <td>グラフ</td>
</tr>
<tr>
  <td>groupItem</td>
  <td>グループ化されたもの</td>
</tr>
<tr>
  <td>legacyTextItem</td>
  <td>かなり古いIllustratorで作成されたテキストフレーム</td>
</tr>
<tr>
  <td>meshItem</td>
  <td>グラデーションメッシュ</td>
</tr>
<tr>
  <td>nonNativeItems</td>
  <td>あらかじめIllustratorに実装されていないもの</td>
</tr>
<tr>
  <td>pathItem</td>
  <td>四角形や円形などパスを使って描いた図形</td>
</tr>
<tr>
  <td>placedItem</td>
  <td>リンク画像</td>
</tr>
<tr>
  <td>pluginItem</td>
  <td>シンボルスプレーで描いた図形。ライブトレースした画像。</td>
</tr>
<tr>
  <td>rasterItem</td>
  <td>埋め込まれた画像</td>
</tr>
<tr>
  <td>symbolItem</td>
  <td>シンボル</td>
</tr>
<tr>
  <td>textFrame</td>
  <td>テキストフレーム</td>
</tr>
</tbody>
</table>
<p>テキストフレームだけ選択するサンプル</p>
<pre><code>// テキストフレームだけを選択する
activeDocument.selection = null;    // 全ての選択を解除する
var txtObj = activeDocument.textFrames;
for (var i=0; i&lt;txtObj.length; i++){    // テキストフレーム数だけ繰り返す
    try {
        txtObj[i].selected = true;  // 選択する
    }catch(e){}
}</code></pre>
<p>　テキストフレームだけが選択されます。</p>
<figure>
<figcaption>【図】テキストフレームだけが選択される</figcaption>
<img src="images/00212.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-744">
<section>
<h2 id="calibre_link-382"><b>15-9　テキストフレームだけ選択を解除する</b></h2>
<p>　テキストフレームだけ選択を解除するにはtextFrames配列に格納されているテキストフレームオブジェクトのselectedプロパティにfalseを指定します。テキストフレームがロックされたレイヤーにある場合、selectedプロパティにfalseを指定するとエラーで停止します。このエラーによる停止を防ぐにはtry...catchを使います。</p>
<p>テキストフレームだけ選択を解除するサンプル</p>
<pre><code>// テキストフレームだけ選択を解除する
var txtObj = activeDocument.textFrames;
for (var i=0; i&lt;txtObj.length; i++){
    try{
        txtObj[i].selected = false;
    }catch(e){}
}</code></pre>
<p>　パスや図形、画像、テキストフレームなどを選択します。</p>
<figure>
<figcaption>【図】パスや図形、画像、テキストフレームなどを選択する</figcaption>
<img src="images/00099.jpeg" />
</figure>
<p>　テキストフレームだけが選択解除されます。</p>
<figure>
<figcaption>【図】テキストフレームだけが選択解除される</figcaption>
<img src="images/00005.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-521">
<section>
<h2 id="calibre_link-383"><b>15-10　特定のメモ（注釈）を持つオブジェクトのみ選択する</b></h2>
<p>　特定のメモ（注釈）を持つオブジェクトのみ選択するにはpageItems配列に格納されているオブジェクトのnoteプロパティを調べます。このnoteプロパティに入っている文字列と一致したものだけを選択します。選択はオブジェクトのselectedプロパティにtrueを入れます。</p>
<p>　このnoteプロパティの内容は属性パネルのメモの欄で確認、変更することができます。</p>
<p>特定のメモ（注釈）を持つオブジェクトのみ選択するサンプル</p>
<pre><code>// 特定のメモ（注釈）を持つオブジェクトだけを選択する
var msg = prompt("ノート内の文字を指定してください", "山");
if (msg){
    var docObj = activeDocument;  // アクティブドキュメントを指定する
    for(var i=0; i&lt;docObj.pageItems.length; i++){
        if(docObj.pageItems[i].note == msg) {   // 一致しているか調べる
            try {
                docObj.pageItems[i].selected = true;    // 選択する
            }catch(e){}
        }
    }
}</code></pre>
<p>　メモの文字を入力します。</p>
<figure>
<figcaption>【図】メモの文字を入力する</figcaption>
<img src="images/00242.jpeg" />
</figure>
<p>　完全一致したメモの文字を持つオブジェクトだけが選択されます。</p>
<figure>
<figcaption>【図】完全一致したメモの文字を持つオブジェクトだけが選択される</figcaption>
<img src="images/00378.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-682">
<section>
<h2 id="calibre_link-384"><b>15-11　特定の破線パターンのパスだけ選択する</b></h2>
<p>　特定の破線パターンのパスだけ選択するにはパスのstrokeDashes配列（オブジェクト）を参照します。これが空の場合は直線であることを示します。破線の場合は線分と間隔の値が交互に入ります。これは線パネルで指定するものと全く同じものです。</p>
<p>　特定の破線パターンかどうかを調べるには配列を走査して処理する方法もありますが、toString()を使って配列データを文字列にします。このようにすることで配列内の破線パターンが「12,4,10,5」のようにカンマ区切りの数値になります。チェックする場合は、この破線パターンをユーザーにダイアログに入力してもらうことで手軽に破線パターンが一致するかどうかを調べることができます。</p>
<p>特定の破線パターンのパスだけ選択するサンプル</p>
<pre><code>// 特定の破線パターンを持つパスを選択する
var pat = prompt("破線パターンを入れてください", "12,4");
if (pat){   // 破線パターンが入力された場合に処理する
    var pObj = activeDocument.pathItems;    // 全てのパス
    for(var i=0; i&lt;pObj.length; i++){   // パスの数だけ繰り返す
        if(pObj[i].strokeDashes.toString() == pat){ // 破線パターンと一致しているか調べる
            pObj[i].selected = true;    // 一致したら選択する
        }
    }
}</code></pre>
<p>　選択したい破線パターンを入力します。</p>
<figure>
<figcaption>【図】選択したい破線パターンを入力する</figcaption>
<img src="images/00161.jpeg" />
</figure>
<p>　該当する破線パターンを持つパスが選択されます。</p>
<figure>
<figcaption>【図】該当する破線パターンを持つパスが選択される</figcaption>
<img src="images/00023.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-46">
<section>
<h2 id="calibre_link-385"><b>15-12　選択された中でパスを削除する</b></h2>
<p>　パスや画像などさまざまなものが選択された中でパスだけを削除するには、選択されたオブジェクトがパスかどうかを調べる必要があります。パスかどうかは選択されたオブジェクトのtypenameプロパティを調べます。このtypenameプロパティがPathItemの文字であれば選択されたものはパスということになります。あとはremove()メソッドを使ってパスを削除します。</p>
<p>選択された中でパスを削除するサンプル</p>
<pre><code>// 選択された中でパスだけ削除する
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    if (selObj[i].typename == "PathItem"){  // パスかどうか
        selObj[i].remove(); // 削除する
    }
}</code></pre>
<p>　各種図形やテキストなどを選択します。</p>
<figure>
<figcaption>【図】各種図形やテキストなどを選択する</figcaption>
<img src="images/00199.jpeg" />
</figure>
<p>　スクリプトを実行すると種類がパスになっている図形だけが削除されます。</p>
<figure>
<figcaption>【図】種類がパスになっている図形だけが削除される</figcaption>
<img src="images/00558.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-582">
<section>
<div>
<h1 id="calibre_link-386"><b>第16章　選択（文字／TextRange）</b></h1>
</div>
<p>　この章では、テキストフレーム内で選択されている文字に関するサンプルを示し、解説します。スクリプトならではの複数選択やフォント指定などさまざまな処理を行うことができます。</p>
</section>
</div>
<div id="calibre_link-748">
<section>
<h2 id="calibre_link-387"><b>16-1　選択されたテキストフレーム内の文字を取得する</b></h2>
<p>　選択されたテキストフレーム内の文字を取得するにはselectionオブジェクトのtypenameプロパティを参照します。このtypenameプロパティがTextRangeの文字であればテキストフレーム内に選択された文字があることになります。選択された文字をまとめて読み出すにはTextRangeオブジェクトのcontentsプロパティを参照します。</p>
<p>選択されたテキストフレーム内の文字を取得するサンプル</p>
<pre><code>// 選択された文字を表示する
var selObj = activeDocument.selection;
if(selObj.typename == "TextRange"){ // 選択テキストかどうか
    alert(selObj.contents);  // 選択文字を表示
}else{
    alert("選択されているのは文字ではありません");
}</code></pre>
<p>　スクリプトを実行すると選択された文字がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】選択された文字が表示される</figcaption>
<img src="images/00231.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-526">
<section>
<h2 id="calibre_link-388"><b>16-2　選択したテキストフレーム内の文字を削除する</b></h2>
<p>　選択したテキストフレーム内の文字を削除するにはselectionオブジェクトのtypenameプロパティを参照します。このtypenameプロパティがTextRangeの文字であればテキストフレーム内に選択された文字があることになります。選択された文字を削除するにはremove()メソッドを使います。</p>
<p>　削除後でも選択範囲は、そのまま残るため選択範囲を解除したい場合にはdeSelect()メソッドを使うか、activeDocument.selection = null;とします。</p>
<p>選択したテキストフレーム内の文字を削除するサンプル</p>
<pre><code>// 選択された文字を削除する
var selObj = activeDocument.selection;
if(selObj.typename == "TextRange"){
    selObj.remove();    // 削除する
    selObj.deSelect();  // 選択を解除する
}</code></pre>
<p>　文字を選択します。</p>
<figure>
<figcaption>【図】文字を選択する</figcaption>
<img src="images/00334.jpeg" />
</figure>
<p>　スクリプトを実行すると文字が削除されます。</p>
<figure>
<figcaption>【図】文字が削除される</figcaption>
<img src="images/00426.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-688">
<section>
<h2 id="calibre_link-389"><b>16-3　選択されたテキストフレームの特定の行を選択する</b></h2>
<p>　選択されたテキストフレームの特定の行を選択するにはテキストフレームのlines配列に格納されている行オブジェクトのselect()メソッドを使います。linesは配列なので最初の行はlines[0]、2行目はlines[1]、3行目はlines[2]のように示すことができます。つまりlines[]で指定する番号は実際の行数より1少ない値になります。例えばlines[2].select()とすれば3行目を選択することができます。</p>
<p>　ただし、3行目が存在しない場合はエラーで停止します。このような場合はサンプルのように行数を調べて最終行を選択する方法もあります。また、テキストフレームに何も文字が入力されていない場合は0行になるため、lines.lengthを使って行数を調べ0行でない場合に行を選択する処理を行うようにします。</p>
<p>選択されたテキストフレームの特定の行を選択するサンプル</p>
<pre><code>// 選択されたテキストフレームの３行目を選択し３行目が存在しない場合は最終行を選択する。
var txtObj = activeDocument.selection[0];
if (txtObj.lines.length &gt; 0) {
    var lineCount = 2;  // 3行目。最初の行は0になるため。
    if (txtObj.lines.length &lt; lineCount+1) {    // 該当行が存在しない場合
        lineCount =  txtObj.lines.length - 1;   // 最終行を指定
    }
    txtObj.lines[lineCount].select(); // 行を選択する
}</code></pre>
<p>　スクリプトを実行すると選択したテキストフレームの3行目が選択されます。</p>
<figure>
<figcaption>【図】テキストフレームの3行目が選択される</figcaption>
<img src="images/00126.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-608">
<section>
<h2 id="calibre_link-390"><b>16-4　テキストフレーム内で任意の位置から文字を新規に選択する</b></h2>
<p>　テキストフレーム内で任意の位置から文字を新規に選択するにはテキストフレーム内の文字が選択できる状態になっている必要があります。この状態からTextRangeオブジェクトのcharacterOffsetに選択開始位置を指定します。characterOffsetは最初の文字を0としているため、4文字目から選択したければ3を指定します。</p>
<p>　何文字分選択するかを指定するにはTextRangeオブジェクトのlengthプロパティに文字数を指定します。</p>
<p>　新規に選択する場合にはTextRangeオブジェクトのdeSelect()メソッドを使い既存の選択範囲を解除し、その後select()メソッドを使います。このselect()メソッドのパラメーターにtrueを指定すると、すでにある選択範囲に追加する形になります。deSelect()メソッドで解除してあるため、指定した範囲が新規に選択されます。</p>
<p>テキストフレーム内で任意の位置から文字を新規に選択するサンプル</p>
<pre><code>// 文字の選択範囲を指定する
var trObj = activeDocument.selection;
if(trObj.typename &amp;&amp; trObj.typename == "TextRange"){
    trObj.characterOffset = 3;  // 4文字目から選択する
    trObj.length = 7;  // 7文字分を選択する
    trObj.deSelect();   // 一度選択範囲を解除する
    trObj.select(true); // 新規に選択範囲とする
}</code></pre>
<p>　スクリプトを実行すると選択したテキストフレーム内の文字が選択されます。</p>
<figure>
<figcaption>【図】テキストフレーム内の文字が選択される</figcaption>
<img src="images/00029.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-633">
<section>
<h2 id="calibre_link-391"><b>16-5　テキストフレーム内で複数の選択範囲を指定する</b></h2>
<p>　テキストフレーム内で複数の選択範囲を指定するにはテキストフレーム内の文字が選択できる状態になっている必要があります。この状態からTextRangeオブジェクトのcharacterOffsetに選択開始位置、lengthに選択文字数を指定します。</p>
<p>　複数の選択範囲にするためにはTextRangeオブジェクトのselect()メソッドにtrueを指定します。その後、さらにcharacterOffsetに選択開始位置、lengthに選択文字数を指定しselect()メソッドを呼び出します。このようにすることで複数の選択範囲を作成することができます。なお、このような複数の文字選択方法は通常のIllustratorの操作では行うことができません。</p>
<p>テキストフレーム内で複数の選択範囲を指定するサンプル</p>
<pre><code>// 複数の文字の選択範囲を指定する
var trObj = activeDocument.selection;
if(trObj.typename &amp;&amp; trObj.typename == "TextRange"){
    trObj.deSelect();   // 選択を解除する
    trObj.characterOffset = 1;  // 2文字から
    trObj.length = 3;   //  3文字分を選択する
    trObj.select(true); // 既存の選択範囲に追加する
    trObj.characterOffset = 10; // 11文字目から
    trObj.length = 4;   //  4文字分を選択する
    trObj.select(true);// 既存の選択範囲に追加する
    trObj.characterOffset = 20; // 21文字目から
    trObj.length = 5;   //  5文字分を選択する
    trObj.select(true);// 既存の選択範囲に追加する
}</code></pre>
<p>　スクリプトを実行すると選択したテキストフレーム内の文字が複数選択されます。</p>
<figure>
<figcaption>【図】テキストフレーム内の文字が複数選択される</figcaption>
<img src="images/00515.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-32">
<section>
<h2 id="calibre_link-392"><b>16-6　テキストフレーム内で選択された文字の位置を求める</b></h2>
<p>　テキストフレーム内で選択された文字の位置を求めるにはTextRangeオブジェクトのcharacterOffsetを参照します。この場合、characterOffsetは最初の文字を1とするため、3文字目から選択されていれば3となります。何文字選択されているかを求めるにはTextRangeオブジェクトのinsertionPoints配列の長さを調べます。最終文字の位置はinsertionPoints.lengthから1を引いた値になります。</p>
<p>テキストフレーム内で選択された文字の位置を求めるサンプル</p>
<pre><code>// 選択されたテキストフレーム内の文字の開始位置と文字数を表示する
var trObj = activeDocument.selection;
if(trObj.typename &amp;&amp; trObj.typename == "TextRange"){
    var sp = trObj.characterOffset; // 選択開始位置
    var ep = trObj.insertionPoints.length-1;    // 選択終了位置
    alert(sp+"文字目から"+ep+"文字が選択されています");
}</code></pre>
<p>　スクリプトを実行するとテキストフレームで選択されている開始位置と選択された文字数がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】開始位置と選択された文字数が表示される</figcaption>
<img src="images/00221.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-564">
<section>
<h2 id="calibre_link-393"><b>16-7　選択文字か挿入ポイントの前後に文字を追加する</b></h2>
<p>　選択文字か挿入ポイントの前後に文字を追加するにはTextRangeオブジェクトのinsertionPointsオブジェクトを利用します。insertionPointsは選択された文字の数だけ配列に情報が入っています。insertionPoints[0]とすると選択した最初の文字（または挿入ポイント）にアクセスすることができます。選択した文字の最終位置はinsertionPoints.lengthにアクセスすることで取得することができます。</p>
<p>　文字を追加するにはinsertionPointsオブジェクトのcharactersオブジェクトのadd()メソッドを使います。add()メソッドのパラメーターに挿入したい文字列を指定します。</p>
<p>選択文字か挿入ポイントの前後に文字を追加するサンプル</p>
<pre><code>// 選択文字か挿入ポイントの前後に文字を追加する
var trObj = activeDocument.selection;
if(trObj.typename &amp;&amp; trObj.typename == "TextRange"){
    var ip = trObj.insertionPoints[0];  // 選択開始位置
    var len = trObj.insertionPoints.length; // 選択終了位置
    ip.characters.add("【"); // 選択文字の前に文字を追加
    var ip = trObj.insertionPoints[len];  // 選択開始位置
    ip.characters.add("】"); // 選択文字の後に文字を追加
    trObj.deSelect();   // 選択解除
}</code></pre>
<p>　カッコを追加する文字を選択します。</p>
<figure>
<figcaption>【図】カッコを追加する文字を選択する</figcaption>
<img src="images/000301.gif" />
</figure>
<p>　スクリプトを実行すると文字の前後にカッコが追加されます。</p>
<figure>
<figcaption>【図】文字の前後にカッコが追加される</figcaption>
<img src="images/000357.gif" />
</figure>
</section>
</div>
<div id="calibre_link-732">
<section>
<h2 id="calibre_link-394"><b>16-8　複数のテキストフレーム内で文字を選択する</b></h2>
<p>　複数のテキストフレーム内で文字を選択するにはTextRangeオブジェクトを利用します。文字はTextRangeオブジェクトを操作することで自由に選択することができます。手動でIllustratorを操作する場合は1つのテキストフレーム内にある1つの選択範囲だけですが、プログラムでは複数のテキストフレーム内で複数の選択範囲を指定することができます。</p>
<p>　文字を任意の位置から選択する際、先にlengthプロパティに文字数を設定した後でcharacterOffsetに選択開始位置を指定してください。このようにしないとエラーで停止してしまうことがあります。どうしても先にcharacterOffsetに選択開始位置を指定しなければならない場合は初期値として0を設定しておきます。</p>
<p>　選択位置と選択文字数の設定が終わったらselect(true)として選択範囲を追加します。</p>
<p>複数のテキストフレーム内で文字を選択するサンプル</p>
<pre><code>// 複数のテキストフレーム内で文字を選択する
for(var i=0; i&lt;activeDocument.selection.length; i++){
    var txtObj = activeDocument.selection[i];
    if(txtObj.typename == "TextFrame"){
        trObj = txtObj.textRange;
        trObj.characterOffset = 0;  // 最初に必ず0をセットする
        trObj.length = 28;   //  3文字分を選択する
        trObj.characterOffset = 10; // 10文字目から選択
        trObj.select(true); // 既存の選択範囲に追加する
    }
}</code></pre>
<p>　複数のテキストフレームを選択します。</p>
<figure>
<figcaption>【図】複数のテキストフレームを選択する</figcaption>
<img src="images/000081.gif" />
</figure>
<p>　スクリプトを実行すると選択した複数のテキストフレーム内の文字が選択されます。選択された文字のフォントやサイズ、色などは各種パネルで設定することができます。</p>
<figure>
<figcaption>【図】選択した複数のテキストフレーム内の文字が選択される</figcaption>
<img src="images/000017.gif" />
</figure>
</section>
</div>
<div id="calibre_link-69">
<section>
<h2 id="calibre_link-395"><b>16-9　複数のテキストフレームで半角数値のみ選択する</b></h2>
<p>　複数のテキストフレームで半角数値のみ選択するには、選択されたテキストフレームのTextRangeを利用します。テキストフレーム内の文字を読み出し正規表現で置換処理を行うreplace()メソッドを使って数値を選択します。数値は正規表現では\d+として指定します。正規表現のreplace()メソッドは2番目のパラメーターに置換文字でなく関数を指定することができます。一般的には置換処理を行いますが、ここではマッチした文字の位置と文字数を取得するために利用しています。replace()メソッドの最初のパラメーターにはマッチした文字列が渡されます。2番目のパラメーターはマッチした文字の位置になります。これを利用してTextRangeのcharacterOffsetとlengthに開始位置と選択文字数を設定します。replace()メソッドはreturnで置換する文字を返す必要があります。この場合は何も置換しないのでマッチした文字列を、そのまま返します。</p>
<p>　なお、テキストフレームが他のテキストフレームにリンクされている場合は正しく動作しません。</p>
<p>複数のテキストフレームで半角数値のみ選択するサンプル</p>
<pre><code>// 半角数値のみ選択する
for(var i=0; i&lt;activeDocument.selection.length; i++){
    var txtObj = activeDocument.selection[i];
    if(txtObj.typename == "TextFrame"){
        trObj = txtObj.textRange;
        trObj.characterOffset = 0;  // 最初に必ず0をセットする
        var text = trObj.contents;
        var point = text.replace(/\d+/g, function(str, ptr, allText){
            trObj.length = str.length;   //  マッチした文字数だけ選択する
            trObj.characterOffset = ptr; // 一致した位置から選択
            trObj.select(true); // 既存の選択範囲に追加する
            return str;
        });
    }
}</code></pre>
<p>　スクリプトを実行すると選択した複数のテキストフレーム内の数値が複数選択されます。</p>
<figure>
<figcaption>【図】選択した複数のテキストフレーム内の数値が複数選択される</figcaption>
<img src="images/000467.gif" />
</figure>
</section>
</div>
<div id="calibre_link-671">
<section>
<h2 id="calibre_link-396"><b>16-10　複数のテキストフレームで英文字のみ選択する</b></h2>
<p>　複数のテキストフレームで英文字のみ選択するには、選択されたテキストフレームのTextRangeを利用します。テキストフレーム内の文字を読み出し正規表現で置換処理を行うreplace()メソッドを使って英文字を選択します。英文字は正規表現では[a-z]として指定します。なお、英文字には大文字と小文字があるため、区別しない場合は/[a-z]/iのようにしてiオプションを付ける必要があります。</p>
<p>　正規表現のreplace()メソッドは2番目のパラメーターに置換文字でなく関数を指定することができます。一般的には置換処理を行いますが、ここではマッチした文字の位置と文字数を取得するために利用しています。replace()メソッドの最初のパラメーターにはマッチした文字列が渡されます。2番目のパラメーターはマッチした文字の位置になります。これを利用してTextRangeのcharacterOffsetとlengthに開始位置と選択文字数を設定します。replace()メソッドはreturnで置換する文字を返す必要があります。この場合は何も置換しないのでマッチした文字列を、そのまま返します。</p>
<p>　なお、テキストフレームが他のテキストフレームにリンクされている場合は正しく動作しません。</p>
<p>複数のテキストフレームで英文字のみ選択するサンプル</p>
<pre><code>// 半角英文字のみ選択する
for(var i=0; i&lt;activeDocument.selection.length; i++){
    var txtObj = activeDocument.selection[i];
    if(txtObj.typename == "TextFrame"){
        trObj = txtObj.textRange;
        var text = trObj.contents;
        var point = text.replace(/[a-z]/gi, function(str, ptr, allText){
            $.writeln(str);
            trObj.length = str.length;   //  マッチした文字数だけ選択する
            trObj.characterOffset = ptr; // 一致した位置から選択
            trObj.select(true); // 既存の選択範囲に追加する
            return str;
        });
    }
}</code></pre>
<p>　選択した複数のテキストフレーム内の英文字が複数選択されます。</p>
<figure>
<figcaption>【図】テキストフレーム内の英文字が複数選択される</figcaption>
<img src="images/000209.gif" />
</figure>
</section>
</div>
<div id="calibre_link-536">
<section>
<h2 id="calibre_link-397"><b>16-11　複数のテキストフレームで平仮名のみ選択する</b></h2>
<p>　複数のテキストフレームで平仮名のみ選択するには、選択されたテキストフレームのTextRangeを利用します。テキストフレーム内の文字を読み出し正規表現で置換処理を行うreplace()メソッドを使って平仮名を選択します。平仮名は正規表現では[ぁ-ん]として指定します。ただし、これ以外にも平仮名として登録されている文字があるため、全ての平仮名を対象にするには[ぁ-ん|ゕ|か゚|き゚|く゚|ゖ|け゚|こ゚]と指定する必要があります。</p>
<p>　正規表現のreplace()メソッドは2番目のパラメーターに置換文字でなく関数を指定することができます。一般的には置換処理を行いますが、ここではマッチした文字の位置と文字数を取得するために利用しています。replace()メソッドの最初のパラメーターにはマッチした文字列が渡されます。2番目のパラメーターはマッチした文字の位置になります。これを利用してTextRangeのcharacterOffsetとlengthに開始位置と選択文字数を設定します。replace()メソッドはreturnで置換する文字を返す必要があります。この場合は何も置換しないのでマッチした文字列を、そのまま返します。</p>
<p>　なお、テキストフレームが他のテキストフレームにリンクされている場合は正しく動作しません。</p>
<p>複数のテキストフレームで平仮名のみ選択するサンプル</p>
<pre><code>// 平仮名のみ選択する
for(var i=0; i&lt;activeDocument.selection.length; i++){
    var txtObj = activeDocument.selection[i];
    if(txtObj.typename == "TextFrame"){
        trObj = txtObj.textRange;
        var text = trObj.contents;
        var point = text.replace(/[ぁ-ん|ゕ|か゚|き゚|く゚|ゖ|け゚|こ゚]/gi, function(str, ptr, allText){
            trObj.length = str.length;   //  マッチした文字数だけ選択する
            trObj.characterOffset = ptr; // 一致した位置から選択
            trObj.select(true); // 既存の選択範囲に追加する
            return str;
        });
    }
}</code></pre>
<p>　スクリプトを実行すると選択した複数のテキストフレーム内の英文字が複数選択されます。</p>
<figure>
<figcaption>【図】複数のテキストフレーム内の平仮名が複数選択される</figcaption>
<img src="images/000256.gif" />
</figure>
</section>
</div>
<div id="calibre_link-618">
<section>
<h2 id="calibre_link-398"><b>16-12　複数のテキストフレームで片仮名のみ選択する</b></h2>
<p>　複数のテキストフレームで片仮名のみ選択するには、選択されたテキストフレームのTextRangeを利用します。テキストフレーム内の文字を読み出し正規表現で置換処理を行うreplace()メソッドを使って片仮名を選択します。片仮名は正規表現では[ァ-ン]として指定します。ただし、これ以外にも片仮名として登録されている文字があるため、全ての片仮名を対象にするには[ァ-ン|ヵ|カ゚|キ゚|ㇰ|ク゚|ケ゚|コ゚|ㇱ|ㇲ|セ゚|ツ゚|ㇳ|ト゚|ㇴ|ㇵ|ㇶ|ㇷ|ㇷ゚|ㇸ|ㇹ|ㇺ|ㇻ|ㇼ|ㇽ|ㇾ|ㇿ|ヷ|ヸ|ヹ|ヺ]と指定する必要があります。</p>
<p>　正規表現のreplace()メソッドは2番目のパラメーターに置換文字でなく関数を指定することができます。一般的には置換処理を行いますが、ここではマッチした文字の位置と文字数を取得するために利用しています。replace()メソッドの最初のパラメーターにはマッチした文字列が渡されます。2番目のパラメーターはマッチした文字の位置になります。これを利用してTextRangeのcharacterOffsetとlengthに開始位置と選択文字数を設定します。replace()メソッドはreturnで置換する文字を返す必要があります。この場合は何も置換しないのでマッチした文字列を、そのまま返します。</p>
<p>　なお、テキストフレームが他のテキストフレームにリンクされている場合は正しく動作しません。</p>
<p>複数のテキストフレームで片仮名のみ選択するサンプル</p>
<pre><code>// 片仮名のみ選択する
for(var i=0; i&lt;activeDocument.selection.length; i++){
    var txtObj = activeDocument.selection[i];
    if(txtObj.typename == "TextFrame"){
        trObj = txtObj.textRange;
        var text = trObj.contents;
        var point = text.replace(/[ァ-ン|ヵ|カ゚|キ゚|ㇰ|ク゚|ケ゚|コ゚|ㇱ|ㇲ|セ゚|ツ゚|ㇳ|ト゚|ㇴ|ㇵ|ㇶ|ㇷ|ㇷ゚|ㇸ|ㇹ|ㇺ|ㇻ|ㇼ|ㇽ|ㇾ|ㇿ|ヷ|ヸ|ヹ|ヺ]/gi, function(str, ptr, allText){
            trObj.length = str.length;   //  マッチした文字数だけ選択する
            trObj.characterOffset = ptr; // 一致した位置から選択
            trObj.select(true); // 既存の選択範囲に追加する
            return str;
        });
    }
}</code></pre>
<p>　スクリプトを実行すると選択した複数のテキストフレーム内の片仮名が複数選択されます。</p>
<figure>
<figcaption>【図】複数のテキストフレーム内の片仮名が複数選択される</figcaption>
<img src="images/000408.gif" />
</figure>
</section>
</div>
<div id="calibre_link-631">
<section>
<h2 id="calibre_link-399"><b>16-13　複数のテキストフレームで特定の文字のみ選択する</b></h2>
<p>　複数のテキストフレームで特定の文字のみ選択するには、選択されたテキストフレームのTextRangeを利用します。テキストフレーム内の文字を読み出し正規表現で置換処理を行うreplace()メソッドを使い選択します。replace()メソッドの最初のパラメーターにメタ文字以外の文字を指定すると、完全一致した文字列が選択されます。サンプルのようにダイアログで文字を入力し、それをパラメーターとして指定することもできます。</p>
<p>　正規表現のreplace()メソッドは2番目のパラメーターに置換文字でなく関数を指定することができます。一般的には置換処理を行いますが、ここではマッチした文字の位置と文字数を取得するために利用しています。replace()メソッドの最初のパラメーターにはマッチした文字列が渡されます。2番目のパラメーターはマッチした文字の位置になります。これを利用してTextRangeのcharacterOffsetとlengthに開始位置と選択文字数を設定します。replace()メソッドはreturnで置換する文字を返す必要があります。この場合は何も置換しないのでマッチした文字列を、そのまま返します。</p>
<p>　なお、テキストフレームが他のテキストフレームにリンクされている場合は正しく動作しません。</p>
<p>複数のテキストフレームで特定の文字のみ選択するサンプル</p>
<pre><code>// 特定の文字のみ選択する
var mtext = prompt("マッチする文字列を入力してください", "消費税");
if (!mtext){ mtext = "円";  }  // 何も入力されなかったら円の文字にする
for(var i=0; i&lt;activeDocument.selection.length; i++){
    var txtObj = activeDocument.selection[i];
    if(txtObj.typename == "TextFrame"){
        trObj = txtObj.textRange;
        var text = trObj.contents;
        var point = text.replace(new RegExp(mtext, "gi"), function(str, ptr, allText){
            trObj.length = str.length;   //  マッチした文字数だけ選択する
            trObj.characterOffset = ptr; // 一致した位置から選択
            trObj.select(true); // 既存の選択範囲に追加する
            return str;
        });
    }
}</code></pre>
<p>　マッチさせたい単語を入力します。</p>
<figure>
<figcaption>【図】マッチさせたい単語を入力する</figcaption>
<img src="images/00566.jpeg" />
</figure>
<p>　選択した複数のテキストフレーム内からマッチした単語が複数選択されます。</p>
<figure>
<figcaption>【図】複数のテキストフレーム内からマッチした単語が複数選択される</figcaption>
<img src="images/000496.gif" />
</figure>
</section>
</div>
<div id="calibre_link-669">
<section>
<h2 id="calibre_link-400"><b>16-14　選択された文字の色を変更する</b></h2>
<p>　選択された文字の色を変更するには選択された文字のcharacterAttributesにあるfillColorプロパティにサイズを設定します。カラーは各種カラーオブジェクトを利用して指定します。</p>
<p>　行単位で色を変更する場合はlines配列内にあるcharacterAttributes.fillColorプロパティにカラーを設定します。</p>
<p>　1文字ずつ変更したい場合には選択された文字のcharacters配列を利用します。characters配列には選択された文字の数だけ、文字に関する情報（属性）オブジェクトが格納されています。</p>
<p>選択された文字の色を変更するサンプル</p>
<pre><code>// 選択された文字のカラーを変更する
var selObj = activeDocument.selection;
if(selObj.typename == "TextRange"){
    // 選択範囲全体の色を変更する
    selObj.characterAttributes.fillColor = setRGBColor(255, 0, 0);
    // 選択された3行目の色を変更する
    selObj.lines[2].characterAttributes.fillColor = setRGBColor(0, 0, 255);
    // 選択された先頭の10文字分色を変更する
    for(var i=0; i&lt;10; i++){
        selObj.characters[i].characterAttributes.fillColor = setRGBColor(0, 255, 0);
    }
}
// RGBカラーを設定し、RGBカラーオブジェクトを返す
function setRGBColor(r,g,b){
    var RGB = new RGBColor();
    RGB.red = r;
    RGB.green = g;
    RGB.blue = b;
    return RGB;
}</code></pre>
<p>　テキストフレーム内の文字を選択します。</p>
<figure>
<figcaption>【図】文字を選択する</figcaption>
<img src="images/00288.jpeg" />
</figure>
<p>　全体の色が変更された後、3行目と先頭の10文字の色が変更されます。</p>
<figure>
<figcaption>【図】全体と、3行目と先頭の10文字の色が変更される</figcaption>
<img src="images/00201.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-100">
<section>
<h2 id="calibre_link-401"><b>16-15　選択された文字のサイズを変更する</b></h2>
<p>　選択された文字のサイズを変更するには選択された文字のcharacterAttributesにあるsizeプロパティにサイズを数値で設定します。サイズはポイントで指定します。</p>
<p>　行単位でサイズを変更する場合はlines配列内にあるcharacterAttributes.sizeプロパティにサイズを設定します。</p>
<p>　1文字ずつ変更したい場合には選択された文字のcharacters配列を利用します。characters配列には選択された文字の数だけ、文字に関する情報（属性）オブジェクトが格納されています。</p>
<p>選択された文字のサイズを変更するサンプル</p>
<pre><code>// 選択された文字のサイズを変更する
var selObj = activeDocument.selection;
if(selObj.typename == "TextRange"){
    // 選択範囲全体のサイズを変更する
    selObj.characterAttributes.size = 9;
    // 選択された3行目のサイズを変更する
    selObj.lines[2].characterAttributes.size = 32;
    // 選択された先頭の10文字分のサイズを変更する
    for(var i=0; i&lt;10; i++){
        selObj.characters[i].characterAttributes.size = 12 + i;
    }
}</code></pre>
<p>　テキストフレーム内の文字を選択します。</p>
<figure>
<figcaption>【図】文字を選択する</figcaption>
<img src="images/00206.jpeg" />
</figure>
<p>　全体のサイズが変更された後、3行目と先頭から10文字分のサイズが変更されます。</p>
<figure>
<figcaption>【図】全体と、3行目と先頭の10文字のサイズが変更される</figcaption>
<img src="images/00561.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-761">
<section>
<h2 id="calibre_link-402"><b>16-16　半角数字を縦中横にする</b></h2>
<p>　半角数字を縦中横にするには、文字のbaselineDirectionプロパティ（属性）にBaselineDirectionType.TateChuYokoを設定します。ただし、文字列を走査し処理すると時間がかかるため、該当する文字を選択した後で文字のbaselineDirectionプロパティにBaselineDirectionType.TateChuYokoを設定します。このようにすることで数倍高速に処理することができます。</p>
<p>　サンプルではテキストフレーム内をダブルクリックしてカーソルが点滅した状態で実行すると半角数字を縦中横にします。また、正規表現で\d{1,2}として1~2桁までの数値にマッチするようにしていますが、数値が3桁以上の場合でも、まとめて縦中横になります。（Illustratorの仕様なので2桁ごとに選択して縦中横にしても選択された数桁がまとめて回転します。選択せずに処理しても同じです。）</p>
<p>半角数字を縦中横にするサンプル</p>
<pre><code>// 半角数字を縦中横にする
var trObj = activeDocument.selection.parent.textRange;
trObj.contents.replace(/\d{1,2}/g, function(str, ptr){
    trObj.length = str.length;  // 文字の長さ＝選択文字数を設定
    trObj.characterOffset = ptr;    // 選択文字の開始位置
    trObj.select(true); // 追加して選択する
    return str;
});
var selObj = activeDocument.selection;  // 複数の選択箇所を処理する
for(var i=0; i&lt;selObj.length; i++){
    selObj[i].baselineDirection = BaselineDirectionType.TateChuYoko;    // 縦中横にする
}</code></pre>
<p>　テキストフレームをダブルクリックしてカーソルが点滅した状態にします。</p>
<figure>
<figcaption>【図】ダブルクリックしてカーソルが点滅した状態にする</figcaption>
<img src="images/00001.jpeg" />
</figure>
<p>　スクリプトを実行すると半角数値が回転し縦中横になります。</p>
<figure>
<figcaption>【図】半角数値が回転し縦中横になる</figcaption>
<img src="images/00000.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-604">
<section>
<div>
<h1 id="calibre_link-403"><b>第17章　グラフィックスタイル</b></h1>
</div>
<p>　グラフィックスタイルに関するサンプルと解説です。グラフィックスタイルはパネルで操作することができますが、スクリプトでも処理することができます。</p>
</section>
</div>
<div id="calibre_link-648">
<section>
<h2 id="calibre_link-404"><b>17-1　グラフィックスタイルの登録数を表示する</b></h2>
<p>　グラフィックスタイルの登録数を表示するにはドキュメントオブジェクトのgraphicStyles配列の長さを調べます。つまりactiveDocument.graphicStyles.lengthとするとアクティブになっているドキュメントに登録されているグラフィックスタイルの総数を取得することができます。</p>
<p>　登録されているグラフィックスタイルの情報を取得したい場合はgraphicStyles配列に格納されているグラフィックスタイルオブジェクトの各プロパティを読み出します。グラフィックスタイルオブジェクトのプロパティを下表に示します。</p>
<table>
<caption>【表】グラフィックスタイルオブジェクトのプロパティ</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ</span>
  </td>
  <td>
    <span>取得する情報</span>
  </td>
</tr>
<tr>
  <td>name</td>
  <td>名前</td>
</tr>
<tr>
  <td>parent</td>
  <td>親ドキュメントを示す</td>
</tr>
<tr>
  <td>typename</td>
  <td>種類（GraphicStyleの文字列）</td>
</tr>
</tbody>
</table>
<p>グラフィックスタイルの登録数を表示するサンプル</p>
<pre><code>// グラフィックスタイルの登録数を表示する
var n = activeDocument.graphicStyles.length;
var txt = "登録数：" + n +"\r";
for(var i=0; i&lt;n; i++){
    txt = txt + activeDocument.graphicStyles[i].name + "\r";
}
alert(txt);</code></pre>
<p>　グラフィックスタイルの総数と名前がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】総数と名前がアラートダイアログに表示される</figcaption>
<img src="images/00374.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-693">
<section>
<h2 id="calibre_link-405"><b>17-2　選択した文字や図形にグラフィックスタイルを設定する</b></h2>
<p>　選択した文字や図形にグラフィックスタイルを設定するにはグラフィックスタイルオブジェクトのapplyTo()メソッドを使います。このapplyTo()メソッドのパラメーターにグラフィックスタイルを反映させる図形のオブジェクトを指定します。なお、グループ化されていたり、複合パスになっているような場合は反映されません。</p>
<p>　グラフィックスタイルは名前か参照番号で指定します。つまりactiveDocument.graphicStyles["木の葉_GS"].またはactiveDocument.graphicStyles[3]のように指定します。なお、該当する名前のグラフィックスタイルがない場合はエラーになります。</p>
<p>グラフィックスタイルを設定するサンプル</p>
<pre><code>// 選択した文字や図形にグラフィックスタイルを設定する
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    activeDocument.graphicStyles["木の葉_GS"].applyTo(selObj[i]);
}</code></pre>
<p>　グラフィックスタイルを設定する図形を選択します。</p>
<figure>
<figcaption>【図】図形を選択</figcaption>
<img src="images/00194.jpeg" />
</figure>
<p>　グラフィックスタイルが設定されます。</p>
<figure>
<figcaption>【図】グラフィックスタイルが設定される</figcaption>
<img src="images/00162.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-737">
<section>
<h2 id="calibre_link-406"><b>17-3　グラフィックスタイルを削除する</b></h2>
<p>　ドキュメントに登録されているグラフィックスタイルを削除するにはremove()メソッドを使います。graphicStyles配列で削除する名称を指定しremove()メソッドを実行します。</p>
<p>　個別に削除するのではなく全てのグラフィックスタイルを削除する場合はactiveDocument.graphicStyles.removeAll();のようにremoveAll()メソッドを使います。</p>
<p>　なお、ドキュメントのグラフィックスタイルを削除するのではなく、図形のグラフィックスタイルを削除したい場合はactiveDocument.graphicStyles["[デフォルト]"].applyTo(~)のようにデフォルトのグラフィックスタイルを設定します。</p>
<p>グラフィックスタイルを削除するサンプル</p>
<pre><code>// グラフィックスタイルを削除する
activeDocument.graphicStyles["木の葉_GS"].remove();</code></pre>
<p>　グラフィックスタイルを削除する前の状態です。</p>
<figure>
<figcaption>【図】グラフィックスタイルを削除する前</figcaption>
<img src="images/00386.jpeg" />
</figure>
<p>　スクリプトを実行するとグラフィックスタイルから「木の葉_GS」が削除されます。</p>
<figure>
<figcaption>【図】グラフィックスタイルが削除される</figcaption>
<img src="images/00554.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-51">
<section>
<div>
<h1 id="calibre_link-407"><b>第18章　グラフ</b></h1>
</div>
<p>　グラフに関するサンプルと解説です。スクリプトではグラフ操作で多くのことは扱えず基本的な操作のみになります。</p>
</section>
</div>
<div id="calibre_link-665">
<section>
<h2 id="calibre_link-408"><b>18-1　ドキュメント内にあるグラフ数を表示する</b></h2>
<p>　ドキュメント内にあるグラフはgraphItems配列に格納されています。配列なのでlengthプロパティを参照すればドキュメント内にあるグラフの総数を求めることができます。</p>
<p>グラフ数を表示するサンプル</p>
<pre><code>// ドキュメント内にあるグラフ数を表示する
var n = activeDocument.graphItems.length;
alert(n+"個のグラフがあります");</code></pre>
<p>　ドキュメント内にあるグラフオブジェクトの総数がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】グラフオブジェクトの総数が表示される</figcaption>
<img src="images/00091.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-113">
<section>
<h2 id="calibre_link-409"><b>18-2　ドキュメント内にあるグラフを全て削除する</b></h2>
<p>　ドキュメント内にあるグラフを全て削除するには、グラフオブジェクトのremoveAll()メソッドを使います。</p>
<p>グラフを全て削除するサンプル</p>
<pre><code>// ドキュメント内にあるグラフを全て削除する
activeDocument.graphItems.removeAll();</code></pre>
<p>　ドキュメント内には複数のグラフがあります。</p>
<figure>
<figcaption>【図】複数のグラフがある</figcaption>
<img src="images/00332.jpeg" />
</figure>
<p>　スクリプトを実行するとドキュメント内にあるグラフが全て削除されます。</p>
<figure>
<figcaption>【図】グラフが全て削除される</figcaption>
<img src="images/00182.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-534">
<section>
<h2 id="calibre_link-410"><b>18-3　ドキュメント内にあるグラフのオフセットを指定する</b></h2>
<p>　ドキュメント内にあるグラフのオフセットを指定するには、グラフオブジェクトのwrappedプロパティにtrueを設定します。通常、グラフを作成した段階ではグラフ全体を囲む枠は設定されていません。グラフオブジェクトのwrappedプロパティにtrueを設定すると、グラフ全体を囲む枠が追加されます。プログラムでグラフ全体の位置を調整する場合、グラフが囲まれていると囲まれた枠の座標が基準になります。</p>
<p>　グラフを囲む枠はグラフの外側にするか内側にするかをwrapInsideプロパティで設定することができます。trueを指定すると内側に、falseを指定すると外側を囲むようになります。グラフからどの程度の余白の枠にするかはwrapOffsetプロパティで設定することができます。</p>
<p>グラフのオフセットを指定するサンプル</p>
<pre><code>// ドキュメント内にあるグラフのオフセットを指定する
var gObj = activeDocument.graphItems;
for(var i=0; i&lt;gObj.length; i++){
    gObj[i].wrapped = true; // グラフをラップする
    gObj[i].wrapInside = false; // 外側にラップする
    gObj[i].wrapOffset = 20;    // グラフの余白
}</code></pre>
<p>　ドキュメント内には複数のグラフがあります。単純にグラフを作成した場合、グラフはラップ（囲まれて）されていません。</p>
<figure>
<figcaption>【図】複数のグラフがある</figcaption>
<img src="images/00121.jpeg" />
</figure>
<p>　スクリプトを実行するとグラフを包むように枠が追加されます。</p>
<figure>
<figcaption>【図】枠が追加される</figcaption>
<img src="images/00157.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-4">
<section>
<div>
<h1 id="calibre_link-411"><b>第19章　シンボル</b></h1>
</div>
<p>　シンボルに関するサンプルと解説です。ここでのシンボルはドキュメント上に配置されたものではなく、シンボルパネルにあるシンボルを示します。</p>
</section>
</div>
<div id="calibre_link-544">
<section>
<h2 id="calibre_link-412"><b>19-1　登録されているシンボル数を表示する</b></h2>
<p>　登録されているシンボル数（シンボルパネルに表示されているシンボル数）はsymbols配列に格納されています。配列なのでlengthプロパティを参照すればシンボルの総数を求めることができます。</p>
<p>登録されているシンボル数を表示するサンプル</p>
<pre><code>// 登録されているシンボル数を表示する
var n = activeDocument.symbols.length;
alert(n+"個のシンボルがあります");</code></pre>
<p>　シンボルパネルに表示されている数が登録数になるので、その個数がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】個数がアラートダイアログに表示される</figcaption>
<img src="images/00510.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-706">
<section>
<h2 id="calibre_link-413"><b>19-2　特定の名前を持つシンボルを削除する</b></h2>
<p>　特定の名前を持つシンボルを削除するにはsymbols配列の添え字に名前を指定します。サンプルではsymbols["プロセス長方形"]のようにしてプロセス長方形という名前のシンボルを指定しています。指定したシンボルを削除するにはremove()メソッドを使います。また、symbols[2]のようにして名前でなく登録してある順番を指定することもできます。</p>
<p>　指定したシンボル名が存在しない場合はエラーになるのでサンプルのようにtry...catchを使ってエラーを回避します。</p>
<p>特定の名前を持つシンボルを削除するサンプル</p>
<pre><code>// 特定の名前を持つシンボルを削除する
try{
    activeDocument.symbols["プロセス長方形"].remove();
}catch(e){
    alert("該当するシンボル名はありません");
}</code></pre>
<p>　7つのシンボルが登録されています。</p>
<figure>
<figcaption>【図】7つのシンボルが登録されている</figcaption>
<img src="images/00578.jpeg" />
</figure>
<p>　スクリプトを実行すると最初のシンボル（プロセス長方形という名前のシンボル）が削除されます。</p>
<figure>
<figcaption>【図】最初のシンボルが削除される</figcaption>
<img src="images/00298.jpeg" />
</figure>
<p>　さらに同じスクリプトを実行すると、該当する名前のシンボルがないため、その旨のメッセージがアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】アラートダイアログに表示される</figcaption>
<img src="images/00172.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-111">
<section>
<h2 id="calibre_link-414"><b>19-3　全てのシンボルを削除する</b></h2>
<p>　全てのシンボルを削除するにはsymbolオブジェクトのremoveAll()メソッドを使います。</p>
<p>全てのシンボルを削除するサンプル</p>
<pre><code>// 全てのシンボルを削除する
activeDocument.symbols.removeAll();</code></pre>
<p>　シンボルパネルに7つのシンボルが登録されています。</p>
<figure>
<figcaption>【図】7つのシンボルが登録されている</figcaption>
<img src="images/00077.jpeg" />
</figure>
<p>　スクリプトを実行すると全てのシンボルが削除されます。</p>
<figure>
<figcaption>【図】全てのシンボルが削除される</figcaption>
<img src="images/00367.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-649">
<section>
<h2 id="calibre_link-415"><b>19-4　シンボルを登録する</b></h2>
<p>　シンボルを登録するにはsymbolオブジェクトのadd()メソッドを使います。add()メソッドのパラメーターにシンボルとして登録したい図形を指定します。以下のサンプルではグループオブジェクトを作成しadd()メソッドのパラメーターとして指定しています。登録したシンボルに名前を付けるにはadd()メソッドで生成したオブジェクトのnameプロパティに設定します。なお、すでに同じ名前のシンボル名がある場合はエラーになります。これを回避するにはサンプルのようにtry...catchを使います。</p>
<p>シンボルを登録するサンプル</p>
<pre><code>// シンボルを登録する
var gObj = activeDocument.groupItems.add(); // グループを作成
var rectObj = gObj.pathItems.rectangle(-10, 20, 100, 80);
rectObj.stroked = true; // 線なし
rectObj.filled = false; // 塗りあり
var txtObj = gObj.textFrames.add();
txtObj.contents = "Adobe";  // 表示文字
txtObj.paragraphs[0].size = 24; // 文字サイズ
txtObj.top = -34;   // Y座標
txtObj.left = 33;   // X座標
// シンボルを登録・追加
var mySymbol = activeDocument.symbols.add(gObj);
try{    // 名前を設定する
    mySymbol.name = "A社ロゴ";
}catch(e){
    alert("すでに同じ名前のシンボルが登録されています");
}</code></pre>
<p>　シンボルパネルには、いくつかのシンボルが登録されています。</p>
<figure>
<figcaption>【図】いくつかのシンボルが登録されている</figcaption>
<img src="images/00464.jpeg" />
</figure>
<p>　スクリプトを実行すると、新しくシンボルが1つ追加されます。</p>
<figure>
<figcaption>【図】シンボルが1つ追加される</figcaption>
<img src="images/00295.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-54">
<section>
<div>
<h1 id="calibre_link-416"><b>第20章　シンボルアイテム</b></h1>
</div>
<p>　この章では、シンボルアイテムに関するサンプルを示し、解説します。シンボルアイテムをドキュメント上に配置したり削除することができます。</p>
</section>
</div>
<div id="calibre_link-593">
<section>
<h2 id="calibre_link-417"><b>20-1　ドキュメント内にあるシンボルアイテム数を表示する</b></h2>
<p>　ドキュメント内にあるシンボルアイテムはsymbolItems配列に格納されています。配列なのでlengthプロパティを参照すればドキュメント内にあるシンボルアイテムの総数を求めることができます。</p>
<p>ドキュメント内にあるシンボルアイテム数を表示するサンプル</p>
<pre><code>// ドキュメント内にあるシンボルアイテム数を表示する
var n = activeDocument.symbolItems.length;
alert(n+"個のシンボルアイテムがあります");</code></pre>
<p>　シンボルアイテムをドキュメントに配置しておきます。なお、シンボルスプレーを使ったものはシンボルアイテムとしては扱われません。</p>
<figure>
<figcaption>【図】シンボルアイテムをドキュメントに配置する</figcaption>
<img src="images/00251.jpeg" />
</figure>
<p>　ドキュメント内にあるシンボルアイテムの総数がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】ドキュメント内にあるシンボルアイテムの総数が表示される</figcaption>
<img src="images/00322.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-757">
<section>
<h2 id="calibre_link-418"><b>20-2　特定のシンボル名を持つシンボルアイテムを削除する</b></h2>
<p>　ドキュメント上に配置したシンボルの種類はシンボルアイテムオブジェクトのsymbolオブジェクトのnameプロパティに入っています。nameプロパティの内容を調べて該当するシンボル名であればremove()メソッドを使って削除します。シンボルアイテムのnameプロパティとシンボルアイテム内にあるsymbolオブジェクトのnameプロパティを混同しないように注意してください。</p>
<p>　名前が完全一致でなく名前の一部が含まれている場合に削除したい場合は、条件判断を行うif命令部分をsName.indexOf("長方形") &gt; -1のように変更します。</p>
<p>特定のシンボル名を持つシンボルアイテムを削除するサンプル</p>
<pre><code>// 特定のシンボル名を持つシンボルアイテムを削除する
var symObj = activeDocument.symbolItems;    // ドキュメント上の全シンボル
for(var i=symObj.length-1; i&gt;=0; i--){  // 大きい順から処理する
    var sName = symObj[i].symbol.name;  // 配置されているシンボル名を読み出す
    if (sName == "プロセス長方形"){    // シンボル名を調べる
        symObj[i].remove(); // 削除する
    }
}</code></pre>
<p>　さまざまなシンボルアイテムが配置されています。</p>
<figure>
<figcaption>【図】さまざまなシンボルアイテムが配置されている</figcaption>
<img src="images/00035.jpeg" />
</figure>
<p>　スクリプトを実行すると特定の名前を持つシンボルアイテムが削除されます。</p>
<figure>
<figcaption>【図】特定の名前を持つシンボルアイテムが削除される</figcaption>
<img src="images/00530.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-533">
<section>
<h2 id="calibre_link-419"><b>20-3　ドキュメント内にあるシンボルアイテムを全て削除する</b></h2>
<p>　ドキュメント内にあるシンボルアイテムを全て削除するには、グラフオブジェクトのremoveAll()メソッドを使います。なお、シンボルスプレーを使って作成した図形は削除対象になりません。</p>
<p>ドキュメント内にあるシンボルアイテムを全て削除するサンプル</p>
<pre><code>// ドキュメント内にあるシンボルアイテムを全て削除する
activeDocument.symbolItems.removeAll();</code></pre>
<p>　ドキュメント内には複数のシンボルアイテムがあります。</p>
<figure>
<figcaption>【図】ドキュメント内に複数のシンボルアイテムがある</figcaption>
<img src="images/00418.jpeg" />
</figure>
<p>　スクリプトを実行するとドキュメント内にあるシンボルアイテムが全て削除されます。</p>
<figure>
<figcaption>【図】ドキュメント内のシンボルアイテムが全て削除される</figcaption>
<img src="images/00379.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-695">
<section>
<h2 id="calibre_link-420"><b>20-4　シンボルをドキュメント上に表示する</b></h2>
<p>　シンボルをドキュメント上に表示するにはadd()メソッドを使います。add()メソッドのパラメーターには表示するシンボルを指定します。このadd()メソッドのパラメーターに指定するシンボルはドキュメントオブジェクトのsymbols配列に格納されているものを指定します。例えばサンプルのようにactiveDocument.symbols[0]とするとシンボルパネルに最初に登録されているシンボルを示すことになります。また、activeDocument.symbols["リボン"]のように参照番号でなくシンボル名で指定することもできます。</p>
<p>　add()メソッドにより生成されたシンボルオブジェクトにはtopやleftプロパティなどがあり、位置や幅を設定することができます。</p>
<p>シンボルをドキュメント上に表示するサンプル</p>
<pre><code>// シンボルをドキュメント上に表示する
var sym = activeDocument.symbols[0];    // 最初に登録されているシンボル
var symObj = activeDocument.symbolItems.add(sym);
symObj.top = -40;    // Y座標
symObj.left = 20;    // X座標
symObj.width = 100; // 横幅
symObj.height = 75; // 縦幅</code></pre>
<p>　シンボルが指定した位置とサイズで表示されます。</p>
<figure>
<figcaption>【図】シンボルが指定した位置とサイズで表示される</figcaption>
<img src="images/00196.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-657">
<section>
<h2 id="calibre_link-421"><b>20-5　複数のシンボルをドキュメント内にランダムに配置し回転させる</b></h2>
<p>　シンボルを配置させるにはsymbolItems.add()メソッドを使います。ドキュメント内に配置されたらMath.random()メソッドを使って乱数値を求めます。その際、ドキュメントオブジェクトのwidthプロパティとheightプロパティの値を乗算することでドキュメント内に座標値が収まるようになります。</p>
<p>　求めた乱数値を配置したシンボルオブジェクトのleftプロパティ、topプロパティに入れることで指定した座標に表示することができます。また、回転させるためにはrotate()メソッドを使います。rotate()メソッドのパラメーターには回転角度を指定します。これを生成したい数だけfor命令を使って繰り返します。</p>
<p>複数のシンボルをドキュメント内にランダムに配置し回転させるサンプル</p>
<pre><code>// シンボルをドキュメント内にランダムに配置・回転させる
app.coordinateSystem = CoordinateSystem.ARTBOARDCOORDINATESYSTEM;   // アートボード単位にする
var sym = activeDocument.symbols[0];    // 最初に登録されているシンボル
var num = 100;   // 100個配置する
for(var i=0; i&lt;num; i++){
    var symObj = activeDocument.symbolItems.add(sym);
    var x = Math.random() * activeDocument.width;   // 乱数値を求める
    var y = Math.random() * activeDocument.height;
    var r = Math.random() * 360;
    symObj.left = x;   // X座標
    symObj.top = -y;   // Y座標
    symObj.rotate(r);  // 回転角度
}</code></pre>
<p>　アクティブになっているアートボードに、複数のシンボルが指定した位置と回転角度で表示されます。</p>
<figure>
<figcaption>【図】複数のシンボルが指定した位置と回転角度で表示される</figcaption>
<img src="images/00417.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-716">
<section>
<div>
<h1 id="calibre_link-422"><b>第21章　メッシュグラデーション</b></h1>
</div>
<p>　この章では、メッシュグラデーションに関するサンプルを示し、解説します。メッシュグラデーションに関する様々な処理を行うことができます。</p>
<p>
<br />
</p>
</section>
</div>
<div id="calibre_link-72">
<section>
<h2 id="calibre_link-423"><b>21-1　ドキュメント内にあるメッシュグラデーション適用図形の数を表示する</b></h2>
<p>　ドキュメント内にあるメッシュグラデーション適用図形はmeshItems配列に格納されています。配列なのでlengthプロパティを参照すればドキュメント内にあるメッシュグラデーション適用図形の総数を求めることができます。</p>
<p>ドキュメント内にあるメッシュグラデーション適用図形の数を表示するサンプル</p>
<pre><code>// ドキュメント内にあるメッシュグラデーション適用図形の数を表示する
var n = activeDocument.meshItems.length;
alert(n+"個のメッシュグラデーション適用図形があります");</code></pre>
<p>　メッシュグラデーションを使って図形を作成します。スクリプトを実行するとアラートダイアログにはメッシュグラデーション適用図形の数が表示されます。</p>
<figure>
<figcaption>【図】メッシュグラデーション適用図形の数が表示される</figcaption>
<img src="images/00590.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-553">
<section>
<h2 id="calibre_link-424"><b>21-2　ドキュメント内にあるメッシュグラデーション適用図形を全て削除する</b></h2>
<p>　ドキュメント内にあるメッシュグラデーション適用図形を全て削除するには、メッシュグラデーションオブジェクトのremoveAll()メソッドを使います。</p>
<p>ドキュメント内にあるメッシュグラデーション適用図形を全て削除するサンプル</p>
<pre><code>// ドキュメント内にあるメッシュグラデーション適用図形を全て削除する
activeDocument.meshItems.removeAll();</code></pre>
<p>　ドキュメント内には複数のメッシュグラデーション適用図形があります。</p>
<figure>
<figcaption>【図】複数のメッシュグラデーション適用図形がある</figcaption>
<img src="images/00485.jpeg" />
</figure>
<p>　スクリプトを実行するとドキュメント内にあるメッシュグラデーション適用図形が全て削除されます。</p>
<figure>
<figcaption>【図】メッシュグラデーション適用図形が全て削除される</figcaption>
<img src="images/00371.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-664">
<section>
<h2 id="calibre_link-425"><b>21-3　選択したメッシュグラデーションをページの右端まで複製し配置する</b></h2>
<p>　選択したメッシュグラデーションをページの右端まで複製し配置するにはduplicate()メソッドを使います。単純に複製するだけならばduplicate()メソッドのパラメーターは指定する必要はありません。ページの右端はドキュメントオブジェクトのwidthプロパティに入っています。選択したメッシュグラデーションの座標からドキュメントの横幅まで繰り返します。繰り返し処理を行う際に複製したメッシュグラデーションのleftプロパティにX座標を入れることでページの右端まで配置されるようになります。</p>
<p>選択したメッシュグラデーションをページの右端まで複製し配置するサンプル</p>
<pre><code>// 選択したメッシュグラデーションをページの右端まで複製し配置する
app.coordinateSystem = CoordinateSystem.ARTBOARDCOORDINATESYSTEM;   // アートボード座標を基準にする
var selObj = activeDocument.selection[0];
var docW = activeDocument.width;   // ドキュメントの横幅
var startX = selObj.left;   // 開始X座標
var itemW = selObj.width;   // 選択項目の横幅
for(var x=startX; x&lt;docW; x+=itemW){    // 選択項目の横幅分移動するようにする
    var dupObj = selObj.duplicate();    // 複製する
    dupObj.left = x;    // X座標を設定する
}</code></pre>
<p>　メッシュグラデーションを1つ選択します。</p>
<figure>
<figcaption>【図】メッシュグラデーションを1つ選択する</figcaption>
<img src="images/00486.jpeg" />
</figure>
<p>　メッシュグラデーションがページの右端（アクティブになっているアートボードの右端）まで複製されます。</p>
<figure>
<figcaption>【図】メッシュグラデーションが複製される</figcaption>
<img src="images/00160.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-16">
<section>
<div>
<h1 id="calibre_link-426"><b>第22章　プラグインアイテム</b></h1>
</div>
<p>　この章では、プラグインアイテムに関するサンプルを示し、解説します。プラグインアイテムとしてはトレースされた画像などがあります。</p>
<p>
<br />
</p>
</section>
</div>
<div id="calibre_link-762">
<section>
<h2 id="calibre_link-427"><b>22-1　ドキュメント内にあるプラグインアイテム数を表示する</b></h2>
<p>　ドキュメント内にあるプラグインアイテムはpluginItems配列に格納されています。配列なのでlengthプロパティを参照すればドキュメント内にあるプラグインアイテムの総数を求めることができます。</p>
<p>　なお、ここでのプラグインはIllustratorの拡張機能のプラグインを直接示すわけではありません。プラグインを利用して生成された図形や画像などを示します。また、プラグインを利用した図形や画像を直接スクリプト（JavaScript）で新規に生成することはできません。画像を配置後にtrace()メソッドなどを使って変換するなど、あらかじめ用意された機能（メソッド）を使用する必要があります。</p>
<p>ドキュメント内にあるプラグインアイテム数を表示するサンプル</p>
<pre><code>// ドキュメント内にあるプラグインアイテム数を表示する
var n = activeDocument.pluginItems.length;
alert(n+"個のプラグインアイテムがあります");</code></pre>
<p>　プラグインアイテムをドキュメントに配置しておきます。ここでは画像をトレースしたものと、シンボルスプレーを使ったシンボル群の2つがあります。スクリプトを実行するとアラートダイアログには2つのプラグインアイテムがあると表示されます。</p>
<figure>
<figcaption>【図】スクリプトを実行後、2つのプラグインアイテムがあると表示される</figcaption>
<img src="images/00551.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-592">
<section>
<h2 id="calibre_link-428"><b>22-2　ドキュメント内にあるプラグインアイテムを全て削除する</b></h2>
<p>　ドキュメント内にあるプラグインアイテムを全て削除するには、プラグインオブジェクトのremoveAll()メソッドを使います。</p>
<p>ドキュメント内にあるプラグインアイテムを全て削除するサンプル</p>
<pre><code>// ドキュメント内にあるプラグインアイテムを全て削除する
activeDocument.pluginItems.removeAll();</code></pre>
<p>　ドキュメント内には複数のプラグインアイテムがあります。</p>
<figure>
<figcaption>【図】ドキュメント内には複数のプラグインアイテムがある</figcaption>
<img src="images/00252.jpeg" />
</figure>
<p>　スクリプトを実行するとドキュメント内にあるプラグインアイテムが全て削除されます。</p>
<figure>
<figcaption>【図】ドキュメント内のプラグインアイテムが全て削除される</figcaption>
<img src="images/00225.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-64">
<section>
<div>
<h1 id="calibre_link-429"><b>第23章　ブラシ</b></h1>
</div>
<p>　この章では、ブラシに関するサンプルを示し、解説します。特定のブラシを図形に適用することができます。</p>
<p>
<br />
</p>
</section>
</div>
<div id="calibre_link-687">
<section>
<h2 id="calibre_link-430"><b>23-1　ドキュメント内にあるブラシの総数を表示する</b></h2>
<p>　ドキュメント内にあるプラグインアイテムはbrushes配列に格納されています。配列なのでlengthプロパティを参照すればドキュメント内にあるブラシの総数を求めることができます。なお、基本のブラシは数に入りません。</p>
<p>ドキュメント内にあるブラシの総数を表示するサンプル</p>
<pre><code>// ブラシの総数を表示する
var n = activeDocument.brushes.length;
alert(n+"個のブラシがあります");</code></pre>
<p>　基本ブラシを除くブラシの総数がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】基本ブラシを除くブラシの総数が表示される</figcaption>
<img src="images/00253.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-647">
<section>
<h2 id="calibre_link-431"><b>23-2　選択した図形に指定したブラシを適用する</b></h2>
<p>　選択した図形に指定したブラシを適用するには、ブラシオブジェクトのapplyTo()メソッドを使います。ブラシはactiveDocument.brushes["モップ"]かactiveDocument.brushes[0]のようにして指定した後、applyTo()メソッドを呼び出します。applyTo()メソッドのパラメーターにブラシを適用させたい図形を指定します。</p>
<p>選択した図形に指定したブラシを適用するサンプル</p>
<pre><code>// 選択した図形に指定したブラシを適用する
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    activeDocument.brushes["モップ"].applyTo(selObj[i]);
}</code></pre>
<p>　図形を選択します。</p>
<figure>
<figcaption>【図】図形を選択</figcaption>
<img src="images/00479.jpeg" />
</figure>
<p>　スクリプトを実行すると図形に指定したブラシが適用されます。</p>
<figure>
<figcaption>【図】図形に指定したブラシが適用される</figcaption>
<img src="images/00317.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-48">
<section>
<div>
<h1 id="calibre_link-432"><b>第24章　プリント／印刷</b></h1>
</div>
<p>　この章では、プリント／印刷に関するサンプルを示し、解説します。プリンタの種類や用紙サイズ一覧などを取得したり様々な処理を行うことができます。</p>
<p>
<br />
</p>
</section>
</div>
<div id="calibre_link-13">
<section>
<h2 id="calibre_link-433"><b>24-1　プリンタ一覧を取得する</b></h2>
<p>　プリンタ一覧を取得するにはアプリケーションオブジェクトのprinterList配列を参照します。この配列にプリンタオブジェクトが入っています。printerList配列は読み出しのみで設定することはできません。</p>
<p>プリンタ一覧を取得するサンプル</p>
<pre><code>// プリンタ一覧を表示する
var pNameList = app.printerList;
var txt = "";
for (var i=0; i&lt;pNameList.length; i++){
    txt = txt + (i+1)+"番目："+pNameList[i].name + "\r";
}
// テキストフレームを生成しプリンタ一覧を表示する
var txtObj = app.activeDocument.textFrames.add();
txtObj.contents = txt;
txtObj.top = -20;   // 表示位置を設定
txtObj.left = 10;</code></pre>
<p>　プリンタ一覧がドキュメント上に表示されます。</p>
<figure>
<figcaption>【図】プリンタ一覧が表示される</figcaption>
<img src="images/00133.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-103">
<section>
<h2 id="calibre_link-434"><b>24-2　プリントプリセットを取得する</b></h2>
<p>　プリントプリセットを取得するにはアプリケーションオブジェクトのprintPresetsList配列を参照します。この配列にプリントプリセット名が入っています。printPresetsList配列は読み出しのみで設定することはできません。</p>
<p>プリントプリセットを取得するサンプル</p>
<pre><code>// プリントプリセット一覧を表示する
var pNameList = app.printPresetsList;
var txt = "";
for (var i=0; i&lt;pNameList.length; i++){
    txt = txt + (i+1)+"番目："+pNameList[i] + "\r";
}
// テキストフレームを生成しプリントプリセット一覧を表示する
var txtObj = app.activeDocument.textFrames.add();
txtObj.contents = txt;
txtObj.top = -20;   // 表示位置を設定
txtObj.left = 10;</code></pre>
<p>　プリントプリセット一覧がドキュメント上に表示されます。</p>
<figure>
<figcaption>【図】プリントプリセット一覧がドキュメント上に表示される</figcaption>
<img src="images/00387.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-528">
<section>
<h2 id="calibre_link-435"><b>24-3　アクティブドキュメントを印刷する</b></h2>
<p>　アクティブドキュメントを印刷するにはプリントオプションを設定した後にprint()メソッドを使います。プリントオプションオブジェクトはnewPrintOptions()で作成します。最低限colorManagementOptionsオプションにカラーマネージメントオプションは指定する必要があります。指定しないと印刷が行われません。また、設定するカラーとドキュメントのカラーが一致していない（CMYKなのにRGBカラーで印刷しようとした場合など）とエラーで停止し印刷されません。</p>
<p>　カラーマネージメントオプションはnewPrintColorManagementOptions()で作成します。カラーマネージメントオブジェクトのnameプロパティにプロファイル名、colorProfileModeプロパティにカラー処理、intentプロパティにマッチング方法を指定します。</p>
<p>　直接印刷するのではなく、印刷ダイアログを表示したい場合はapp.executeMenuCommand("Print");を使います。</p>
<p>
<br />
</p>
<p>
<br />
</p>
<table>
<caption>【表】colorProfileModeプロパティに指定できる値</caption>
<tbody>
<tr>
  <td>
    <span>プロパティの値</span>
  </td>
  <td>
    <span>カラープロファイルの種類</span>
  </td>
</tr>
<tr>
  <td>PrintColorProfile.CUSTOMPROFILE</td>
  <td>カスタム(独自の)プロファイル</td>
</tr>
<tr>
  <td>PrintColorProfile.OLDSTYLEPROFILE</td>
  <td>古いカラープロファイル</td>
</tr>
<tr>
  <td>PrintColorProfile.PRINTERPROFILE</td>
  <td>プリンタのカラープロファイル</td>
</tr>
<tr>
  <td>PrintColorProfile.SOURCEPROFILE</td>
  <td>Illustrator のカラー設定プロファイル</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】intentプロパティに指定できるもの</caption>
<tbody>
<tr>
  <td>
    <span>プロパティの値</span>
  </td>
  <td>
    <span>マッチングの種類</span>
  </td>
</tr>
<tr>
  <td>PrintColorIntent.ABSOLUTECOLORIMETRIC</td>
  <td>絶対的な色域を維持</td>
</tr>
<tr>
  <td>PrintColorIntent.PERCEPTUALINTENT</td>
  <td>知覚的</td>
</tr>
<tr>
  <td>PrintColorIntent.RELATIVECOLORIMETRIC</td>
  <td>相対的な色域を維持</td>
</tr>
<tr>
  <td>PrintColorIntent.SATURATIONINTENT</td>
  <td>彩度</td>
</tr>
</tbody>
</table>
<p>アクティブドキュメントを印刷するサンプル</p>
<pre><code>// アクティブドキュメントを印刷する
var printObj = new PrintOptions();
// カラー設定オプション
var colorOpt = new PrintColorManagementOptions();
colorOpt.colorProfileMode = PrintColorProfile.SOURCEPROFILE;
colorOpt.name = "ColorMatch RGB";   // RGBカラー
colorOpt.intent = PrintColorIntent.RELATIVECOLORIMETRIC;
printObj.colorManagementOptions = colorOpt;
// アクティブドキュメントを印刷する
activeDocument.print(printObj);</code></pre>
<p>　アクティブドキュメントが印刷されます。</p>
<figure>
<figcaption>【図】アクティブドキュメントが印刷される</figcaption>
<img src="images/00382.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-690">
<section>
<h2 id="calibre_link-436"><b>24-4　指定したプリンタで使える用紙サイズ一覧を取得する</b></h2>
<p>　指定したプリンタで使える用紙サイズ一覧を取得するにはprinterList配列から調べたいプリンタを指定します。サンプルでは配列に番号を指定することで該当するプリンタを指定しています。プリンタで使える用紙一覧はprinterInfo.paperSizes配列に入っています。この配列の要素数だけ繰り返すことでプリンタ用紙サイズが分かります。</p>
<p>　用紙の名前はprinterInfoオブジェクトのnameプロパティに、横幅はwidthプロパティ、縦幅はheightプロパティに入っています。</p>
<p>指定したプリンタで使える用紙サイズ一覧を取得するサンプル</p>
<pre><code>// 指定したプリンタで使える用紙サイズ一覧を表示する
var txt = "";
var myPrinter = app.printerList[2]; // プリンタ
var ps = myPrinter.printerInfo.paperSizes;  // 用紙サイズ
for(var i=0; i&lt;ps.length; i++){
    var pName = ps[i].name; // 用紙の名称
    var w = ps[i].paperInfo.width;  // 用紙の横幅（単位はpt）
    var h = ps[i].paperInfo.height; // 用紙の縦幅（単位はpt）
    txt = txt + pName+" : "+w+", "+h + "\r";
}
alert(txt);</code></pre>
<p>　指定したプリンタで使える用紙一覧がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】指定したプリンタで使える用紙一覧が表示される</figcaption>
<img src="images/00516.jpeg" />
</figure>
<p>　他のプリンタを指定した場合は、このようになります。なお、全く用紙が存在しないプリンタもあります。</p>
<figure>
<figcaption>【図】他のプリンタを指定した場合</figcaption>
<img src="images/00040.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-92">
<section>
<h2 id="calibre_link-437"><b>24-5　プリンタの種類を調べる</b></h2>
<p>　プリンタの種類を調べるにはprinterオブジェクトのprinterInfoオブジェクトのprinterTypeプロパティを調べます。printerTypeプロパティは以下の表に示す値を保持しています。</p>
<table>
<caption>【表】printerTypeプロパティの値</caption>
<tbody>
<tr>
  <td>
    <span>プロパティの値</span>
  </td>
  <td>
    <span>プリンタの種類</span>
  </td>
</tr>
<tr>
  <td>NONPOSTSCRIPTPRINTER</td>
  <td>非PostScriptプリンタ</td>
</tr>
<tr>
  <td>POSTSCRIPTPRINTER</td>
  <td>PostScriptプリンタ</td>
</tr>
<tr>
  <td>Unknown</td>
  <td>不明</td>
</tr>
</tbody>
</table>
<p>プリンタの種類を調べるサンプル</p>
<pre><code>// プリンタの種類を調べる
var msg = [];
msg[PrinterTypeEnum.NONPOSTSCRIPTPRINTER] = "非PostScriptプリンタ";
msg[PrinterTypeEnum.POSTSCRIPTPRINTER] = "PostScriptプリンタ";
msg[PrinterTypeEnum.Unknown] = "PostScriptプリンタ";
var txt = "■結果\r";
var pList = app.printerList;
for(var i=0; i&lt;pList.length; i++){
    var pName = pList[i].name;  // プリンタ名
    var pType = pList[i].printerInfo.printerType;   // 種類
    txt = txt + pName + "：" + msg[pType] + "\r";
}
alert(txt);</code></pre>
<p>　プリンタの種類がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】プリンタの種類が表示される</figcaption>
<img src="images/00163.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-636">
<section>
<div>
<h1 id="calibre_link-438"><b>第25章　フォルダ</b></h1>
</div>
<p>　この章では、フォルダに関するサンプルを示し、解説します。OSに密着したフォルダ処理を行うことができます。</p>
</section>
</div>
<div id="calibre_link-754">
<section>
<h2 id="calibre_link-439"><b>25-1　現在のフォルダ（カレントフォルダ）を取得する</b></h2>
<p>　現在のフォルダ(カレントフォルダ)を取得するにはフォルダオブジェクトのcurrentプロパティを参照します。currentプロパティには現在のフォルダを示すフォルダオブジェクトが格納されています。</p>
<p>現在のフォルダ（カレントフォルダ）を取得するサンプル</p>
<pre><code>// 現在のフォルダ（カレントフォルダ）名を表示する
var cFolder = Folder.current;
var cfName = cFolder.fullName
alert("現在のフォルダ："+cfName);</code></pre>
<p>　現在のフォルダ（カレントフォルダ）のパスがアラートダイアログに表示されます。Mac OS X/OS Xの場合）。</p>
<figure>
<figcaption>【図】現在のフォルダが表示される（Mac OS X/OS Xの場合）</figcaption>
<img src="images/00299.jpeg" />
</figure>
<p>　現在のフォルダ（カレントフォルダ）のパスがアラートダイアログに表示されます（Windows 7の場合）。</p>
<figure>
<figcaption>【図】現在のフォルダのパスが表示される（Windows 7の場合）</figcaption>
<img src="images/00419.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-530">
<section>
<h2 id="calibre_link-440"><b>25-2　ドキュメントフォルダを取得する</b></h2>
<p>　ドキュメントフォルダを取得するにはフォルダオブジェクトのmyDocumentsプロパティを参照します。myDocumentsプロパティにはユーザーのドキュメントフォルダを示すフォルダオブジェクトが格納されています。Windowsの場合はマイドキュメント(C:\Documents and Settings\ユーザー名\MyDocuments)、Mac OS X/OS Xの場合は書類(~/Documents)フォルダになります。</p>
<p>ドキュメントフォルダを取得するサンプル</p>
<pre><code>// ユーザーのドキュメントフォルダを表示する
var cFolder = Folder.myDocuments;
var myDocName = cFolder.fullName
alert("ドキュメントフォルダ："+myDocName);</code></pre>
<p>　ドキュメントフォルダのパスがアラートダイアログに表示されます（Mac OS X/OS Xの場合）。</p>
<figure>
<figcaption>【図】ドキュメントフォルダのパスが表示される（Mac OS X/OS Xの場合）</figcaption>
<img src="images/00552.jpeg" />
</figure>
</section>
<p>
<br />
</p>
<section>
<p>　ドキュメントフォルダのパスがアラートダイアログに表示されます（Windows 7の場合）。</p>
<figure>
<figcaption>【図】ドキュメントフォルダのパスが表示される（Windows 7の場合）</figcaption>
<img src="images/00075.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-694">
<section>
<h2 id="calibre_link-441"><b>25-3　デスクトップフォルダを取得する</b></h2>
<p>　デスクトップフォルダを取得するにはフォルダオブジェクトのdesktopプロパティを参照します。desktopプロパティにはユーザーのデスクトップフォルダを示すフォルダオブジェクトが格納されています。Windowsの場合は「C:\Documents and Settings\ユーザー名\Desktop」、Mac OS X/OS Xの場合は「~/Desktop」フォルダになります。</p>
<p>デスクトップフォルダを取得するサンプル</p>
<pre><code>// デスクトップフォルダのパスを表示する
var cFolder = Folder.desktop;
var desk = cFolder.fullName
alert("デスクトップフォルダ："+desk);</code></pre>
<p>　デスクトップフォルダのパスがアラートダイアログに表示されます（Mac OS X/OS Xの場合）。</p>
<figure>
<figcaption>【図】デスクトップフォルダのパスが表示される（Mac OS X/OS Xの場合）</figcaption>
<img src="images/00202.jpeg" />
</figure>
<p>　デスクトップフォルダのパスがアラートダイアログに表示されます（Windows 7の場合）。</p>
<figure>
<figcaption>【図】デスクトップフォルダのパスが表示される（Windows 7の場合）</figcaption>
<img src="images/00326.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-638">
<section>
<h2 id="calibre_link-442"><b>25-4　ゴミ箱フォルダを取得する</b></h2>
<p>　ゴミ箱フォルダを取得するにはフォルダオブジェクトのtrashプロパティを参照します。trashプロパティにはユーザーのゴミ箱フォルダを示すフォルダオブジェクトが格納されています。なお、Windows 7ではFolder.trashはnullを返すため利用することはできません。</p>
<p>ゴミ箱フォルダを取得するサンプル</p>
<pre><code>// ゴミ箱フォルダのパスを表示する
var cFolder = Folder.trash;
var trName = cFolder.fullName
alert("ゴミ箱フォルダ："+trName);</code></pre>
<p>　ゴミ箱フォルダのパスがアラートダイアログに表示されます（Mac OS X/OS Xの場合）。</p>
<figure>
<figcaption>【図】ゴミ箱フォルダのパスが表示される（Mac OS X/OS Xの場合）</figcaption>
<img src="images/00457.jpeg" />
</figure>
</section>
<p>
<br />
</p>
<section>
<p>　使えないことを示すアラートダイアログが表示されます（Windows 7の場合）。</p>
<figure>
<figcaption>【図】アラートダイアログが表示される（Windows 7の場合）</figcaption>
<img src="images/00585.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-639">
<section>
<h2 id="calibre_link-443"><b>25-5　テンポラリフォルダを取得する</b></h2>
<p>　テンポラリ(一時的に使用する)フォルダを取得するにはフォルダオブジェクトのtempプロパティを参照します。tempプロパティにはテンポラリフォルダを示すフォルダオブジェクトが格納されています。</p>
<p>テンポラリフォルダを取得するサンプル</p>
<pre><code>// テンポラリフォルダのパスを表示する
var cFolder = Folder.temp;
var tempName = cFolder.fullName
alert("テンポラリ（一時的に使用する）フォルダ："+tempName);</code></pre>
<p>　テンポラリフォルダのパスがアラートダイアログに表示されます（Mac OS X/OS Xの場合）。</p>
<figure>
<figcaption>【図】テンポラリフォルダのパスがアラートダイアログに表示される（Mac OS X/OS Xの場合）</figcaption>
<img src="images/00254.jpeg" />
</figure>
</section>
<p>
<br />
</p>
<section>
<p>　テンポラリフォルダのパスがアラートダイアログに表示されます（Windows 7の場合）。</p>
<figure>
<figcaption>【図】テンポラリフォルダのパスが表示される（Windows 7の場合）</figcaption>
<img src="images/00186.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-41">
<section>
<h2 id="calibre_link-444"><b>25-6　フォルダ内のAIファイル一覧を取得する</b></h2>
<p>　フォルダ内のファイル一覧を取得するにはフォルダオブジェクトのgetFiles()メソッドを使います。getFiles()のパラメーターに何も指定しないか"*"を指定した場合は、フォルダ内の全てのファイル、フォルダを取得します。Mac OS X/OS Xの場合、.（ドット）で始まる隠しファイルも取得します。getFiles()でAIファイルだけを取得したい場合はgetFiles("*.ai")のように指定します。このようにすると拡張子がaiのファイルだけが取得されます。その他に指定できる拡張子の例を以下の表に示します。</p>
<table>
<caption>【表】指定できる拡張子の例</caption>
<tbody>
<tr>
  <td>
    <span>指定できる拡張子</span>
  </td>
  <td>
    <span>ファイル形式</span>
  </td>
</tr>
<tr>
  <td>*.ai</td>
  <td>AIファイル</td>
</tr>
<tr>
  <td>*.eps</td>
  <td>EPS形式</td>
</tr>
<tr>
  <td>*.jpg</td>
  <td>JPEG画像ファイル</td>
</tr>
<tr>
  <td>*.jpeg</td>
  <td>JPEG画像ファイル</td>
</tr>
<tr>
  <td>*.pdf</td>
  <td>PDF</td>
</tr>
<tr>
  <td>*.psd</td>
  <td>PSD(Photoshop)ファイル</td>
</tr>
<tr>
  <td>*.png"</td>
  <td>PNG画像ファイル</td>
</tr>
<tr>
  <td>*</td>
  <td>全てのファイル（空欄でも同じ）</td>
</tr>
</tbody>
</table>
<p>　なお、拡張子の大文字小文字は関係ありません（ファイルシステム／ファイルフォーマットが大文字小文字を区別する場合は未検証）。また、AIファイルとJPEGファイルの両方をまとめて取得することはできません。この場合、以下のようにgetFiles()メソッドを使ってファイルを取得する必要があります。</p>
<p>
<strong><b>【書式】</b></strong>
</p>
<p>var fileList1 = folderObj.getFiles("*.ai")</p>
<p>var fileList2 = folderObj.getFiles("*.jpg")</p>
<p>var fileList = fileList1.concat(fileList2)</p>
<p>　Mac OS X/OS Xの場合、日本語ファイル名が含まれる際にdecodeURI()、decodeURIComponent()メソッドを使うと濁点などが分離してしまうことがあります。これを回避するにはサンプル-2のように日本語変換処理を行う関数を使います。</p>
<p>フォルダ内のAIファイル一覧を取得するサンプル-1</p>
<pre><code>// フォルダ内のAIファイルを取得する
(function(){
    var folderObj = Folder.selectDialog("フォルダを選択してください");
    if (!folderObj) return;     // キャンセルされたら処理しない
    var fileList = folderObj.getFiles("*.ai");
    var txt = "";
    for(var i=0; i&lt;fileList.length; i++){
        txt = txt + decodeURI(fileList[i].name) + "\r";
    }
    var txtObj = activeDocument.textFrames.add();
    txtObj.top = -10;
    txtObj.left = 20;
    txtObj.contents = txt;
})();</code></pre>
<p>フォルダ内のAIファイル一覧を取得するサンプル-2</p>
<pre><code>// フォルダ内のAIファイルを取得する
(function(){
    var folderObj = Folder.selectDialog("フォルダを選択してください");
    if (!folderObj) return;     // キャンセルされたら処理しない
    var fileList = folderObj.getFiles("*.ai");
    var txt = "";
    for(var i=0; i&lt;fileList.length; i++){
        txt = txt + convertKana(fileList[i].name) + "\r";
    }
    var txtObj = activeDocument.textFrames.add();
    txtObj.top = -10;
    txtObj.left = 20;
    txtObj.contents = txt;
})();
// ------------------------------------------------------------------
// 日本語ファイル名を変換する関数 (MacOS X/OS Xのみ。Windowsは不要)
// ------------------------------------------------------------------
function convertKana(filename){
    var dakuten = "%E3%82%99";
    var handakuten = "%E3%82%9A";
    filename = convertKanaSub(filename,dakuten,1);
    filename = convertKanaSub(filename,handakuten,2);
    return File.decode(filename);
    // 日本語ファイル名変換サブ処理
    function convertKanaSub(srcName, code, count){
        srcName = srcName.replace(/%E3%82%BF%E3%82%99/g, "%E3%83%80"); // ダだけ特殊処理
        var text = srcName.split(code); // 濁点
        for (var i=0; i&lt;text.length-1; i++){
            var str = text[i];
            if (str == "") continue;
            var body = str.substring(0,str.length-2);
            var footL = str.substring(str.length-2, str.length);
            var hexL = eval("0x"+footL) + count;
            hexL = hexL.toString(16).toUpperCase();
            text[i] = body+hexL;
        }
        return text.join("");
    }
}</code></pre>
<p>　フォルダ選択ダイアログが表示されるのでAIファイルが含まれるフォルダを選択します。</p>
<figure>
<figcaption>【図】AIファイルが含まれるフォルダを選択する</figcaption>
<img src="images/00360.jpeg" />
</figure>
<p>　サンプル-1の実行結果です。フォルダ内に含まれるAIファイルの一覧がドキュメント上に表示されます。なお、あらかじめドキュメントを表示しておかないとエラーになります。Mac OS X/OS Xの場合、ファイル名に濁点などが含まれると正しく処理されません。</p>
<figure>
<figcaption>【図】サンプル-1の実行結果</figcaption>
<img src="images/00493.jpeg" />
</figure>
<p>　サンプル-2の実行結果です。濁点などの処理が正しく行われます。</p>
<figure>
<figcaption>【図】サンプル-2の実行結果</figcaption>
<img src="images/00020.jpeg" />
</figure>
</section>
<p>
<br />
</p>
<section>
<p>　Windows 7でのサンプル-1の実行結果です。Windows 7の場合は特に日本語の処理をしなくても正常に処理されます。</p>
<figure>
<figcaption>【図】Windows 7でのサンプル-1の実行結果</figcaption>
<img src="images/00146.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-573">
<section>
<h2 id="calibre_link-445"><b>25-7　サブフォルダ内のAIファイル一覧を取得する</b></h2>
<p>　サブフォルダ内のファイル等も取得するにはgetFiles()を使ってファイル/フォルダの一覧を取得します。取得したものがフォルダの場合は再度フォルダ一覧を取得します。これを延々と繰り返します（再帰処理）。また、Mac OS X/OS Xの場合、ファイル名に日本語が含まれると正常に処理されないためサンプル-2のように日本語変換プログラムを使用する必要があります。</p>
<p>　なお、フォルダ一覧を取得する方法については前項を参照してください。</p>
<p>サブフォルダ内のAIファイル一覧を取得するサンプル-1</p>
<pre><code>// サブフォルダも含めたAIファイル一覧を取得する
var fileExt = "*.ai";  // 拡張子がaiのファイルを取得する
(function(){
    var folderObj = Folder.selectDialog("フォルダを選択してください");
    if (!folderObj) return;     // キャンセルされたら処理しない
    var txt = "";
    txt = getFolder(folderObj, txt, "");
    var txtObj = activeDocument.textFrames.add();
    txtObj.top = -10;
    txtObj.contents = txt;  // ドキュメント上に表示する
})();
// フォルダ内の一覧を取得
function getFolder(folderObj, txt, indent){
    var fileList = folderObj.getFiles(fileExt);
    for(var i=0; i&lt;fileList.length; i++){
        txt = txt + indent + decodeURI(fileList[i].name) + "\r";
    }
    var fileList = folderObj.getFiles(); 
    for (var i=0; i&lt;fileList.length; i++){
        if (fileList[i].getFiles) {
            txt = txt + indent + "■"+decodeURI(fileList[i].name) + "\r";     // フォルダの場合に先頭に■を追加する
            txt = getFolder(fileList[i], txt, indent+"＿");     // インデント文字を変更する場合は、ここの＿を変更する
        }
    }
    return txt;
}</code></pre>
<p>サブフォルダ内のAIファイル一覧を取得するサンプル-2</p>
<pre><code>// サブフォルダも含めたAIファイル一覧を取得する
var fileExt = "*.ai";  // 拡張子がaiのファイルを取得する
(function(){
    var folderObj = Folder.selectDialog("フォルダを選択してください");
    if (!folderObj) return;     // キャンセルされたら処理しない
    var txt = "";
    txt = getFolder(folderObj, txt, "");
    var txtObj = activeDocument.textFrames.add();
    txtObj.top = -10;
    txtObj.contents = txt;  // ドキュメント上に表示する
})();
// フォルダ内の一覧を取得
function getFolder(folderObj, txt, indent){
    var fileList = folderObj.getFiles(fileExt);
    for(var i=0; i&lt;fileList.length; i++){
        txt = txt + indent + convertKana(fileList[i].name) + "\r";
    }
    var fileList = folderObj.getFiles(); 
    for (var i=0; i&lt;fileList.length; i++){
        if (fileList[i].getFiles) {
            txt = txt + indent + "■"+convertKana(fileList[i].name) + "\r";   // フォルダの場合に先頭に■を追加する
            txt = getFolder(fileList[i], txt, indent+"＿");   // インデント文字を変更する場合は、ここの＿を変更する
        }
    }
    return txt;
}
// ------------------------------------------------------------------
// 日本語ファイル名を変換する関数 (MacOS X/OS Xのみ。Windowsは不要)
// ------------------------------------------------------------------
function convertKana(filename){
    var dakuten = "%E3%82%99";
    var handakuten = "%E3%82%9A";
    filename = convertKanaSub(filename,dakuten,1);
    filename = convertKanaSub(filename,handakuten,2);
    return File.decode(filename);
    // 日本語ファイル名変換サブ処理
    function convertKanaSub(srcName, code, count){
        srcName = srcName.replace(/%E3%82%BF%E3%82%99/g, "%E3%83%80"); // ダだけ特殊処理
        var text = srcName.split(code); // 濁点
        for (var i=0; i&lt;text.length-1; i++){
            var str = text[i];
            if (str == "") continue;
            var body = str.substring(0,str.length-2);
            var footL = str.substring(str.length-2, str.length);
            var hexL = eval("0x"+footL) + count;
            hexL = hexL.toString(16).toUpperCase();
            text[i] = body+hexL;
        }
        return text.join("");
    }
}</code></pre>
<p>　フォルダ選択ダイアログが表示されるのでAIファイルが含まれるフォルダを選択します。</p>
<figure>
<figcaption>【図】AIファイルが含まれるフォルダを選択する</figcaption>
<img src="images/00279.jpeg" />
</figure>
<p>　サンプル-1の実行結果です。フォルダ／サブフォルダ内に含まれる全てのAIファイルの一覧がドキュメント上に表示されます。なお、あらかじめドキュメントを表示しておかないとエラーになります。Mac OS X/OS Xの場合、ファイル名に濁点などが含まれると正しく処理されません。</p>
<figure>
<figcaption>【図】サンプル-1の実行結果</figcaption>
<img src="images/00397.jpeg" />
</figure>
<p>　サンプル-2の実行結果です。濁点などの処理が正しく行われます。</p>
<figure>
<figcaption>【図】サンプル-2の実行結果</figcaption>
<img src="images/00531.jpeg" />
</figure>
<p>　Windows 7でのサンプル-1の実行結果です。Windows 7の場合は特に日本語の処理をしなくても正常に処理されます。</p>
<figure>
<figcaption>【図】Windows 7でのサンプル-1の実行結果</figcaption>
<img src="images/00056.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-738">
<section>
<h2 id="calibre_link-446"><b>25-8　フォルダ／サブフォルダ内にあるJPEGファイルを配置する</b></h2>
<p>　フォルダ／サブフォルダ内にあるJPEGファイルを配置するには再帰を使ってJPEGファイルを取得します。JPEGファイルはgetFiles("*.jpg")のようにgetFiles()メソッドを使って取得することができます。画像を取得するたびにドキュメント上に配置する方法と一括して取得し配列に入れた後に配置する方法があります。サンプルでは一括して取得した後に配置しています。</p>
<p>　サンプルでは配置した画像を埋め込み画像としていますが、リンク画像のままにしたい場合は「myImage.embed();」の行を削除してください。</p>
<p>フォルダ／サブフォルダ内にあるJPEGファイルを配置するサンプル</p>
<pre><code>// フォルダ／サブフォルダ内にあるJPEGファイルを配置する
var fileExt = "*.jpg";  // 拡張子がjpgのファイルを取得する
var offsetX = 5;   // 開始位置の横方向のオフセット
var offsetY = 50;   // 開始位置の縦方向のオフセット
var imageW = 80;   // 画像の横幅
var imageH = 80;   // 画像の縦幅
var imageMarginW = 100; // // 横方向の画像との間隔
var imageMarginH = 95; // 縦方向の画像との間隔
var folderObj = Folder.selectDialog("フォルダを選択してください");
var jpegFileList = [];  // 画像のファイルオブジェクトを入れる配列
var count = 0;  // カウンタ
if (folderObj) {    // フォルダが選択された場合
    jpegFileList = getFolder(folderObj, jpegFileList);
    for(var y=0; y&lt;8; y++){
        for(var x =0; x&lt; 6; x++){
            var myImage = activeDocument.placedItems.add();
            myImage.file = jpegFileList[count];
            myImage.left = x * imageMarginW + offsetX;  // 画像のX座標を設定する
            myImage.top = -y * imageMarginH - offsetY;  // 画像のY座標を設定する
            myImage.width = imageH; // 画像の横幅を設定する
            myImage.height = imageW;    // 画像の縦幅を設定する
            count = count + 1;
            myImage.embed();    // 埋め込み画像にする
        }
    }
}
// フォルダ内のファイル一覧を取得
function getFolder(folderObj, jpegFileList){
    jpegFileList = jpegFileList.concat(folderObj.getFiles(fileExt));    // JPEGファイルオブジェクトを連結
    var fileList = folderObj.getFiles();    // フォルダ一覧を取得
    for (var i=0; i&lt;fileList.length; i++){
        if (fileList[i].getFiles) { // フォルダがある場合は再帰処理を行う
            jpegFileList = getFolder(fileList[i], jpegFileList);     // サブフォルダがある限り繰り返す
        }
    }
    return jpegFileList;    // 結果を返す
}</code></pre>
<p>　フォルダ選択ダイアログが表示されるのでJPEGファイルが含まれるフォルダを選択します。</p>
<figure>
<figcaption>【図】JPEGファイルが含まれるフォルダを選択する</figcaption>
<img src="images/00179.jpeg" />
</figure>
<p>　サブフォルダ内にあるJPEG画像も含めてドキュメント上に配置されます。</p>
<figure>
<figcaption>【図】JPEG画像も含めてドキュメント上に配置される</figcaption>
<img src="images/00309.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-138">
<section>
<div>
<h1 id="calibre_link-447"><b>第26章　ファイル</b></h1>
</div>
<p>　この章では、ファイルに関するサンプルを示し、解説します。OSに密着したさまざまなファイル処理やIllustratorの情報、ドキュメント情報などを書き出すこともできます。</p>
</section>
</div>
<div id="calibre_link-677">
<section>
<h2 id="calibre_link-448"><b>26-1　Illustratorで開くことができるファイルを、ファイル選択ダイアログを表示して開く</b></h2>
<p>　Illustratorで開くことができるファイルを、ファイル選択ダイアログを表示して開くには、File.openDialogとapp.open()を使います。File.openDialog()は選択されたファイルオブジェクト（ファイルに関する情報を入れたもの）または複数のファイルオブジェクトを格納した配列を返します。File.openDialog()は3つのパラメーターを指定することができます。最初のパラメーターがダイアログに表示する文字、2番目のパラメーターは選択できるファイルを示すワイルドカード (epsを選択させたい場合は"*.eps"を指定。JPEGなら"*.jpg")、3番目のパラメーターは複数のファイルを選択できるようにするかどうかのフラグです。</p>
<p>　3番目のパラメーターでtrueを指定すると複数のファイルを選択することができ、falseを指定すると1つしかファイルが選択できなくなります。また、falseを指定した場合、File.openDialog()はファイルオブジェクトを返しますが、trueを指定すると選択されたファイルの情報を持つファイルオブジェクトを格納した配列を返します。</p>
<p>　選択されたファイルを開くにはapp.open()のパラメーターに開きたいファイルのファイルオブジェクトを指定します。app.open()はIllustratorで開けるファイルであれば画像でもテキストでも処理されます。</p>
<p>Illustratorで開くことができるファイルを、ファイル選択ダイアログを表示して開くサンプル</p>
<pre><code>// 複数のファイルをファイルダイアログを使って開く
var fileList = File.openDialog ("イラストレーターで開けるファイルを複数選択してください", "*", true);
if (fileList != null) {
    for (var i=0; i&lt;fileList.length; i++){
        try {
            app.open(fileList[i]);
        }catch(e){}
    }
}</code></pre>
<p>　ファイル選択ダイアログが表示されるので開きたいファイルを複数選択します。</p>
<figure>
<figcaption>【図】開きたいファイルを複数選択する</figcaption>
<img src="images/00436.jpeg" />
</figure>
<p>　選択した複数のファイルがまとめて開かれます。</p>
<figure>
<figcaption>【図】選択した複数のファイルがまとめて開かれる</figcaption>
<img src="images/00565.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-80">
<section>
<h2 id="calibre_link-449"><b>26-2　ファイルパスを指定して開く</b></h2>
<p>　ファイルパスを指定して開くにはnew File()とapp.open()を使います。new File()のパラメーターには文字列で開きたいファイルのパスを指定します。"/Yosemite/images/sample.jpg"であればYosemiteフォルダにあるimagesフォルダ内のsample.jpgファイルを示します。</p>
<p>　また、ユーザーのホームフォルダ内にある画像を示す場合は"~/sample.jpg"のように~/を使って指定します。"~/images/sample.jpg"であればホームフォルダにあるimagesフォルダ内のsample.jpgを示します。Illustratorではアプリケーションフォルダやホームフォルダにアクセスするためのプロパティが用意されています。（フォルダの章のページを参照してください）</p>
<p>　あとはapp.open()のパラメーターにファイルオブジェクトを指定すればファイルが開かれます。ファイルパスが間違っている場合はファイルは開かれません。</p>
<p>ファイルパスを指定して開くサンプル</p>
<pre><code>// パスを指定してファイルを開く
var fileObj = new File("~/images/0.jpg");
try {
    app.open(fileObj);
}catch(e){
    alert("エラーです。\r" + e);
}</code></pre>
<p>　スクリプトを実行すると指定されたパスにある画像が開かれます。</p>
<figure>
<figcaption>【図】指定されたパスにある画像が開かれる</figcaption>
<img src="images/00090.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-624">
<section>
<h2 id="calibre_link-450"><b>26-3　テキストファイルを読み込みエリアテキストとして配置する</b></h2>
<p>　テキストファイルを読み込みエリアテキストとして配置するには、まずファイルオブジェクトのopen()メソッドを使いテキストファイルを読み込ませます。open()メソッドのパラメーターとして"r"を指定します。"r"はファイルモードで読み込み専用であることを示します。open()はファイルを開くことができた場合、trueを返します。ファイルが開けなかった場合はfalseを返します。trueだった場合のみファイルの読み込み処理を行います。</p>
<p>　テキストファイルの内容をまとめて読み込むにはread()メソッドを使います。read()はファイルの全ての内容を読み込むため、ファイルサイズによっては多少読み込みに時間がかかる場合もあります。</p>
<p>　ファイルの処理が終わったらclose()メソッドを使ってファイルを閉じます。なお、close()メソッドを使わなくても自動的にファイルは閉じられるため、再度スクリプトを実行した場合でもファイルがすでに開かれていてアクセスできない、ということはありません。</p>
<p>　全ての内容ではなく一行だけ読み込む場合はread()メソッドの代わりにreadln()メソッドを使います。1文字だけ読み込む場合はread()メソッドの代わりにreadch()メソッドを使います。</p>
<p>テキストファイルを読み込みエリアテキストとして配置するサンプル</p>
<pre><code>// テキストファイルを開いてドキュメントに配置する
var fileObj = File.openDialog("テキストファイルを選択してください", "*.txt", false);
if (fileObj) {
    var flag = fileObj.open("r");
    if (flag == true){
        var text = fileObj.read();  // 全ての内容を読み込む
        fileObj.close();    // ファイルを閉じる
        var rect = activeDocument.pathItems.rectangle(-20, 10, 580, 800);
        var tfObj = activeDocument.textFrames.areaText(rect);
        tfObj.top = -20;
        tfObj.left = 10;
        tfObj.contents = text;  // テキストフレームに読み込んだ内容を入れる
    }else{
        alert("ファイルが開けませんでした");
    }
}</code></pre>
<p>　スクリプトを実行するとファイル選択ダイアログが表示されるので、テキストファイルを選択します。</p>
<figure>
<figcaption>【図】テキストファイルを選択する</figcaption>
<img src="images/00216.jpeg" />
</figure>
<p>　選択したテキストファイルがエリアテキスト内に読み込まれます。</p>
<figure>
<figcaption>【図】テキストファイルがエリアテキスト内に読み込まれる</figcaption>
<img src="images/00337.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-23">
<section>
<h2 id="calibre_link-451"><b>26-4　テキストファイルで任意の位置から任意の文字数だけ読み込む</b></h2>
<p>　テキストファイルで任意の位置から任意の文字数だけ読み込むにはファイルオブジェクトのseek()メソッドとread()メソッドを使います。seek()メソッドの最初のパラメーターには読み込むファイルの位置を指定します。ファイル位置は文字数ではなくバイト数になります。8を指定すれば先頭から8バイトの位置にディスクヘッドが移動します。実際にread()などで読み込まれるのは9バイト目からになります。</p>
<p>　seek()の2番目のパラメーターには以下の基準位置を指定します。この基準位置により最初のパラメーターで指定された位置の意味が変わることになります。無事に指定した位置にファイルポジションが設定できた場合にはseek()はtrueを返します。指定した位置に移動できなかった場合にはfalseを返します。</p>
<table>
<caption>【表】seek()の2番目のパラメーターの意味</caption>
<tbody>
<tr>
  <td>
    <span>2番目のパラメーター</span>
  </td>
  <td>
    <span>意味</span>
  </td>
</tr>
<tr>
  <td>0</td>
  <td>絶対位置指定</td>
</tr>
<tr>
  <td>1</td>
  <td>相対位置指定</td>
</tr>
<tr>
  <td>2</td>
  <td>ファイルの終わりを基準（逆方向）</td>
</tr>
</tbody>
</table>
<p>read()メソッドのパラメーターには読み込む文字数を指定します。read(4)とすれば4文字分読み込まれます。この場合、1バイト単位で処理されるのではなく、1文字単位で処理が行われます。つまり、日本語や中国語などのマルチバイト文字でもバイト単位ではなく1文字単位で処理が行われます。</p>
<p>テキストファイルで任意の位置から任意の文字数だけ読み込むサンプル</p>
<pre><code>// テキストファイルの8バイト目の次から4文字だけ読み込む
var fileObj = File.openDialog("テキストファイルを選択してください", "*.txt", false);
if (fileObj) {
    var flag = fileObj.open("r");
    if (flag == true){
        fileObj.seek(6, 0);           // 絶対位置から6バイト目に移動
        var text = fileObj.read(4);  // 4文字読み込む
        var rect = activeDocument.pathItems.rectangle(-20, 10, 200, 100);
        var tfObj = activeDocument.textFrames.areaText(rect);
        tfObj.top = -20;
        tfObj.left = 10;
        tfObj.contents = text;  // テキストフレームに読み込んだ内容を入れる
        fileObj.close();
    }else{
        alert("ファイルが開けませんでした");
    }
}</code></pre>
<figure>
<figcaption>　テキストファイルを選択します。</figcaption>
</figure>
<figure>
<figcaption>【図】テキストファイルを選択する</figcaption>
<img src="images/00470.jpeg" />
</figure>
<p>　選択したテキストファイルの6バイト目の次から4文字がエリアテキスト内に読み込まれます。</p>
<figure>
<figcaption>【図】6バイト目の次から4文字がエリアテキスト内に読み込まれる</figcaption>
<img src="images/00508.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-558">
<section>
<h2 id="calibre_link-452"><b>26-5　ファイルに選択されたエリアテキストの内容を書き込む</b></h2>
<p>　ファイルに選択されたエリアテキストの内容を書き込むにはファイルオブジェクトのwrite()メソッドを使います。パラメーターには書き込みたい文字を指定します。エリアテキストの内容はcontentsプロパティから読み出すことができます。</p>
<p>　write()は改行コードなしで文字列を書き込みます。改行コードも付加したい場合にはwriteln()メソッドを使います。write()、writeln()メソッドを使う場合には、open()メソッドのファイルモードを"w"または"e"に指定しておく必要があります。さらに、write()、writeln()を使う場合にはファイルやフォルダへの書き込みが許可されている必要があります。</p>
<p>ファイルに選択されたエリアテキストの内容を書き込むサンプル</p>
<pre><code>// 選択されたエリアテキストの内容を書き込む
var selObj = activeDocument.selection[0];   // 最初に選択されたものだけが対象
var fileObj = File.saveDialog("保存するテキストファイル名を入れて下さい");
if (fileObj) {
    var flag = fileObj.open("w");
    if (flag == true){
        var text = selObj.contents; // エリアテキストの内容を読み出す
        fileObj.write(text);    // ファイルに書き込む
        fileObj.close();
    }else{
        alert("ファイルが開けませんでした");
    }
}</code></pre>
<p>　エリアテキストを選択します。</p>
<figure>
<figcaption>【図】エリアテキストを選択する</figcaption>
<img src="images/00296.jpeg" />
</figure>
<p>　スクリプトを実行し保存するファイル名を入力します。</p>
<figure>
<figcaption>【図】保存するファイル名を入力する</figcaption>
<img src="images/00074.jpeg" />
</figure>
<p>　エリアテキストの内容がファイルに書き出されます。</p>
<figure>
<figcaption>【図】エリアテキストの内容がファイルに書き出される</figcaption>
<img src="images/00460.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-725">
<section>
<h2 id="calibre_link-453"><b>26-6　ファイルをコピーする</b></h2>
<p>　ファイルをコピーするにはファイルオブジェクトのcopy()メソッドを使います。copy()メソッドのパラメーターにはコピー先のパスとファイル名が含まれるファイルオブジェクトを指定します。正常にファイルがコピーできた場合にはcopy()はtrueを返します。正常にコピーすることができなかった場合にはfalseを返します。</p>
<p>　ファイルがコピーできない場合は、copy()に指定したファイルオブジェクトで指定したパスやファイル名が正しいかどうか確認してください。また、フォルダ内に書き込み権限がない場合にもコピーできません。ネットワーク上のディスクには書き込む場合には特に書き込み権限やディスクドライブ名の指定に注意してください。また、フォルダ名やファイル名などに日本語や特殊記号が含まれている場合に失敗する場合は日本語でなくフォルダ名、ファイル名を全て英数字にしてみてください。どうしても、うまくいかない場合はIllustratorまたはOSを再起動してください。</p>
<p>ファイルをコピーするサンプル</p>
<pre><code>// ファイルをコピーする
var fileObj = File.openDialog("コピー元のファイルを選択してください", "*", false);
var copyTarget = new File("~/0x"+fileObj.name);
if (fileObj) {
    var flag = fileObj.copy(copyTarget);
    if (flag == true){
        alert("正常にファイルがコピーされました");
    }else{
        alert("ファイルがコピーできませんでした。");
    }
}</code></pre>
<p>　スクリプトを実行するとファイル選択ダイアログが表示されるので、コピーするファイルを選択します。</p>
<figure>
<figcaption>【図】コピーするファイルを選択する</figcaption>
<img src="images/00248.jpeg" />
</figure>
<p>　ファイルのコピー処理の結果がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】ファイルのコピー処理の結果が表示される</figcaption>
<img src="images/00033.jpeg" />
</figure>
<p>　ホームフォルダに、元のファイル名の先頭に0xが付加されたファイルが作成されます。</p>
<figure>
<figcaption>【図】元のファイル名の先頭に0xが付加されたファイルが作成される</figcaption>
<img src="images/00416.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-83">
<section>
<h2 id="calibre_link-454"><b>26-7　ファイルを削除する</b></h2>
<p>　ファイルを削除するにはファイルオブジェクトのremove()メソッドを使います。remove()メソッドにはパラメーターにはありません。正常にファイルが削除できた場合にはremove()はtrueを返します。正常に削除することができなかった場合にはfalseを返します。remove()メソッドは、削除するファイルをゴミ箱などに移動させたり、確認のダイアログを表示することはありません。remove()メソッドを使うと、いきなりファイルが削除されるため、使用する際は十分注意してください。</p>
<p>　ファイルが削除できない場合は、remove()に指定したファイルオブジェクトで指定したパスやファイル名が正しいかどうか確認してください。また、フォルダ内に書き込み権限／アクセス権がない場合にも削除できません。ネットワーク上のディスクにはアクセス限やディスクドライブ名の指定に注意してください。また、フォルダ名やファイル名などに日本語や特殊記号が含まれている場合に失敗する場合は日本語でなくフォルダ名、ファイル名を全て英数字にしてみてください。どうしても、うまくいかない場合はIllustratorまたはOSを再起動してください。</p>
<p>ファイルを削除するサンプル</p>
<pre><code>// ファイルを削除する
var fileObj = File.openDialog("削除するファイルを選択してください", "*", false);
if (fileObj) {
    var flag = fileObj.remove();    // ファイルを削除
    if (flag == true){
        alert("ファイルが削除されました");
    }else{
        alert("ファイルは削除できませんでした。");
    }
}</code></pre>
<p>　スクリプトを実行するとファイル選択ダイアログが表示されるので、削除するファイルを選択します。</p>
<figure>
<figcaption>【図】削除するファイルを選択する</figcaption>
<img src="images/00200.jpeg" />
</figure>
<p>　ファイルの削除処理の結果がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】削除処理の結果が表示される</figcaption>
<img src="images/00587.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-73">
<section>
<h2 id="calibre_link-455"><b>26-8　ファイル名を変更する</b></h2>
<p>　ファイル名を変更するにはファイルオブジェクトのrename()メソッドを使います。rename()メソッドのパラメーターに変更後のファイル名を指定します。指定するのはファイル名の文字のみでパスなどは指定できません。</p>
<p>正常にファイル名が変更できた場合にはrename()はtrueを返します。ファイル名を変更することができなかった場合にはfalseを返します。</p>
<p>　ファイル名が変更できない場合は、ファイルがロックされているかどうか、ファイルを含むフォルダなどにアクセス権があるかどうかを確認してください。また、フォルダ名やファイル名などに日本語や特殊記号が含まれている場合に失敗する場合は日本語でなくフォルダ名、ファイル名を全て英数字にしてみてください。どうしても、うまくいかない場合はIllustratorまたはOSを再起動してください。</p>
<p>ファイル名を変更するサンプル</p>
<pre><code>// ファイル名を変更する
var fileObj = File.openDialog("名前を変更するファイルを選択してください", "*", false);
if (fileObj) {
    var newname = prompt("新しいファイル名を入れてください", "0123.txt");
    if (newname){
        var flag = fileObj.rename(newname); // ファイル名変更
        if (flag == true){
            alert("ファイル名を変更しました");
        }else{
            alert("ファイル名が変更できませんでした。");
        }
    }
}</code></pre>
<p>　スクリプトを実行するとファイル選択ダイアログが表示されるので、ファイル名を変更するファイルを選択します。</p>
<figure>
<figcaption>【図】ファイル名を変更するファイルを選択する</figcaption>
<img src="images/00368.jpeg" />
</figure>
<p>　新しいファイル名を入力します。</p>
<figure>
<figcaption>【図】新しいファイル名を入力する</figcaption>
<img src="images/00158.jpeg" />
</figure>
<p>　ファイル名の変更処理の結果がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】ファイル名の変更処理の結果が表示される</figcaption>
<img src="images/00548.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-525">
<section>
<h2 id="calibre_link-456"><b>26-9　ファイル名を取得する</b></h2>
<p>　ファイル名を取得するにはファイルオブジェクトのnameプロパティを参照します。Mac OS X/OS Xの場合、nameプロパティにはエンコードされた状態でファイル名が格納されています。エンコードされている、つまり「あ.pdf」というファイルであれば%E3%81%82.pdfのように%nnの形式で格納されています。このエンコードされたファイル名を元に戻すにはFile.decode()を使います。ただし、日本語によっては正常に変換することができない場合があります。そのような場合は、第16章 フォルダ編の「フォルダ内のAIファイル一覧を取得する」に掲載している日本語ファイル名変換関数を利用してください。</p>
<p>　なお、日本語が含まれるファイル名をチェックして処理する場合は以下のようにFile.decode()等を使って変換した後に条件判断を行うようにしてください。</p>
<p>
<strong><b>【例】</b></strong>
</p>
<p>
<span>if (File.decode(fName) == "あ.pdf") { 一致した場合の処理 }</span>
</p>
<p>ファイル名を取得するサンプル</p>
<pre><code>// ファイルの名前を表示する
var fileObj = File.openDialog("ファイルを選択してください", "*", false);
if (fileObj) {
    var fName = fileObj.name;
    alert(fName);
    alert(File.decode(fName));
}</code></pre>
<p>　スクリプトを実行するとファイル選択ダイアログが表示されるので、ファイル名を変更するファイルを選択します。</p>
<figure>
<figcaption>【図】ファイル名を変更するファイルを選択する</figcaption>
<img src="images/00324.jpeg" />
</figure>
<p>　変換される前のファイル名がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】変換される前のファイル名が表示される</figcaption>
<img src="images/00292.jpeg" />
</figure>
<p>　変換（デコード・復元）されたファイル名がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】変換されたファイル名が表示される</figcaption>
<img src="images/00503.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-561">
<section>
<h2 id="calibre_link-457"><b>26-10　ファイルのパスを求める</b></h2>
<p>　ファイルのパスを求めるにはファイルオブジェクトのpathプロパティを参照します。pathには「~/Desktop」といったファイルまでのパスが格納されています。なお、末尾にはフォルダの区切りを示す/（スラッシュ）はありません。ユーザーフォルダ内にあるファイルの場合は「~/」で始まるパスになります。Mac OS X/OS Xの場合は、デスクトップに表示されているディスクドライブは「/Volumes」以下のパスにあります。</p>
<p>ファイルのパスと名前を求める場合はfullNameプロパティまたはabsoluteURIを参照します。fullNameプロパティはnameプロパティとは異なり日本語はデコードされた状態（普通に可読できる状態）になっています。absoluteURIプロパティはnameプロパティと同様に日本語はURIエンコードされた状態になっています。</p>
<p>ファイルのパスを求めるサンプル</p>
<pre><code>// ファイルのパスを表示する
var fileObj = File.openDialog("ファイルを選択してください", "*", false);
if (fileObj) {
    var fName = fileObj.fullName;   // フルネーム
    var aName = fileObj.absoluteURI;
    var fPath = fileObj.path;
    alert(fName+"\r"+aName+"\r"+fPath);
}</code></pre>
<p>　スクリプトを実行するとファイル選択ダイアログが表示されるので、ファイルパスを表示するファイルを選択します。</p>
<figure>
<figcaption>【図】ファイルパスを表示するファイルを選択する</figcaption>
<img src="images/00293.jpeg" />
</figure>
<p>　ファイルパスなどがアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】ファイルパスなどが表示される</figcaption>
<img src="images/00071.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-729">
<section>
<h2 id="calibre_link-458"><b>26-11　ファイルサイズを取得する</b></h2>
<p>　ファイルサイズを取得するにはファイルオブジェクトのlengthプロパティを参照します。得られる値はファイルのバイト数になります。ただし、2GB (2147483647バイト) を超えるファイルサイズの場合、lengthプロパティは正しいバイト数を返さないので注意が必要です。</p>
<p>ファイルサイズを取得するサンプル</p>
<pre><code>// ファイルサイズを表示する
var fileObj = File.openDialog("ファイルを選択してください", "*", false);
if (fileObj) {
    var Bytes = fileObj.length; // バイトサイズ
    var KB = Math.floor(Bytes / 1024);  // KBサイズを計算
    var MB = (KB / 1024).toPrecision(2);   // MBサイズを計算
    var GB = (MB / 1024).toPrecision(2);   // GBサイズを計算
    alert("ファイルサイズ："+Bytes+"バイト\r"+KB+"KB\r"+MB+"\r"+GB+"GB");
}</code></pre>
<p>　スクリプトを実行するとファイル選択ダイアログが表示されるので、ファイルパスを表示するファイルを選択します。</p>
<figure>
<figcaption>【図】ファイルパスを表示するファイルを選択する</figcaption>
<img src="images/00456.jpeg" />
</figure>
<p>　ファイルサイズがアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】ファイルサイズが表示される</figcaption>
<img src="images/00243.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-52">
<section>
<h2 id="calibre_link-459"><b>26-12　ファイルがエイリアス／ショートカットかどうか調べる</b></h2>
<p>　ファイルがエイリアス／ショートカットかどうか調べるにはファイルオブジェクトのaliasプロパティを参照します。aliasの値がtrueならエイリアス／ショートカット、falseなら実ファイルであることを示します。なお、MacOS X/OS Xではエイリアスであってもfalseを返すため正しい結果を得ることができません。これはファインダーで作成したエイリアスだけでなくターミナルからlnコマンドで作成したシンボリックリンクでも同様に正しく処理されません。Windows 7でも同様にファイルがエイリアス（ショートカット）であっても正しい結果を返しません。</p>
<p>ファイルがエイリアス／ショートカットかどうか調べるサンプル</p>
<pre><code>// ファイルがエイリアスかどうか調べる
var fileObj = File.openDialog("ファイルを選択してください", "*", false);
if (fileObj) {
    var flag = fileObj.alias;
    if (flag == true){
        alert("ファイルはエイリアス／ショートカットです");
    }else{
        alert("ファイルはエイリアス／ショートカットではありません");
    }
}</code></pre>
<p>　スクリプトを実行するとファイル選択ダイアログが表示されるので、エイリアスかどうか調べたいファイルを選択します。</p>
<figure>
<figcaption>【図】ファイルを選択する</figcaption>
<img src="images/00030.jpeg" />
</figure>
<p>　ファイルがエイリアスかどうかが、アラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】エイリアスかどうかが表示される</figcaption>
<img src="images/00413.jpeg" />
</figure>
<figure>
<figcaption>【図】ファイルを選択する（Windows 7）</figcaption>
<img src="images/00197.jpeg" />
</figure>
<figure>
<figcaption>【図】エイリアス（ショートカット）かどうかが表示される（Windows 7）</figcaption>
<img src="images/00583.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-95">
<section>
<h2 id="calibre_link-460"><b>26-13　ファイルの作成日、修正日を求める</b></h2>
<p>　ファイルの作成日を求めるにはファイルオブジェクトのcreatedプロパティを参照します。createdプロパティには作成された日付を示すDateオブジェクトが格納されています。一般的な月日、時間表示を行うにはDateオブジェクト内にある各種メソッドを使って情報を読み出す必要があります。サンプルではconvDateString()関数を使ってDateオブジェクトに含まれる日付情報を一般的な年月日表示に変換しています。</p>
<p>また、ファイルの修正日を求める場合はmodifiedプロパティを参照します。modifiedもcreatedプロパティ同様、Dateオブジェクトが格納されているので必要に応じて読みやすい日付形式に変換する必要があります。</p>
<p>ファイルの作成日、修正日を求めるサンプル</p>
<pre><code>// ファイルの作成日、修正日を表示する
var fileObj = File.openDialog("ファイルを選択してください", "*", false);
if (fileObj) {
    var cDate = fileObj.created;    // ファイル作成日
    var mDate = fileObj.modified;
    alert("ファイル作成日は"+cDate +"\r"+
        "ファイル修正日は"+mDate +"です");
    alert("ファイル作成日は"+convDateString(cDate) +"\r"+
        "ファイル修正日は"+convDateString(mDate) +"です");
}
// Dateオブジェクトを年月日等に変換して返す関数
function convDateString(dateObj){
    var d = new Date(dateObj);
    var Y = d.getFullYear();
    var M = d.getMonth() + 1;
    var D = d.getDate();
    var h = d.getHours();
    var m = d.getMinutes();
    var s = d.getSeconds();
    return Y+"年"+M+"月"+D+"日　"+h+"時"+m+"分"+s+"秒";
}</code></pre>
<p>　スクリプトを実行するとファイル選択ダイアログが表示されるので、作成日と修正日を表示するファイルを選択します。</p>
<figure>
<figcaption>【図】作成日と修正日を表示するファイルを選択する</figcaption>
<img src="images/00363.jpeg" />
</figure>
<p>　選択したファイルの作成日と修正日が、そのまま表示されます。</p>
<figure>
<figcaption>【図】作成日と修正日が、そのまま表示される</figcaption>
<img src="images/00154.jpeg" />
</figure>
<p>　読みやすい形式に変換したファイルの作成日と修正日が表示されます。</p>
<figure>
<figcaption>【図】読みやすい形式で、作成日と修正日が表示される</figcaption>
<img src="images/00543.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-139">
<section>
<h2 id="calibre_link-461"><b>26-14　ファイルが存在するかどうか調べる</b></h2>
<p>　ファイルが存在するかどうか調べるにはファイルオブジェクトのexistsプロパティを参照します。existsプロパティがtrueであれば、ファイルは存在していることになります。falseであればファイルは存在していないことになります。</p>
<p>ファイルが存在するかどうか調べるサンプル</p>
<pre><code>// ファイルが存在するかどうか調べる
var fileObj = new File("~/sample.txt");
if (fileObj) {
    var flag = fileObj.exists;  // ファイルの有無を調べる
    if (flag == true){
        alert("ホームフォルダにsample.txtファイルは存在します");
    }else{
        alert("ホームフォルダにsample.txtファイルは存在していません");
    }
}</code></pre>
<p>　ホームフォルダにファイルが存在するかどうかが、アラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】ファイルが存在するかどうかが表示される</figcaption>
<img src="images/00320.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-86">
<section>
<h2 id="calibre_link-462"><b>26-15　改行コードの種類を調べる</b></h2>
<p>　改行コードの種類を調べるにはファイルオブジェクトのlineFeedプロパティを参照します。これは指定されたファイルの改行コードを調べるものではありません。lineFeedプロパティは下表のような文字列を返します。</p>
<table>
<caption>【表】lineFeedプロパティが返す値</caption>
<tbody>
<tr>
  <td>
    <span>OSの種類</span>
  </td>
  <td>
    <span>返される文字列</span>
  </td>
</tr>
<tr>
  <td>Windows</td>
  <td>windows</td>
</tr>
<tr>
  <td>Mac OS X/OS X</td>
  <td>macintosh</td>
</tr>
<tr>
  <td>UNIX (Linux)</td>
  <td>unix</td>
</tr>
</tbody>
</table>
<p>　改行コードの値はOSによって異なり、Windowsでは0x0d, 0x0aの2バイト、Mac OS X/ OS X（Mac OS 9）では0x0dの1バイト（ただしUnixレイヤー上の場合は0x0a)、UNIXの場合は0x0aの1バイトとなります。なお、0x0dはCR (キャリッジリターン)、0x0aはLF (ラインフィード) の文字で示されることもあります。</p>
<p>改行コードの種類を調べるサンプル</p>
<pre><code>// 改行コードの種類を調べる
var fileObj = new File();
if (fileObj) {
    var type = fileObj.lineFeed;    // 改行の種類を取得
    alert(type);
}</code></pre>
<p>　改行コードの種類がアラートダイアログに表示されます（Mac OS X/ OS Xの場合）。</p>
<figure>
<figcaption>【図】改行コードの種類が表示される（Mac OS X/ OS X）</figcaption>
<img src="images/00111.jpeg" />
</figure>
<p>　改行コードの種類がアラートダイアログに表示されます（Windows 7の場合）。</p>
<figure>
<figcaption>【図】改行コードの種類が表示される（Windows 7）</figcaption>
<img src="images/00497.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-56">
<section>
<h2 id="calibre_link-463"><b>26-16　ファイルが書き込み禁止（ロックされている）かどうか調べる</b></h2>
<p>　ファイルが書き込み禁止（ロックされている）かどうか調べるにはファイルオブジェクトのreadonlyプロパティを参照します。readonlyの値がtrueであればファイルは書き込み禁止（ロックされている）になっています。falseであればファイルは書き込み禁止になっていないことになります。</p>
<p>ファイルが書き込み禁止（ロックされている）かどうか調べるサンプル</p>
<pre><code>// ファイルが書き込み禁止になっているか調べる
var fileObj = File.openDialog("ファイルを選択してください", "*", false);
if (fileObj) {
    var flag = fileObj.readonly;    // 読み出しのみかどうか調べる
    if (flag == true){
        alert("ファイルがロックされ書き込み禁止になっています。");
    }else{
        alert("ファイルはロックされていません。");
    }
}</code></pre>
<p>　スクリプトを実行するとファイル選択ダイアログが表示されるので、調べたいファイルを選択します。</p>
<figure>
<figcaption>【図】調べたいファイルを選択する</figcaption>
<img src="images/00394.jpeg" />
</figure>
<p>　選択したファイルがロックされているかどうかが、アラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】ロックされているかどうかが表示される</figcaption>
<img src="images/00066.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-650">
<section>
<h2 id="calibre_link-464"><b>26-17　親フォルダを求める</b></h2>
<p>　親フォルダを求めるにはファイルオブジェクトのparentプロパティを参照します。parentは指定されたファイルの親フォルダのフォルダオブジェクトが格納されています。このため、フォルダオブジェクト関連のメソッドやプロパティを使って処理を行うことができます。</p>
<p>親フォルダを求めるサンプル</p>
<pre><code>// 親フォルダを求める
var fileObj = File.openDialog("ファイルを選択してください", "*", false);
if (fileObj) {
    var folderObj = fileObj.parent; // 親フォルダのオブジェクトを読み出す
    alert("親フォルダ名："+File.decode(folderObj.name));
}</code></pre>
<p>　スクリプトを実行するとファイル選択ダイアログが表示されるので、ファイルを選択します。</p>
<figure>
<figcaption>【図】ファイルを選択する</figcaption>
<img src="images/00452.jpeg" />
</figure>
<p>　選択したファイルの親フォルダのフォルダ名がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】選択したファイルの親フォルダのフォルダ名が表示される</figcaption>
<img src="images/00237.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-713">
<section>
<h2 id="calibre_link-465"><b>26-18　アプリケーションを実行する</b></h2>
<p>　アプリケーションを実行するにはファイルオブジェクトのexecute()メソッドを使います。execute()にはパラメーターはありません。execute()はアプリケーションを実行するためのメソッドではなく、指定されたファイルを開く処理を行います。これは、ファインダーやエクスプローラーでファイルがダブルクリックされた場合と同じ結果になります。つまり、テキストファイルであれば、テキストエディタ（メモ帳など）が開きます。HTMLファイルであればデフォルトのブラウザが開かれます。アプリケーションの場合は、アプリケーションが起動することになります。ただし、場合によってはアプリケーションを実行することができない可能性もあります。</p>
<p>　execute()メソッドによりアプリケーションが実行された場合、アプリケーションからの戻り値を得たいことがあります。execute()ではアプリケーションからの戻り値を返さないため、どうしてもアプリケーションからの戻り値を得たい場合にはファイルなどを経由するか、Adobe BridgeのBridgeTalkを使ってやりとりします。Bridge Talkについては『ExtendScript Toolkit（ESTK）基本編』（ISBN：978-4-8443-9613-0）を参照してください。また、ファイルを実行するのではなく、コマンドを実行したい場合にはapp.system()を使ってください。</p>
<p>アプリケーションを実行するサンプル</p>
<pre><code>// アプリケーションを実行する
var fileObj = File.openDialog("実行する（開く）ファイルを指定して下さい");
if (fileObj) {
    fileObj.execute();  // 実行する
}</code></pre>
<p>　スクリプトを実行するとファイル選択ダイアログが表示されるので、実行するファイルを選択します。これは実行権限があるファイルやexeファイルでなく、通常のテキストファイルやPDFなどでも問題ありません。</p>
<figure>
<figcaption>【図】実行するファイルを選択する</figcaption>
<img src="images/00024.jpeg" />
</figure>
<p>　選択したファイルが実行されます。PDFやテキストファイルの場合は、該当するアプリケーションでファイルが開かれます。</p>
<figure>
<figcaption>【図】選択したファイルに該当するアプリケーションが実行される</figcaption>
<img src="images/00405.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-119">
<section>
<h2 id="calibre_link-466"><b>26-19　スウォッチカラーなどのカラー情報をファイルに書き出す</b></h2>
<p>　スウォッチカラーなどのカラー情報をファイルに書き出すにはwriteln()メソッドを使います。スウォッチカラーやグラデーションカラーなど複数の情報を書き出すには、まとめてファイルに書き出す関数を作成します。この関数に書き出したいオブジェクトを渡します。関数内ではオブジェクト（配列オブジェクト）の数だけnameプロパティをwriteln()メソッドを使ってファイルに書き出します。</p>
<p>ウォッチカラーなどのカラー情報をファイルに書き出すサンプル</p>
<pre><code>// スウォッチカラーなどのカラー情報をファイルに書き出す
var fileObj = File.saveDialog("保存するテキストファイル名を入れて下さい");
if (fileObj) {
    var flag = fileObj.open("w");   // 書き込みモードで開く
    if (flag == true){  // 書き込みが可能な場合のみ処理する
        writeName(activeDocument.swatches, "スウォッチカラー");
        writeName(activeDocument.swatchGroups, "スウォッチカラーグループ");
        writeName(activeDocument.spots, "スポットカラーグループ");
        writeName(activeDocument.patterns, "パターンカラーグループ");
        writeName(activeDocument.gradients, "グラデーションカラーグループ");
        fileObj.close();    // ファイルを閉じる
    }else{
        alert("ファイルが開けませんでした");
    }
}
// 指定したオブジェクトの名前を書き出す
function writeName(obj, title){
    fileObj.writeln("■"+title);
    for(var i=0; i&lt;obj.length; i++){    // 配列要素の数だけ繰り返す
        fileObj.writeln(obj[i].name);   // 名前を出力する
    }
    fileObj.writeln("--------------");  // 区切り線
}</code></pre>
<p>　スクリプトを実行するとファイル保存ダイアログが表示されるので、保存するファイル名を入力します。</p>
<figure>
<figcaption>【図】保存するファイル名を入力する</figcaption>
<img src="images/00192.jpeg" />
</figure>
<p>　複数のカラー情報がテキストファイルに書き出されます。</p>
<figure>
<figcaption>【図】複数のカラー情報がテキストファイルに書き出される</figcaption>
<img src="images/00484.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-655">
<section>
<div>
<h1 id="calibre_link-467"><b>第27章　ファイル保存</b></h1>
</div>
<p>　この章では、ファイル保存に関するサンプルを示し、解説します。Illustratorが対応しているさまざまなファイル形式での保存ができます。</p>
</section>
</div>
<div id="calibre_link-60">
<section>
<h2 id="calibre_link-468"><b>27-1　アクティブドキュメントを保存する</b></h2>
<p>　アクティブドキュメントを保存するにはドキュメントオブジェクトのsave()メソッドを使います。save()には指定できるパラメーターはありません。save()は一度もドキュメントが保存されていない場合はエラーになります。この場合はドキュメントオブジェクトのsavedプロパティを調べます。savedプロパティがtrueなら保存済み、falseなら保存されていないことになります。trueの場合はsave()メソッドを使います。falseの場合は、状況に応じて処理を行います。</p>
<p>　サンプルではドキュメントが保存されていない場合は保存ダイアログを表示し、saveAs()メソッドを使ってドキュメントの保存を行います。saveAs()メソッドは2つのパラメーターを指定することができます。最初のパラメーターには保存先を示すファイルオブジェクトを指定します。2番目のパラメーターは各種画像形式を保存する際のオプションを指定します。2番目のパラメーターは省略することができ、AI形式で保存する場合はオプションを指定する必要はありません。</p>
<p>アクティブドキュメントを保存するサンプル</p>
<pre><code>// アクティブドキュメントを保存する
if (activeDocument.saved == true){
    activeDocument.save();
}else{
    alert("ドキュメントがまだ保存されていません");
    var savefile = File.saveDialog("保存ファイル名を入れてください", "*");
    if (savefile != null) {
        activeDocument.saveAs(savefile);
    }
}</code></pre>
<p>　アクティブになっているドキュメントが保存されます。保存されていない場合はアラートダイアログが表示されます。</p>
<figure>
<figcaption>【図】保存されていない場合はアラートダイアログが表示される</figcaption>
<img src="images/00014.jpeg" />
</figure>
<p>　保存ダイアログが表示されるので、ファイル名と保存場所を指定します。</p>
<figure>
<figcaption>【図】ファイル名と保存場所を指定します。</figcaption>
<img src="images/00302.jpeg" />
</figure>
<p>　ファイルがAI形式で保存されます。</p>
<figure>
<figcaption>【図】ファイルがAI形式で保存される</figcaption>
<img src="images/00268.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-600">
<section>
<h2 id="calibre_link-469"><b>27-2　EPS形式で保存する</b></h2>
<p>　EPS形式で保存するにはドキュメントオブジェクトのsaveAs()メソッドを使います。saveAs()メソッドは2つのパラメーターを指定することができます。最初のパラメーターには保存先を示すファイルオブジェクトを指定します。2番目のパラメーターはEPS形式のオプションを指定します。EPS形式保存時に指定できるオプションを表「EPS保存オプション」に示します。</p>
<p>　なお、アートボードが複数ある場合にはファイル名に「-番号」が付加されますが、この番号の形式をプログラムで指定することはできません。また、現在ではEPS形式の使用は推奨されていません。EPS形式を使用すると期待通りの結果にならないことがあります。EPS形式は古いバージョンのDTPアプリケーションに対応しなければならない場合を除いて使用を避け、AI形式を使用するようにしてください。</p>
<table>
<caption>【表】EPS保存オプション</caption>
<tbody>
<tr>
  <td>
    <span>オプション</span>
  </td>
  <td>
    <span>設定</span>
  </td>
</tr>
<tr>
  <td>artboardRange</td>
  <td>saveMultipleArtboardsがtrueの場合のアートボードの保存範囲（ページ数）</td>
</tr>
<tr>
  <td>cmykPostScript</td>
  <td>CMYKポストスクリプト（trueでCMYKポストスクリプト）</td>
</tr>
<tr>
  <td>compatibility</td>
  <td>互換性（表「保存バージョン」を参照）</td>
</tr>
<tr>
  <td>compatibleGradientPrinting</td>
  <td>コンパチブルグラデーション＆グラデーションメッシュプリント（trueで互換）</td>
</tr>
<tr>
  <td>embedAllFonts</td>
  <td>フォントを埋め込むかどうか（trueで埋め込み）</td>
</tr>
<tr>
  <td>embedLinkedFiles</td>
  <td>リンク画像を含めるかどうか（trueで含める）</td>
</tr>
<tr>
  <td>flattenOuput</td>
  <td>透明化の設定（表「透明化の設定」を参照）</td>
</tr>
<tr>
  <td>includeDocumentThumbnails</td>
  <td>サムネール（trueでサムネールを含める）</td>
</tr>
<tr>
  <td>overprint</td>
  <td>オーバープリント設定（表「オーバープリントの設定」を参照）</td>
</tr>
<tr>
  <td>postScript</td>
  <td>PostScriptレベル設定（表「ポストスクリプトレベルの設定」を参照）</td>
</tr>
<tr>
  <td>preview</td>
  <td>EPSプレビュー（表「EPSプレビューの設定」を参照）</td>
</tr>
<tr>
  <td>saveMultipleArtboards</td>
  <td>複数のアートボードを保存するかどうか（trueで保存。保存範囲はartboardRangeで指定）</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】保存バージョン</caption>
<tbody>
<tr>
  <td>
    <span>オプション</span>
  </td>
  <td>
    <span>設定</span>
  </td>
</tr>
<tr>
  <td>Compatibility.ILLUSTRATOR8</td>
  <td>Illustrator ver 8</td>
</tr>
<tr>
  <td>Compatibility.ILLUSTRATOR9</td>
  <td>Illustrator ver 9</td>
</tr>
<tr>
  <td>Compatibility.ILLUSTRATOR10</td>
  <td>Illustrator ver 10</td>
</tr>
<tr>
  <td>Compatibility.ILLUSTRATOR11</td>
  <td>Illustrator ver CS</td>
</tr>
<tr>
  <td>Compatibility.ILLUSTRATOR12</td>
  <td>Illustrator ver CS2</td>
</tr>
<tr>
  <td>Compatibility.ILLUSTRATOR13</td>
  <td>Illustrator ver CS3</td>
</tr>
<tr>
  <td>Compatibility.ILLUSTRATOR14</td>
  <td>Illustrator ver CS4</td>
</tr>
<tr>
  <td>Compatibility.ILLUSTRATOR15</td>
  <td>Illustrator ver CS5</td>
</tr>
<tr>
  <td>Compatibility.ILLUSTRATOR16</td>
  <td>Illustrator ver CS6</td>
</tr>
<tr>
  <td>Compatibility.ILLUSTRATOR17</td>
  <td>Illustrator ver CC</td>
</tr>
<tr>
  <td>Compatibility.JAPANESEVERSION3</td>
  <td>Illustrator 3日本語版</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】透明化の設定</caption>
<tbody>
<tr>
  <td>
    <span>オプション</span>
  </td>
  <td>
    <span>設定</span>
  </td>
</tr>
<tr>
  <td>OutputFlattening.PRESERVEPATHS</td>
  <td>パスを保持（透明部分を破棄）</td>
</tr>
<tr>
  <td>OutputFlattening.PRESERVEAPPEARANCE</td>
  <td>アピアランスとオーバープリントを保持</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】オーバープリントの設定</caption>
<tbody>
<tr>
  <td>
    <span>オプション</span>
  </td>
  <td>
    <span>設定</span>
  </td>
</tr>
<tr>
  <td>PDFOverprint.DISCARDPDFOVERPRINT</td>
  <td>破棄</td>
</tr>
<tr>
  <td>PDFOverprint.PRESERVEPDFOVERPRINT</td>
  <td>保持</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】ポストスクリプトレベルの設定</caption>
<tbody>
<tr>
  <td>
    <span>オプション</span>
  </td>
  <td>
    <span>設定</span>
  </td>
</tr>
<tr>
  <td>EPSPostScriptLevelEnum.LEVEL2</td>
  <td>ポストスクリプト レベル2</td>
</tr>
<tr>
  <td>EPSPostScriptLevelEnum.LEVEL3</td>
  <td>ポストスクリプト レベル3</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】EPSプレビューの設定</caption>
<tbody>
<tr>
  <td>
    <span>オプション</span>
  </td>
  <td>
    <span>設定</span>
  </td>
</tr>
<tr>
  <td>EPSPreview.BWTIFF</td>
  <td>TIFF（白黒）</td>
</tr>
<tr>
  <td>EPSPreview.COLORTIFF</td>
  <td>TIFF（カラー）</td>
</tr>
<tr>
  <td>EPSPreview.TRANSPARENTCOLORTIFF</td>
  <td>TIFF（透明情報あり）</td>
</tr>
<tr>
  <td>EPSPreview.None</td>
  <td>なし</td>
</tr>
</tbody>
</table>
<p>EPS形式で保存するサンプル</p>
<pre><code>// EPS形式で保存する
var savefile = File.saveDialog("保存ファイル名を入れてください", "*");
if (savefile != null) {
    var opt = new EPSSaveOptions();
    opt.cmykPostScript = true;   // CMYKポストスクリプト
    opt.compatibility = Compatibility.ILLUSTRATOR16;   // CS5互換
    opt.compatibleGradientPrinting = false;   // コンパチブルグラデーション＆グラデーションメッシュプリント
    opt.embedAllFonts = false;   // フォントの埋め込み(trueなら埋め込み)
    opt.embedLinkedFiles = true;     // リンクファイルの埋め込み(配置した画像を含む)
    opt.flattenOuput = OutputFlattening.PRESERVEPATHS;     // 透明化の処理
    opt.includeDocumentThumbnails = true;     // サムネールの作成
    opt.overprint = PDFOverprint.PRESERVEPDFOVERPRINT;
    opt.postScript = EPSPostScriptLevelEnum.LEVEL3;   // PostScript Level 3
    opt.preview = EPSPreview.None;   // EPSプレビューなし
    activeDocument.saveAs(savefile, opt);
}</code></pre>
<p>　スクリプトを実行するとファイル保存ダイアログが表示されるのでファイル名を入力します。</p>
<figure>
<figcaption>【図】ファイル名を入力する</figcaption>
<img src="images/00362.jpeg" />
</figure>
<p>　ファイルがEPS形式で保存されます。</p>
<figure>
<figcaption>【図】EPS形式で保存される</figcaption>
<img src="images/00404.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-760">
<section>
<h2 id="calibre_link-470"><b>27-3　GIF形式で保存する</b></h2>
<p>　GIF形式で保存するにはドキュメントオブジェクトのexportFile()メソッドを使います。exportFile()には3つのパラメーターを指定することができます。最初のパラメーターが保存先の情報を格納したファイルオブジェクトになります。2番目のパラメーターは保存形式を指定します。GIF形式で保存する場合はExportType.GIFを指定します。</p>
<p>　3番目のパラメーターはオプションです。オプションは省略できますが、期待する設定で画像を書き出すのであればオプションは指定する必要があります。GIF形式の保存オプションでは解像度指定や特定のアートボードを指定して書き出すオプションはありません。オプションのartBoardClippingプロパティにtrueを指定するとアクティブになっているアートボードをGIF画像として書き出します。falseに設定されている場合は全てのアートボードを1枚のGIF画像として書き出します。</p>
<p>　なお、アートボードごとにGIF画像として書き出すにはfor()命令を使ってアートボードの数だけ繰り返します。その際、書き出すアートボードをアクティブにしてからexportFile()メソッドを使います。</p>
<p>GIF形式で保存するサンプル</p>
<pre><code>// GIF形式で保存する
var savefile = File.saveDialog ("保存ファイル名をいれてください", "*");
if (savefile != null) {
    var opt = new ExportOptionsGIF();
    opt.transparency = false;  // 透明OFF
    opt.antiAliasing = true;  // アンチエイリアス ON
    opt.colorCount = 16;   // 16色で書き出し
    opt.colorDither = ColorDitherMethod.DIFFUSION;   // 誤差拡散
    opt.artBoardClipping = false;   // 全てのアートボードを1枚の画像として保存
    opt.horizontalScale = 100;  // 水平の割合
    opt.verticalScale = 100;  // 縦方向の割合
    opt.interlaced = false;  // インターレースOFF
    opt.matter = true;  // マットカラー（背景色）を付ける
    opt.matteColor = setRGBColor(0, 0, 255);   // マットは青色
    opt.saveAsHTML = false;   // HTMLファイルは同時に保存しない
    opt.webSnap = 10;   // Webカラーパレットに合わせるための最大変更色数を100にする
    app.activeDocument.exportFile(savefile, ExportType.GIF, opt);
}
// RGBカラーを設定し、RGBカラーオブジェクトを返す
function setRGBColor(r,g,b){
    var RGB = new RGBColor();
    RGB.red = r;
    RGB.green = g;
    RGB.blue = b;
    return RGB;
}</code></pre>
<p>　スクリプトを実行するとファイル保存ダイアログが表示されます。</p>
<figure>
<figcaption>【図】ファイル保存ダイアログが表示される</figcaption>
<img src="images/00438.jpeg" />
</figure>
<p>　ファイルがGIF形式で保存されます。</p>
<figure>
<figcaption>【図】GIF形式で保存される</figcaption>
<img src="images/00167.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-537">
<section>
<h2 id="calibre_link-471"><b>27-4　PNG8形式で保存する</b></h2>
<p>　PNG8形式（8ビットカラー。最大256色まで）で保存するにはドキュメントオブジェクトのexportFile()メソッドを使います。exportFile()には3つのパラメーターを指定することができます。最初のパラメーターが保存先の情報を格納したファイルオブジェクトになります。2番目のパラメーターは保存形式を指定します。PNG8形式で保存する場合はExportType.PNG8を指定します。</p>
<p>　3番目のパラメーターはオプションです。オプションは省略できますが、期待する設定で画像を書き出すのであればオプションは指定する必要があります。同じPNG形式であってもPNG8とPNG24では使用できるオプションが若干異なっています。</p>
<p>　PNG8形式で保存するオプションには解像度指定や特定のアートボードを指定して書き出すオプションはありません。オプションのartBoardClippingプロパティにtrueを指定するとアクティブになっているアートボードをPNG画像として書き出します。falseに設定されている場合は全てのアートボードを1枚のPNG画像として書き出します。</p>
<p>　なお、アートボードごとにPNG画像として書き出すにはfor()命令を使ってアートボードの数だけ繰り返します。その際、書き出すアートボードをアクティブにしてからexportFile()メソッドを使います。</p>
<p>PNG8形式で保存するサンプル</p>
<pre><code>// PNG8形式で保存する
var savefile = File.saveDialog ("保存ファイル名をいれてください", "*");
if (savefile != null) {
    var opt = new ExportOptionsPNG8();
    opt.transparency = false;  // 透明OFF
    opt.antiAliasing = true;  // アンチエイリアス ON
    opt.colorCount = 16;     // 16色で書き出し
    opt.colorDither = ColorDitherMethod.DIFFUSION;  // 誤差拡散
    opt.artBoardClipping = true;     // アートボード内だけを保存
    opt.horizontalScale = 100;  // 水平の割合
    opt.verticalScale = 100;   // 縦方向の割合
    opt.interlaced = false;   // インターレースOFF
    opt.matter = true;   // マットカラー（背景色）を付ける
    opt.matteColor = setRGBColor(0, 255, 0);   // マットは緑色
    opt.saveAsHTML = false;   // HTMLファイルは同時に保存しない
    opt.webSnap = 10;   // Webカラーパレットに合わせるための最大変更色数を100にする
    app.activeDocument.exportFile(savefile, ExportType.PNG8, opt);
}
// RGBカラーを設定し、RGBカラーオブジェクトを返す
function setRGBColor(r,g,b){
    var RGB = new RGBColor();
    RGB.red = r;
    RGB.green = g;
    RGB.blue = b;
    return RGB;
}</code></pre>
<p>　スクリプトを実行するとファイル保存ダイアログが表示されます。</p>
<figure>
<figcaption>【図】ファイル保存ダイアログが表示される</figcaption>
<img src="images/00512.jpeg" />
</figure>
<p>　ファイルがPNG8形式で保存されます。</p>
<figure>
<figcaption>【図】PNG8形式で保存される</figcaption>
<img src="images/00423.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-701">
<section>
<h2 id="calibre_link-472"><b>27-5　PNG24形式で保存する</b></h2>
<p>　PNG24形式（24ビットカラー＆透明情報（αチャネル））で保存するにはドキュメントオブジェクトのexportFile()メソッドを使います。exportFile()には3つのパラメーターを指定することができます。最初のパラメーターが保存先の情報を格納したファイルオブジェクトになります。2番目のパラメーターは保存形式を指定します。PNG24形式で保存する場合はExportType.PNG24を指定します。</p>
<p>　3番目のパラメーターはオプションです。オプションは省略できますが、期待する設定で画像を書き出すのであればオプションは指定する必要があります。同じPNG形式であってもPNG8とPNG24では使用できるオプションが若干異なっています。</p>
<p>　PNG24形式で保存するオプションはPNG8形式より少なくなっています。PNG24形式には解像度指定や特定のアートボードを指定して書き出すオプションはありません。オプションのartBoardClippingプロパティにtrueを指定するとアクティブになっているアートボードをPNG画像として書き出します。falseに設定されている場合は全てのアートボードを1枚のPNG画像として書き出します。</p>
<p>　なお、アートボードごとにPNG画像として書き出すにはfor()命令を使ってアートボードの数だけ繰り返します。その際、書き出すアートボードをアクティブにしてからexportFile()メソッドを使います。</p>
<p>PNG24形式で保存するサンプル</p>
<pre><code>// PNG24形式で保存する
var savefile = File.saveDialog ("保存ファイル名をいれてください", "*");
if (savefile != null){
    var opt = new ExportOptionsPNG24();
    opt.transparency = false;   // 透明OFF
    opt.antiAliasing = true;   // アンチエイリアス ON
    opt.artBoardClipping = false;   // アートボード全体を保存
    opt.horizontalScale = 100;  // 水平の割合
    opt.verticalScale = 100;  // 縦方向の割合
    opt.matter = true;  // マットカラー（背景色）を付ける
    opt.matteColor = setRGBColor(255, 255, 0);  // マットは黄色
    opt.saveAsHTML = false;   // HTMLファイルは同時に保存しない
    app.activeDocument.exportFile(savefile, ExportType.PNG24, opt);
}

// RGBカラーを設定し、RGBカラーオブジェクトを返す
function setRGBColor(r,g,b){
    var RGB = new RGBColor();
    RGB.red = r;
    RGB.green = g;
    RGB.blue = b;
    return RGB;
}</code></pre>
<p>　スクリプトを実行するとファイル保存ダイアログが表示されます。</p>
<figure>
<figcaption>【図】ファイル保存ダイアログが表示される</figcaption>
<img src="images/00536.jpeg" />
</figure>
<p>　ファイルがPNG24形式で保存されます。</p>
<figure>
<figcaption>【図】PNG24形式で保存される</figcaption>
<img src="images/00078.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-105">
<section>
<h2 id="calibre_link-473"><b>27-6　JPEG形式で保存する</b></h2>
<p>　JPEG形式で保存するにはドキュメントオブジェクトのexportFile()メソッドを使います。exportFile()には3つのパラメーターを指定することができます。最初のパラメーターが保存先の情報を格納したファイルオブジェクトになります。2番目のパラメーターは保存形式を指定します。JPEG形式で保存する場合はExportType.JPEGを指定します。</p>
<p>　3番目のパラメーターはオプションです。オプションは省略できますが、期待する設定で画像を書き出すのであればオプションは指定する必要があります。なお、解像度を指定するオプションはありません。</p>
<p>JPEG形式で保存するサンプル</p>
<pre><code>// JPEG形式で保存する
var savefile = File.saveDialog ("保存ファイル名をいれてください", "*");
if (savefile != null){
    var opt = new ExportOptionsJPEG();
    opt.antiAliasing = true;   // アンチエイリアス ON
    opt.artBoardClipping = true;   // アートボード内だけを保存
    opt.horizontalScale = 100;   // 水平の割合
    opt.verticalScale = 100;   // 縦方向の割合
    opt.matter = true;  // マットカラー（背景色）を付ける
    opt.matteColor = setRGBColor(0, 0, 255);  // マットは青色
    opt.optimization = true;  // Web用に最適化
    opt.qualitySetting = 80;  // 画像品質
    opt.saveAsHTML = false;  // HTMLファイルは同時に保存しない
    app.activeDocument.exportFile(savefile, ExportType.JPEG, opt);
}

// RGBカラーを設定し、RGBカラーオブジェクトを返す
function setRGBColor(r,g,b){
    var RGB = new RGBColor();
    RGB.red = r;
    RGB.green = g;
    RGB.blue = b;
    return RGB;
}</code></pre>
<p>　スクリプトを実行するとファイル保存ダイアログが表示されます。</p>
<figure>
<figcaption>【図】ファイル保存ダイアログが表示される</figcaption>
<img src="images/00205.jpeg" />
</figure>
<p>　ファイルがJPEG形式で保存されます。</p>
<figure>
<figcaption>【図】JPEG形式で保存される</figcaption>
<img src="images/00330.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-107">
<section>
<h2 id="calibre_link-474"><b>27-7　Photoshop形式で保存する</b></h2>
<p>　Photoshop形式（PSD形式）で保存するにはドキュメントオブジェクトのexportFile()メソッドを使います。exportFile()には3つのパラメーターを指定することができます。最初のパラメーターが保存先の情報を格納したファイルオブジェクトになります。2番目のパラメーターは保存形式を指定します。Photoshop形式で保存する場合はExportType.PHOTOSHOPを指定します。</p>
<p>　3番目のパラメーターはオプションです。オプションは省略できますが、期待する設定で画像を書き出すのであればオプションは指定する必要があります。なお、Photoshop形式はドキュメント内に何もない場合には保存することができません。</p>
<table>
<caption>【表】指定できるオプション</caption>
<tbody>
<tr>
  <td>
    <span>オプション</span>
  </td>
  <td>
    <span>設定</span>
  </td>
</tr>
<tr>
  <td>antiAliasing</td>
  <td>アンチエイリアスを有効にするか（trueなら有効）</td>
</tr>
<tr>
  <td>artboardRange</td>
  <td>saveMultipleArtboardsがtrueの場合にアートボードを保存する範囲を指定する</td>
</tr>
<tr>
  <td>editableText</td>
  <td>テキストフレームを編集可能なPhotoshopのテキストレイヤーにするかどうか（trueなら編集可能にする）</td>
</tr>
<tr>
  <td>embedICCProfile</td>
  <td>ICCプロファイルを埋め込むかどうか（trueなら埋め込む）</td>
</tr>
<tr>
  <td>imageColorSpace</td>
  <td>カラーモードを指定する。指定可能なカラーモード表2を参照。</td>
</tr>
<tr>
  <td>maximumEditability</td>
  <td>なるべくオリジナルのドキュメントの構造を保持するかどうか（trueなら保持）</td>
</tr>
<tr>
  <td>resolution</td>
  <td>解像度（72.0~2400.0）</td>
</tr>
<tr>
  <td>saveMultipleArtboards</td>
  <td>複数のアートボードを保存するかどうか。保存範囲はartboardRangeで文字列か数値で指定する。</td>
</tr>
<tr>
  <td>warnings</td>
  <td>何か不具合があった場合にダイアログを表示するかどうか（trueなら表示）</td>
</tr>
<tr>
  <td>writeLayers</td>
  <td>レイヤーを保持して書き出すかどうか（trueなら保持）</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】ImageColorSpaceで指定できる値</caption>
<tbody>
<tr>
  <td>
    <span>値</span>
  </td>
  <td>
    <span>設定</span>
  </td>
</tr>
<tr>
  <td>ImageColorSpace.CMYK</td>
  <td>CMYKカラー</td>
</tr>
<tr>
  <td>ImageColorSpace.Grayscale</td>
  <td>グレースケール</td>
</tr>
<tr>
  <td>ImageColorSpace.RGB</td>
  <td>RGBカラー</td>
</tr>
<tr>
  <td>ImageColorSpace.LAB</td>
  <td>Labカラー</td>
</tr>
<tr>
  <td>ImageColorSpace.Separation</td>
  <td>ダブルトーン</td>
</tr>
<tr>
  <td>ImageColorSpace.Indexed</td>
  <td>インデックスカラー</td>
</tr>
<tr>
  <td>ImageColorSpace.DeviceN</td>
  <td>DeviceNカラー</td>
</tr>
</tbody>
</table>
<p>Photoshop形式で保存するサンプル</p>
<pre><code>// Photoshop形式で保存する
var savefile = File.saveDialog ("保存ファイル名をいれてください", "*");
if (savefile != null){
    var opt = new ExportOptionsPhotoshop();
    opt.antiAliasing = true;  // アンチエイリアス ON
    opt.editableText = true;  // テキストをテキストレイヤーに変換するかどうか
    opt.embedICCProfile = false;     // ICCプロファイルを埋め込むか
    opt.imageColorSpace = ImageColorSpace.RGB;  // カラーモード
    opt.maximumEditability = true;   // 編集機能を最大限に保持する
    opt.resolution = 72;   // 解像度(72~2400)
    opt.warnings = true;   // 出力設定警告
    opt.writeLayers = true;   // レイヤーを保持したまま書き出す
    app.activeDocument.exportFile(savefile, ExportType.PHOTOSHOP, opt);
}</code></pre>
<p>　スクリプトを実行するとファイル保存ダイアログが表示されます。</p>
<figure>
<figcaption>【図】ファイル保存ダイアログが表示される</figcaption>
<img src="images/00462.jpeg" />
</figure>
<p>　ファイルがPhotoshop (PSD) 形式で保存されます。</p>
<figure>
<figcaption>【図】Photoshop (PSD) 形式で保存される</figcaption>
<img src="images/00588.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-68">
<section>
<h2 id="calibre_link-475"><b>27-8　PDF形式で保存する</b></h2>
<p>　ファイルをPDFとして保存するにはsaveAs()メソッドの2番目のパラメーターにPDF保存に必要なオプションを指定します。PDF保存オプションはnew PDFSaveOptions()として生成されたオブジェクトの各プロパティに設定します。主なオプションを下表に示します。なお、複数のアートボードがある場合、PDF形式で保存すると自動的に複数ページのPDFとして保存されます。</p>
<p>　IllustratorでPDF形式で保存されたPDFの場合、後で編集可能なファイルにすることができます。編集可能にする場合はPDF保存オプションのpreserveEditabilityにtrueを設定します。デフォルトではtrueになっているため何もせず保存すると編集可能なPDFになります。</p>
<table>
<caption>【表】主なオプション</caption>
<tbody>
<tr>
  <td>
    <span>オプション</span>
  </td>
  <td>
    <span>設定</span>
  </td>
</tr>
<tr>
  <td>artboardRange</td>
  <td>保存するアートボードの範囲</td>
</tr>
<tr>
  <td>compatibility</td>
  <td>PDF互換性を指定。表2を参照。</td>
</tr>
<tr>
  <td>documentPassword</td>
  <td>ドキュメントパスワード</td>
</tr>
<tr>
  <td>enableCopy</td>
  <td>コピー可能にするかどうか（trueならコピー可能）</td>
</tr>
<tr>
  <td>generateThumbnails</td>
  <td>サムネールを作成するかどうか</td>
</tr>
<tr>
  <td>permissionPassword</td>
  <td>パスワード</td>
</tr>
<tr>
  <td>preserveEditability</td>
  <td>編集可能にして保存するかどうか（trueなら編集可能）</td>
</tr>
<tr>
  <td>printerResolution</td>
  <td>印刷解像度</td>
</tr>
<tr>
  <td>registrationMarks</td>
  <td>レジストレーションマーク（trueなら描画）</td>
</tr>
<tr>
  <td>requireDocumentPassword</td>
  <td>ドキュメントパスワードを要求するかどうか（trueなら要求する）</td>
</tr>
<tr>
  <td>requirePermissionPassword</td>
  <td>パスワードを要求するかどうか（trueなら要求する）</td>
</tr>
<tr>
  <td>trimMarks</td>
  <td>トリムマーク（trueなら描画）</td>
</tr>
<tr>
  <td>viewAfterSaving</td>
  <td>保存した後にPDFとして再度表示するかどうか（trueなら表示する）</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】compatibilityで指定できる値</caption>
<tbody>
<tr>
  <td>
    <span>値</span>
  </td>
  <td>
    <span>設定</span>
  </td>
</tr>
<tr>
  <td>PDFCompatibility.ACROBAT4</td>
  <td>Acrobat 4互換</td>
</tr>
<tr>
  <td>PDFCompatibility.ACROBAT5</td>
  <td>Acrobat 5互換</td>
</tr>
<tr>
  <td>PDFCompatibility.ACROBAT6</td>
  <td>Acrobat 6互換</td>
</tr>
<tr>
  <td>PDFCompatibility.ACROBAT7</td>
  <td>Acrobat 7互換</td>
</tr>
<tr>
  <td>PDFCompatibility.ACROBAT8</td>
  <td>Acrobat 8互換</td>
</tr>
</tbody>
</table>
<p>
<br />
</p>
<p>
<br />
</p>
<p>PDF形式で保存するサンプル</p>
<pre><code>// PDFとして保存する
var saveObj = File.saveDialog ("保存PDFファイル名を入れてください");
if (saveObj != null){
    var opt = new PDFSaveOptions();
    opt.trimMarks = true;    // トリムマークあり
    opt.compatibility = PDFCompatibility.ACROBAT8;  // Acrobat8互換
    opt.generateThumbnails = true;  // サムネールあり
    activeDocument.saveAs(saveObj, opt);
}</code></pre>
<p>　スクリプトを実行するとファイル保存ダイアログが表示されます。</p>
<figure>
<figcaption>【図】ファイル保存ダイアログが表示される</figcaption>
<img src="images/00117.jpeg" />
</figure>
<p>　ファイルがPDF形式で保存されます。</p>
<figure>
<figcaption>【図】PDF形式で保存される</figcaption>
<img src="images/00245.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-49">
<section>
<h2 id="calibre_link-476"><b>27-9　SVG形式で保存する</b></h2>
<p>　SVG形式で保存するにはドキュメントオブジェクトのexportFile()メソッドを使います。exportFile()には3つのパラメーターを指定することができます。最初のパラメーターが保存先の情報を格納したファイルオブジェクトになります。2番目のパラメーターは保存形式を指定します。SVG形式で保存する場合はExportType.SVGを指定します。</p>
<p>　3番目のパラメーターはオプションです。オプションは省略できますが、期待する設定で画像を書き出すのであればオプションは指定する必要があります。</p>
<p>SVG形式で保存するサンプル</p>
<pre><code>// SVG 形式で保存する
var savefile = File.saveDialog("保存ファイル名をいれてください(拡張子は.svg)", "*");
if (savefile != null){
    var opt = new ExportOptionsSVG();
    opt.embedRasterImages = true;     // 画像を埋め込む時はtrue
    opt.embedAllFonts = true;   // フォントを埋め込まない時はfalse
    opt.documentEncoding = SVGDocumentEncoding.UTF8;  // 文字コードはUTF-8
    opt.fontType = SVGFontType.OUTLINEFONT;  // アウトラインにする
    opt.fontSubsetting = SVGFontSubsetting.GLYPHSUSED;
    opt.compressed = false;   // 圧縮する場合はtrue
    opt.saveMultipleArtboards = true;   // アートボード単位で書き出す
    opt.artboardRange = "2-3, 5";
    app.activeDocument.exportFile(savefile, ExportType.SVG, opt);
}</code></pre>
<p>　スクリプトを実行するとファイル保存ダイアログが表示されます。</p>
<figure>
<figcaption>【図】ファイル保存ダイアログが表示される</figcaption>
<img src="images/00018.jpeg" />
</figure>
<p>　ファイルがSVG形式で保存されます。</p>
<figure>
<figcaption>【図】SVG形式で保存される</figcaption>
<img src="images/00499.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-585">
<section>
<h2 id="calibre_link-477"><b>27-10　TIFF形式で保存する</b></h2>
<p>　TIFF形式で保存するにはドキュメントオブジェクトのexportFile()メソッドを使います。exportFile()には3つのパラメーターを指定することができます。最初のパラメーターが保存先の情報を格納したファイルオブジェクトになります。2番目のパラメーターは保存形式を指定します。TIFF形式で保存する場合はExportType.TIFFを指定します。</p>
<p>　3番目のパラメーターはオプションです。オプションは省略できますが、期待する設定で画像を書き出すのであればオプションは指定する必要があります。</p>
<p>　なお、TIFFF形式で書き出した後に、エラーを示すダイアログが表示されることがあります。</p>
<p>TIFF形式で保存するサンプル</p>
<pre><code>// TIFF形式で保存する
var savefile = File.saveDialog("保存ファイル名をいれてください", "*");
if (savefile != null){
    var opt = new ExportOptionsTIFF();
    opt.IZWCompression = true;  // LZW圧縮する
    opt.byteOrder = TIFFByteOrder.MACINTOSH;    // バイト並びの指定
    opt.imageColorSpace = ImageColorSpace.RGB;  // RGBカラー空間を指定
    opt.resolution = 300;   // 解像度を300にする
    app.activeDocument.exportFile(savefile, ExportType.TIFF, opt);
}</code></pre>
<p>　スクリプトを実行するとファイル保存ダイアログが表示されます。</p>
<figure>
<figcaption>【図】ファイル保存ダイアログが表示される</figcaption>
<img src="images/00026.jpeg" />
</figure>
<p>　ファイルがTIFF形式で保存されます。</p>
<figure>
<figcaption>【図】TIFF形式で保存される</figcaption>
<img src="images/00151.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-751">
<section>
<div>
<h1 id="calibre_link-478"><b>第28章　XML／データ処理</b></h1>
</div>
<p>　この章では、XMLデータ処理に関するサンプルを示し、解説します。汎用データフォーマットとして使われているXMLを利用することでデータベースなどと連携した処理も可能になります。</p>
</section>
</div>
<div id="calibre_link-124">
<section>
<h2 id="calibre_link-479"><b>28-1　XMLデータを作成する</b></h2>
<p>　XMLデータを作成するにはnew XML()としパラメータにはXML文字列を指定します。new XML()により指定されたXML文字列が解析され正しいXMLの文法に従っている場合、XMLオブジェクトが作成されます。ここで作成されるのはXMLオブジェクトですが、IllustratorではWebブラウザで使用されているgetElementByTagNames()などの要素やノード処理を行うメソッドはサポートされていません。IllustratorでのXMLオブジェクトのアクセスはXMLタグ名をそのまま記述するか、XMLタグ名と配列を組み合わせたものになります。また、XMLタグの属性は@マークを属性名の先頭に付けてアクセスします。</p>
<p>　なお、BridgeにはXMLデータを解析するためのメソッドが用意されています。</p>
<p>XMLデータを作成するサンプル</p>
<pre><code>// XMLデータを作成する
try {
    var xml = new XML("
&lt;root&gt;&lt;data&gt;&lt;name&gt;KF&lt;/name&gt;&lt;num&gt;2&lt;/num&gt;&lt;/data&gt;&lt;/root&gt;");
}catch(e){
    xml = "解析できませんでした。エラー："+e;
}
alert(xml);</code></pre>
<p>　XMLオブジェクトの内容がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】XMLオブジェクトの内容が表示される</figcaption>
<img src="images/00351.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-691">
<section>
<h2 id="calibre_link-480"><b>28-2　配列の参照番号を使って特定のXMLタグにアクセスする</b></h2>
<p>　配列の参照番号を使って特定のXMLタグにアクセスするには「XMLオブジェクト.タグ名[番号]」の形式で指定します。サンプルではappという名前のタグ名になっているのでxml.app[2]のようにしてタグにアクセスすることができます。入れ子になっている場合はxml.app[2].data[2].note[0]のように列記することでアクセスすることができます。</p>
<p>配列の参照番号を使って特定のXMLタグにアクセスするサンプル</p>
<pre><code>// 配列の参照番号を使ってXMLタグにアクセスする
var xmlText = '&lt;?xml version="1.0" encoding="UTF-8" ?&gt;\
&lt;list&gt;\
      &lt;app&gt;\
            &lt;name&gt;Illustrator&lt;/name&gt;\
            &lt;ver&gt;CC&lt;/ver&gt;\
      &lt;/app&gt;\
      &lt;app&gt;\
            &lt;name&gt;Photoshop&lt;/name&gt;\
            &lt;ver&gt;CC 2014&lt;/ver&gt;\
      &lt;/app&gt;\
      &lt;app&gt;\
            &lt;name&gt;InDesign&lt;/name&gt;\
            &lt;ver&gt;CS6&lt;/ver&gt;\
      &lt;/app&gt;\
      &lt;app&gt;\
            &lt;name&gt;Bridge&lt;/name&gt;\
            &lt;ver&gt;CC&lt;/ver&gt;\
      &lt;/app&gt;\
      &lt;app&gt;\
            &lt;name&gt;AfterEffects&lt;/name&gt;\
            &lt;ver&gt;CC 2014&lt;/ver&gt;\
      &lt;/app&gt;\
&lt;/list&gt;';
try {
      var xml = new XML(xmlText);
}catch(e){ xml = e; }
var nameTag = xml.app[0].name;      // Illustratorが読み出される
var verTag = xml.app[1].ver;      // CC 2014が読み出される
alert("最初のnameタグの内容："+nameTag + "\r" +
       "2番目のverタグの内容："+verTag);</code></pre>
<p>　XMLオブジェクトから読み出した内容がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】XMLオブジェクトから読み出した内容が表示される</figcaption>
<img src="images/00144.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-717">
<section>
<h2 id="calibre_link-481"><b>28-3　child()を使って特定のXMLタグにアクセスする</b></h2>
<p>　childを使って特定のXMLタグにアクセスするには「XMLオブジェクト.child("タグ名")[番号]」の形式で指定します。サンプルではappという名前のタグ名になっているのでxml.child("app")のようにしてタグにアクセスすることができます。最初のタグの場合はxml.child("app")[0]のように配列を使ってアクセスします。入れ子になっている場合はxml.child("app")[0].child("name")のように列記することでXMLタグや内容にアクセスすることができます。　また、タグ名が不明な場合はxml.child(0)のように直接番号を使って指定しアクセスすることもできます。</p>
<p>child()を使って特定のXMLタグにアクセスするサンプル</p>
<pre><code>// child()を使ってXMLタグにアクセスする
var xmlText = '&lt;?xml version="1.0" encoding="UTF-8" ?&gt;\
&lt;list&gt;\
      &lt;app&gt;\
            &lt;name&gt;Illustrator&lt;/name&gt;\
            &lt;ver&gt;CC&lt;/ver&gt;\
      &lt;/app&gt;\
      &lt;app&gt;\
            &lt;name&gt;Photoshop&lt;/name&gt;\
            &lt;ver&gt;CC 2014&lt;/ver&gt;\
      &lt;/app&gt;\
      &lt;app&gt;\
            &lt;name&gt;InDesign&lt;/name&gt;\
            &lt;ver&gt;CS6&lt;/ver&gt;\
      &lt;/app&gt;\
      &lt;app&gt;\
            &lt;name&gt;Bridge&lt;/name&gt;\
            &lt;ver&gt;CC&lt;/ver&gt;\
      &lt;/app&gt;\
      &lt;app&gt;\
            &lt;name&gt;AfterEffects&lt;/name&gt;\
            &lt;ver&gt;CC 2014&lt;/ver&gt;\
      &lt;/app&gt;\
&lt;/list&gt;';
try {
      var xml = new XML(xmlText);
}catch(e){ xml = e; }
var nameTag = xml.child("app")[0].child("name");      // Illustratorが読み出される
var priceTag = xml.child("app")[2].child("ver");      // CS6が読み出される
alert("最初のnameタグの内容："+nameTag + "\r" +
       "3番目のverタグの内容："+verTag);</code></pre>
<p>　XMLオブジェクトから読み出した内容がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】XMLオブジェクトから読み出した内容が表示される</figcaption>
<img src="images/00532.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-662">
<section>
<h2 id="calibre_link-482"><b>28-4　指定したXMLタグの数を求める</b></h2>
<p>　指定したXMLタグの数を求めるにはlength()メソッドを使います。総数を取得したいタグに対してlength()メソッドを実行します。一般的にJavaScriptでは配列やノードなどに関してはlengthプロパティで総数を取得することができますが、XMLタグの場合はlength()メソッドを使います。</p>
<p>指定したXMLタグの数を求めるサンプル</p>
<pre><code>// 指定したXMLタグの数を求める
var xmlText = '&lt;?xml version="1.0" encoding="UTF-8" ?&gt;\
&lt;list&gt;\
      &lt;app&gt;\
            &lt;name&gt;Illustrator&lt;/name&gt;\
            &lt;ver&gt;CC&lt;/ver&gt;\
      &lt;/app&gt;\
      &lt;app&gt;\
            &lt;name&gt;Photoshop&lt;/name&gt;\
            &lt;ver&gt;CC 2014&lt;/ver&gt;\
      &lt;/app&gt;\
      &lt;app&gt;\
            &lt;name&gt;InDesign&lt;/name&gt;\
            &lt;ver&gt;CS6&lt;/ver&gt;\
      &lt;/app&gt;\
      &lt;app&gt;\
            &lt;name&gt;Bridge&lt;/name&gt;\
            &lt;ver&gt;CC&lt;/ver&gt;\
      &lt;/app&gt;\
      &lt;app&gt;\
            &lt;name&gt;AfterEffects&lt;/name&gt;\
      &lt;ver&gt;CC 2014&lt;/ver&gt;\
      &lt;/app&gt;\
&lt;/list&gt;';
try {
      var xml = new XML(xmlText);
}catch(e){ xml = e; }
var appTag = xml.child("app").length();      // 総数を取得
alert("appタグの総数："+appTag);</code></pre>
<p>　指定したタグの総数がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】指定したタグの総数が表示される</figcaption>
<img src="images/00507.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-709">
<section>
<h2 id="calibre_link-483"><b>28-5　XMLタグの属性にアクセスする</b></h2>
<p>　XMLタグの属性にアクセスするには「XMLオブジェクト.タグ名.@属性名」の形式で指定するか「XMLオブジェクトタグ名.attributes("属性名")」のようにあらかじめ用意されたメソッドを使います。XMLデータでアクセスすべき属性名が分かっている場合は@を使って「XMLオブジェクトタグ名.@属性名」のように指定することもできます。なお、attributes()で指定できるパラメーターは文字列だけでなく参照番号を使うこともできます。attributes(0)とすると指定したタグの最初の属性値にアクセスすることができます。</p>
<p>XMLタグの属性にアクセスするサンプル</p>
<pre><code>// XMLタグの属性にアクセスする
var xmlText = '&lt;?xml version="1.0" encoding="UTF-8" ?&gt;\
&lt;list&gt;\
      &lt;app&gt;\
            &lt;name jpname="イラストレータ"&gt;Illustrator&lt;/name&gt;\
            &lt;ver&gt;CC&lt;/ver&gt;\
      &lt;/app&gt;\
      &lt;app&gt;\
            &lt;name jpname="フォトショップ"&gt;Photoshop&lt;/name&gt;\
            &lt;ver&gt;CC 2014&lt;/ver&gt;\
      &lt;/app&gt;\
      &lt;app&gt;\
            &lt;name jpname="インデザイン"&gt;InDesign&lt;/name&gt;\
            &lt;ver&gt;CS6&lt;/ver&gt;\
      &lt;/app&gt;\
      &lt;app&gt;\
            &lt;name jpname="ブリッジ"&gt;Bridge&lt;/name&gt;\
            &lt;ver&gt;CC&lt;/ver&gt;\
      &lt;/app&gt;\
      &lt;app&gt;\
            &lt;name jpname="アフターエフェクツ"&gt;AfterEffects&lt;/name&gt;\
            &lt;ver&gt;CC 2014&lt;/ver&gt;\
      &lt;/app&gt;\
&lt;/list&gt;';
try {
      var xml = new XML(xmlText);
}catch(e){ xml = e; }
var txt1 = xml.app[0].name.@jpname;   // 「jpname」の属性が読み出される
var txt2 = xml.app[3].name.attributes("jpname");   // 「jpname」の属性が読み出される
alert("最初のjpnameタグの属性の内容：" + txt1 + "\r" +
    "3番目のjpnameタグの属性の内容："+txt2);</code></pre>
<p>　指定したタグの属性の内容がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】指定したタグの属性の内容が表示される</figcaption>
<img src="images/00098.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-569">
<section>
<h2 id="calibre_link-484"><b>28-6　XMLデータをファイルから読み込む</b></h2>
<p>　XMLデータをファイルから読み込むにはFile.openDialog()やnew File()を使ってファイル内容を読み込み、読み込まれたテキストをnew XML()のパラメーターとして指定します。読み込まれたファイルが正しいXMLとは限らないのでtry...catchによりエラー処理を追加しておく必要があります。</p>
<p>XMLデータをファイルから読み込むサンプル</p>
<pre><code>// XMLデータをファイルから読み込む
var fileObj = File.openDialog("XMLファイルを指定してください", "*.xml", false);
if (fileObj != null) {   // ファイルが選択された場合のみ処理する
    var flag = fileObj.open("r");
    if (flag == true) { // ファイルが開くことができた場合のみ処理する
        var xmlText = fileObj.read();   // XMLファイル内容を全て読み込む
        try{    // 読み込み後の解析時のエラーを回避
            var xml = new XML(xmlText);
        }catch(e){
            var xml = "エラーで読み込めません\r"+e;
        }
        alert(xml);
    }
}</code></pre>
<p>　ファイル選択ダイアログが表示されるのでXMLファイルを選択します。</p>
<figure>
<figcaption>【図】XMLファイルを選択する</figcaption>
<img src="images/00312.jpeg" />
</figure>
<p>　読み込まれたXMLファイルの内容がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】読み込まれたXMLファイルの内容が表示される</figcaption>
<img src="images/00441.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-10">
<section>
<div>
<h1 id="calibre_link-485"><b>第29章　PDF</b></h1>
</div>
<p>　この章では、に関するサンプルを示し、解説します。PDFのページを指定して開いたり、基本的な処理などを行うことができます。</p>
</section>
</div>
<div id="calibre_link-134">
<section>
<h2 id="calibre_link-486"><b>29-1　ページを指定してPDFを開く</b></h2>
<p>　ページを指定してPDFを開くには、いくつかの手順が必要になります。まず、app.preferences.PDFFileOptionsオブジェクトのpageToOpenプロパティに開きたいPDFのページ数を指定します。1を指定すると1ページ、50を指定すると50ページが開かれます。なお、PDFのページ数より大きい値を指定した場合はエラーにならず、1ページ目が開かれます。</p>
<p>　次に複数ページを開く場合、どのようなボックスタイプで描画するかをpDFCropToBoxプロパティに指定します。指定できる値は表のようになります。</p>
<p>　PDF でページ番号を指定して開く場合はapp.userInteractionLevelにUserInteractionLevel.DONTDISPLAYALERTSを設定しておく必要があります。この設定が行われていない場合は、ダイアログが表示されてしまいます。</p>
<p>　設定ができたらapp.open()メソッドを使ってPDFのファイルオブジェクトを指定します。</p>
<table>
<caption>【表】pDFCropToBoxプロパティに指定できる値</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ</span>
  </td>
  <td>
    <span>ボックスの種類</span>
  </td>
</tr>
<tr>
  <td>PDFARTBOX</td>
  <td>アートボックス</td>
</tr>
<tr>
  <td>PDFBLEEDBOX</td>
  <td>ブリードボックス</td>
</tr>
<tr>
  <td>PDFBOUNDINGBOX</td>
  <td>バウンディングボックス</td>
</tr>
<tr>
  <td>PDFCROPBOX</td>
  <td>クロップボックス</td>
</tr>
<tr>
  <td>PDFMEDIABOX</td>
  <td>メディアボックス</td>
</tr>
<tr>
  <td>PDFTRIMBOX</td>
  <td>トリムボックス</td>
</tr>
</tbody>
</table>
<p>ページを指定してPDFを開くサンプル</p>
<pre><code>// ページを指定してPDFを開く
var opt = app.preferences.PDFFileOptions;
opt.pDFCropToBox = PDFBoxType.PDFBOUNDINGBOX;
opt.pageToOpen = 2;   // 2ページ目を開く
var fileObj = File.openDialog ("PDFを選択してください", "*.pdf", false);
if (fileObj){
    // UIのアラートダイアログを表示しないようにする
    app.userInteractionLevel = UserInteractionLevel.DONTDISPLAYALERTS;
    app.open(fileObj, DocumentColorSpace.RGB);  // PDFを開く
}</code></pre>
<p>　PDFを選択します。</p>
<figure>
<figcaption>【図】PDFを選択する</figcaption>
<img src="images/00044.jpeg" />
</figure>
<p>　ページ数が多い場合はプログレスバーが表示されPDFが読み込まれます。</p>
<figure>
<figcaption>【図】ページ数が多い場合、プログレスバーが表示される</figcaption>
<img src="images/00442.jpeg" />
</figure>
<p>　指定したページが開かれます。</p>
<figure>
<figcaption>【図】指定したページが開かれる</figcaption>
<img src="images/00115.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-675">
<section>
<h2 id="calibre_link-487"><b>29-2　ドキュメントをPDFとして保存する</b></h2>
<p>　ドキュメントをPDFとして保存するにはdocumentオブジェクトのsaveAs()メソッドを使います。この時にファイルオブジェクトと同時に保存するオプションを指定します。このオプションでPDFで保存するための情報を指定します。PDFに関する情報を設定するにはPDFSaveOptions()を使います。</p>
<p>　new PDFSaveOptions()としてオブジェクトを生成し、そのオブジェクトの各プロパティに必要な情報を設定します。特に全ての情報を設定しなくてもPDFとして保存することができます。PDFのバージョンを指定して保存したい場合はcompatibilityプロパティに対応する設定値を指定します（下表）。また、ドキュメントに複数のアートボードが存在する場合、何も設定しない状態では複数ページのPDFとして保存されます。</p>
<table>
<caption>【表】compatibilityプロパティに指定できるPDFバージョン</caption>
<tbody>
<tr>
  <td>
    <span>バージョン</span>
  </td>
  <td>
    <span>対応する設定値</span>
  </td>
</tr>
<tr>
  <td>PDF1.3</td>
  <td>PDFCompatibility.ACROBAT4</td>
</tr>
<tr>
  <td>PDF1.4</td>
  <td>PDFCompatibility.ACROBAT5</td>
</tr>
<tr>
  <td>PDF1.5</td>
  <td>PDFCompatibility.ACROBAT6</td>
</tr>
<tr>
  <td>PDF1.6</td>
  <td>PDFCompatibility.ACROBAT7</td>
</tr>
<tr>
  <td>PDF1.7</td>
  <td>PDFCompatibility.ACROBAT8</td>
</tr>
</tbody>
</table>
<p>ドキュメントをPDFとして保存するサンプル</p>
<pre><code>// 現在開かれているドキュメントをPDFとして保存する
var fileObj = File.saveDialog("保存するPDFファイル名を入れてください");
var opt = new PDFSaveOptions();
opt.trimMarks = true;  // トリムマークあり
opt.compatibility = PDFCompatibility.ACROBAT8;  // Acrobat 8(PDF1.7)互換
opt.generateThumbnails = true;  // サムネールを作成する
opt.preserveEditability = true; // 編集可能なPDFとして保存する
activeDocument.saveAs(fileObj, opt);</code></pre>
<p>　保存ダイアログが表示されますのでファイル名を入力します。</p>
<figure>
<figcaption>【図】ファイル名を入力する</figcaption>
<img src="images/00342.jpeg" />
</figure>
<p>　PDFが保存されます。</p>
<figure>
<figcaption>【図】PDFが保存される</figcaption>
<img src="images/00181.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-714">
<section>
<h2 id="calibre_link-488"><b>29-3　ドキュメントをパスワード付きのPDFとして保存する</b></h2>
<p>　ドキュメントをパスワード付きのPDFとして保存するにはdocumentオブジェクトのsaveAs()メソッドを使い、ファイルオブジェクトと同時に保存するオプションを指定します。このオプションのrequireDocumentPasswordプロパティにtrueを設定します。trueを設定するとパスワード付きのPDFとして保存されます。</p>
<p>　パスワードそのものはdocumentPasswordプロパティに設定します。パスワードは文字列でも数値でも設定することができます。</p>
<p>ドキュメントをパスワード付きのPDFとして保存するサンプル</p>
<pre><code>// ドキュメントをパスワード付きのPDFとして保存する
var fileObj = File.saveDialog("保存するPDFのファイル名を入れてください");
var opt = new PDFSaveOptions();
opt.requireDocumentPassword = true;   // 開くときにパスワードが必要
opt.documentPassword = "AI";    // パスワードをAIに設定する
activeDocument.saveAs(fileObj, opt);</code></pre>
<p>　パスワード付きのPDFの保存先とファイル名を入力します。</p>
<figure>
<figcaption>【図】パスワード付きのPDFの保存先とファイル名を入力する</figcaption>
<img src="images/00008.jpeg" />
</figure>
<p>　パスワード付きのPDFとしてファイルが作成されます。</p>
<figure>
<figcaption>【図】パスワード付きのPDFとしてファイルが作成される</figcaption>
<img src="images/000258.gif" />
</figure>
<p>　AcrobatでPDFを読み込ませるとパスワードを要求されるので、設定したパスワードを入力します。</p>
<figure>
<figcaption>【図】設定したパスワードを入力する</figcaption>
<img src="images/00244.jpeg" />
</figure>
<p>　PDFが表示されます。</p>
<figure>
<figcaption>【図】PDFが表示される</figcaption>
<img src="images/00031.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-621">
<section>
<div>
<h1 id="calibre_link-489"><b>第30章　アートボード（CS4以降）</b></h1>
</div>
<p>　この章では、Illustrator CS4以降からサポートされたアートボードに関するサンプルを示し、解説します。アートボードに関するさまざまな処理を行うことができます。</p>
</section>
</div>
<div id="calibre_link-19">
<section>
<h2 id="calibre_link-490"><b>30-1　アートボードの数を求める</b></h2>
<p>　アートボードの情報はドキュメントオブジェクトのartboardsオブジェクトに入っています。アートボードの総数はartboardsオブジェクトのlengthプロパティを参照することで求めることができます。</p>
<p>アートボードの数を求めるサンプル</p>
<pre><code>// アートボードの数を求める
var docObj = app.activeDocument;
var n = docObj.artboards.length;
alert("アートボードの総数："+n);</code></pre>
<p>　アラートダイアログにドキュメントのアートボードの総数が表示されます。</p>
<figure>
<figcaption>【図】ドキュメントのアートボードの総数が表示される</figcaption>
<img src="images/00414.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-555">
<section>
<h2 id="calibre_link-491"><b>30-2　アートボードを追加する</b></h2>
<p>　アートボードを追加するにはartboardsオブジェクトのadd()メソッドを使います。add()メソッドには追加するアートボードの座標値を指定する必要があります。座標値は配列形式で[左座標, 上座標, 右座標, 下座標]の順番で座標値を指定します。この座標値は上側に行くに従って数値が増えます。つまり数学座標系と同じです。add()メソッドの座標値を指定しないとエラーになります。また、指定した座標値が「左座標 &lt;= 右座標」「上座標 &lt;= 下座標」になっていないと「an Illustrator error occurred: 1346458189 ('MRAP')」というエラーで停止してしまいます。</p>
<p>アートボードを追加するサンプル</p>
<pre><code>// アートボードを追加する
var docObj = app.activeDocument;
var top = 0;    // 上の座標値（単位はポイント）
var left = 10;  // 左の座標値（単位はポイント）
var bottom = -400;  // 下の座標値（単位はポイント）
var right = 800;    // 右の座標値（単位はポイント）
var ab = docObj.artboards.add([left, top, right, bottom]);</code></pre>
<p>　実行前のアートボードの状態です。</p>
<figure>
<figcaption>【図】実行前のアートボード</figcaption>
<img src="images/00198.jpeg" />
</figure>
<p>　スクリプトを実行すると指定した座標にアートボードが追加されます。</p>
<figure>
<figcaption>【図】指定した座標にアートボードが追加される</figcaption>
<img src="images/00584.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-5">
<section>
<h2 id="calibre_link-492"><b>30-3　アクティブになっているアートボードを求める</b></h2>
<p>　アクティブになっているアートボードを求めるにはartboardsオブジェクトのgetActiveArtboardIndex()メソッドを使います。getActiveArtboardIndex()はアクティブになっているアートボードの番号を返します。この番号はartboards[]配列で指定／参照する時に使用する数値になります。この番号は0から始まります。0がアートボードパネルで一番上にあるアートボードになります。</p>
<p>　複数のアートボードがアクティブになっている場合は、最初にアクティブにしたアートボードの番号を返します。複数選択されていても、最初にアクティブにされたアートボードの番号しか取得できないので注意してください。また、選択したアートボードの名前を求めるにはサンプルのようにartboads[番号].nameとします。</p>
<p>アクティブになっているアートボードを求めるサンプル</p>
<pre><code>// アクティブになっているアートボードの番号と名前を表示する
var docObj = app.activeDocument;
var idx = docObj.artboards.getActiveArtboardIndex();
var aName = docObj.artboards[idx].name;
alert(idx + "："+aName);</code></pre>
<p>　アラートダイアログにドキュメントのアートボードの総数が表示されます。</p>
<figure>
<figcaption>【図】ドキュメントのアートボードの総数が表示される</figcaption>
<img src="images/00364.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-531">
<section>
<h2 id="calibre_link-493"><b>30-4　指定したアートボードをアクティブにする</b></h2>
<p>　指定したアートボードをアクティブにするにはartboardsオブジェクトのsetActiveArtboardIndex()メソッドを使います。setActiveArtboardIndex()はアクティブにしたいアートボードの番号を指定します。この番号はartboards[]配列で指定／参照する時に使用する数値になります。この番号は0から始まります。0がアートボードパネルで一番上にあるアートボードになります。</p>
<p>　なお、複数のアートボードがアクティブになっている場合、setActiveArtboardIndex()は期待する動作をしません。複数のアートボードがアクティブになっており、setActiveArtboardIndex()で指定したアートボードがアクティブになっていない場合、そのアートボードをアクティブにすることができません。また、アクティブを解除する手段がないため、setActiveArtboardIndex()はアクティブになっているアートボードが1つだけの場合のみ動作することになります。</p>
<p>指定したアートボードをアクティブにするサンプル</p>
<pre><code>// 3番目のアートボードをアクティブにする
var docObj = app.activeDocument;
docObj.artboards.setActiveArtboardIndex(2);</code></pre>
<p>　実行前はアートボード1がアクティブになっています。</p>
<figure>
<figcaption>【図】アートボード1がアクティブになっている</figcaption>
<img src="images/00155.jpeg" />
</figure>
<p>　3番目のアートボードがアクティブになります。</p>
<figure>
<figcaption>【図】3番目のアートボードがアクティブになる</figcaption>
<img src="images/00544.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-623">
<section>
<h2 id="calibre_link-494"><b>30-5　アートボードのサイズを取得する</b></h2>
<p>　アートボードのサイズを取得するにはartboards[]配列に格納されているアートボードオブジェクトのartboardRectを参照します。artboardRectは配列になっており、以下の順番で座標値が格納されています。いずれも単位はポイントになります。</p>
<p>　サンプルでは最初のアートボードの座標を取得していますが、アクティブになっているアートボードの座標を取得する場合はdocObj.artboards.getActiveArtboardIndex()でアクティブになっているアートボードの番号を求めます。求めた番号をdocObj.artboards[番号]のように配列の添え字として指定します。</p>
<table>
<caption>【表】座標と格納順序の対応</caption>
<tbody>
<tr>
  <td>
    <span>値</span>
  </td>
  <td>
    <span>座標</span>
  </td>
</tr>
<tr>
  <td>0</td>
  <td>左座標</td>
</tr>
<tr>
  <td>1</td>
  <td>上座標</td>
</tr>
<tr>
  <td>2</td>
  <td>右座標</td>
</tr>
<tr>
  <td>3</td>
  <td>下座標</td>
</tr>
</tbody>
</table>
<p>アートボードのサイズを取得するサンプル</p>
<pre><code>// 最初のアートボードのサイズを表示する
var docObj = app.activeDocument;
var rect = docObj.artboards[0].artboardRect;
var left = rect[0]; // 左座標
var top = rect[1];  // 上座標
var right = rect[2];    // 右座標
var bottom = rect[3];   // 下座標
alert(left+", "+top+", "+right+", "+bottom);</code></pre>
<p>　最初のアートボードのサイズがアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】最初のアートボードのサイズが表示される</figcaption>
<img src="images/00321.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-660">
<section>
<h2 id="calibre_link-495"><b>30-6　アートボードを削除する</b></h2>
<p>　アートボードを削除するにはartboardsオブジェクトのremove()メソッドを使います。削除したいアートボードをartboard[番号]と指定しremove()メソッドを実行します。複数のアートボードを削除する場合はサンプルのように末尾から削除する必要があります。これはアートボードを削除するたびに、アートボードの情報が更新されるためです。このため、アートボードの最初から処理するとアートボードが削除されないことがあります。</p>
<p>アートボードを削除するサンプル</p>
<pre><code>// 最初のアートボード以外全て削除する
var docObj = app.activeDocument;
for(var i=docObj.artboards.length-1; i&gt;0; i--){
    docObj.artboards[i].remove();   // 指定した番号のアートボードを削除
}</code></pre>
<p>　スクリプト実行前には複数のアートボードがあります。</p>
<figure>
<figcaption>【図】複数のアートボードがある</figcaption>
<img src="images/00112.jpeg" />
</figure>
<p>　スクリプトを実行すると最初のアートボード以外、全てのアートボードが削除されます。</p>
<figure>
<figcaption>【図】最初のアートボード以外、全てのアートボードが削除される</figcaption>
<img src="images/00498.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-559">
<section>
<h2 id="calibre_link-496"><b>30-7　全てのアートボードにセンターマークやセーフゾーンを表示する</b></h2>
<p>　全てのアートボードにセンターマークやセーフゾーンを表示するにはartboardsオブジェクトのshowCenterプロパティなどにtrueを設定します。falseを設定すると非表示になります。設定できるプロパティを下表に示します。</p>
<table>
<caption>【表】アートボードで設定できるプロパティ</caption>
<tbody>
<tr>
  <td>
    <span>プロパティ</span>
  </td>
  <td>
    <span>表示する内容</span>
  </td>
</tr>
<tr>
  <td>showCenter</td>
  <td>センターマーク</td>
</tr>
<tr>
  <td>showCrossHairs</td>
  <td>上下左右の十字線</td>
</tr>
<tr>
  <td>showSafeAreas</td>
  <td>映像でのテロップ（字幕）が表示可能な安全エリア（セーフゾーン）</td>
</tr>
</tbody>
</table>
<p>全てのアートボードにセンターマークやセーフゾーンを表示するサンプル</p>
<pre><code>// 全てのアートボードにセンターマークやセーフゾーンを表示する
var docObj = app.activeDocument;
for(var i=0; i&lt;docObj.artboards.length; i++){
    docObj.artboards[i].showCenter = true;  // センターマーク
    docObj.artboards[i].showCrossHairs = true;  // 十字線
    docObj.artboards[i].showSafeAreas = true;   // セーフゾーン
}</code></pre>
<p>　全てのアートボードにセンターマーク、十字線、セーフゾーンが表示されます。</p>
<figure>
<figcaption>【図】全てのアートボードにセンターマーク、十字線、セーフゾーンが表示される</figcaption>
<img src="images/00287.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-756">
<section>
<h2 id="calibre_link-497"><b>30-8　アクティブになっているアートボード内にあるパスだけ残す</b></h2>
<p>　アクティブになっているアートボード内にあるパスだけ残すにはartboardsオブジェクトからアートボードのサイズを読み出します。読み出したアートボードの座標からパスが完全にはみ出しているかどうか調べ、はみ出している場合はremove()メソッドを使い削除します。</p>
<p>アクティブになっているアートボード内にあるパスだけ残すサンプル</p>
<pre><code>// アクティブになっているアートボード内にあるパスだけ残す
removePath(activeDocument.pathItems);   // ドキュメント全体から該当パスを削除
removePath(activeDocument.textFrames);  // ドキュメント全体から該当テキストフレームを削除
// パスを削除する関数
function removePath(p){
    // アクティブにアートボードのインデックス番号を求める
    var abIndex = app.activeDocument.artboards.getActiveArtboardIndex();
    // アクティブなアートボードのサイズを求める
    var rect = app.activeDocument.artboards[abIndex].artboardRect;
    var ax1 = rect[0];
    var ay1 = -rect[1];
    var ax2 = rect[2];
    var ay2 = -rect[3];
    // パスを削除する
    for(var i=p.length-1; i&gt;=0; i--){
        var geo = p[i].geometricBounds;
        if (!geo){ continue; }  // geometricBoundsがない場合は処理しない
        var x1 = geo[0];
        var y1 = -geo[1];
        var x2 = geo[2];
        var y2 = -geo[3];
        // アートボード内に少しでも座標値が収まっていなければ削除する
        if (x2 &lt; ax1){ p[i].remove(); continue; }
        if (x1 &gt; ax2){ p[i].remove(); continue; }
        if (y2 &lt; ay1){ p[i].remove(); continue; }
        if (y1 &gt; ay2){ p[i].remove(); continue; }
    }
}</code></pre>
<p>　アートボードにパスやテキストがあります。</p>
<figure>
<figcaption>【図】アートボードにパスやテキストがある</figcaption>
<img src="images/00067.jpeg" />
</figure>
<p>　スクリプトを実行するとアクティブになっているアートボード以外のパスとテキストが削除されます。</p>
<figure>
<figcaption>【図】アクティブなアートボード以外のパスとテキストが削除される</figcaption>
<img src="images/00141.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-42">
<section>
<h2 id="calibre_link-498"><b>30-9　全てのアートボードの右下に文字を入れる</b></h2>
<p>　全てのアートボードの右下に文字を入れるにはartboardsオブジェクトのartboardRectプロパティから座標を読み出します。新しく生成したテキストフレームの座標値にアートボードの座標を設定します。これをアートボードの数だけ繰り返します。</p>
<p>全てのアートボードの右下に文字を入れるサンプル</p>
<pre><code>// 全てのアートボードの右下に文字を入れる
// アートボード座標を基準にするように設定
app.coordinateSystem = CoordinateSystem.ARTBOARDCOORDINATESYSTEM;
// アートボードの数だけ繰り返す
for(var i=0; i&lt;activeDocument.artboards.length; i++){
    var rect = activeDocument.artboards[i].artboardRect;    // アートボード座標
    var right = rect[2];    // 右側のアートボード座標
    var bottom = rect[3];   // 下側のアートボード座標
    var txtObj = activeDocument.textFrames.add();   // テキストフレームを生成
    txtObj.contents = "2014 K.FuRuhata";    // 表示する文字
    txtObj.paragraphs[0].justification = Justification.RIGHT;   // 右揃え
    txtObj.paragraphs[0].size = 36; // 文字サイズ
    txtObj.top = bottom + txtObj.height;    // Y座標を設定する
    txtObj.left = right - txtObj.width; // X座標を設定する
}</code></pre>
<p>　全てのアートボードの右下に文字が表示されます。</p>
<figure>
<figcaption>【図】全てのアートボードの右下に文字が表示される</figcaption>
<img src="images/00238.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-82">
<section>
<h2 id="calibre_link-499"><b>30-10　全てのアートボードにページ番号（ノンブル）を入れる</b></h2>
<p>　全てのアートボードにページ番号（ノンブル）を入れるにはアートボードの数だけ繰り返します。for命令で繰り返しに使う変数を利用しページ番号にします。ページ番号の表示は新しくテキストフレームを生成し、各アートボードの中央下に配置します。配置する際に必要なアートボード座標はartboardsオブジェクトのartboardRectプロパティから読み出します。</p>
<p>全てのアートボードにページ番号（ノンブル）を入れるサンプル</p>
<pre><code>// 全てのアートボードにページ番号を入れる
// アートボード座標を基準にするように設定
app.coordinateSystem = CoordinateSystem.ARTBOARDCOORDINATESYSTEM;
// アートボードの数だけ繰り返す
for(var i=0; i&lt;activeDocument.artboards.length; i++){
    var rect = activeDocument.artboards[i].artboardRect;    // アートボード座標
    var left = rect[0];    // 右側のアートボード座標
    var right = rect[2];    // 右側のアートボード座標
    var bottom = rect[3];   // 下側のアートボード座標
    var txtObj = activeDocument.textFrames.add();   // テキストフレームを生成
    txtObj.contents = (i+1)+"ページ";    // 表示するページ番号
    txtObj.paragraphs[0].justification = Justification.CENTER;   // センタリング
    txtObj.paragraphs[0].size = 48; // 文字サイズ
    txtObj.top = bottom + txtObj.height;    // Y座標を設定する
    txtObj.left = left + (right - left - txtObj.width)/2; // X座標を設定する
}</code></pre>
<p>　アートボードのサイズに調整したい図形などを選択します。</p>
<figure>
<figcaption>【図】全てのアートボードの下中央にページ番号が表示される</figcaption>
<img src="images/00025.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-550">
<section>
<h2 id="calibre_link-500"><b>30-11　指定したアートボードを選択した図形のサイズに合わせる</b></h2>
<p>　指定したアートボードを選択した図形のサイズに合わせるにはドキュメントオブジェクトのfitArtboardToSelectedArt()メソッドを使います。fitArtboardToSelectedArt()のパラメーターにはサイズを変更したいアートボードの番号を入れます。</p>
<p>指定したアートボードを選択した図形のサイズに合わせるサンプル</p>
<pre><code>// 指定したアートボードを選択した図形のサイズに合わせる
var flag = activeDocument.fitArtboardToSelectedArt(2);
if(flag == true){
    alert("アートボードを変更しました");
}else{
    alert("アートボードの変更に失敗しました");
}</code></pre>
<p>　アートボードのサイズに調整したい図形などを選択します。</p>
<figure>
<figcaption>【図】アートボードのサイズに調整したい図形などを選択する</figcaption>
<img src="images/00406.jpeg" />
</figure>
<p>　スクリプトを実行すると処理に成功したかどうかのアラートダイアログが表示されます。</p>
<figure>
<figcaption>【図】処理に成功したかどうかが表示される</figcaption>
<img src="images/00193.jpeg" />
</figure>
<p>　選択した図形サイズにアートボードが調整されます。</p>
<figure>
<figcaption>【図】選択した図形サイズにアートボードが調整される</figcaption>
<img src="images/00504.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-612">
<section>
<h2 id="calibre_link-501"><b>30-12　アートボードを再レイアウト（整理整頓）する</b></h2>
<p>　アートボードを再レイアウト（整理整頓）するにはドキュメントオブジェクトのrearrangeArtboards()メソッドを使います。rearrangeArtboards()メソッドはパラメーターを省略することができます。アートボードのレイアウト方法を変更したい場合はrearrangeArtboards()メソッドの最初のパラメーターを指定します。指定できるレイアウト方法を下表に示します。</p>
<p>　rearrangeArtboards()メソッドの2番目のパラメーターには縦か横に並べるアートボードの数を指定します。3番目のパラメーターにはアートボードとの間隔を指定します。4番目のパラメーターはアートボードに合わせて図形も移動させるかどうかのフラグです。trueならアートボードの移動に合わせて図形も移動します。falseを指定するとアートボードのみ移動し図形は移動しません。</p>
<p>　なお、アートボードを再レイアウトした場合、カンバスの境界からはみ出すような場合はエラーとなります。</p>
<table>
<caption>【表】レイアウト方法</caption>
<tbody>
<tr>
  <td>
    <span>パラメーター</span>
  </td>
  <td>
    <span>レイアウトの方法</span>
  </td>
</tr>
<tr>
  <td>DocumentArtboardLayout.GridByRow</td>
  <td>縦横に整列（横から縦）</td>
</tr>
<tr>
  <td>DocumentArtboardLayout.GridByCol</td>
  <td>縦横に整列（縦から横）</td>
</tr>
<tr>
  <td>DocumentArtboardLayout.Row</td>
  <td>横一列に整列</td>
</tr>
<tr>
  <td>DocumentArtboardLayout.Column</td>
  <td>縦一列に整列</td>
</tr>
<tr>
  <td>DocumentArtboardLayout.RLRow</td>
  <td>横一列に整列（右から左）</td>
</tr>
<tr>
  <td>DocumentArtboardLayout.RLGridByRow</td>
  <td>縦横に整列（右から左）</td>
</tr>
<tr>
  <td>DocumentArtboardLayout.RLGridByCol</td>
  <td>縦横に整列（右から左）</td>
</tr>
</tbody>
</table>
<p>アートボードを再レイアウト（整理整頓）するサンプル</p>
<pre><code>// アートボードを再レイアウトする
activeDocument.rearrangeArtboards(DocumentArtboardLayout.Row);</code></pre>
<p>　アートボードがランダムに並んでいる状態です。</p>
<figure>
<figcaption>【図】アートボードの状態</figcaption>
<img src="images/00358.jpeg" />
</figure>
<p>　スクリプトを実行するとアートボードが整理され再配置されます。</p>
<figure>
<figcaption>【図】アートボードが再配置される</figcaption>
<img src="images/00150.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-599">
<section>
<div>
<h1 id="calibre_link-502"><b>第31章　マトリクス</b></h1>
</div>
<p>　この章では、マトリクス（行列）に関するサンプルを示し、解説します。マトリクスの各種処理を行うことができます。</p>
</section>
</div>
<div id="calibre_link-644">
<section>
<h2 id="calibre_link-503"><b>31-1　マトリクスオブジェクトを作成する</b></h2>
<p>　イラストレーターではappオブジェクトにマトリクス（行列）を処理する機能が用意されています。マトリクスオブジェクトを作成するにはnew Matrix()とします。作成されたマトリクスオブジェクトの各プロパティ値は0が設定されます。マトリクスの値を後から設定することもできます。その場合、各プロパティに設定したい値を代入します。</p>
<p>マトリクスオブジェクトを作成するサンプル</p>
<pre><code>// マトリクスオブジェクトを作成する
var mtx = new Matrix();
var mA = mtx.mValueA;
var mB = mtx.mValueB;
var mC = mtx.mValueC;
var mD = mtx.mValueD;
var mTX = mtx.mValueTX;
var mTY = mtx.mValueTY;
alert("mA,B,C,D:"+mA+","+mB+","+mC+","+mD+"/TX,Y:"+mTX+","+mTY);
mtx.mValueTX = 100;
mTX = mtx.mValueTX;
alert("mA,B,C,D:"+mA+","+mB+","+mC+","+mD+"/TX,Y:"+mTX+","+mTY);</code></pre>
<p>　スクリプトを実行するとアラートダイアログにマトリクスの初期値が表示されます。初期値はすべて0になっています。</p>
<figure>
<figcaption>【図】マトリクスの初期値が表示される</figcaption>
<img src="images/00538.jpeg" />
</figure>
<p>　mValueTX（横方向の移動量）に100を設定した後のマトリクスの値がアラートダイアログに表示されます。</p>
<figure>
<figcaption>【図】横方向の移動量に100を設定した後のマトリクスの値が表示される</figcaption>
<img src="images/00009.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-683">
<section>
<h2 id="calibre_link-504"><b>31-2　選択した図形のマトリクス値を表示する</b></h2>
<p>　Illustratorで扱える画像やパスは変形に関するmatrixオブジェクトを持っています。matrixオブジェクトはmValueA、mValueB、mValueC、mValueD、mValueTX、mValueTYのプロパティを持っており、変形に関する値を読み出すことができます。</p>
<p>　また、matirixオブジェクトの各プロパティに値を代入することでテキストフレームや画像オブジェクトを変形させたり移動させることができます。なお、イラストレーターにはマトリクスを使わなくても図形を移動させたり変形させるための簡単なメソッドやプロパティが用意されています。</p>
<p>選択した図形のマトリクス値を表示するサンプル</p>
<pre><code>// 選択したオブジェクトのマトリクス値を表示する
var selObj = app.activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var mA = selObj[i].matrix.mValueA;
    var mB = selObj[i].matrix.mValueB;
    var mC = selObj[i].matrix.mValueC;
    var mD = selObj[i].matrix.mValueD;
    var mTX = selObj[i].matrix.mValueTX;
    var mTY = selObj[i].matrix.mValueTY;
    alert("mA,B,C,D:"+mA+","+mB+","+mC+","+mD+"/TX,Y:"+mTX+","+mTY);
}</code></pre>
<p>　スクリプトを実行するとアラートダイアログに選択した図形のマトリクスの値が表示されます。</p>
<figure>
<figcaption>【図】選択した図形のマトリクスの値が表示される</figcaption>
<img src="images/00107.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-540">
<section>
<h2 id="calibre_link-505"><b>31-3　マトリクスオブジェクトを連結する</b></h2>
<p>　matrixオブジェクトを連結するにはconcatenateMatrix()を使います。パラメーターは2つで、どちらもmatrixオブジェクトを指定します。2つのマトリクスを連結した結果をconcatenateMatrix()は返します。</p>
<p>　連結されたmatrixオブジェクトを図形に反映させるにはtransform()メソッドのパラメーターとして指定します。</p>
<p>マトリクスオブジェクトを連結するサンプル</p>
<pre><code>// マトリクスオブジェクトを連結する
var selObj = app.activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var mtx1 = app.getRotationMatrix(45);
    var mtx2 = app.getScaleMatrix(50, 50);
    var mtx = concatenateMatrix(mtx1, mtx2);
    selObj[i].transform(mtx);
}</code></pre>
<p>　文字や図形を選択します。</p>
<figure>
<figcaption>【図】文字や図形を選択する</figcaption>
<img src="images/00491.jpeg" />
</figure>
<p>　スクリプトを実行すると選択した文字や図形が、設定したマトリクスの値に応じて変形します。この場合、50%サイズに縮小され反時計回りに45度回転します。</p>
<figure>
<figcaption>【図】文字や図形が、設定したマトリクスの値に応じて変形する</figcaption>
<img src="images/00282.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-652">
<section>
<h2 id="calibre_link-506"><b>31-4　選択された図形を、マトリクスを使って回転させる</b></h2>
<p>　選択された図形をマトリクスを使って回転させるにはconcatenateRotationMatrix()メソッドを使います。パラメーターは2つで、最初のパラメーターに基本となるマトリクスを、2番目のパラメーターには回転角度を指定します。正数の場合は反時計回り、負数の場合は時計回りに回転します。concatenateRotationMatrix()メソッドの最初のパラメーターで指定するマトリクスはapp.getTranslationMatrix(0, 0)のようにして用意することができます。また、既存の図形のマトリクスを指定することもできます。</p>
<p>選択された図形を、マトリクスを使って回転させるサンプル</p>
<pre><code>// 選択された図形をマトリクスを使って回転させる
var tMatrix = app.getTranslationMatrix(0, 0);
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var mtx = concatenateRotationMatrix(tMatrix, 30);   // 30度回転
    selObj[i].transform(mtx);
}</code></pre>
<p>　文字や図形を選択します。</p>
<figure>
<figcaption>【図】文字や図形を選択する</figcaption>
<img src="images/00062.jpeg" />
</figure>
<p>　スクリプトを実行すると選択した文字や図形が、設定したマトリクスに応じて回転します。</p>
<figure>
<figcaption>【図】文字や図形が、設定したマトリクスの値に応じて回転する</figcaption>
<img src="images/00449.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-57">
<section>
<h2 id="calibre_link-507"><b>31-5　選択された図形を、マトリクスを使って拡大縮小させる</b></h2>
<p>　選択された図形をマトリクスを使って拡大縮小させるにはconcatenateScaleMatrix()メソッドを使います。パラメーターは3つで、最初のパラメーターに基本となるマトリクスを、2番目のパラメーターには横のスケール（拡大縮小率）、3番目のパラメーターには縦のスケールを指定します。100を指定すると100%、つまり等倍になります。50を指定すると50%のサイズに、200を指定すると200%のサイズになります。concatenateScaleMatrix()メソッドの最初のパラメーターで指定するマトリクスはapp.getTranslationMatrix(0, 0)のようにして用意することができます。また、既存の図形のマトリクスを指定することもできます。</p>
<p>選択された図形を、マトリクスを使って拡大縮小させるサンプル</p>
<pre><code>// 選択された図形をマトリクスを使って拡大縮小させる
var tMatrix = app.getTranslationMatrix(0, 0);
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var mtx = concatenateScaleMatrix(tMatrix, 50, 150);   // 横50%,縦150%
    selObj[i].transform(mtx);
}</code></pre>
<p>　文字や図形を選択します。</p>
<figure>
<figcaption>【図】文字や図形を選択する</figcaption>
<img src="images/00233.jpeg" />
</figure>
<p>　スクリプトを実行すると選択した文字や図形のスケールが、設定したマトリクスに応じて変化します。</p>
<figure>
<figcaption>【図】文字や図形のスケールが、設定したマトリクスの値に応じて変化する</figcaption>
<img src="images/00019.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-597">
<section>
<h2 id="calibre_link-508"><b>31-6　選択された図形を、マトリクスを使って移動させる</b></h2>
<p>　選択された図形をマトリクスを使って移動させるにはconcatenateTranslationMatrix()メソッドを使います。パラメーターは3つで、最初のパラメーターに基本となるマトリクスを、2番目のパラメーターには横の移動量、3番目のパラメーターには縦の移動量を指定します。横の移動量は正数を指定すると右方向に、負数を指定すると左方向に移動します。縦の移動量は正数を指定すると上方向に移動し、負数を指定すると下方向に移動します。concatenateTranslationMatrix()メソッドの最初のパラメーターで指定するマトリクスはapp.getTranslationMatrix(0, 0)のようにして用意することができます。また、既存の図形のマトリクスを指定することもできます。</p>
<p>選択された図形を、マトリクスを使って移動させるサンプル</p>
<pre><code>// 選択された図形をマトリクスを使って移動させる
var tMatrix = app.getTranslationMatrix(0, 0);
var selObj = activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var mtx = concatenateTranslationMatrix(tMatrix, -50, 20);   // 横に-50pt, 縦に20pt移動
    selObj[i].transform(mtx);
}</code></pre>
<p>　文字や図形を選択します。</p>
<figure>
<figcaption>【図】文字や図形を選択する</figcaption>
<img src="images/00401.jpeg" />
</figure>
<p>　スクリプトを実行すると選択した文字や図形の位置が、設定したマトリクスに応じて変化します。</p>
<figure>
<figcaption>【図】選択した文字や図形の位置が、設定したマトリクスの値に応じて変化する</figcaption>
<img src="images/00187.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-65">
<section>
<h2 id="calibre_link-509"><b>31-7　選択した図形を傾斜させる</b></h2>
<p>　選択した図形を傾斜させるには新規にマトリクスオブジェクトを作成し傾斜させるための値を設定します。作成したマトリクスオブジェクトのmValueBに値を設定すると縦方向の傾斜、mValueCに値を設定すると横方向の傾斜になります。なお、マトリクスを利用して変形させる場合は傾斜のみの変形だけでなく同時に回転や拡大縮小、移動も行うことができます（「31-4」〜「31-6」を参照してください）。</p>
<p>　マトリクス値を設定したら図形などのオブジェクトに用意されているtransform()メソッドを使って反映させます。この時、パラメーターを正しく指定しないと線が太くなってしまったりパターンが正しく処理されないことがあります。指定できるパラメーターの順番と意味を表「transform()メソッドのパラメーター」に示します。</p>
<table>
<caption>【表】transform()メソッドのパラメーター</caption>
<tbody>
<tr>
  <td>
    <span>値</span>
  </td>
  <td>
    <span>内容</span>
  </td>
</tr>
<tr>
  <td>1</td>
  <td>設定するマトリクスオブジェクト</td>
</tr>
<tr>
  <td>2</td>
  <td>位置を変更するかどうかをtrue、falseで指定する。マトリクス値を反映させる場合はtrueを設定する</td>
</tr>
<tr>
  <td>3</td>
  <td>パターンを変形させるかどうかをtrue、falseで指定する</td>
</tr>
<tr>
  <td>4</td>
  <td>グラデーションを変形させるかどうかをtrue、falseで指定する</td>
</tr>
<tr>
  <td>5</td>
  <td>線のパターンを変形させるかどうかをtrue、falseで指定する</td>
</tr>
<tr>
  <td>6</td>
  <td>線幅を変更するかどうかをtrue、falseで指定する</td>
</tr>
<tr>
  <td>7</td>
  <td>変形基準位置を指定する。表「基準位置」を参照</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】基準位置</caption>
<tbody>
<tr>
  <td>
    <span>値</span>
  </td>
  <td>
    <span>内容</span>
  </td>
</tr>
<tr>
  <td>Transformation.TOP</td>
  <td>上側</td>
</tr>
<tr>
  <td>Transformation.TOPLEFT</td>
  <td>左上</td>
</tr>
<tr>
  <td>Transformation.TOPRIGHT</td>
  <td>右上</td>
</tr>
<tr>
  <td>Transformation.BOTTOM</td>
  <td>下側</td>
</tr>
<tr>
  <td>Transformation.BOTTOMLEFT</td>
  <td>左下</td>
</tr>
<tr>
  <td>Transformation.BOTTOMRIGHT</td>
  <td>右下</td>
</tr>
<tr>
  <td>Transformation.CENTER</td>
  <td>中央</td>
</tr>
<tr>
  <td>Transformation.LEFT</td>
  <td>左側</td>
</tr>
<tr>
  <td>Transformation.RIGHT</td>
  <td>右側</td>
</tr>
<tr>
  <td>Transformation.DOCUMENTORIGIN</td>
  <td>ドキュメントの原点</td>
</tr>
</tbody>
</table>
<p>選択した図形を傾斜させるサンプル</p>
<pre><code>// 選択した図形を傾斜させる
var selObj = app.activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var mtx = new Matrix();    // 新しく設定するマトリクスを生成
    mtx.mValueA = 1;
    mtx.mValueB = 0;
    mtx.mValueC = 0.8; // 傾きを設定
    mtx.mValueD = 1;
    mtx.mValueTX = 0;  // 横の移動量
    mtx.mValueTY = 0;  // 縦の移動量
    selObj[i].transform(mtx, true, false, false, false, false);  // 選択した図形のマトリクスとして設定
}</code></pre>
<p>　文字や図形を選択します。</p>
<figure>
<figcaption>【図】文字や図形を選択する</figcaption>
<img src="images/00573.jpeg" />
</figure>
<p>　スクリプトを実行すると選択した文字や図形が、設定したマトリクスの値に応じて傾斜します。</p>
<figure>
<figcaption>【図】選択した文字や図形が、設定したマトリクスの値に応じて傾斜する。</figcaption>
<img src="images/00352.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-666">
<section>
<h2 id="calibre_link-510"><b>31-8　選択した図形を左右反転させる</b></h2>
<p>　選択した図形を左右反転させるには新規にマトリクスオブジェクトを作成しmValueAプロパティに-1の値を設定します。マトリクス値を設定したら図形などのオブジェクトに用意されているtransform()メソッドを使って反映させます。</p>
<p>　左右反転でなく上下反転させたい場合はマトリクスオブジェクトのmValueDプロパティに-1の値を設定します。</p>
<p>選択した図形を左右反転させるサンプル</p>
<pre><code>// 選択した図形を左右反転させる
var selObj = app.activeDocument.selection;
for(var i=0; i&lt;selObj.length; i++){
    var mtx = new Matrix();    // 新しく設定するマトリクスを生成
    mtx.mValueA = -1;   // 符号を反転
    mtx.mValueB = 0;
    mtx.mValueC = 0;
    mtx.mValueD = 1;    // ここの符号を反転させると上下反転になる
    mtx.mValueTX = 0;  // 横の移動量
    mtx.mValueTY = 0;  // 縦の移動量
    selObj[i].transform(mtx, true, false, false, false, false);  // 選択した図形のマトリクスとして設定
}</code></pre>
<p>　反転させたい図形や画像を選択します。</p>
<figure>
<figcaption>【図】反転させたい図形や画像を選択する</figcaption>
<img src="images/00145.jpeg" />
</figure>
<p>　スクリプトを実行すると選択した図形などが左右反転します。</p>
<figure>
<figcaption>【図】選択した図形などが左右反転する</figcaption>
<img src="images/00533.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-40">
<section>
<div>
<h1 id="calibre_link-511"><b>第32章　その他の自動処理</b></h1>
</div>
<p>　この章では、アクションやIllustratorのメニューを実行する方法やカレンダーの生成などさまざまな処理のサンプルと解説を行っています。</p>
</section>
</div>
<div id="calibre_link-79">
<section>
<h2 id="calibre_link-512"><b>32-1　スクリプトからアクションを実行する</b></h2>
<p>　スクリプトからアクションを実行するにはapp.doScript()を使います。パラメーターはアクション名とアクションが入っているセット名の2つを指定します。一致するアクションもしくはセット名がない場合はエラーではなく、アクションの停止ダイアログが表示されます。アクションが実行できるかどうかをtry...catchを使って調べることはできません。また、アクションが実行できないような状態になった場合は停止します。</p>
<p>スクリプトからアクションを実行するサンプル</p>
<pre><code>// スクリプトからアクションを実行する
app.doScript("不透明度40スクリーン(選択範囲)", "初期設定アクション");</code></pre>
<p>　アクションの対象になる図形を用意または選択しておきます。</p>
<figure>
<figcaption>【図】アクションの対象になる図形を用意する</figcaption>
<img src="images/00128.jpeg" />
</figure>
<p>　スクリプトを実行すると「初期設定アクション」フォルダ内にある「不透明度40スクリーン（選択範囲）」が実行されます。</p>
<figure>
<figcaption>【図】「不透明度40スクリーン（選択範囲）」が実行される</figcaption>
<img src="images/00518.jpeg" />
</figure>
<p>　アクションが実行されます。このアクションでは選択された文字の不透明度が変化します。</p>
<figure>
<figcaption>【図】選択された文字の不透明度が変化する</figcaption>
<img src="images/00304.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-126">
<section>
<h2 id="calibre_link-513"><b>32-2　アクションファイルを読み込む</b></h2>
<p>　アクションファイルを読み込むにはapp.loadAction()を使います。パラメーターは読み込むアクションファイルを示すファイルオブジェクトを指定します。なお、同じ名前のアクションフォルダがあってもエラーにはならず、重複して読み込まれます。</p>
<p>アクションファイルを読み込むサンプル</p>
<pre><code>// アクションファイルを読み込む
app.loadAction(new File("~/Desktop/rotateX.aia"));</code></pre>
<p>　あらかじめ読み込むアクションファイルを用意しておきます。</p>
<figure>
<figcaption>【図】読み込むアクションファイルを用意する</figcaption>
<img src="images/00084.jpeg" />
</figure>
<p>　実行前のアクションパネルの状態です。</p>
<figure>
<figcaption>【図】実行前のアクションパネルの状態</figcaption>
<img src="images/00469.jpeg" />
</figure>
<p>　スクリプトを実行するとアクションファイルが読み込まれ、アクションパネルに追加されます。</p>
<figure>
<figcaption>【図】とアクションファイルが読み込まれ、アクションパネルに追加される</figcaption>
<img src="images/00260.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-543">
<section>
<h2 id="calibre_link-514"><b>32-3　スクリプトからメニューを実行する</b></h2>
<p>　Illustrator CS6以降ではスクリプトを使ってメニュー項目を選択し実行したのと同じことができるようになりました。</p>
<p>　スクリプトからメニューを実行するにはapp.executeMenuCommand()を使います。パラメーターはメニュー項目に対応する文字列を指定します。主なメニュー項目と対応する文字列を下表に示します。下表以外の対応文字列については以下のページを参照してください。</p>
<p>
<a href="https://forums.adobe.com/thread/1405101">https://forums.adobe.com/thread/1405101</a>
</p>
<table>
<caption>【表】Illustrator/ヘルプメニューと文字列の対応</caption>
<tbody>
<tr>
  <td>
    <span>文字列</span>
  </td>
  <td>
    <span>対応する項目</span>
  </td>
</tr>
<tr>
  <td>about</td>
  <td>Illustrator＞Illustratorについて（Mac OS X/OS X版）、ヘルプ＞Illustratorについて（Windows版）</td>
</tr>
<tr>
  <td>quit</td>
  <td>Illustrator＞Illustratorを終了（Mac OS X/OS X版）、ファイル＞終了（Windows版）</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】ファイルメニューと文字列の対応</caption>
<tbody>
<tr>
  <td>
    <span>文字列</span>
  </td>
  <td>
    <span>対応する項目</span>
  </td>
</tr>
<tr>
  <td>new</td>
  <td>新規...</td>
</tr>
<tr>
  <td>newFromTemplate</td>
  <td>テンプレートから新規...</td>
</tr>
<tr>
  <td>open</td>
  <td>開く...</td>
</tr>
<tr>
  <td>Adobe Bridge Browse</td>
  <td>Bridgeで参照...</td>
</tr>
<tr>
  <td>close</td>
  <td>閉じる</td>
</tr>
<tr>
  <td>save</td>
  <td>保存</td>
</tr>
<tr>
  <td>saveas</td>
  <td>別名で保存...</td>
</tr>
<tr>
  <td>saveacopy</td>
  <td>複製を保存...</td>
</tr>
<tr>
  <td>saveastemplate</td>
  <td>テンプレートとして保存...</td>
</tr>
<tr>
  <td>Adobe AI Save For Web</td>
  <td>Web用に保存</td>
</tr>
<tr>
  <td>revert</td>
  <td>復帰</td>
</tr>
<tr>
  <td>AI Place</td>
  <td>配置...</td>
</tr>
<tr>
  <td>Save for Office</td>
  <td>Microsoft Office用に保存...</td>
</tr>
<tr>
  <td>ai_browse_for_script</td>
  <td>スクリプト＞その他のスクリプト...</td>
</tr>
<tr>
  <td>Print</td>
  <td>プリント...</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】編集メニューと文字列の対応</caption>
<tbody>
<tr>
  <td>
    <span>文字列</span>
  </td>
  <td>
    <span>対応する項目</span>
  </td>
</tr>
<tr>
  <td>undo</td>
  <td>●●●の取り消し</td>
</tr>
<tr>
  <td>cut</td>
  <td>カット</td>
</tr>
<tr>
  <td>copy</td>
  <td>コピー</td>
</tr>
<tr>
  <td>paste</td>
  <td>ペースト</td>
</tr>
<tr>
  <td>pasteFront</td>
  <td>前面へペースト</td>
</tr>
<tr>
  <td>pasteBack</td>
  <td>背面へペースト</td>
</tr>
<tr>
  <td>clear</td>
  <td>消去</td>
</tr>
<tr>
  <td>Find and Replace</td>
  <td>検索と置換...</td>
</tr>
<tr>
  <td>color</td>
  <td>カラー設定...</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】オブジェクトメニューと文字列の対応</caption>
<tbody>
<tr>
  <td>
    <span>文字列</span>
  </td>
  <td>
    <span>対応する項目</span>
  </td>
</tr>
<tr>
  <td>ungroup</td>
  <td>グループ解除</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】選択メニューと文字列の対応</caption>
<tbody>
<tr>
  <td>
    <span>文字列</span>
  </td>
  <td>
    <span>対応する項目</span>
  </td>
</tr>
<tr>
  <td>selectall</td>
  <td>すべてを選択</td>
</tr>
</tbody>
</table>
<table>
<caption>【表】表示メニューと文字列の対応</caption>
<tbody>
<tr>
  <td>
    <span>文字列</span>
  </td>
  <td>
    <span>対応する項目</span>
  </td>
</tr>
<tr>
  <td>actualsize</td>
  <td>100%表示</td>
</tr>
<tr>
  <td>rulerCoordinateSystem</td>
  <td>定規＞「ウィンドウ定規に変更」←→「アートボード定規に変更」</td>
</tr>
<tr>
  <td>ruler</td>
  <td>定規＞定規を表示</td>
</tr>
<tr>
  <td>zoomin</td>
  <td>ズームイン</td>
</tr>
<tr>
  <td>zoomout</td>
  <td>ズームアウト</td>
</tr>
<tr>
  <td>showguide</td>
  <td>ガイド＞「ガイドを隠す」←→「ガイドを表示」</td>
</tr>
<tr>
  <td>lockguide</td>
  <td>ガイド＞ガイドをロック</td>
</tr>
<tr>
  <td>releaseguide</td>
  <td>ガイド＞ガイドを解除</td>
</tr>
<tr>
  <td>clearguide</td>
  <td>ガイド＞ガイドを消去</td>
</tr>
</tbody>
</table>
<p>スクリプトからメニューを実行するサンプル</p>
<pre><code>// スクリプトからメニューを実行する
app.executeMenuCommand("new");</code></pre>
<p>　スクリプトを実行すると、ファイルメニューの新規...を選択した状態と同じ結果になります。</p>
<figure>
<figcaption>【図】ファイルメニューの新規...を選択した状態と同じ結果になる</figcaption>
<img src="images/00189.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-594">
<section>
<h2 id="calibre_link-515"><b>32-4　スクリプトからエフェクト効果のダイアログを表示する</b></h2>
<p>　スクリプトからエフェクト効果のダイアログを表示するにはapp.executeMenuCommand()を使います。パラメーターは効果メニュー項目に対応する文字列を指定します。指定可能な文字列については以下のページを参照してください。</p>
<p>
<a href="https://forums.adobe.com/thread/1405101">https://forums.adobe.com/thread/1405101</a>
</p>
<p>スクリプトからエフェクト効果のダイアログを表示するサンプル</p>
<pre><code>// スクリプトから3D&gt;押し出し...を実行する
app.executeMenuCommand("Live 3DExtrude");</code></pre>
<p>　押し出し効果を適用する文字を選択します。</p>
<figure>
<figcaption>【図】押し出し効果を適用する文字を選択する</figcaption>
<img src="images/00425.jpeg" />
</figure>
<p>　スクリプトを実行すると3D押し出し・ベベルオプションダイアログが表示されます。</p>
<figure>
<figcaption>【図】3D押し出し・ベベルオプションダイアログが表示される</figcaption>
<img src="images/00208.jpeg" />
</figure>
<p>　保存するファイル名を入力します。</p>
<figure>
<figcaption>【図】3D効果が適用される</figcaption>
<img src="images/00003.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-641">
<section>
<h2 id="calibre_link-516"><b>32-5　指定したサイズでウィンドウをキャプチャーし画像として保存する</b></h2>
<p>　指定したサイズでウィンドウをキャプチャーし画像として保存するにはドキュメントオブジェクトのwindowCapture()メソッドを使います。windowCapture()メソッドの最初のパラメーターには保存するファイルオブジェクトを指定します。2番目のパラメーターには配列形式でキャプチャーするウィンドウサイズを指定します。例えば横幅100ピクセル、縦幅200ピクセルでキャプチャーする場合は[100, 200]のように指定します。</p>
<p>　キャプチャーされる画像はウィンドウの外観も含まれます。保存される画像形式はTIFFになります。他の保存形式を指定することはできません。</p>
<p>指定したサイズでウィンドウをキャプチャーし画像として保存するサンプル</p>
<pre><code>// 指定したサイズでウィンドウをキャプチャーし画像として保存する
var fileObj = File.saveDialog("保存ファイル名を入れてください");
if (fileObj){
    activeDocument.windowCapture(fileObj, [200, 300] );
}</code></pre>
<p>　保存するファイル名を入力します。</p>
<figure>
<figcaption>【図】保存するファイル名を入力する</figcaption>
<img src="images/00376.jpeg" />
</figure>
<p>　アクティブになっているウィンドウがキャプチャーされ、TIFF形式で保存されます。</p>
<figure>
<figcaption>【図】アクティブなウィンドウがキャプチャーされ、TIFF形式で保存される</figcaption>
<img src="images/00164.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-679">
<section>
<h2 id="calibre_link-517"><b>32-6　1年分のカレンダーを生成する</b></h2>
<p>　1年分のカレンダーを生成するには、一ヶ月分のカレンダーを表示する関数を作成します。関数ではDateオブジェクトに表示する年月を設定します。設定した年が閏年の場合は2月の末日を29日に設定します。閏年は4で割り切れる年は閏年、ただし100で割り切れる年は閏年ではない、が400で割り切れる年は閏年であるというルールに基づいて計算します。あとは曜日に応じてカレンダーの枠と日にちを描画していきます。</p>
<p>1年分のカレンダーを生成するサンプル</p>
<pre><code>// 1年分のカレンダーを生成する
var baseX = 10; // カレンダーの最初の表示位置（X座標）
var baseY = 0; // カレンダーの最初の表示位置（Y座標）
var calDX = 30; // カレンダーの１日あたりの横幅
var calDY = 30; // カレンダーの１日あたりの縦幅
var blockX = 250; // 一ヶ月分のカレンダーの横の差
var blockY = 250; // 一ヶ月分のカレンダーの縦の差
var blackColor = new CMYKColor(); 
blackColor.cyan = blackColor.magenta= blackColor.yellow = blackColor.black = 100; // 色の初期化（黒色に設定）
var docObj = activeDocument;
// 一ヶ月分のカレンダーを描画する関数
function calendar(theYear_,theMonth_){
    var wrtMonth= new Array(0,31,28,31,30,31,30,31,31,30,31,30,31); // 月末の最終日
    var wrtDate = new Array("日","月","火","水","木","金","土");
    var theDate = new Date(); //　日付オブジェクトを生成
    theDate.setFullYear(theYear_); //　指定された年を設定
    theDate.setMonth(theMonth_-1); //　指定された月を設定
    if (((theYear_ % 4 == 0) &amp;&amp; (theYear_ % 100 != 0)) || (theYear_ % 400 == 0)){
        wrtMonth[2] = 29; //　閏年だったら2月を29日にする
    }
    theDate.setDate(1); //　日付を１日にし曜日を次の行で取得
    var count = theDate.getDay();
    var day = 0; //　曜日カウンタを0にする
    var date = 1; //　日付を1日にする
    var week = 0;
    var calX = 0; //■カレンダーを表示する相対座標(X)
    var calY = 60; //■カレンダーを表示する相対座標(Y)
    write(theYear_+"年"+theMonth_+"月", 95, 0); // 相対座標(95pt,0pt)に描画
    for(var i=0;i&lt;7;i++) { write(wrtDate[i], 0+i*calDX, 30); } //　曜日書き出し
    for(var i=1;i&lt;=wrtMonth[theMonth_]+count;i++){
        if (day&gt;=count){
            var dayText = ""+date;
            date = date + 1;
            if ((day % 7) == 1) { week++; } //　月曜日の場合は週の数を増やす
        }else{
            var dayText = "　";
        }
        drawBox(calX, calY); //枠を表示する。しない場合は行ごと削除する。
        write(dayText, calX, calY); // 日にちを表示する
        calX = calX + calDX;
        if (day % 7 == 6) { calX = 0; calY += calDY; }
        day = day + 1; //　1日増やす
    }
}
// 指定された座標に枠を描く
function drawBox(x, y){
    var pObj = docObj.pathItems.rectangle(0,0,calDX,calDY);
    pObj.translate(baseX + x - 15,baseY-y+calDY-9); //ここで位置を微調整
    pObj.filled = false; //　塗りなし
    pObj.stroked = true; //　線あり
    pObj.strokeWidth = 0.2; //　線幅0.2ポイント
    pObj.strokeColor = blackColor; //　線の色を指定（黒色）
}
// カレンダーの日にちの文字を生成する
function write(txt, x,y){
    var textObj = docObj.textFrames.add();
    textObj.contents = txt;
    textObj.translate(baseX + x, baseY - y);
    textObj.paragraphs[0].justification = Justification.CENTER;
}
// カレンダーを生成するメイン処理部分
var calYear = prompt("作成する年を入れてください",2014);
if (calYear){
    var storeX = baseX;
    var cal = 1;
    for (var cy=0; cy&lt;4; cy++){ //縦に4つ
        for (var cx=0; cx&lt;3; cx++){ //横に3つ
            calendar(calYear, cal); // 一ヶ月分のカレンダーを描画する
            baseX = baseX + blockX;
            cal = cal + 1;
        }
        baseX = storeX;
        baseY = baseY - blockY;
    }
}</code></pre>
<p>　スクリプトを実行すると文字を入力するダイアログが表示されるので、生成するカレンダーの年を入れます。</p>
<figure>
<figcaption>【図】生成するカレンダーの年を入れる</figcaption>
<img src="images/00556.jpeg" />
</figure>
<p>　カレンダーが生成されます。なお、アートボードかカレンダー全体のサイズは調整する必要があります。</p>
<figure>
<figcaption>【図】カレンダーが生成される</figcaption>
<img src="images/00478.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-728">
<section>
<h1 id="calibre_link-518">◎著者紹介</h1>
<p><b>古籏 一浩<span>（ふるはた かずひろ）</span></b></p>
<p>　JavaScript関係の本を多数執筆。この本で55冊目、自動化関係の本としては5冊目となる。他にも自動化関連の本を出したいと考えている。本の執筆以外にも4K映像など、いろいろ手がけている。</p>
<p>Web：http://www.openspc2.org/</p>
<p>
<br />
</p>
<p>◎本書スタッフ</p>
<p>アートディレクター/装丁：　岡田 章志＋GY</p>
<p>編集：　種村嘉彦+ピーチプレス</p>
</section>
</div>
<div id="calibre_link-47">
<section>
<h1 id="calibre_link-765"><b>●本書の内容についてのお問い合わせ先</b></h1>
<p>株式会社インプレスR&amp;D　メール窓口</p>
<p>
<a href="mailto:np-info@impress.co.jp">np-info@impress.co.jp</a>
</p>
<p>件名に「『本書名』問い合わせ係」と明記してお送りください。</p>
<p>電話やFAX、郵便でのご質問にはお答えできません。返信までには、しばらくお時間をいただく場合があります。なお、本書の範囲を超えるご質問にはお答えしかねますので、あらかじめご了承ください。</p>
<p>また、本書の内容についてはNextPublishingオフィシャルWebサイトにて情報を公開しております。</p>
<p>
<a href="http://nextpublishing.jp">http://nextpublishing.jp</a>/</p>
</section>
</div>
<div id="calibre_link-59">
<section>
<p>Adobe JavaScriptシリーズ</p>
</section>
</div>
<div id="calibre_link-62">
<section>
<h1 id="calibre_link-766">Illustrator自動化基本編</h1>
<hr />
<p>2014年12月19日　初版発行Ver.1.0（リフロー版）</p>
<dl>
<dt>著　者</dt>
<dd>古籏 一浩</dd>
<dt>編集人</dt>
<dd>桜井 徹</dd>
<dt>発行人</dt>
<dd>井芹 昌信</dd>
<dt>発　行</dt>
<dd>株式会社インプレスR&amp;D<br />
〒102-0075<br />
東京都千代田区三番町20<br /><a href="http://www.impressRD.jp/">http://www.impressRD.jp/</a></dd>
</dl>
<hr />
<p>◉本書は著作権法上の保護を受けています。本書の一部あるいは全部について株式会社インプレスR&amp;Dから文書による許諾を得ずに、いかなる方法においても無断で複写、複製することは禁じられています。</p>
<p>©2014 Kazuhiro Furuhata, All rights reserved.</p>
<p>ISBN978-4-8443-9649-9</p>
<p>
<br />
</p>
<figure>
<img src="images/00124.jpeg" />
</figure>
</section>
</div>
<div id="calibre_link-524">
<section>
<hgroup>
<h1 id="calibre_link-767"><b>［ 好評既刊 ］NextPublishing</b></h1>
<h2 id="calibre_link-768"><b>◎インプレスR&amp;D</b></h2>
</hgroup>
<hr />
</section>
</div>
<div id="calibre_link-563">
<section>
<h2 id="calibre_link-769"><b>Adobe JavaScriptリファレンス</b></h2>
<h3 id="calibre_link-770"><b></b></h3>
<p>◎古籏 一浩　著</p>
<p>◎印刷書籍版：B5正寸判／550ページ／小売希望価格 4,700円（税別）</p>
<p>◎電子書籍版：EPUB3/PDF／小売希望価格 3,200円（税別）</p>
<p>◎ISBN：978-4-8443-9595-9</p>
<hr />
</section>
</div>
<div id="calibre_link-91">
<section>
<h2 id="calibre_link-771"><b>ExtendScript Toolkit（ESTK）基本編</b></h2>
<h3 id="calibre_link-772"><b>Adobe JavaScript開発の必須ツール</b></h3>
<p>◎古籏 一浩　著</p>
<p>◎印刷書籍版：A5正寸判／380ページ／小売希望価格 3,000円（税別）</p>
<p>◎電子書籍版：EPUB3/PDF／小売希望価格 1,900円（税別）</p>
<p>◎ISBN：978-4-8443-9613-0</p>
<hr />
</section>
</div>
<div id="calibre_link-634">
<section>
<h2 id="calibre_link-773"><b>HTMLとCSS、JavaScriptで作る、リッチなiBooks電子書籍</b></h2>
<h3 id="calibre_link-774"><b></b></h3>
<p>◎久松 慎一　著</p>
<p>◎印刷書籍版：B5変型版／221ページ／小売希望価格 2,400円（税別）</p>
<p>◎電子書籍版：EPUB3/PDF／小売希望価格 1,600円（税別）</p>
<p>◎ISBN：978-4-8443-9610-9</p>
<hr />
</section>
</div>
<div id="calibre_link-33">
<section>
<h2 id="calibre_link-775"><b>文具王・高畑正幸とカラクリ大好き・大谷和利が見つけた3DプリンタCellPの楽しみ方</b></h2>
<h3 id="calibre_link-776"><b>デスクトップ・ファクトリーの時代がやってきた</b></h3>
<p>◎高畑 正幸/大谷 和利　著</p>
<p>◎印刷書籍版：A5正寸版／196ページ／小売希望価格 2,100円（税別）</p>
<p>◎電子書籍版：EPUB3/PDF／小売希望価格 1,400円（税別）</p>
<p>◎ISBN：978-4-8443-9632-1</p>
<hr />
</section>
</div>
<div id="calibre_link-566">
<section>
<h2 id="calibre_link-777"><b>ゲームを作りながら楽しく学べるHTML5+CSS+JavaScriptプログラミング</b></h2>
<h3 id="calibre_link-778"><b></b></h3>
<p>◎田中 賢一郎　著</p>
<p>◎印刷書籍版：B5正寸版／326ページ／小売希望価格 2,500円（税別）</p>
<p>◎電子書籍版：EPUB3/PDF／小売希望価格 1,500円（税別）</p>
<p>◎ISBN：978-4-8443-9596-6</p>
<hr />
</section>
</div>
<div id="calibre_link-55">
<section>
<hgroup>
<h1 id="calibre_link-779"><b>［ 既刊一覧 ］NextPublishing</b></h1>
<h2 id="calibre_link-780"><b>◎インプレスR&amp;D</b></h2>
</hgroup>
<ul>
<li>プロフェッショナルのためのGoogleアナリティクス完全マニュアル Ver.5対応版　<span>◎ 衣袋 宏美［著］</span></li>
<li>Visual BasicによるKinect基本プログラミング　<span>◎ 薬師寺 国安［著］</span></li>
<li>今、見直すHTML　<span>◎ 林 拓也［著］</span></li>
<li>今、見直すCSS　<span>◎ 林 拓也［著］</span></li>
<li>Objective-Cの要点　<span>◎ 柴田 文彦［著］</span></li>
<li>OpenStack Swiftによるオブジェクトストレージ入門　<span>◎ 山縣 陽［著］</span></li>
<li>CloudStack実践ガイド［前編］［後編］　<span>◎ 大削 緑［著］</span></li>
<li>［改訂新版］SDN/OpenFlowで進化する仮想ネットワーク入門　<span>◎ 伊勢 幸一［著］</span></li>
<li>1日で読めてわかるTCP/IPのエッセンス　<span>◎ 榊 正憲［著］</span></li>
<li>Internet of Everythingの衝撃　<span>◎ シスコシステムズ合同会社　IoTインキュベーションラボ［著］</span></li>
<li>クラウドソーシングの衝撃　<span>◎ 比嘉 邦彦／井川 甲作［著］</span></li>
<li>実践クラウドソーシング　<span>◎ 松浦 拓平／吉村 恭輔／後藤 匠／井川 甲作［著］</span></li>
<li>顧客を知るためのデータマネジメントプラットフォーム　DMP入門　<span>◎ 横山 隆治／菅原 健一／草野 隆史［著］</span></li>
<li>日本の電子出版を創ってきた男たち　<span>◎ OnDeck編集部［編］</span></li>
<li>知らないと始められない電子出版最新用語集　<span>◎ OnDeck編集部［編］</span></li>
<li>電子書籍端末の最新技術　<span>◎ 藤原 隆弘［著］</span></li>
<li>Facebookは初期設定で使うな！　<span>◎ インプレスジャパン編集部［編］</span></li>
<li>Gmailは初期設定で使うな！　<span>◎ インプレスジャパン編集部［編］</span></li>
<li>LINE＆Twitterは初期設定で使うな！　<span>◎ インプレスジャパン編集部［編］</span></li>
<li>Aterm MR03LN超入門　<span>◎ 村上 俊一［著］</span></li>
<li>SIMフリー超入門 iPhone編／Android編　<span>◎ 武井 一巳［著］</span></li>
<li>MacでWindowsを使う本　<span>◎ 向井 領治［著］</span></li>
<li>おとなが読んで・知って・まもる　こどもiPad　<span>◎ 吉田 メグミ［著］</span></li>
</ul>
</section>
</div>




<script>function myFunction(){document.getElementById("tateyoko").classList.toggle("tateread")}</script></body></html>