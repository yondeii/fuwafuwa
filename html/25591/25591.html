<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Xojo ユーザーガイド: Book 1: 基礎</title>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="/css/mainday.css" title="default">
<link rel="alternate stylesheet" href="/css/mainnight.css" title="alternate">
<script type="text/javascript" src="/js/styleswitcher.js"></script>
<script type="text/javascript" src="/js/global.js"></script>
</head>
<body>
<div class="novelpage">
<div class="novelbody">
<div id="tateyoko">
<div id="_top"></div>
<a href="/">🏠</a>&emsp;
<a href="#" onclick="setActiveStyleSheet('default'); return false;">日</a>&emsp;
<a href="#" onclick="setActiveStyleSheet('alternate'); return false;">月</a>&emsp;
<a href="#_top" onclick="myFunction()" style="cursor: pointer;">縦書き／横書き</a>
<div id="calibre_link-38">
<div>
<div>
<table class="noveltitle">
<tr>
<td colspan="2"><i><span><i>Xojo ユーザーガイド: Book 1: 基礎</i></span></i></td>
</tr>
<tr>
                    
                    
      </tr>
<tr>
<td colspan="2">Xojo開発チーム</td>
</tr>
<tr>
<td colspan="2">グレープシティ株式会社 (2016)</td>
</tr>
<tr>
<td colspan="2"></td>
</tr>
</table>
<div></div>
</div>
<div></div>
</div>
</div>



<div id="calibre_link-93">
<div>
<div>
<p>
<span>※Kindle版発行にあたって</span>
</p>
<p>本書籍は、Xojo, Inc. の許諾を得て2015年に発行された「Xojo User Guide Book1 Fundamental」をグレープシティ株式会社が日本語に翻訳したものをKindle版として制作・発行したものです。これからXojoを使ってみようと考えている人、すでにXojoを仕事や研究に活かしている人など、さまざまな方に役立てていただければ幸いです。</p>
<p>本文中のソースコードはAdobe® 社がSIL Open Font License にて提供している欧文等幅フォント Source Han Code JP を使用しています。</p>
<p><br />
</p>
<p>グレープシティ 株式会社</p>
</div>
</div>
</div>


<div id="calibre_link-95">
<div>
<p><img src="images/000074.jpg" alt="" /></p>
</div>
</div>


<div id="calibre_link-1">
<div>
<p><img src="images/000090.jpg" alt="" /></p>
</div>
</div>


<div id="calibre_link-82">
<div>
<div>
<h2><b>
<span><b>Section 1</b></span>
<br /><b></b>
Xojo ユーザーガイドについて</b></h2>
<p><br />
</p>
<p>この Xojo ユーザーガイドは、Xojo の初心者である開発者および Xojo に熟達した開発者の両方を読者として想定しています。</p>
<p><br />
</p>
<p>ユーザーガイドは、Xojo の各分野に特化した:『Xojo の基礎』、『Xojo のユーザーインタフェース』、『Xojo のフレームワーク』、および『Xojo での開発』の4冊で構成されています。</p>
<p><br />
</p>
<p>ユーザーガイドのトピックの並び順は、通常使用する順序になるように編成されています。</p>
<p>『Xojo の基礎』では、まず Xojo 統合開発環境（IDE）について説明し、その後「Xojo プログラミング言語」、「モジュール」、および「クラス」と続きます。最後は「アプリケーションの構造」の章です。</p>
<p><br />
</p>
<p>『Xojo のユーザーインタフェース』では、デスクトップアプリケーションやウェブアプリを作成するためのコントロールとクラスについて説明します。</p>
<p><br />
</p>
<p>『Xojo のフレームワーク』は、『Xojo のユーザインタフェース』と『Xojo の基礎』で学習した内容がベースになっています。Xojo の主なフレームワークエリアについて、「ファイル」、「テキスト」、「グラフィックスとマルチメディア」、「データベース」、「印刷とレポート」、「通信とネットワーキング」、「同時実行」、および「デバッグ」の各章で説明します。最後に、「アプリケーションのビルド」の章と「高度な機能」の2つの章があります。</p>
<p><br />
</p>
<p>『Xojo での開発』では、「アプリケーションの展開」、「クロスプラットフォームの開発」、「ウェブの開発」、「他のツールからの移行」、「コードの管理」、および「サンプルアプリケーション」の各エリアについて説明します。</p>
<p><br />
</p>
<h4><b>著作権</b></h4>
<p>この書籍の著作権はすべて Xojo,Inc. が保有しています。この文書のすべてまたは一部や関連するファイルを、どのような電子的または物理的な形式であっても、物理的、電子的、写真撮影、動画撮影やその他の電磁的複製方法を含むどのような方法であっても、著作権者の文書による許諾を前もって受けることなく、その内容を複製、送信、アップロードすることは、国際法国内法の関連法規により禁じられています。</p>
<p><br />
</p>
<h4><b>商標</b></h4>
<p>Xojo は Xojo, Inc. の登録商標です。無断複写・転載を禁じます。</p>
<p><br />
</p>
<p>この書籍内で使用されている商品名やサービス名は各社の商標、登録商標、サービスマークで、この書籍内で触れる目的でのみ使用されています。なお、商標、登録商標、サービスマークである可能性がある語句は適宜その旨の表示を行っておりますが、Xojo, Inc. はその情報の正確性を保証するものではありません。そのような語句をこの書籍内で使用していたとしても、商標、登録商標、サービスマークは正しくない可能性があることを含みおきください。Xojo, Inc. はこの書籍内で触れている商品やサービスとは関係がありません。</p>
</div>
</div>
</div>


<div id="calibre_link-83">
<div>
<div>
<h2><b>
<span><b>Section 2</b></span>
<br /><b></b>
凡例</b></h2>
<p><br />
</p>
<p>本書では、Xojo の Windows、OS X、Linux の各画面のスナップショットを掲載しています。インタフェースデザインと機能はすべてのプラットフォームで統一されていますので、プラットフォームによる違いは、見た目の違い、ひいては Windows、OS X、Linux のグラフィカルインタフェースの違いによるものです。</p>
<p><br />
</p>
<div>
<p>・<span>太字</span>
 は初めての新しい項目が使用された時に、その部分を強調するために利用され、また重要な概念を強調する場合にも使用されます。また、書籍のタイトル（『Xojo ユーザーガイド』など）は斜体で記述しています。</p>
<p><br />
</p>
<p>・メニューから項目を１つ選択するような場合には、「［ファイル］→［新規プロジェクト］を選択します。」のような書式で表示されます。この例では、「［ファイル］メニューから［新規プロジェクト］を選ぶ」という意味になります。</p>
<p><br />
</p>
<p>・キーボードショートカットを構成するキーの並びは、記述されている順序で押す必要があります。Windows と Linux では、［Ctrl］キーが修飾キーです。OS X では、［⌘］（［Command］）キーが修飾キーです。たとえば、［Ctrl］+［O］または［⌘］-［O］の場合、Windows と Linux では［Ctrl］キーを押しながら［O］キーを押し、OS X では［⌘］（［Command］）キーを押しながら［O］キーを押します。修飾キーは、ショートカットキー（この場合は［O］キー）を押す前に手を離してはいけません。</p>
<p><br />
</p>
<p>・何かキー入力をしなければならない場合には、「GoButton」のようにその部分はカギかっこで囲んで表示されます。</p>
<p><br />
</p>
<p>・コードエディタ上でプログラムを入力する必要がある部分もあります。入力する文字は例のように灰色のボックス内に表示されます。</p>
</div>
<p><br />
</p>
<div>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>ShowURL(SelectedURL.Text)</p>
</div>
</div>
<p><br />
</p>
<p>プログラムコードを入力したら、このガイドラインをチェックしてみてください。</p>
<p><br />
</p>
<div>
<p>・灰色のボックス内の文字列が複数行ある場合、コードエディタ内でも別々の行として入力します。複数の行を無理やり1行に詰め込んだり、長いからといって1行を別々の行に分けてはいけません。</p>
<p><br />
</p>
<p>・空白文字（スペース）を入れるように指示されていないのに、余分な空白文字をプログラム内に入れてはいけません。</p>
<p><br />
</p>
<p>・もちろん、この書籍からコピー・ペーストして使用することもできます。</p>
</div>
<p><br />
</p>
<p>自分で作成したアプリケーションを実行する時には、Xojo は毎回、まず入力された文字の間違いや文法間違いを検査します。この検査の時に誤りを発見した場合、Xojo はどの行に問題があったかがすぐに分かるように、そのプログラム内の誤りがある行を表示します。</p>
</div>
</div>
</div>


<div id="calibre_link-80">
<div>
<div>
<h2><b>
<span><b>Section 3</b></span>
<br /><b></b>
目次</b></h2>
<p><br />
</p>
<p><br />
</p>
<p>
<a href="#calibre_link-81">前書き</a>
</p>
<p>
<a href="#calibre_link-82">Xojo ユーザーガイドについて</a>
</p>
<p>
<a href="#calibre_link-83">凡例</a>
</p>
<p>
<a href="#calibre_link-80">目次</a>
</p>
<p><br />
</p>
<p>
<a href="#calibre_link-44">1. 始めに</a>
</p>
<p>
<a href="#calibre_link-45">1.1.　Xojo について</a>
</p>
<p>
<a href="#calibre_link-46">1.2.　Xojo のインストール</a>
</p>
<p>
<a href="#calibre_link-47">1.3.　使い始める</a>
</p>
<p>
<a href="#calibre_link-48">1.4.　オンラインヘルプ</a>
</p>
<p>
<a href="#calibre_link-49">1.5.　サンプルプロジェクト</a>
</p>
<p>
<a href="#calibre_link-50">1.6.　フィードバック</a>
</p>
<p><br />
</p>
<p>
<a href="#calibre_link-6">2. 概要</a>
</p>
<p>
<a href="#calibre_link-7">2.1.　プロジェクト選択ツール</a>
</p>
<p>
<a href="#calibre_link-8">2.2.　ワークスペース</a>
</p>
<p>
<a href="#calibre_link-9">2.3.　ナビゲーター</a>
</p>
<p>
<a href="#calibre_link-10">2.4.　ウィンドウとウェブページのレイアウトエディタ</a>
</p>
<p>
<a href="#calibre_link-11">2.5.　ライブラリとインスペクタ</a>
</p>
<p>
<a href="#calibre_link-12">2.6.　コードエディタ</a>
</p>
<p>
<a href="#calibre_link-13">2.7.　その他のエディタ</a>
</p>
<p>
<a href="#calibre_link-14">2.8.　パネル</a>
</p>
<p>
<a href="#calibre_link-15">2.9.　アプリケーションの実行</a>
</p>
<p>
<a href="#calibre_link-16">2.10.　プロジェクトの種類、フォーマット、およびテンプレート</a>
</p>
<p>
<a href="#calibre_link-17">2.11.　環境設定とオプション</a>
</p>
<p>
<a href="#calibre_link-18">2.12.　キーボードショートカット</a>
</p>
<p><br />
</p>
<p>
<a href="#calibre_link-26">3. Xojo プログラミング言語</a>
</p>
<p>
<a href="#calibre_link-84">3.1.　命名規則</a>
</p>
<p>
<a href="#calibre_link-85">3.2.　変数と定数</a>
</p>
<p>
<a href="#calibre_link-86">3.3.　データの型と保存</a>
</p>
<p>
<a href="#calibre_link-87">3.4.　データのコレクション</a>
</p>
<p>
<a href="#calibre_link-88">3.5.　比較</a>
</p>
<p>
<a href="#calibre_link-89">3.6.　分岐</a>
</p>
<p>
<a href="#calibre_link-90">3.7.　ループ</a>
</p>
<p>
<a href="#calibre_link-91">3.8.　メソッド</a>
</p>
<p><br />
</p>
<p>
<a href="#calibre_link-71">4. モジュール</a>
</p>
<p>
<a href="#calibre_link-72">4.1.　モジュールについて</a>
</p>
<p>
<a href="#calibre_link-73">4.2.　プロジェクト項目のグループ化（名前空間）</a>
</p>
<p>
<a href="#calibre_link-74">4.3.　拡張メソッド</a>
</p>
<p><br />
</p>
<p>
<a href="#calibre_link-28">5. クラス</a>
</p>
<p>
<a href="#calibre_link-29">5.1.　クラスについて</a>
</p>
<p>
<a href="#calibre_link-30">5.2.　オブジェクト指向設計の概念</a>
</p>
<p>
<a href="#calibre_link-31">5.3.　プロパティ、メソッド、およびイベント</a>
</p>
<p>
<a href="#calibre_link-32">5.4.　コンストラクタとデストラクタ</a>
</p>
<p>
<a href="#calibre_link-33">5.5.　インタフェース</a>
</p>
<p>
<a href="#calibre_link-34">5.6.　サブクラスの例</a>
</p>
<p>
<a href="#calibre_link-35">5.7.　クラスの応用機能</a>
</p>
<p><br />
</p>
<p>
<a href="#calibre_link-62">6. アプリケーション構造</a>
</p>
<p>
<a href="#calibre_link-63">6.1.　デスクトップアプリケーション</a>
</p>
<p>
<a href="#calibre_link-64">6.2.　ウェブアプリケーション</a>
</p>
<p>
<a href="#calibre_link-65">6.3.　コンソールアプリケーション</a>
</p>
<p>
<a href="#calibre_link-66">6.4.　iOS アプリケーション</a>
</p>
<p>
<a href="#calibre_link-52">6.5.　アイコンエディタ</a>
</p>
</div>
</div>
</div>


<div id="calibre_link-75">
<div>
<p><img src="images/000023.jpg" alt="" /></p>
</div>
</div>


<div id="calibre_link-43">
<div>
<div>
<p>
<span>Contents</span>
</p>
<p><br />
</p>
<div>
<p>
<a href="#calibre_link-44">1. 始めに</a>
</p>
</div>
<div>
<div>
<p>
<a href="#calibre_link-45">1.1. Xojo について</a>
</p>
<p>
<a href="#calibre_link-46">1.2. Xojo のインストール</a>
</p>
<p>
<a href="#calibre_link-47">1.3. 使い始める</a>
</p>
<p>
<a href="#calibre_link-48">1.4. オンラインヘルプ</a>
</p>
<p>
<a href="#calibre_link-49">1.5. サンプルプロジェクト</a>
</p>
<p>
<a href="#calibre_link-50">1.6. フィードバック</a>
</p>
</div>
</div>
</div>
</div>
</div>


<div id="calibre_link-67">
<div>
<div>
<h2 id="calibre_link-45"><b>
<span><b>Section 1</b></span>
<br /><b></b>
Xojo について</b></h2>
<p><br />
</p>
<p>Xojo を使用すると、マルチプラットフォームの強力なデスクトップおよびウェブアプリケーションをすばやく簡単にビルドできます。Xojo のプログラミング言語は、初めてプログラミングを行う方でも簡単に学習できます。経験豊富なプログラマーには、この言語が強力で堅牢なことを実感していただけます。どちらの場合も、短期間で非常に多くのことを実現できます。</p>
<p><br />
</p>
<p>Xojo には、まったく（またはほとんど）プログラミングせずにアプリケーションのユーザーインタフェースを作成できる視覚的なグラフィカルユーザーインタフェース（「GUI」）ビルダーがあります。ドラッグアンドドロップ操作を知っていれば、インタフェースをビルドできます。Xojo はインタフェースコントロールの充実したセットを提供しており、ユーザーは独自のコントロールを作成することもできます。</p>
<p><br />
</p>
<p>Xojo のプログラミング言語は、わかりやすいコンパイル型オブジェクト指向プログラミング言語です。これは、Xojo のプログラミング言語が、ほとんどのプログラミング言語（C++、Objective-C、Java など）で現在使用されているものと同じタイプの最新アーキテクチャーを使用していることを意味します。オブジェクト指向プログラミング言語では現実世界のオブジェクトに似た個々のオブジェクトとしてコードを作成するため、作成とデバッグがより簡単になります。</p>
<p><br />
</p>
<p>Xojo を使用すると、OS のプログラミングインタフェースへのアクセス方法を学習する必要がなくなるので、従来の言語よりも迅速かつ簡単にアプリケーションを開発できます。このアプリケーションプログラミングインタフェース（略して API）は数千個のコマンドで構成されていますが、Xojo でアプリケーションをビルドするためにこれらを学習する必要は一切ありません。</p>
</div>
</div>
</div>


<div id="calibre_link-78">
<div>
<div>
<h2 id="calibre_link-46"><b>
<span><b>Section 2</b></span>
<br /><b></b>
Xojo のインストール</b></h2>
<p><br />
</p>
<p>Xojo には、ハードウェアと OS に関する次の要件があります。</p>
<p><br />
</p>
<h3><b>OS X</b></h3>
<h4><b>
<span><b>IDE</b></span>
</b></h4>
<p>OS X で Xojo を使用して開発を行う場合の要件は、次のとおりです。</p>
<p><br />
</p>
<table>
<tr>
<th><b>サポート対象</b></th>
</tr>
<tr>
<td>OS X Lion 10.7 以降</td>
</tr>
<tr>
<td>iOS 開発時 OS X Mavericks 10.9 以降</td>
</tr>
<tr>
<td>2 GB RAM</td>
</tr>
</table>
<p><br />
</p>
<h4><b>コンパイル済みアプリケーション</b></h4>
<p>Xojo は、次のバージョンの OS X を搭載したすべての Intel Macintosh 用にアプリケーションを作成できます。</p>
<p><br />
</p>
<table>
<tr>
<th><b>Cocoa</b></th>
<th><b>Carbon</b></th>
</tr>
<tr>
<td>OS X 10.7<br />
以降</td>
<td>OS X 10.7<br />
以降</td>
</tr>
</table>
<p><br />
</p>
<h4><b>インストール</b></h4>
<p>次の Xojo ウェブサイトから最新バージョンをダウンロードしてください。</p>
<p><br />
</p>
<p>
<a href="http://www.xojo.com/download/">
<span>http://www.xojo.com/download/</span>
</a>
</p>
<p><br />
</p>
<p>ダウンロードされるデータには、ディスクイメージ（DMG）ファイルが含まれています。このファイルをダブルクリックして Finder に表示してください。</p>
<p><br />
</p>
<p>Finder でディスクイメージを選択し、ディスクイメージからアプリケーションフォルダに Xojo フォルダをドラッグします。</p>
<p><br />
</p>
<h3><b>Windows</b></h3>
<h4><b>
<span><b>IDE</b></span>
</b></h4>
<p>Microsoft Windows で Xojo を使用して開発を行う場合の要件は、次のとおりです。</p>
<p><br />
</p>
<table>
<tr>
<th><b>サポート対象</b></th>
</tr>
<tr>
<td>Windows ７ 以降</td>
</tr>
<tr>
<td>2 GB RAM</td>
</tr>
<tr>
<td>PDF 閲覧ソフトウェア</td>
</tr>
</table>
<p><br />
</p>
<h4><b>コンパイル済みアプリケーション</b></h4>
<p>Xojo は、Windows の次のバージョンで動作するアプリケーションを作成できます。</p>
<p><br />
</p>
<table>
<tr>
<th><b>Windows</b></th>
</tr>
<tr>
<td>Windows 7 x86 または x64</td>
</tr>
<tr>
<td>Windows 8.x x86 または x64</td>
</tr>
<tr>
<td>Windows 10 x86 または x64</td>
</tr>
</table>
<p><br />
</p>
<h4><b>インストール</b></h4>
<p>Windows インストーラーを実行し、Windows に Xojo をインストールします。</p>
<p><br />
</p>
<h3><b>Linux</b></h3>
<h4><b>
<span><b>IDE</b></span>
</b></h4>
<p>Linux で Xojo を使用して開発を行う場合の要件は、次のとおりです。</p>
<p><br />
</p>
<table>
<tr>
<th><b>サポート対象</b></th>
</tr>
<tr>
<td>Linux Mint 16 以降</td>
</tr>
<tr>
<td>Ubuntu 10.04 以降</td>
</tr>
<tr>
<td>Debian 6.0 以降</td>
</tr>
<tr>
<td>OpenSUSE 11.3 以降</td>
</tr>
<tr>
<td>Fedora 13 Desktop 以降</td>
</tr>
<tr>
<td>CentOS 6.0 以降</td>
</tr>
<tr>
<td>2GB RAM</td>
</tr>
<tr>
<td>PDF 閲覧ソフトウェア</td>
</tr>
</table>
<p><br />
</p>
<h4><b>コンパイル済みアプリケーション</b></h4>
<p>Xojo は、次の要件を満たす Linux ディストリビューションで動作するアプリケーションを作成できます。</p>
<p><br />
</p>
<table>
<tr>
<th><b>サポート対象</b></th>
</tr>
<tr>
<td>Linux Mint 16 以降</td>
</tr>
<tr>
<td>Ubuntu 10.04 以降</td>
</tr>
<tr>
<td>Debian 6.0 以降</td>
</tr>
<tr>
<td>OpenSUSE 11.3 以降</td>
</tr>
<tr>
<td>Fedora 13 Desktop 以降</td>
</tr>
<tr>
<td>CentOS 6.0 以降</td>
</tr>
</table>
<p><br />
</p>
<h4><b>
<span><b>64</b></span>
 ビット<span><b>Linux</b></span>
 とライブラリ情報</b></h4>
<p>Xojo と Xojo で作成したアプリケーションでは、次のライブラリが必要です。</p>
<p><br />
</p>
<div>
<p>・GTK+ 2.20（デスクトップ）</p>
<p>・glib 2.0（ウェブとコンソール）</p>
<p>・glibc-2.11</p>
<p>・libstdc++.so.6.0.13</p>
<p>・libicu 4.2+</p>
<p>・libwebkitgtk-1.0.0 または libgtkhtml (HTMLViewer 用)</p>
</div>
<p><br />
</p>
<p>64 ビット Linux ディストリビューションでは、Xojo または Xojo でビルドしたアプリケーションを実行するために適切な32ビット互換ライブラリがインストールされていることを確認する必要があります。Ubuntu の場合は、通常、次のコマンドのいずれかを使用できます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>sudo apt-get install ia32-libs</p>
<p>sudo apt-get install ia32-libs-multiarch</p>
</div>
<p><br />
</p>
<p>より新しいバージョンの Ubuntu では、次の追加手順も必要な場合があります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>sudo dpkg --add-architecture i386</p>
<p>sudo apt-get update</p>
<p>sudo apt-get install ia32-libs-multiarch</p>
</div>
<p><br />
</p>
<p>Multiarch サポートの詳細については、次のウェブサイトを参照してください。</p>
<p><br />
</p>
<p>
<a href="https://wiki.debian.org/Multiarch/HOWTO">
<span>https://wiki.debian.org/Multiarch/HOWTO</span>
</a>
</p>
<p><br />
</p>
<p>Xojo が使用するライブラリは、ldd コマンドで決定できます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>ldd Xojo</p>
</div>
<p><br />
</p>
<h3><b>ウェブ</b></h3>
<p>ウェブアプリケーションは、サーバーコンポーネントとウェブブラウザで動作するユーザーインタフェースの2つの部分で構成されます。サーバーコンポーネントの要件は、ビルド対象プラットフォームと同じです。</p>
<p><br />
</p>
<p>ウェブアプリケーションは、次のウェブブラウザをサポートします。</p>
<p><br />
</p>
<table>
<tr>
<th><b>サポート対象のウェブブラウザ</b></th>
</tr>
<tr>
<td>Chrome</td>
</tr>
<tr>
<td>Firefox</td>
</tr>
<tr>
<td>Safari</td>
</tr>
<tr>
<td>Internet Explorer 9+</td>
</tr>
<tr>
<td>Mobile Safari (iOS)</td>
</tr>
<tr>
<td>Chrome for Android devices</td>
</tr>
</table>
<p><br />
</p>
<h3><b>iOS</b></h3>
<p>iOS アプリを開いたり作成したりすることができるのは、Xojo の OS X バージョンだけです。次のような、より制約的 IDE 要件もあります。</p>
<p><br />
</p>
<div>
<p>・OS X Mavericks 10.9 以降</p>
<p>・Xcode 6.1（iOS Simulator 向け）</p>
</div>
<p><br />
</p>
<p>Xojo で作成した iOS アプリは、次のバージョンの iOS で動作します。</p>
<p><br />
</p>
<div>
<p>・iOS 7</p>
<p>・iOS 8</p>
</div>
<p><br />
</p>
<p>次の iOS デバイスがサポートされています。</p>
<p><br />
</p>
<div>
<p>・iPhone 4S 以降の iPhone</p>
<p>・すべての iPad mini モデル</p>
<p>・iPad 2以降のモデル</p>
<p>・iPod touch（第5世代以上）</p>
</div>
<p><br />
</p>
<p>次の操作を行うためには、有料の Apple iOS Developer アカウントが必要です。</p>
<p><br />
</p>
<div>
<p>・iOS デバイスへの展開</p>
<p>・App Store への申請</p>
</div>
</div>
</div>
</div>


<div id="calibre_link-100">
<div>
<div>
<h2 id="calibre_link-47"><b>
<span><b>Section 3</b></span>
<br /><b></b>
使い始める</b></h2>
<p><br />
</p>
<h3><b>Xojo ID のログイン</b></h3>
<p>Xojo がライセンスを使用するためには、Xojo アカウントにログインする必要があります。</p>
<p><br />
</p>
<p><img src="images/000110.jpg" alt="Figure 1.1 [Xojo ID のログイン]ウィンドウ" />
</p>
<p><br />
</p>
<p>ログインするには、Xojo ID とパスワードを入力して［ログイン］ボタンをクリックします。この手順を実行すると、アカウントに関連付けられているライセンスが適用されます。</p>
<p><br />
</p>
<p>所有しているライセンスは、［ライセンス］タブの［Xojo について］ウィンドウで確認できます。使用可能なライセンスが、ライセンス終了期限およびライセンスが登録されている電子メールとともに表示されます。</p>
<p><br />
</p>
<p><img src="images/000077.jpg" alt="Figure 1.2 [Xojo について]ウィンドウの[ライセンス]画面" />
</p>
<p><br />
</p>
<p>Xojo で新しいライセンスを強制的に確認するには、［ダウンロード］ボタンを使用します。</p>
<p><br />
</p>
<p>［追加］ボタンを使用して手動でライセンスファイルを追加することもできます。［削除］ボタンはライセンスを削除します。</p>
<p><br />
</p>
<p>Xojo ウェブサイトでは、アカウントにログインしてライセンスの表示、ライセンスファイルのダウンロード、およびライセンスの購入または更新を実行することができます。</p>
<p><br />
</p>
<p>
<a href="https://xojo.com/account/login.php?lang=jp">
<span>https://xojo.com/account/login.php?lang=jp</span>
</a>
</p>
<p><br />
</p>
<h3><b>クイックスタートとチュートリアル</b></h3>
<p>プログラミング初心者の方は、まずデスクトップまたはウェブアプリケーション用のクイックスタートに目を通し、次にチュートリアルに目を通してください。これらのガイドには、Xojo の概要がうまくまとめられており、プログラミング言語が紹介されています。</p>
<p><br />
</p>
<p>次に、『Xojo ユーザーガイド』をお読みください。このガイドでは、Xojo、Xojo のプログラミング言語、ユーザーインタフェースコントロール、フレームワーク、およびその他の機能が詳細に説明されています。プログラミング言語の特定のコントロールまたはコマンドの詳細が必要な場合は、次の URL でオンライン言語リファレンスを参照してください。</p>
<p><br />
</p>
<p>
<a href="http://developer.xojo.com/ja/reference-guide">
<span>http://developer.xojo.com/ja/reference-guide</span>
</a>
</p>
</div>
</div>
</div>


<div id="calibre_link-108">
<div>
<div>
<h2 id="calibre_link-48"><b>
<span><b>Section 4</b></span>
<br /><b></b>
オンラインヘルプ</b></h2>
<p><br />
</p>
<h3><b>クイックスタート、チュートリアル、およびユーザーガイド</b></h3>
<p>クイックスタート、チュートリアル、および『Xojo ユーザーガイド』は、Xojo のインストール先に PDF 形式で含まれています。これらのガイドは Xojo のインストール先の Documentation フォルダにあり、Xojoの［ヘルプ］メニューからもアクセスできます。</p>
<p><br />
</p>
<p><img src="images/000001.jpg" alt="Figure 1.3 Xojo [ヘルプ]メニュー" />
</p>
<p><br />
</p>
<p>これらのガイドを iBooks for iOS または iBooks for Mac で読みたい場合は、グレープシティのWebサイト（<a href="http://xojo.grapecity.com/support/developguide">
<span>http://xojo.grapecity.com/support/developguide</span>
</a>
 ）から入手できます。</p>
<p><br />
</p>
<h3><b>言語リファレンス</b></h3>
<p>言語リファレンスは Xojo に組み込まれています。言語リファレンスにアクセスするには、［ヘルプ］→［言語リファレンス］（Windows と Linux では［F1］、OS X では［⌘］-［?］）を選択するか、ツールバーの［ヘルプ］ボタンを使用します。</p>
<p><br />
</p>
<p>カテゴリー名をクリックしてサブカテゴリーを表示し、サブカテゴリーをクリックして言語項目を表示します。項目にナビゲートするには、その項目をクリックします。</p>
<p><br />
</p>
<p>閲覧してきた項目を前後に移動するには、ヘッダーエリアの矢印を使用します。［ホーム］ボタンを押すと、カテゴリーとサブカテゴリーの一覧のあるページに戻ります。</p>
<p><br />
</p>
<p>プログラミング中には、文脈依存型ヘルプも使用できます。ヘルプが必要な項目をコードエディタで選択して右クリック（OS X では［Control］-クリック）します。コンテキストメニューが表示されます。［ItemName のヘルプ］メニューコマンドを選択すると、希望する項目の言語リファレンスが開きます。［Command］キー（Windows と Linux では［Control］キー）を押しながら項目をダブルクリックすることで、その項目の言語リファレンスを開くこともできます。</p>
<p><br />
</p>
<p><img src="images/000005.jpg" alt="Figure 1.4 Xojo [言語リファレンス]ウィンドウ" />
</p>
<p><br />
</p>
<p>通常、Xojo 内から言語リファレンスにアクセスする場合は、最新のドキュメントを閲覧できるように、オンラインドキュメントへのアクセスが行われます。</p>
<p><br />
</p>
<p>しかしながら、オフライン時に言語リファレンスを使用したい場合もあります。Xojo の各リリースには、組み込み版の言語リファレンスが含まれています。</p>
<p><br />
</p>
<p>ローカル言語リファレンスにアクセスするには、［編集］→［環境設定］オプション（OS X では ［Xojo］→［環境設定］）を選択し、［基本設定］ページを選択します。［ヘルプの場所］のセクションでは、オンラインドキュメントと組み込みドキュメントのどちらを使用するかを指定することができます。</p>
<p><br />
</p>
<p><img src="images/000035.jpg" alt="Figure 1.5 オンライン言語リファレンスまたは組み込み言語リファレンスの選択" />
</p>
<p><br />
</p>
<p>OS X では、［Option］キーを押しながら［ヘルプ］メニューから［言語リファレンス］にアクセスすることで、この設定を一時的に逆にすることもできます。</p>
<p><br />
</p>
<h3><b>Documentation Wiki の使用</b></h3>
<p>Xojo 自体を介してアクセスできるドキュメントに加えて、<a href="http://docs.xojo.com">
<span>http://docs.xojo.com</span>
</a>
 にはウェブブラウザを使用してアクセスできる Documentation Wiki も用意されています。</p>
<p><br />
</p>
<p>Documentation Wiki には、言語リファレンス、記事、ヒントなどの役に立つ情報が含まれています。</p>
<p><br />
</p>
<p><img src="images/000060.jpg" alt="Figure 1.6 Documentation Wiki ホームページ" />
</p>
</div>
</div>
</div>


<div id="calibre_link-96">
<div>
<div>
<h2 id="calibre_link-49"><b>
<span><b>Section 5</b></span>
<br /><b></b>
サンプルプロジェクト</b></h2>
<p><br />
</p>
<p>Xojo には、Xojo の多くの特長と機能を実際に示す各種サンプルプロジェクトが含まれています。</p>
<p><br />
</p>
<p>サンプルプロジェクトには、Xojo 起動時に表示される［プロジェクト選択］ウィンドウを使用してアクセスすることができます（［プロジェクト選択］ウィンドウの詳細については、第2章のセクション1を参照してください）。</p>
<p><br />
</p>
<p><img src="images/000039.jpg" alt="Figure 1.7 サンプルを表示する[プロジェクト選択]ウィンドウ" />
</p>
<p><br />
</p>
<p>サンプルプロジェクトは、次のフォルダにグループ分けされています。</p>
<p><br />
</p>
<div>
<p>・Advanced</p>
<p>・Communication</p>
<p>・Console</p>
<p>・Database</p>
<p>・Design Patterns</p>
<p>・Desktop</p>
<p>・Files</p>
<p>・Framework</p>
<p>・Graphics and Multimedia</p>
<p>・Language Features</p>
<p>・Platform-Specific</p>
<p>・Printing and Reporting</p>
<p>・Sample Applications</p>
<p>・Text</p>
<p>・Unit Testing</p>
<p>・Web</p>
</div>
<p><br />
</p>
<p>サンプルプロジェクトを選択すると、選択したプロジェクトのコピーが開かれます。このコピーは、変更後、任意の場所に保存できます。</p>
</div>
</div>
</div>


<div id="calibre_link-58">
<div>
<div>
<h2 id="calibre_link-50"><b>
<span><b>Section 6</b></span>
<br /><b></b>
フィードバック</b></h2>
<p><br />
</p>
<h3><b>お問い合わせ情報</b></h3>
<table>
<tr>
<th><b>ライセンス</b></th>
<th><b>お問い合わせ先</b></th>
</tr>
<tr>
<td>ご購入前</td>
<td>Webお問い合わせ窓口：<br />
<span>
<a href="http://xojo.grapecity.com/contact">http://xojo.grapecity.com/contact</a>
</span>
<br />
カスタマーサービス：<br />
<span>sales@grapecity.com</span>
</td>
</tr>
<tr>
<td>ご購入後</td>
<td>テクニカルサポート：<br />
<span>
<a href="http://xojo.grapecity.com/support">http://xojo.grapecity.com/support</a>
</span>
</td>
</tr>
</table>
<p><br />
</p>
<h3><b>バグレポートと機能要求</b></h3>
<p>Xojo でバグを見つけたと思われる場合や、機能に関する要求がある場合は、当社までお知らせください。バグレポートまたは機能要求には、Feedback（<a href="http://www.xojo.com/feedback/">
<span>http://www.xojo.com/feedback/</span>
</a>
 ）アプリケーション（＊１）を使用するのが最も良い方法です。Feedback は、バグを追跡し、機能要求を実現するために役立つすべての必要情報を集めるように設計されています。レポートされたバグまたは機能要求（案件と呼びます）ごとに、案件番号が記載された確認メッセージが電子メールで届きます。案件が更新されると、変更を知らせる電子メールが案件提出者に届きます。（＊１：を使用した場合、開発元であるXojo, Inc.社のフィードバックシステムに直接接続されるため、英語でのやりとりが必要となります。日本語によるテクニカルサポートは、左記のお問い合わせ先よりご利用いただけます。）</p>
<p><br />
</p>
<p>Feedback アプリケーションは、英語版のXojo 内からは直接起動できますが、グレープシティの販売する日本語版では起動できません。日本語によるお問い合わせは、グレープシティのWebサイトからお問い合わせいただけます。</p>
<p><br />
</p>
<h3><b>推奨されるフィードバック案件の作成</b></h3>
<p>フィードバック案件を作成する場合、最も重要なのは詳細情報を提供することです。</p>
<p><br />
</p>
<p>ここでは、フィードバック案件作成時に入力が必要なフィールドについて説明します。</p>
<p><br />
</p>
<h4><b>
<span><b>Summary</b></span>
</b></h4>
<p>問題を要約して記載します。要約では、実際の問題を説明します。</p>
<p><br />
</p>
<p>例：</p>
<table>
<tr>
<th><b>適切でない要約</b></th>
<th><b>適切な要約</b></th>
</tr>
<tr>
<td>Xojo がクラッシュする</td>
<td>32 ビットライブラリがない状態で64ビット Linux で Xojo がクラッシュする</td>
</tr>
<tr>
<td>リストボックスが機能しない</td>
<td>64 列を超えると、リストボックスが機能しない</td>
</tr>
</table>
<p><br />
</p>
<h4><b>
<span><b>Product</b></span>
</b></h4>
<p>この案件に関係する Xojo 製品を選択します。</p>
<p><br />
</p>
<h4><b>
<span><b>Category</b></span>
</b></h4>
<p>カテゴリーを持つ製品もあります。提出案件に最も関係の深いカテゴリーを選択します。</p>
<p><br />
</p>
<h4><b>
<span><b>Case Type</b></span>
</b></h4>
<p>ほとんどの場合、案件はバグか機能要求です。</p>
<p><br />
</p>
<h4><b>
<span><b>Details</b></span>
</b></h4>
<p>案件をより詳細に記述します。バグの場合は、バグを再現する方法を具体的に具体的に記載してください。記載すべき重要な内容は次のとおりです。</p>
<p><br />
</p>
<div>
<p>・発生した問題。</p>
<p>・問題が発生する手順。</p>
<p>・予想していた動作。</p>
</div>
<p><br />
</p>
<p>機能要求の場合は、実現する必要がある内容に関する情報を記載します。具体的な実装の提案は制限するようお願いします。</p>
<p><br />
</p>
<h4><b>
<span><b>Workarounds</b></span>
</b></h4>
<p>問題の回避方法を見つけた場合は、このフィールドに記載してください。同じ問題に遭遇した他のユーザーにとって有用です。</p>
<p><br />
</p>
<h4><b>
<span><b>Attachments</b></span>
</b></h4>
<p>バグを実際に示す最良の方法は、サンプルプロジェクトを添付することです。お忙しい中恐縮ですが、問題を実証するサンプルプロジェクトを構築して案件に添付してください。</p>
<p><br />
</p>
<h4><b>
<span><b>Include System Data</b></span>
</b></h4>
<p>Feedback は、OS、Xojo のバージョン、プラグインなど、システムに関する情報を収集できます。Feedback でこれらの情報を収集することを許可してください。</p>
</div>
</div>
</div>


<div id="calibre_link-60">
<div>
<p><img src="images/000119.jpg" alt="" /></p>
</div>
</div>


<div id="calibre_link-5">
<div>
<div>
<p>
<span>Contents</span>
</p>
<p><br />
</p>
<div>
<p>
<a href="#calibre_link-6">2. 概要</a>
</p>
</div>
<div>
<div>
<p>
<a href="#calibre_link-7">2.1. プロジェクト選択ツール</a>
</p>
<p>
<a href="#calibre_link-8">2.2. ワークスペース</a>
</p>
<p>
<a href="#calibre_link-9">2.3. ナビゲーター</a>
</p>
<p>
<a href="#calibre_link-10">2.4. ウィンドウとウェブページのレイアウトエディタ</a>
</p>
<p>
<a href="#calibre_link-11">2.5. ライブラリとインスペクタ</a>
</p>
<p>
<a href="#calibre_link-12">2.6. コードエディタ</a>
</p>
<p>
<a href="#calibre_link-13">2.7. その他のエディタ</a>
</p>
<p>
<a href="#calibre_link-14">2.8. パネル</a>
</p>
<p>
<a href="#calibre_link-15">2.9. アプリケーションの実行</a>
</p>
<p>
<a href="#calibre_link-16">2.10. プロジェクトの種類、フォーマット、およびテンプレート</a>
</p>
<p>
<a href="#calibre_link-17">2.11. 環境設定とオプション</a>
</p>
<p>
<a href="#calibre_link-18">2.12. キーボードショートカット</a>
</p>
</div>
</div>
</div>
</div>
</div>


<div id="calibre_link-76">
<div>
<div>
<h2 id="calibre_link-7"><b>
<span><b>Section 1</b></span>
<br /><b></b>
プロジェクト選択ツール</b></h2>
<p><br />
</p>
<h3><b>プロジェクト選択</b></h3>
<p>［プロジェクト選択］ウィンドウは、Xojo を起動するたび、および［ファイル］→［新規プロジェクト］の選択時に表示されます。</p>
<p><br />
</p>
<p><img src="images/000048.jpg" alt="Figure 2.1 [プロジェクト選択]ウィンドウ" />
</p>
<p><br />
</p>
<h4><b>新規プロジェクト</b></h4>
<p>［プロジェクト選択］では、作業を行うプロジェクトをすばやく決定できます。新しい空のデスクトップ、ウェブ、コンソール、または iOS プロジェクトの作成を選択することができます。</p>
<p><br />
</p>
<h4><b>最近使用したプロジェクト</b></h4>
<p>最近使用したプロジェクトを表示し、その中のいずれかを選択して開くことができます。</p>
<p><br />
</p>
<h4><b>テンプレート</b></h4>
<p>テンプレートは、Xojo アプリケーションと一緒に Templates フォルダに保存される Xojo プロジェクトです。</p>
<p><br />
</p>
<p>よく使用するモジュール、クラスなどのセットがある場合は、それらをすべて1つのプロジェクトにまとめて Templates フォルダに保存することができます。テンプレートを開くと、すべてのプロジェクト項目がすでに含まれた状態の新規プロジェクトが表示されます。</p>
<p><br />
</p>
<p>Xojo には、サービスアプリケーション、CGI アプリケーション、およびイベント駆動コンソールアプリケーションを作成するためのテンプレートがあります。</p>
<p><br />
</p>
<h4><b>サンプルアプリケーション</b></h4>
<p>［サンプルアプリケーション］セクションでは、Xojo に付属しているサンプルプロジェクトを表示できます。サンプルアプリケーションは、Xojo の特定の特長と機能をどのように使用するのかを実際に示します。</p>
<p><br />
</p>
<p>サンプルアプリケーションを選択すると、サンプルアプリケーションが新規プロジェクトで開かれ、実行、編集、または任意の場所に保存することができます。</p>
<p><br />
</p>
<h4><b>既存のファイルを開く</b></h4>
<p>［既存のファイルを開く］ボタンをクリックすると、既存の Xojo プロジェクトを開くことができます。ファイル選択ダイアログが表示され、開く対象のファイルを選択できます。</p>
<p><br />
</p>
<p>Xojo プロジェクトを（ドックまたはデスクトップ上の）Xojo アプリケーションアイコンにドラッグしたり、Xojo プロジェクトをダブルクリックしたりすることによって、Xojo プロジェクトを開くこともできます。</p>
</div>
</div>
</div>


<div id="calibre_link-98">
<div>
<div>
<h2 id="calibre_link-8"><b>
<span><b>Section 2</b></span>
<br /><b></b>
ワークスペース</b></h2>
<p><br />
</p>
<h3><b>IDE</b></h3>
<p>Xojo は統合開発環境（IDE）です。つまり、Xojo のすべてのコンポーネント（レイアウトエディタ、コードエディタ、コンパイラー、およびデバッガ）は、1つのパッケージに統合されています。従来のプログラミング言語では、これらの項目はそれぞれ別のアプリケーションでした。</p>
<p><br />
</p>
<p><img src="images/000047.jpg" alt="Figure 2.2 ワークスペース" />
</p>
<p><br />
</p>
<p>Xojo を開くと、デフォルトではプロジェクト内のすべての項目が、ワークスペースと呼ばれる1つのウィンドウに整理されます。このウィンドウでは、名前をクリックすることでプロジェクト項目間をナビゲートできます。開いているプロジェクト項目をそれら自体のタブで選択することもできます。</p>
<p><br />
</p>
<p>複数のプロジェクトが同時に開いている場合は、それぞれが独自のワークスペースに表示されます。</p>
<p><br />
</p>
<h3><b>ワークスペース</b></h3>
<p>プロジェクトを選択すると表示されるメインのウィンドウをワークスペースと呼びます。Xojo での開発はすべてこのウィンドウ内で行います。［ファイル］→［新規ワークスペース］を使用すると、1つのプロジェクト用に複数のワークスペースウィンドウを開くことができます。これは、複数のディスプレイで作業する場合に便利です。</p>
<p><br />
</p>
<p>ワークスペースは、次のエリアで構成されます。</p>
<p><br />
</p>
<div>
<p>・ツールバー</p>
<p>・ナビゲーター</p>
<p>・エディタ</p>
<p>・ライブラリ／インスペクタ</p>
<p>・パネル</p>
</div>
<p><br />
</p>
<p>これらのエリアについては、次のセクション以降で説明します。</p>
<p><br />
</p>
<p><img src="images/000071.jpg" alt="Figure 2.3 ワークスペースツールバー" />
</p>
<p><br />
</p>
<h4><b>ワークスペースツールバー</b></h4>
<p>メインウィンドウの上部にあるツールバーをワークスペースツールバーと呼びます。このツールバーには、次のボタンがあります。</p>
<p><br />
</p>
<p>・挿入</p>
<p>プロジェクトまたは選択したプロジェクト項目に追加できる項目のメニューを表示します。</p>
<p><br />
</p>
<p>・前画面</p>
<p>タブに最後に表示した項目に戻る場合に使用します。</p>
<p><br />
</p>
<p>・次画面</p>
<p>タブの次のナビゲーション履歴に進みます。</p>
<p><br />
</p>
<p>・実行</p>
<p>「デバッグモード」でプロジェクトを実行する場合に使用します。</p>
<p><br />
</p>
<p>・ビルド</p>
<p>指定されているプラットフォーム用にアプリケーションのスタンドアロンビルドを作成します。</p>
<p><br />
</p>
<p>・ヘルプ</p>
<p>［言語リファレンス］ウィンドウを表示します。</p>
<p><br />
</p>
<p>・フィードバック</p>
<p>Feedback アプリを開きます。</p>
<p><br />
</p>
<p>・ライブラリ</p>
<p>ライブラリの表示を切り替えます。</p>
<p><br />
</p>
<p>・インスペクタ</p>
<p>ナビゲーターの表示を切り替えます。</p>
<p><br />
</p>
<p>ツールバーは、［表示］→［ツールバーを隠す］を選択して非表示にすることができます。</p>
<p><br />
</p>
<h4><b>全画面モード</b></h4>
<p>OS X 10.7 Lion 以降、ウィンドウの右上にある「全画面」ボタンをクリックすることで、ワークスペースを全画面モードにできます。</p>
<p><br />
</p>
<p><img src="images/000098.jpg" alt="Figure 2.4 [全画面]ボ タン" />
</p>
<p><br />
</p>
<p>全画面モードでは、ウィンドウのタイトルバーとメインメニューバーが非表示になります。メインメニューバーを表示したい場合は、画面の上部にマウスカーソルを移動してください。メニューバーが下に展開されて表示されます。全画面モードを終了するには、メニューバーの全画面アイコンをクリックします。</p>
</div>
</div>
</div>


<div id="calibre_link-19">
<div>
<div>
<h2 id="calibre_link-9"><b>
<span><b>Section 3</b></span>
<br /><b></b>
ナビゲーター</b></h2>
<p><br />
</p>
<h3><b>ナビゲーターとは</b></h3>
<p>ナビゲーターは、プロジェクト内をナビゲートできる左サイドバー上のエリアです。ナビゲーターには［内容］、［実行］、［プロファイル］、および［ビルドの設定］セクションがあります。</p>
<p><br />
</p>
<p><img src="images/000003.jpg" alt="Figure 2.5 ナビゲーター" />
</p>
<p><br />
</p>
<p>
<span>［内容］</span>
 セクションには、［挿入］ボタンまたは［挿入］メニューを使用して追加した、ウィンドウ、ウェブページ、クラス、メニュー、フォルダなどのプロジェクト内の項目が含まれています。</p>
<p><br />
</p>
<p>［内容］セクションでプロジェクト項目をクリックすると、それらを表示または編集できます。</p>
<p><br />
</p>
<p>項目が１つ選択されているとき、矢印キーを使用して項目間を移動できます。</p>
<p><br />
</p>
<p>
<span>［実行］</span>
 セクションは、プロジェクト実行中に［デバッガ］タブにのみ表示されます。</p>
<p><br />
</p>
<p>
<span>［プロファイル］</span>
 セクションは、プロファイラーを有効にしてデバッグモードでアプリを実行し、プロファイラーデータを取得している場合のみ表示されます。</p>
<p><br />
</p>
<p>
<span>［ビルドの設定］</span>
 セクションには、ビルド対象（とそれらの設定）やビルドオートメーションで使用される有効なビルド手順などのビルド関連情報がすべて含まれています。</p>
<p><br />
</p>
<h3><b>フィルタ</b></h3>
<p>ナビゲーターの上部には、［内容］セクションの表示内容をフィルタリングするために使用できるフィルタフィールドがあります。フィルタは、条件に従って特定のプロジェクト項目をすばやく表示するために使用します。たとえば、「AddInvoice」というメソッドがあることはわかっているが、どのクラスまたはウィンドウにあったのか思い出せない場合は、フィルタフィールドに「Add」とだけ入力することができます。すると、名前に「Add」を含むもの（メソッド、コントロール名、定数、プロパティなど）を持つすべてのプロジェクト項目がナビゲーターに表示されます。</p>
<p><br />
</p>
<p><img src="images/000032.jpg" alt="Figure 2.6 [フィルタ]の使用" />
</p>
<p><br />
</p>
<p>ここでプロジェクト項目をクリックし、表示または編集することができます。</p>
<p><br />
</p>
<h3><b>ジャンプバー</b></h3>
<p>ナビゲーターは、階層状のリストを使用して項目を表示します。表示内容のスコープは、ジャンプバーによってコントロールします。デフォルトでは、プロジェクト全体がスコープに含まれるので、ジャンプバーにはプロジェクト名が表示されます。 親である項目をダブルクリックすると、ジャンプバーが変更されて親が表示されます（これをプロジェクト項目の「詳細表示」と言います）。このとき、その子項目だけがナビゲーターに表示されます。</p>
<p><br />
</p>
<p><img src="images/000104.jpg" alt="Figure 2.7 [ジャンプバー]の使用" />
</p>
<p><br />
</p>
<div>
<p>
<span>注</span>
 ：［環境設定］の［ダブルクリックで新しいタブに項目を表示］設定は、この動作を変更します。この設定にチェックを入れておくと、ダブルクリックによって新しいタブに項目が開かれるため、プロジェクト項目の詳細を表示するには［Option］+［⌘］を押しながらダブルクリックします（Windows と Linux では、［Shift］-［Control］を使用します）。</p>
</div>
<p><br />
</p>
<p>履歴全体を表示して履歴内の特定の項目にすばやくジャンプするには、ジャンプバー上で名前をクリックします。</p>
<p>作業する特定の項目だけタブで表示できるので、ジャンプバーはタブと使用すると非常に効果的です。</p>
<p><br />
</p>
<h3><b>内容</b></h3>
<p>［内容］セクションには、プロジェクト内にある項目が表示されます。</p>
<p><br />
</p>
<p>［内容］セクションでプロジェクト項目をクリックすると、それらを表示または編集できます。</p>
<p><br />
</p>
<p>項目が１つ選択されているとき、矢印キーを使用して項目間を移動できます。</p>
<p><br />
</p>
<p>プロジェクト項目の削除、コピー、貼り付けなどの通常の操作を実行できます。プロジェクト項目をドラッグして、構成を変更することや、プロジェクト項目間で移動することもできます。</p>
<p><br />
</p>
<p>たとえば、あるクラスから別のクラスにメソッドをドラッグし、移動することなども可能です。</p>
<p><br />
</p>
<p>また、オブジェクトは複数選択することができます。たとえば、クラスとウィンドウを選択し、フォルダにドラッグすることなどが可能です。</p>
<p><br />
</p>
<p><img src="images/000053.jpg" alt="Figure 2.8 複数項目が選択されたナビゲーター" />
</p>
<p><br />
</p>
<h3><b>実行</b></h3>
<p>プロジェクトを実行すると、［実行］セクションが別のタブに表示されます。これによってアプリ名が見えるようになり、デバッガが表示されます。</p>
<p><br />
</p>
<p><img src="images/000124.jpg" alt="Figure 2.9 新規タブに表示される[実行] セクション" />
</p>
<p><br />
</p>
<p>プロジェクトの別のセクションにナビゲートする場合は、プロジェクト実行中にこのタブをクリックすると、デバッガが表示されます。</p>
<p><br />
</p>
<h3><b>プロファイル</b></h3>
<p>プロファイリングを有効にしてアプリを実行すると、アプリ終了時に［プロファイル］セクションが表示されます。このセクションでは、プロファイル結果をレビューすることができます。</p>
<p><br />
</p>
<p><img src="images/000013.jpg" alt="Figure 2.10 [プロファイル]セクション" />
</p>
<p><br />
</p>
<h3><b>ビルドの設定</b></h3>
<p>［ビルドの設定］セクションは、プロジェクトのビルドと実行に必要な情報を表示および変更するために使用します。</p>
<p><br />
</p>
<p>［ビルド］セクションには、利用可能な各種ビルド OS ターゲットも表示されます。［このコンピュータ］は、デフォルトで選択されており、現在使用しているプラットフォームの設定が含まれています。</p>
<p><br />
</p>
<p>他のターゲットの横にあるチェックボックスをオンにすると、次回プロジェクトをビルドするときに、そのターゲットのビルドが作成されます。インスペクタを使用して設定を変更するには、ビルドターゲット名をクリックします。</p>
<p><br />
</p>
<p>［ビルド］セクションでは、ビルド手順も管理できます。新しいビルド手順は、［挿入］ボタンまたはメニューを使用して追加します。新しいビルド手順は［内容］エリアに追加できますが、［内容］エリアにある間は実行されません。ビルド手順を有効化するには、適切な OS ターゲットにドラッグします。デフォルトの「ビルド」手順の前にある手順はプロジェクトがビルドされる前に実行され、後にある手順はプロジェクトがビルドされた後に実行されます。</p>
<p><br />
</p>
<p>ビルド手順を無効化するには、ターゲットの外にドラッグし、［内容］エリアに戻します。</p>
<p><br />
</p>
<p>Xojo を採用する前のプロジェクトのビルド手順は、プロジェクトを開いたときに自動的に適切なターゲットに保存されます。</p>
<p><br />
</p>
<p><img src="images/000111.jpg" alt="Figure 2.11 Windows でのビルドが選択され、ビルド手順が表示されているビルドターゲット" />
</p>
<p><br />
</p>
<h3><b>タブ</b></h3>
<p>タブは、プロジェクトに対する1つのビューにすぎません。新しいタブを作成すると、新しいナビゲーターとエディタエリアが表示されます。</p>
<p><br />
</p>
<p><img src="images/000083.jpg" alt="Figure 2.12 複数のタブを持つワークスペース" />
</p>
<p><br />
</p>
<p>タブがない場合とまったく同じように、タブ内のどこにでもナビゲートすることができます。すべてがまったく同じように機能します。プロジェクトに対して、複数のビューを表示して、それぞれ異なる情報を表示できるということです。</p>
<p><br />
</p>
<p>タブは、よく使用する項目を表示したままにできる便利な方法であり、特にジャンプバーと組み合わせて使用すると役に立ちます。</p>
<p><br />
</p>
<p>タブでプロジェクト項目を開くには、コンテキストメニューを使用し、［新しいタブで開く］を選択します。［Option］+［⌘］を押しながらプロジェクト項目をダブルクリックして、新しいタブで開くこともできます（Windows と Linux では、［Shift］-［Control］キーを使用します）。ダブルクリック時に新しいタブでプロジェクト項目を開くように設定する環境設定もあります。</p>
<p><br />
</p>
<div>
<p>
<span>注</span>
 ：［環境設定］の［ダブルクリックで新しいタブに項目を表示］設定は、この動作を変更します。この設定にチェックを入れると、ダブルクリックで新しいタブで項目が開きます。［Option］+［⌘］を押しながらプロジェクト項目をダブルクリックすると、その項目の詳細を表示することができます（Windows と Linux では、［Shift］-［Control］キーを使用します）。</p>
</div>
<p><br />
</p>
<p>タブは固定または固定解除することができます。フィルタまたは検索結果をクリックしても固定したタブの内容は変更されません。［場所へ移動］を使用した場合も、タブは変更されません。これらの場合は、新しいタブ（または次に使用できる固定されていないタブ）が使用されます。</p>
<p><br />
</p>
<p>閉じるには、タブの小さい［x］をクリックします。一番左を除くすべてのタブを閉じるには、［Option］（OS X）または［Alt］（Windows または Linux）を押し続けます。</p>
<p><br />
</p>
<p>タブバーに表示できる以上のタブを開くと、［オーバーフロー］アイコンが表示されます。これをクリックすると、ドロップダウンリストが開いて、残りのタブが表示されます。リストからタブを選択すると、現在選択されているタブと置き換えられます。</p>
<p><br />
</p>
<p><img src="images/000058.jpg" alt="Figure 2.13 オーバーフロータブを持つタブバー" />
</p>
<p><br />
</p>
<p>タブ間は［⌘］+［Shift］+［または［⌘］+［Shift］+］を使用して切り替えることができます（最後のタブの次には最初のタブが、最初のタブの前には最後のタブが表示されます）。</p>
<p><br />
</p>
<h3><b>プロジェクト項目の追加</b></h3>
<p>新規プロジェクト項目を追加するには、ツールバーの［挿入］ボタンまたは［挿入］メニューを使用します。</p>
<p><br />
</p>
<p>ライブラリからナビゲーターにコントロールを直接ドラッグして新規プロジェクト項目を追加することもできます。この場合は、コントロールのサブクラスが作成されます。</p>
<p><br />
</p>
<div>
<p>
<span>注</span>
 ：プロジェクト項目に「Xojo」という名前を付けることはできません。</p>
</div>
<p><br />
</p>
<p>Xojo では、次のプロジェクト項目はデスクトッププロジェクトとウェブプロジェクトの両方で共有されます。</p>
<p><br />
</p>
<div>
<p>・クラス</p>
<p>・クラスインタフェース</p>
<p>・コンテナコントロール</p>
<p>・ファイルタイプセット</p>
<p>・フォルダ</p>
<p>・モジュール</p>
<p>・データベース</p>
<p>・ビルド手順</p>
<p>・コピーファイル</p>
<p>・スクリプト</p>
<p>・外部スクリプト</p>
</div>
<p><br />
</p>
<p>次のプロジェクト項目は、デスクトッププロジェクトに固有です。</p>
<p><br />
</p>
<div>
<p>・メニューバー</p>
<p>・レポート</p>
<p>・ツールバー</p>
<p>・ウィンドウ</p>
</div>
<p><br />
</p>
<p>次のプロジェクト項目は、ウェブプロジェクトに固有です。</p>
<p><br />
</p>
<div>
<p>・ウェブページ</p>
<p>・ウェブダイアログ</p>
<p>・ウェブスタイル</p>
</div>
<p><br />
</p>
<h3><b>場所へ移動</b></h3>
<p>名前がわかっている場合は、［場所へ移動］機能で特定のプロジェクト項目にジャンプすることができます。</p>
<p><br />
</p>
<p>［場所へ移動］ウィンドウを表示するには、［プロジェクト］→［場所へ移動］を選択します。ジャンプ先のプロジェクト項目の名前を入力し、［Return］キーを押します（または［移動］をクリックします）。ナビゲーターでその項目が選択されます。</p>
<p><br />
</p>
<p><img src="images/000070.jpg" alt="Figure 2.14 [場所へ移動]ウィンドウ" />
</p>
<p><br />
</p>
<h3><b>印刷</b></h3>
<p>ソースコードは、メニューの［ファイル］→［印刷］を使用して印刷できます。</p>
<p><br />
</p>
<p>プロジェクト項目を選択している場合は、選択した項目だけが印刷されます。</p>
<p><br />
</p>
<p>何も選択していない場合は、プロジェクト全体が印刷されます。</p>
<p><br />
</p>
<h3><b>ナビゲーターでのプロジェクト項目の操作</b></h3>
<p>ナビゲーターでプロジェクト項目を右クリック（OS X では［Control］+クリック）すると、コンテキストメニューを表示できます。コンテキストメニューには、次のオプションが表示されます。</p>
<p><br />
</p>
<div>
<p>・に追加</p>
</div>
<div>
<p>このコマンドは、イベントハンドラ、メソッド、プロパティなどのコード項目をプロジェクト項目に追加するために使用します。</p>
</div>
<p><br />
</p>
<div>
<p>・Inspect</p>
</div>
<div>
<p>プロジェクト項目に対してインスペクタを表示します。</p>
</div>
<p><br />
</p>
<div>
<p>・カット／コピー</p>
</div>
<div>
<p>プロジェクト項目をクリップボードにカットまたはコピーするために使用します。</p>
</div>
<p><br />
</p>
<div>
<p>・貼り付け</p>
</div>
<div>
<p>クリップボードのプロジェクト項目をナビゲーターに貼り付け、プロジェクトに追加します。</p>
</div>
<p><br />
</p>
<div>
<p>・削除</p>
</div>
<div>
<p>プロジェクト項目を削除します。</p>
</div>
<p><br />
</p>
<div>
<p>・Duplicate</p>
</div>
<div>
<p>ナビゲーターでプロジェクト項目のコピーを作成します。</p>
</div>
<p><br />
</p>
<div>
<p>・外部参照ファイルにする／プロジェクトファイル内に取り込む</p>
</div>
<div>
<p>外部項目を使用すると、プロジェクト間でプロジェクト項目を共有できます。プロジェクト項目の共有については、『Xojo での開発』の第5章を参照してください。</p>
</div>
<p><br />
</p>
<div>
<p>・暗号化／復号</p>
</div>
<div>
<p>プロジェクト項目の暗号化と復号については、セクション10の「プロジェクトの種類、フォーマット、およびテンプレート」を参照してください。</p>
</div>
<p><br />
</p>
<div>
<p>・エクスポート</p>
</div>
<div>
<p>プロジェクト項目をファイルにエクスポートするために使用します。エクスポートは、プロジェクト項目を他のユーザーと共有するのに便利な方法です。</p>
</div>
<p><br />
</p>
<div>
<p>・印刷</p>
</div>
<div>
<p>プロジェクト項目のすべてのソースコードを印刷します。</p>
</div>
<p><br />
</p>
<div>
<p>・New Subclass</p>
</div>
<div>
<p>プロジェクト項目を親クラスとして使用する新しいクラスをナビゲーターに作成します。</p>
</div>
<p><br />
</p>
<div>
<p>・インタフェース実装</p>
</div>
<div>
<p>そのクラスに実装するメソッドを含むインタフェースを選択できます。追加するインタフェースを1つ以上選択すると、インタフェースのメソッドがプロジェクト項目に追加されます。インタフェースは、第5章セクション5で説明されます。</p>
</div>
<p><br />
</p>
<div>
<p><img src="images/000018.jpg" alt="Figure 2.15 [インタフェース実装]ウィンドウ" />
</p>
</div>
<p><br />
</p>
<div>
<p>・インスペクタ・ビヘイビア</p>
</div>
<div>
<p>レイアウトに追加するクラスとコントロールのインスペクタで表示されるプロパティをカスタマイズできるインスペクタ・ビヘイビアリストを表示します。カスタムクラスとサブクラスのプロパティを表示し、通常表示されるプロパティを非表示することを選択できます。新しいプロパティは、プロパティのリストの左下にある［+］ボタンを使用して追加します。インスペクタで表示するかどうかを決定するには、プロパティ名の横にあるチェックボックスにチェックを入れるか、チェックを外します。また、表示されるどのプロパティに対してもデフォルト値を指定できます。インスペクタでプロパティを並べ替えたり、グループを変更したりする場合は、リスト内でプロパティをドラッグします。ユーザーがドロップダウンメニューで選択できる値のリストを追加するには、［列挙型の項目］セクションを使用します。</p>
</div>
<p><br />
</p>
<div>
<p><img src="images/000068.jpg" alt="Figure 2.16 [インスペクタ・ビヘイビア]ウィンドウ" />
</p>
</div>
<p><br />
</p>
<div>
<p>・親クラスを編集</p>
</div>
<div>
<p>現在選択中のクラスの親（上位）クラスを表示します。この項目は、サブクラスでのみ表示されます。</p>
</div>
</div>
</div>
</div>


<div id="calibre_link-105">
<div>
<div>
<h2 id="calibre_link-10"><b>
<span><b>Section 4</b></span>
<br /><b></b>
ウィンドウとウェブページのレイアウトエディタ</b></h2>
<p><br />
</p>
<h3><b>ユーザーインタフェースのデザイン</b></h3>
<p>ウィンドウとウェブページのレイアウトエディタは、アプリケーションのユーザーインタフェースをデザインするために主に使用するエディタです。</p>
<p><br />
</p>
<h3><b>レイアウトエリア</b></h3>
<p>レイアウトエリアは、プロジェクトのタイプに応じて、ウィンドウまたはウェブページのどちらかとして表示されます。どちらの場合も、コントロールをレイアウトエリアに追加するには、ライブラリまたはナビゲーターからコントロールをレイアウトエリアにドラッグします。</p>
<p><br />
</p>
<h3><b>ツールバー</b></h3>
<p>レイアウトエディタには固有のツールバーがあります。この後は、使用できる機能を左から右に順番に説明します。</p>
<p><br />
</p>
<p><img src="images/000040.jpg" alt="Figure 2.17 [レイアウトエディタ]のツールバー" />
</p>
<p><br />
</p>
<h4><b>追加</b></h4>
<p>［追加］ボタンは、コードが関連付けられている項目をウィンドウまたはウェブのページに追加するために使用します。次が含まれます。</p>
<p>イベントハンドラ（後述の「<a href="#calibre_link-106">イベントハンドラ</a>
 」のトピックを参照）</p>
<p><br />
</p>
<div>
<p>・メニューハンドラ</p>
<p>・メソッド</p>
<p>・メモ</p>
<p>・プロパティ</p>
<p>・計算型プロパティ</p>
<p>・定数</p>
<p>・委譲</p>
<p>・列挙型</p>
<p>・イベント定義</p>
<p>・外部メソッド</p>
<p>・共有計算型プロパティ</p>
<p>・共有メソッド</p>
<p>・共有プロパティ</p>
<p>・構造体</p>
</div>
<p><br />
</p>
<h4><b>
<span><b>View Layout</b></span>
</b></h4>
<p>これは［View Code］とグループ化された切り替えボタンです。レイアウトを表示している間は、このボタンは選択されています。</p>
<p><br />
</p>
<p>レイアウトを表示していないときにこのボタンをクリックすると、すぐにレイアウトエディタに戻って、最後に作業した項目を表示できます。</p>
<p><br />
</p>
<h4><b>
<span><b>View Code</b></span>
</b></h4>
<p>これは［View Layout］とグループ化された切り替えボタンです。レイアウトを表示している間は、このボタンを使用してコードエディタに切り替えて、最後に編集した項目の位置に戻ることができます。</p>
<p><br />
</p>
<h4><b>
<span><b>Set Default Value</b></span>
</b></h4>
<p>［Set Default Value］ボタンを使用して、さまざまなコントロールのデフォルト値を設定できます。後述の「<a href="#calibre_link-107">デフォルト値</a>
 」のトピックを参照してください。</p>
<p><br />
</p>
<h4><b>位置を固定</b></h4>
<p>［位置を固定］ボタンは、コントロールの位置を固定して移動できないようにします。この機能を使用すると、編集中ユーザーインタフェースが誤って変更されることを防ぐことができます。</p>
<p><br />
</p>
<h4><b>タブ順の表示</b></h4>
<p>タブ順エディタに各コントロールを表示します。レイアウトのコントロールは、エディタリストにタブ順で表示されます。レイアウトのタブ順は、コントロールをドラッグすることで変更できます。</p>
<p><br />
</p>
<p><img src="images/000126.jpg" alt="Figure 2.18 タブ順エディタ" />
</p>
<p><br />
</p>
<h4><b>メジャーを表示</b></h4>
<p>［メジャーを表示］ボタンを使用して、レイアウトをさらにわかりやすく表示します。このボタン<img src="images/000055.jpg" alt="" />
 をクリックして［メジャーを表示］ビューを有効にすると、レイアウト上でマウスを移動したときに、ウィンドウまたはウェブページの上端からコントロールまでの距離など、さまざまな測定値を表示できます。</p>
<p><br />
</p>
<p>複数のコントロールを選択すると、コントロール間の距離など、さまざまな測定値を表示できます。</p>
<p><br />
</p>
<p><img src="images/000066.jpg" alt="Figure 2.19 メジャーを表示" />
</p>
<p><br />
</p>
<h4><b>移動</b></h4>
<p>各種の移動ボタン（［前面に移動］、［最前面に移動］、［背面に移動］、および［最背面に移動］）は、レイアウト上のコントロールの順序を変更します。</p>
<p><br />
</p>
<h4><b>埋める</b></h4>
<p>［幅を埋める］ボタンと［高さを埋める］ボタンは、選択されているコントロールを広げて、コンテナ内の余白を埋めます。</p>
<p><br />
</p>
<h4><b>位置揃え</b></h4>
<p>各種の位置揃えボタン（［左揃え］、［右揃え］、［上揃え］、および［下揃え］）は、レイアウト上のコントロールの位置を揃えます。</p>
<p><br />
</p>
<h4><b>等間隔に並べる</b></h4>
<p>［横方向に並べる］ボタンと［縦方向に並べる］ボタンは、選択されているコントロールを等間隔に揃えます。</p>
<p><br />
</p>
<h3><b>棚</b></h3>
<p>レイアウトに追加されるコントロールの中には、タイマーのように実際にはウィンドウまたはウェブページの一部ではないものもあります。</p>
<p><br />
</p>
<p><img src="images/000069.jpg" alt="Figure 2.20 棚にタイマーが表示されるウィンドウ" />
</p>
<p><br />
</p>
<p>これらの種類のコントロールをレイアウトに追加すると、レイアウトエディタの下部に棚が自動的に表示され、その棚にコントロールが追加されます。</p>
<p><br />
</p>
<p>ウェブアプリケーションでは、ウェブダイアログも棚に表示されます。</p>
<p><br />
</p>
<p>デスクトップアプリケーションでは、ウィンドウに追加されたツールバーが棚に表示されます。</p>
<p><br />
</p>
<h3 id="calibre_link-107"><b>デフォルト値</b></h3>
<p>レイアウトエディタ上のコントロールは、コントロールを選択しながら［Return］キーを押したり、マウスをコントロール上に移動すると表示される<span>鉛筆</span>
 のロールオーバーアイコンをクリックしたり、またはレイアウトエディタツールバーの<span>［Set Default Value］</span>
 ボタンをクリックしたりすることで、デフォルト値を指定することができます。これにより、デフォルト値を入力するポップアウトウィンドウが開きます。たとえば、プッシュボタンの場合は Caption を指定できます。ポップアップウィンドウを閉じるには、［Return］キーを押すか、ポップアップウィンドウの外をクリックするか、またはレイアウトエディタツールバーの［Set Default Value］ボタンをクリックします。</p>
<p><br />
</p>
<p><img src="images/000109.jpg" alt="Figure 2.21 プッシュボタンのデフォルト値を設定" />
</p>
<p><br />
</p>
<h3 id="calibre_link-106"><b>イベントハンドラ</b></h3>
<p>イベントハンドラをコントロールに追加するには、<span>［追加］</span>
 ボタンをクリックして<span>［イベントハンドラ］</span>
 を選択します。</p>
<p><br />
</p>
<p><img src="images/000087.jpg" alt="Figure 2.22 [イベントハンドラの追加]ダイアログ" />
</p>
<p><br />
</p>
<p>これにより、コントロール（または選択した場合はウィンドウまたはWebページ）に使用できるイベントを表示する<span>［イベントハンドラの追加］</span>
 ダイアログが開きます。各イベントをクリックすると、その説明を表示できます。対応するイベントハンドラを作成するには、1つ以上のイベントを選択して<span>［OK］</span>
 をクリックします。［⌘］-［A］（Windows と Linux では［Ctrl］+［A］）を押して、追加するすべてのイベントハンドラを一度に選択することもできます。</p>
<p><br />
</p>
<p>イベントハンドラは、<a href="#calibre_link-9">ナビゲーター</a>
 で、選択されているコントロールの下に表示されます。イベントハンドラをクリックすると、そのコードを表示できます。</p>
<p><br />
</p>
<p><img src="images/000043.jpg" alt="Figure 2.23 イベントハンドラを表示するナビゲーター" />
</p>
<p><br />
</p>
<h3><b>ゲージ</b></h3>
<p>レイアウト上でコントロールを動かすとき、位置決めをしやすくするゲージが表示されます。</p>
<p><br />
</p>
<p>ゲージを無効化するには、［Command］（Windows と Linux では［Control］）を押しながらドラッグします。</p>
<p><br />
</p>
<h3><b>ユーザーコントロール（コントロールサブクラス）</b></h3>
<p>ユーザーコントロール（組み込みコントロールのサブクラス）には、ライブラリのプロジェクトコントロールグループからアクセスすることができます。</p>
<p><br />
</p>
<p>または単に、ナビゲーターからレイアウトエリアにサブクラスをドラッグします。</p>
<p><br />
</p>
<h3><b>レイアウト上のコントロールの操作</b></h3>
<p>レイアウト上でコントロールを右クリック（OS X では［Control］-クリック）すると、コンテキストメニューを表示できます。コンテキストメニューには、次のオプションが表示されます。</p>
<p><br />
</p>
<p>・追加</p>
<p>このコマンドは、サブメニューで［イベントハンドラの追加］を選択し、イベントハンドラをコントロールに追加するために使用します。</p>
<p><br />
</p>
<p>・Inspect</p>
<p>コントロールに対してインスペクタを表示します。</p>
<p><br />
</p>
<p>・カット／コピー</p>
<p>コントロールをカットまたはコピーするために使用します。</p>
<p><br />
</p>
<p>・貼り付け</p>
<p>クリップボードのコントロールをレイアウトに貼り付けます。</p>
<p><br />
</p>
<p>・削除</p>
<p>コントロールを削除します。クリップボードに入れる場合は［カット］を使用します。</p>
<p><br />
</p>
<p>・Duplicate</p>
<p>レイアウト上でコントロールのコピーを作成します。マウスボタンでクリックし、［Command］（Windows と Linux では［Shift］+［Control］）を押しながらマウスをドラッグすることで、コントロールのコピーを作成することもできます。</p>
<p><br />
</p>
<p>・印刷</p>
<p>コントロールのイベントハンドラ内に含まれるすべてのソースコードを印刷します。</p>
<p><br />
</p>
<p>・New Subclass</p>
<p>ナビゲーターでコントロールを親クラスとして使用する新しいクラスを作成します。</p>
<p><br />
</p>
<p>・すべて選択</p>
<p>レイアウト内のすべてのコントロールを選択します。</p>
<p><br />
</p>
<p>・選択する</p>
<p>このサブメニューには、レイアウト上のすべてのコントロールが含まれます。コントロールを名前で検索して選択するか、レイヤ化されているためレイアウトでは見えないコントロールを選択するために使用します。</p>
<p><br />
</p>
<p>・位置を固定／位置固定を解除</p>
<p>レイアウト上の位置にコントロールを固定し、レイアウト編集中に誤って移動されることを防止します。コントロールを移動する場合は、まず固定を解除します。</p>
<p><br />
</p>
<p>・親クラスを編集</p>
<p>コントロールが親クラスを持つ場合に、このコマンドを選択すると、親クラスに直接ジャンプして編集できます。</p>
</div>
</div>
</div>


<div id="calibre_link-41">
<div>
<div>
<h2 id="calibre_link-11"><b>
<span><b>Section 5</b></span>
<br /><b></b>
ライブラリとインスペクタ</b></h2>
<p><br />
</p>
<h3><b>ライブラリ</b></h3>
<p>ライブラリは、レイアウトに追加できるすべてのビルトインコントロールのリストです。ライブラリには、プロジェクトに追加できるすべてのプロジェクト項目も含まれています。</p>
<p><br />
</p>
<p><img src="images/000105.jpg" alt="Figure 2.24 ウェブコントロールを表示するライブラリ" />
</p>
<p><br />
</p>
<p>ライブラリを表示するには、ツールバーの［ライブラリ］ボタンをクリックするか、メニューで［表示］→［ライブラリ］を選択するか、ショートカットキー（OS X では［⌘］-［L］、Windows と Linux では［Ctrl］-［L］）を押します。ライブラリはデフォルトではワークスペースの右側に表示されますが、フローティングパレットとして表示するように環境設定を指定することもできます。</p>
<p><br />
</p>
<p>ライブラリでは、さまざまな方法でコントロールをグループ分けすることができます。デフォルトではコントロールは大きいサイズで表示されますが、ライブラリ上部の小さい「ギア」アイコンを使用して、サイズの変更、グループヘッダーの追加、ソートの変更を行うこともできます。表示設定には次のようなものがあります。</p>
<p><br />
</p>
<div>
<p>・大きいアイコン</p>
<p>・大きいアイコンとラベル</p>
<p>・小さいアイコンとラベル</p>
<p>・大きいアイコンと説明</p>
<p>・グループバナーを表示</p>
<p>・英文字順で並べ替え</p>
</div>
<p><br />
</p>
<p>コントロールの上にマウスを置くと、下部の説明エリアに説明が表示されます。説明を表示する必要がない場合は、このエリアのサイズを変更して非表示にすることができます。</p>
<p><br />
</p>
<p>コントロールを検索することもできます。ライブラリの上部にあるドロップダウンを使用して、特定のグループのコントロールだけを表示することを選択できます。あるいは、同様に上部にある［検索］フィールドを使用して、名前または種類でコントロールをすばやく検索し表示することができます。たとえば、「ボタン」と入力すると、すべてのボタンコントロールが表示されます。</p>
<p><br />
</p>
<p>選択したコントロールがレイアウトエディタでサポートされている場合は、ライブラリからレイアウトエディタにコントロールをドラッグできます。コントロールをナビゲーターに直接ドラッグし、サブクラスを即座に作成することもできます。最後に、コントロールをダブルクリックするだけで、ナビゲーター（サブクラスとして）またはレイアウトエディタのどちらかフォーカスのあるほうにコントロールを追加することもできます。</p>
<p><br />
</p>
<h3><b>インスペクタ</b></h3>
<p>インスペクタは、現在選択されている対象に関する情報を表示します。この情報として、レイアウトエディタ上のコントロール、ナビゲーターのプロジェクト項目、ビルドの設定、コードエディタ使用時のメソッドまたはプロパティに関して、それらのプロパティが表示されます。</p>
<p><br />
</p>
<p>インスペクタは、ワークスペースの右側のスペースをライブラリと共有します。インスペクタを表示するには、ツールバーの［インスペクタ］ボタンをクリックするか、メニューで［表示］→［インスペクタ］を選択するか、ショートカットキー（OS X では［⌘］-［I］、Windows と Linux では［Ctrl］-［I］）を押します。</p>
<p><br />
</p>
<p><img src="images/000091.jpg" alt="Figure 2.25 メソッドのプロパティを表示するインスペクタ" />
</p>
<p><br />
</p>
<p>インスペクタに表示される内容は、選択されている対象によって異なります。レイアウトエディタのコントロールの場合は、選択したコントロールで使用できるすべてのプロパティが表示されます。これらのプロパティは、検索対象を簡単に見つけられるよう、トピックごとにグループ分けされています。</p>
<p><br />
</p>
<p>表示している内容によっては、インスペクタの上部に複数のタブがある場合もあります。より一般的な項目は［ID］タブ、使用されることの少ない（または高度な）項目は［Gear］タブに含まれます。</p>
<p><br />
</p>
<p><img src="images/000125.jpg" alt="Figure 2.26 ウェブツールバーのプロパティを表示するインスペクタ" />
</p>
<p><br />
</p>
<h3><b>パレット</b></h3>
<p>デフォルトでは、ライブラリとインスペクタはウィンドウの右側に表示され、一度にどちらか1つだけが表示されます。メニューの［表示］→［パレット切り替え］を使用すると、ライブラリとインスペクタをすばやく切り替えることができます。</p>
<p><br />
</p>
<p>ライブラリとインスペクタを画面の任意の位置に表示したり、両方を同時に表示したりしたい場合は、環境設定を使用してこれらをパレットとして表示します。</p>
<p><br />
</p>
<p>［環境設定］の［基本設定］エリア（Windows と Linux では［Options］）で、［ライブラリとインスペクタを表示］を［プロジェクトウィンドウ］から［フローティングパレットとして］に変更します。</p>
<p><br />
</p>
<p><img src="images/000020.jpg" alt="Figure 2.27 インスペクタのパレット" />
</p>
<p><br />
</p>
<p><img src="images/000015.jpg" alt="Figure 2.28 ライブラリのパレット" />
</p>
</div>
</div>
</div>


<div id="calibre_link-77">
<div>
<div>
<h2 id="calibre_link-12"><b>
<span><b>Section 6</b></span>
<br /><b></b>
コードエディタ</b></h2>
<p><br />
</p>
<p>アプリケーションをプログラミングするには、次のような組み込みコードエディタで、Xojo プログラミング言語を使用してコードを作成します。</p>
<p><br />
</p>
<p><img src="images/000085.jpg" alt="Figure 2.29 コードエディタ" />
</p>
<p><br />
</p>
<p>コードは、ウィンドウ、ウェブページ、コントロール、クラス、モジュールなど、プロジェクト内のほぼすべての項目に関連付けることができます。</p>
<p><br />
</p>
<h3><b>ツールバー</b></h3>
<p>コードエディタには、左から右に次の機能を備えた独自のツールバーがあります。</p>
<p><br />
</p>
<p><img src="images/000034.jpg" alt="Figure 2.30 コードエディタのツールバーボタン" />
</p>
<p><br />
</p>
<h4><b>追加</b></h4>
<p>［追加］ボタンは、コードが関連付けられている項目をウィンドウまたはウェブのページに追加するために使用します。次が含まれます。</p>
<p><br />
</p>
<div>
<p>・イベントハンドラ</p>
<p>・メニューハンドラ</p>
<p>・メソッド</p>
<p>・メモ</p>
<p>・プロパティ</p>
<p>・計算型プロパティ</p>
<p>・定数</p>
<p>・委譲</p>
<p>・列挙型</p>
<p>・イベント定義</p>
<p>・共有計算型プロパティ</p>
<p>・共有メソッド</p>
<p>・共有プロパティ</p>
<p>・構造体</p>
<p>・Using 節</p>
</div>
<p><br />
</p>
<h4><b>
<span><b>View Layout</b></span>
</b></h4>
<p>このボタンは［View Code］とグループ化された切り替えボタンです。</p>
<p><br />
</p>
<p>コードを表示している間は、このボタンをクリックすると、レイアウトエディタにすばやく戻って、最後に作業していた項目が表示されます。</p>
<p><br />
</p>
<h4><b>
<span><b>View Code</b></span>
</b></h4>
<p>これは［View Layout］とグループ化された切り替えボタンです。コードを表示するときには、このボタンを選択します。</p>
<p><br />
</p>
<p>コードを表示していないときにこのボタンをクリックすると、コードエディタにすばやく戻って、最後に編集していた項目が表示されます。</p>
<p><br />
</p>
<h4><b>コメント化／コメント解除</b></h4>
<p>このボタンは、選択したコードをコードエディタでコメント化するために使用します。コードが選択されていない場合は、現在の行がコメント化されます。</p>
<p><br />
</p>
<p>コードがすでにコメント化されている場合は、そのコードがコメント解除されます。</p>
<p><br />
</p>
<h4><b>項目を分析</b></h4>
<p>現在のプロジェクト項目のソースコードを検証するために使用します。分析では、コンパイルエラーと警告（未使用の変数など）がないかどうかプロジェクト項目が確認されます。</p>
<p><br />
</p>
<p>［分析による警告］ウィンドウを使用すると表示する警告をコントロールすることができます。メニューで［プロジェクト］→［分析による警告］を選択し、表示する警告を選択してください。</p>
<p><br />
</p>
<p><img src="images/000103.jpg" alt="Figure 2.31 [分析による警告]ウィンドウ" />
</p>
<p><br />
</p>
<h3><b>編集機能</b></h3>
<p>コードエディタには、コードを作成しやすくするために設計された機能がいくつかあります。</p>
<p><br />
</p>
<h4><b>構文ハイライト表示</b></h4>
<p>コードエディタは、入力時ソースコードをハイライト表示します。［環境設定］では、キーワード、文字列、整数、コメントなどのデフォルトの色を変更することができます。</p>
<p><br />
</p>
<p><img src="images/000052.jpg" alt="Figure 2.33 「Fol」と入力するとオートコンプリート機能により「FolderItem」と入力される" />
</p>
<p><br />
</p>
<h4><b>自動インデント</b></h4>
<p>コードエディタでは、入力時自動的にコードにインデントが付きます。If/Then、While/Do ループ、Select/Case などのコードやその他のコマンドには、自動的にインデントが付けられます。</p>
<p><br />
</p>
<p><img src="images/000117.jpg" alt="Figure 2.32 構文ハイライト表示および自動インデント" />
</p>
<p><br />
</p>
<p>インデントが付けられたコードは、コードブロックと呼ばれます。コードエディタでは、コードブロックの左に小さい「-」記号が表示されます。これをクリックすることによりコードブロックを折り畳み（「-」記号は「+」に変化）、ブロック内のすべてのコードを非表示にすることができます。コードは単にコードエディタで表示されなくなるだけで、この状態でも実行され、プロジェクトの一部を構成します。</p>
<p><br />
</p>
<p>コードブロックを展開するには、「+」をクリックします。</p>
<p><br />
</p>
<h4><b>自動補完</b></h4>
<p>コードエディタで入力中、入力しているテキストの後に3つの小さい省略記号が表示されることがよくあります。これは、コードエディタにオートコンプリート候補があることを示しています。省略記号が表示されたら、［Tab］キーを押して、オートコンプリートに使用可能なコマンドのリストを表示してください。</p>
<p><br />
</p>
<p>オートコンプリートはインテリジェンスを備えており、コードの文脈に基づいて関係のあるコマンドだけを表示しようとします。</p>
<p><br />
</p>
<h4><b>構文ヘルプ</b></h4>
<p>コードエディタの下部には、構文ヘルプを表示するために使用される小さいエリアがあります。</p>
<p><br />
</p>
<p>構文ヘルプエリアには、マウスカーソルの下にあるコードの構文情報、メソッドシグネチャ、宣言などが表示されます。</p>
<p><br />
</p>
<p><img src="images/000010.jpg" alt="Figure 2.34 構文ヘルプエリア" />
</p>
<p><br />
</p>
<h4><b>コンテキストメニュー</b></h4>
<p>プロジェクトまたは Xojo フレームワーク内の変数、メソッド、プロパティ、クラス、または任意の項目を右クリック（または［Control］+クリック）すると、コンテキストメニューが表示され、次に示すさまざまな便利な機能を選択できます。</p>
<p><br />
</p>
<p>・カット／コピー／貼り付け／削除</p>
<p>通常のカット、コピー、貼り付け、および削除機能を提供します。</p>
<p><br />
</p>
<p>・すべて選択</p>
<p>コードエディタ内のすべてのテキストを選択します。</p>
<p><br />
</p>
<p>・コメントにする</p>
<p>選択されているコードをコメントにします（またはコメントを解除します）。</p>
<p><br />
</p>
<p>・色の挿入</p>
<p>色選択ウィンドウを開いて、色を選択できるようにします。選択した色は、コードエディタに色リテラルとして追加されます。</p>
<p><br />
</p>
<p>・移動</p>
<p>コードエディタで選択した項目の定義にジャンプします。プロジェクトで作成した変数、メソッド、クラスなどに使用できます。<br />
［Command］キー（OS X）または［Control］キー（Windows と Linux）を押しながら変数、メソッド、クラスをダブルクリックすることにより、すばやくジャンプすることもできます。</p>
<p><br />
</p>
<p>・切り替え</p>
<p>別のイベント、メソッド、またはプロパティに切り替えます。</p>
<p><br />
</p>
<p>・フォーマットを標準化する</p>
<p>選択したテキストに標準的なフォーマットルールを適用します。</p>
<p><br />
</p>
<p>・If/End If で囲む</p>
<p>選択したコードを If Then / End If コードブロックで囲みます。</p>
<p><br />
</p>
<p>・Do/Loop で囲む</p>
<p>選択したコードを Do / Loop コードブロックで囲みます。</p>
<p><br />
</p>
<p>・While/Wend で囲む</p>
<p>選択したコードを While / Wend コードブロックで囲みます。</p>
<p><br />
</p>
<p>・メソッドへ変換する</p>
<p>選択したコードを独自のメソッドとして移動し、そのメソッドに切り替えます。</p>
<p><br />
</p>
<p>・定数へ変換する</p>
<p>選択部分を独自の定数定義として移動し、その定数に切り替えます。</p>
<p><br />
</p>
<p>・まだ作成されていないメソッドを作成する</p>
<p>選択したメソッドをメソッド名として使用し、新しいメソッドを作成します。引数を指定している場合は、それらの型がメソッド定義に自動的に追加されます。</p>
<p><br />
</p>
<p>・表示できない文字を消去する</p>
<p>コードのカットと貼り付けを行う際、表示できない ASCII 文字によりコードエディタで混乱が生じる場合があります。このコマンドを使用して、選択したテキストをクリーンアップしてください。</p>
<p><br />
</p>
<p>・ブレイクポイントをオン／オフにする</p>
<p>現在の行のブレイクポイントをオンまたはオフにします。</p>
<p><br />
</p>
<p>・ヘルプ／言語リファレンスを表示</p>
<p>言語リファレンスを開きます。</p>
<p>カーソル位置のコマンドが Xojo コマンドと認識されると、「ヘルプ」が表示され、言語リファレンスのエントリーに直接ジャンプすることができます。</p>
<p><br />
</p>
<h4><b>ツールバー</b></h4>
<p>コードエディタのツールバーには次のボタンがあります。</p>
<p><br />
</p>
<p>・追加</p>
<p>イベントハンドラ、メニューハンドラ、メソッド、プロパティ、メモ、計算型プロパティ、定数、委譲、列挙型、イベント定義、外部メソッド、構造体、共有メソッド、共有プロパティ、および共有計算型プロパティなどのその他のソースコード要素を追加することができます。</p>
<p><br />
</p>
<p>・［コメントにする］</p>
<p>選択されているコードをコメントにします（またはコメントを解除します）。</p>
<p><br />
</p>
<p>・Check for Errors / 選択中の項目を分析する</p>
<p>［選択中の項目を分析する］コマンドを実行し、コンパイルエラーと警告がないかどうか現在のメソッドを確認します。</p>
<p><br />
</p>
<h4><b>便利なキーボードショートカット</b></h4>
<p>コードエディタでの作業で生産性を高めるために役立つキーボードショートカットがいくつかあります。</p>
<p><br />
</p>
<div>
<p>・［Shift］+［Enter］（OS X では［⌘］-［Return］）キーは、コードブロックを補完します。たとえば、「If True」と入力して［Shift］+［Enter］キーを押すと、自動的に「Then」と「End If」が入力されて、それらの間にカーソルが移動します。これは、Select、While、Do、For など、他のコードブロックでも同様に機能します。</p>
<p><br />
</p>
<p>・［Ctrl］+［Enter］（OS X では［Option］-［Enter］）キーは、自動的に「_」文字を追加して、コードを新しい行まで拡張します。</p>
<p><br />
</p>
<p>・［Ctrl］+［\］（［⌘］-［\］）キーは、行のブレイクポイントのオンとオフを切り替えます。</p>
<p><br />
</p>
<p>・［Ctrl］+［'］（［⌘］-［'］）キーは、選択されているコード行、またはコードが選択されていない場合はカーソルがある行をコメント化するか、コメント化を解除します。</p>
<p><br />
</p>
<p>・［Ctrl］（OS X では［⌘］）キーを押しながらメソッド名をダブルクリックすると、ナビゲーターでそのメソッドに移動します。</p>
<p><br />
</p>
<p>・［Tab］キーは、自動補完機能を実行します。テキストを自動補完するグレーのテキストが表示されている場合または自動補完項目を表示する省略記号が表示されている場合に押します。</p>
</div>
<p><br />
</p>
<h3><b>メモエディタ</b></h3>
<p>メモエディタは、プロジェクト項目に関するメモを入力できる簡易的なテキストエディタです。たとえば、プロジェクトの技術ドキュメントを保管するのに適しています。</p>
<p><br />
</p>
<p><img src="images/000012.jpg" alt="Figure 2.35 メモエディタ" />
</p>
</div>
</div>
</div>


<div id="calibre_link-24">
<div>
<div>
<h2 id="calibre_link-13"><b>
<span><b>Section 7</b></span>
<br /><b></b>
その他のエディタ</b></h2>
<p><br />
</p>
<p>大部分の作業をレイアウトエディタおよびコードエディタで実行しますが、ほかにもメニュー、ツールバー、レポート、ファイルタイプセット、およびコンテナ用のエディタがあります。</p>
<p><br />
</p>
<h3><b>メニューエディタ</b></h3>
<p>メニューエディタを使用すると、デスクトッププロジェクトにメニューバー、メニュー、およびメニュー項目を簡単に追加できます。標準デスクトップアプリケーションテンプレートには、アプリケーション全体のデフォルトメニューバーとして使用されるメニューバーが含まれています。デフォルトのメニューバーを使用することも、特定のウィンドウに使用される他のメニューバーを作成することもできます。メニューバーを作成する場合は、メニューバーをウィンドウに割り当てることができます。</p>
<p><br />
</p>
<p><img src="images/000096.jpg" alt="Figure 2.36 メニュー項目[保存]を編集中のメニューエディタ" />
</p>
<p><br />
</p>
<p>デスクトップアプリケーションのデフォルトメニューバーである MainMenuBar には、［ファイル］メニューと［編集］メニューおよびそれぞれの標準的なメニュー項目が含まれています。［ファイル］メニューには、［Exit］（Windows）または［終了］（OS X と Linux）という1つのメニュー項目があります。［Exit］／［終了］メニュー項目のプロパティが指定されているため、このメニュー項目は自動的に機能します。有効化するためにメニュー項目のプロパティを変更する必要や、何かを追加する必要はありません。</p>
<p><br />
</p>
<p>これと同様に、［編集］メニューには［取り消す］、［カット］、［コピー］、［貼り付け］、［削除］、および［すべて選択］メニュー項目が含まれています。</p>
<p><br />
</p>
<p>メニューをドラッグして、並べ替えたり、まったく新しいメニューに移動したりできます。ツールバーには、新しいメニューとメニュー項目を追加する機能があります。</p>
<p><br />
</p>
<p>［カット］、［コピー］、［貼り付け］を使用すると、メニューの他のエリアにメニュー項目を移動およびコピーすることができます。</p>
<p><br />
</p>
<h4><b>ツールバー</b></h4>
<p>ツールバーには次のコマンドがあります。</p>
<p><br />
</p>
<p>・プラットフォームの表示</p>
<p><img src="images/000021.jpg" alt="" />
</p>
<p>ツールバーのプラットフォームアイコンを使用すると、Windows、OS X、および Linux でメニューがどのように表示されるかを確認できます。</p>
<p><br />
</p>
<p>・Create New Top-Level Menu</p>
<p><img src="images/000101.jpg" alt="" />
</p>
<p>メニューバーに最上位レベルのメニューを追加します。</p>
<p><br />
</p>
<p>・Create New Menu Item</p>
<p><img src="images/000051.jpg" alt="" />
</p>
<p>選択した最上位レベルのメニューの下に新しいメニュー項目を作成します。</p>
<p><br />
</p>
<p>・Create Separator</p>
<p><img src="images/000120.jpg" alt="" />
</p>
<p>選択したメニュー項目の下に区切り線項目を作成します。</p>
<p><br />
</p>
<p>・Create Submenu</p>
<p><img src="images/000054.jpg" alt="" />
</p>
<p>選択したメニュー項目の下にサブメニューを作成します。</p>
<p><br />
</p>
<p>・Convert Select Menu to a Top-Level Menu</p>
<p><img src="images/000011.jpg" alt="" />
</p>
<p>このコマンドは、選択したメニュー項目を最上位レベルのメニューに変換するために使用します。</p>
<p><br />
</p>
<h4><b>インスペクタ</b></h4>
<p>インスペクタは、選択したメニューまたはメニュー項目のプロパティを表示します。</p>
<p><br />
</p>
<h3><b>ツールバーエディタ</b></h3>
<p>デスクトッププロジェクトの場合はさらに、ツールエディタを使用して、デスクトップアプリのツールバーを設計します。</p>
<p><br />
</p>
<h4><b>ツールバー</b></h4>
<p><br />
</p>
<p><img src="images/000080.jpg" alt="Figure 2.37 ボタンを編集中のツールバーエディタ" />
</p>
<p><br />
</p>
<p>ツールバーには次のコマンドがあります。</p>
<p><br />
</p>
<p>・プラットフォームの表示</p>
<p><img src="images/000030.jpg" alt="" />
</p>
<p>ツールバーのプラットフォームアイコンを使用すると、Windows、OS X、および Linux でツールバーがどのように表示されるかを確認できます。</p>
<p><br />
</p>
<p>・追加</p>
<p><img src="images/000097.jpg" alt="" />
</p>
<p>ツールバーに新しい項目を追加します。</p>
<p><br />
</p>
<h4><b>インスペクタ</b></h4>
<p>インスペクタは、選択したツールバー項目のプロパティを表示します。</p>
<p><br />
</p>
<h3><b>レポートレイアウトエディタ</b></h3>
<p>レポートレイアウトエディタは、デスクトップアプリのレポートを設計するために使用します。</p>
<p><br />
</p>
<p><img src="images/000075.jpg" alt="Figure 2.38 レポートエディタ" />
</p>
<p><br />
</p>
<h4><b>ツールバー</b></h4>
<p>ツールバーには次のコマンドがあります。</p>
<p><br />
</p>
<p>・Add Group</p>
<p>ボディの周囲に新しいグループセクションを追加します。</p>
<p><br />
</p>
<p>・Add Page Header/Footer</p>
<p>レポートに新しいページヘッダーおよびフッターを追加します。</p>
<p><br />
</p>
<p>・Ordering</p>
<p><img src="images/000129.jpg" alt="" />
</p>
<p>レポート上でのコントロールの順序を指定します。</p>
<p><br />
</p>
<p>・Fill</p>
<p><img src="images/000042.jpg" alt="" />
</p>
<p>レポートコントロールで表示可能なスペースを埋めます。</p>
<p><br />
</p>
<p>・Alignment</p>
<p><img src="images/000017.jpg" alt="" />
</p>
<p>レポートコントロールの位置揃えを調整します。</p>
<p><br />
</p>
<p>・Spacing</p>
<p><img src="images/000127.jpg" alt="" />
</p>
<p>レポートコントロールの間隔を調整します。</p>
<p><br />
</p>
<h4><b>ライブラリとインスペクタ</b></h4>
<p>ライブラリは、レポートのレイアウトに追加できるレポートコントロールを表示します。インスペクタは、選択したレポートコントロールのプロパティを表示します。</p>
<p><br />
</p>
<p><img src="images/000036.jpg" alt="Figure 2.39 ファイルタイプセットエディタ" />
</p>
<p><br />
</p>
<h3><b>ファイルタイプセットエディタ</b></h3>
<p>ファイルタイプセットエディタは、デスクトップアプリケーションがサポートするファイルタイプを定義するために使用します。</p>
<p><br />
</p>
<h4><b>ツールバー</b></h4>
<p>ツールバーには次のコマンドがあります。</p>
<p><br />
</p>
<p><img src="images/000084.jpg" alt="Figure 2.40 追加の標準ファイルタイプを選択するプロンプト" />
</p>
<p><br />
</p>
<p>・Add Custom File Type</p>
<p>アプリのカスタムファイルタイプを追加するために使用します。行をダブルクリックし、インラインエディタを使用して値を追加してください。</p>
<p><br />
</p>
<p>・Add Standard File Type</p>
<p>このボタンは、頻繁に使用する標準ファイルタイプのドロップダウンメニューを表示します。完全な選択リストを含むプロンプトを画面下部に表示するには、メニューの「その他」オプションをクリックします。</p>
<p><br />
</p>
<p>・Remove File Type</p>
<p>このボタンは、選択したファイルタイプをリストから削除するために使用します。</p>
<p><br />
</p>
<h3><b>コンテナコントロールエディタ</b></h3>
<p>コンテナコントロールは、複数のコントロールを1つのコントロールに統合してウィンドウまたはウェブページに追加できる特別なプロジェクト項目です。</p>
<p><br />
</p>
<p>コンテナコントロールエディタは、デスクトッププロジェクト用のウィンドウエディタまたはウェブプロジェクト用のウェブページレイアウトエディタと同様に機能します。</p>
</div>
</div>
</div>


<div id="calibre_link-102">
<div>
<div>
<h2 id="calibre_link-14"><b>
<span><b>Section 8</b></span>
<br /><b></b>
パネル</b></h2>
<p><br />
</p>
<h3><b>概要</b></h3>
<p>ワークスペースの下部には、［検索］、［エラー］、および［メッセージ］パネルを開く3つのボタンがあります。</p>
<p><br />
</p>
<p><img src="images/000064.jpg" alt="Figure 2.42 パネルボタン " />
</p>
<p><br />
</p>
<h3><b>検索</b></h3>
<p>［検索］パネルは、プロジェクト内のテキストを検索（または置換）するために使用します。［検索］フィールドにテキストを入力すると、即座に検索が行われます。スコープコントロールを使用すると、検索スコープを変更できます。「ギア」ボタンを使用すると、一致条件を変更できます。</p>
<p><br />
</p>
<p><img src="images/000049.jpg" alt="Figure 2.41 [検索]パネル" />
</p>
<p><br />
</p>
<p><img src="images/000028.jpg" alt="Figure 2.43 スコープコントロール" />
</p>
<p><br />
</p>
<p>スコープの選択肢は次のとおりです。</p>
<p><br />
</p>
<div>
<p>・グローバル（プロジェクト全体）</p>
<p>・現在のプロジェクト項目</p>
<p>・現在のメソッドまたはイベント（該当する場合）</p>
</div>
<p><br />
</p>
<p>一致条件の選択肢は次のとおりです。</p>
<p><br />
</p>
<p>・単語全体</p>
<p>テキストが1つの単語として出現する場所のみ検索します。</p>
<p>・大文字/小文字を区別</p>
<p>大文字と小文字を区別して検索します。</p>
<p>・RegEx を使用</p>
<p>正規表現を使用して検索します。</p>
<p><br />
</p>
<p>プロジェクト内の検索結果の場所にジャンプするには、検索結果を1回クリックします。［検索］では、ナビゲーターに表示されている項目のみ検索します。フィルタまたはジャンプバーのいずれかを使用してナビゲーターをフィルタリングしている場合、［検索］ではフィルタリング結果として表示されている項目のみ検索します。</p>
<p><br />
</p>
<h3><b>エラー</b></h3>
<p>［エラー］パネルには、コンパイラーエラーと警告が表示されます。このパネルは、コンパイラーエラーが存在する場合に<span>実行</span>
 または<span>ビルド</span>
 を行うと自動的に表示されます。問題をクリックすると、プロジェクト内の問題の場所にジャンプにします。</p>
<p><br />
</p>
<p>警告は、［プロジェクトを分析］または［選択中の項目を分析する］コマンドを使用している場合のみ表示されます。</p>
<p><br />
</p>
<p>［エラー］パネルの上部にあるセレクターを使用すると、種類または場所別にエラーまたは警告を表示するよう選択することができます。</p>
<p><br />
</p>
<p><img src="images/000009.jpg" alt="Figure 2.44 種類別のエラー表示" />
</p>
<p><br />
</p>
<p><img src="images/000118.jpg" alt="Figure 2.45 場所別のエラー表示" />
</p>
<p><br />
</p>
<p>［分析による警告］ウィンドウ（［プロジェクト］→［分析による警告］）を使用すると、表示する警告を選択することができます。</p>
<p><br />
</p>
<h3><b>メッセージ</b></h3>
<p>［メッセージ］パネルは、デバッガを使用してプロジェクトを実行するときに主に使用します。</p>
<p><br />
</p>
<p>プロジェクト実行時には、アプリケーションの起動およびアプリケーションの終了を示すメッセージが自動的に作成されます。このパネルには、追加のシステムメッセージが表示される場合もあります。</p>
<p><br />
</p>
<p>また、System.DebugLog メソッドからの出力も［メッセージ］パネルに表示されるため、アプリケーションは独自のロギングメッセージを生成することができます。</p>
<p><br />
</p>
<p>メッセージは、検索フィールドを使用して検索することができます。［クリア］ボタンは、リスト内のすべてのメッセージを消去します。</p>
<p><br />
</p>
<p><img src="images/000095.jpg" alt="Figure 2.46 [メッセージ]パネル" />
</p>
</div>
</div>
</div>


<div id="calibre_link-94">
<div>
<div>
<h2 id="calibre_link-15"><b>
<span><b>Section 9</b></span>
<br /><b></b>
アプリケーションの実行</b></h2>
<p><br />
</p>
<p>プロジェクトの作業中には、プロジェクトをテストする必要が生じます。この作業は、ツールバーの［実行］ボタンをクリックするか、メニューで［プロジェクト］→［実行］を選択して実行することができます。</p>
<p><br />
</p>
<p>この方法でプロジェクトを実行すると、プロジェクトは<span>デバッグ</span>
 モードで実行されます。このモードでは、Xojo はバックグラウンドでアプリケーションと通信します。ワークスペースには、アプリケーションの名前が付いた新しいタブ（デバッガを含む）が表示されます。</p>
<p><br />
</p>
<p><img src="images/000076.jpg" alt="Figure 2.47 デバッグモードで実行中のアプリケーションを表示するデバッガタブ" />
</p>
<p><br />
</p>
<p>このタブを選択すると、デバッガが表示されます。このタブでは、ナビゲーターが［実行］セクションとデバッグ中のアプリの名前を表示します。</p>
<p><br />
</p>
<h3><b>デバッガ</b></h3>
<p>デバッガを使用すると、アプリケーションがどのように実行されるかを観察できます。</p>
<p><br />
</p>
<p>・スタック</p>
<p>アプリケーション内のコードが呼び出された順序を表示します。</p>
<p><br />
</p>
<p>・変数</p>
<p>変数とその現在の値を表示します。</p>
<p><br />
</p>
<p>・ソースコード</p>
<p>現在実行中のソースコードを表示します。</p>
<p><br />
</p>
<p>スタック、変数、および現在実行中のソースコードを確認するために、ソースコード内にブレイクポイントを設定することや、ツールバーの［一時停止］ボタンをクリックすることができます。</p>
<p><br />
</p>
<h4><b>ツールバー</b></h4>
<p>デバッガツールバーには次のコマンドがあります。</p>
<p><br />
</p>
<p><img src="images/000062.jpg" alt="Figure 2.48 デバッガツールバー" />
</p>
<p><br />
</p>
<p>・一時停止</p>
<p>現在実行中のコード行でアプリを一時停止します。デバッガは、このコード行をグレーでハイライト表示します。</p>
<p><br />
</p>
<p>・停止</p>
<p>実行中のアプリを停止し、デバッガを閉じます。</p>
<p><br />
</p>
<p>・ステップ</p>
<p>一時停止中にコードを1行ずつ実行します。</p>
<p><br />
</p>
<p>・ステップイン</p>
<p>一時停止中に現在のコード行がメソッドの場合、そのメソッド内の最初のコード行にステップインします。</p>
<p><br />
</p>
<p>・ステップアウト</p>
<p>一時停止中にメソッド内にいる場合、そのメソッド内の残りのコードが実行され、メソッド呼び出しの次のコード行でデバッグを一時停止します。</p>
<p><br />
</p>
<p>・View Source</p>
<p>プロジェクト項目に移動し、ソースコードを表示して編集できるようにします。コードに対する変更は、プロジェクトを再度実行してはじめて有効になります。</p>
<p><br />
</p>
<h3><b>デバッガの使用</b></h3>
<p>実行中のコードを見直すためにデバッガを一時停止する手順には、次の3種類があります。</p>
<p><br />
</p>
<p><img src="images/000121.jpg" alt="Figure 2.49 デバッガ" />
</p>
<p><br />
</p>
<div>
<p>・［一時停止］ボタンを使用する。コードを一時停止する場所はコントロールできません。</p>
<p><br />
</p>
<p>・コードにブレイクポイントを設定する。</p>
<p><br />
</p>
<p>・コードで Break コマンドを使用する。</p>
</div>
<p><br />
</p>
<p>デバッガの中に入ると、ソースコードを表示することはできますが、変更することはできません。コードを編集するには、［View Source］ボタンを使用して、プロジェクト内で、編集するコードを検索します。すべての変更は、プロジェクトを再度実行してはじめて有効になります。</p>
<p><br />
</p>
<p>一時停止後、アプリケーションの実行を再開するには、［実行］ボタンの代わりに表示されるツールバーの［一時停止解除］ボタンをクリックします。</p>
<p><br />
</p>
<p><img src="images/000019.jpg" alt="Figure 2.50 [一時停止解除]ボタン" />
</p>
<p><br />
</p>
<p>ツールバーの［停止］ボタンをクリックし、実行中のアプリケーションを完全に停止することもできます。アプリは終了しているため、この場合デバッガは表示されませんが、無限ループなどのプログラミングエラーによりアプリをすぐに停止する必要がある場合は便利です。</p>
<p><br />
</p>
<h4><b>スタック</b></h4>
<p>スタックエリア（左下）には、呼び出された順序でオブジェクトの名前が表示されます。現在のオブジェクトはリストの一番上に表示されます。リスト内の他の項目をクリックすると、以前実行されたコードを表示できます。</p>
<p><br />
</p>
<p><img src="images/000128.jpg" alt="Figure 2.51 スタックエリア" />
</p>
<p><br />
</p>
<p>スタックエリアのポップアップメニューは、通常「メインのスレッド」だけを表示します。スレッディングを明確に使用している場合は、このポップアップを使用して他のスレッドで実行中のコードを観察することができます。</p>
<p><br />
</p>
<h4><b>変数</b></h4>
<p>変数エリア（右下）には、現在実行中のメソッドのローカル変数が表示されます。左列には変数名、右列には変数の値が表示されます。右側の値をクリックすると、さらに詳しい内容を表示できます。（数字や文字列などの）一部の値は、編集することによって後続のコードの結果に影響を与えることができます。</p>
<p><br />
</p>
<p><img src="images/000106.jpg" alt="Figure 2.52 LoadCustomers メソッドを表示中の変数エリア" />
</p>
<p><br />
</p>
<p>クリックして変数の詳細を表示すると、［変数］セクションのポップアップメニューの表示が詳細表示に変わります。このポップアップを使用して、前の変数に戻ることができます。</p>
<p><br />
</p>
<p>また、［変数］セクションの「グローバル」項目を使用すると、モジュールやAppオブジェクトの内容といった、アプリのグローバル値を確認できます。</p>
<p><br />
</p>
<h3><b>ブレイクポイントの設定</b></h3>
<p>コードエディタでは、左マージンのガターにブレイクポイントを設定できるコード行に対応する水平の線が表示されます。ブレイクポイントは、この線をクリックするだけで設定できます。これにより、ブレイクポイントが設定されたことを示す赤い点が表示されます。ブレイクポイントをオフにするには、この赤い点をクリックします。［プロジェクト］→［ブレイクポイント］→［ブレイクポイントを設定する］（OS X では［⌘］+［\］、Windows と Linux では［Ctrl］-［\］）を使用してブレイクポイントを設定することもできます。</p>
<p><br />
</p>
<p>アプリ内のすべてのブレイクポイントを無効化するには、［プロジェクト］→［ブレイクポイント］→［すべてのブレイクポイントを消去］を使用します。プロジェクト内のすべてのブレイクポイントを表示するには、［プロジェクト］→［ブレイクポイント］→［すべてを表示］を選択します。［検索］パネルにブレイクポイントが表示されます。</p>
<p><br />
</p>
<p>Break コマンドを使用してアプリケーションを一時停止することもできます。コードが Break コマンドに到達すると、デバッガがその行で一時停止されます。スタンドアロンアプリでは、Break コマンドは無視されます。</p>
<p><br />
</p>
<p>Break コマンドを使用すると、条件を満たしたときにアプリを一時停止し、特定の状況に基づいてデバッガを有効化することができます。</p>
<p><br />
</p>
<p>たとえば、アプリがループ内にある場合は、特定の値に到達したときだけデバッガを中断したい可能性もあります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>For i As Integer = 1 To 100</p>
<p>If i = 50 Then Break</p>
<p>Next</p>
</div>
<p><br />
</p>
<p><img src="images/000033.jpg" alt="Figure 2.53 LoadCustomers メソッドでのブレイクポイントの設定" />
</p>
</div>
</div>
</div>


<div id="calibre_link-4">
<div>
<div>
<h2 id="calibre_link-16"><b>
<span><b>Section 10</b></span>
<br /><b></b>
プロジェクトの種類、フォーマット、およびテンプレート</b></h2>
<p><br />
</p>
<h3><b>プロジェクト</b></h3>
<p>Xojo プロジェクトは、アプリケーションを構成するすべての項目を含むドキュメントです。プロジェクトは一度に複数開くことができ、プロジェクトごとに複数のウィンドウを開くこともできます。</p>
<p><br />
</p>
<p>新規プロジェクト作成を選択する場合、デスクトップ、ウェブ、またはコンソールから選択することができます。</p>
<p><br />
</p>
<h4><b>デスクトップ</b></h4>
<p>デスクトッププロジェクトでは、グラフィカルユーザーインタフェースを持ち、Windows、OS X、および Linux の各デスクトップ OS で動作するアプリケーションを作成できます。</p>
<p><br />
</p>
<h4><b>ウェブ</b></h4>
<p>ウェブプロジェクトでは、ウェブで動作するアプリケーションを作成できます。ユーザーは、ウェブブラウザを使用してこのアプリケーションを操作します。</p>
<p><br />
</p>
<h4><b>コンソール</b></h4>
<p>コンソールプロジェクトは、コマンドライン、または端末から実行するか、バックグラウンドアプリケーション（サービスまたはデーモン）として実行するテキストベースのアプリケーションを作成するために使用します。</p>
<p><br />
</p>
<h4><b>
<span><b>iOS</b></span>
</b></h4>
<p>iOS プロジェクトは、iPhone や iPad などの iOS デバイスで動作するアプリケーションを作成するために使用します。</p>
<p><br />
</p>
<h3><b>プロジェクトフォーマット</b></h3>
<p>プロジェクトは、バイナリシングルファイルフォーマット（xojo_binary_project）、テキストベースの XML フォーマット（xojo_xml_project）、プロジェクト項目ごとに個別のファイルを使用するテキストベースのフォーマット（xojo_project）などの各種フォーマットで保存できます。</p>
<p><br />
</p>
<div>
<p>
<span>注</span>
 ：Xojo では引き続き Real Studio プロジェクトファイルフォーマットの既存のプロジェクトを開いたり保存したりすることができます。</p>
</div>
<p><br />
</p>
<p>［環境設定］では、デフォルトで使用されるフォーマットを変更することができます。</p>
<p><br />
</p>
<h4><b>バイナリ（<span><b>xojo_binary_project</b></span>
 ）</b></h4>
<p>バイナリファイルフォーマットです。プロジェクトは、配布が容易な1つのファイルに格納されます（画像などの外部項目は除く）。ライセンスなしで使用できる唯一のファイルフォーマットです。</p>
<p><br />
</p>
<h4><b>
<span><b>XML (xojo_xml_project)</b></span>
</b></h4>
<p>XML ファイルフォーマットは、バイナリファイルフォーマットを単に XML で表現したものです。これも単独のファイルですが、すべて XML 形式で記述されています。。XML なので、バイナリとして保存した同じファイルより大きくなる場合があります。</p>
<p><br />
</p>
<h4><b>テキスト（<span><b>xojo_project</b></span>
 ）</b></h4>
<p>テキストファイルフォーマットでは、プロジェクトはプロジェクト項目ごとに別々のテキストファイルに保存されます。このため、必ず各テキストプロジェクトをプロジェクト固有のフォルダに保存してください。複数のテキストプロジェクトを同じフォルダには保存しないでください。</p>
<p><br />
</p>
<p>テキストファイルフォーマットは、変更されたファイルを正確に把握でき、ファイルに対する変更の履歴を追跡できるため、Subversion や Git などのバージョン管理システムで使用するのに最適です。</p>
<p><br />
</p>
<p>このフォーマットでは、プロジェクト項目に次の拡張子を使用します。</p>
<p><br />
</p>
<p>・xojo_code</p>
<p>モジュール、クラス、ウェブページなどのソースコードプロジェクト項目を含む。</p>
<p><br />
</p>
<p>・xojo_window</p>
<p>デスクトッププロジェクトのウィンドウやコンテナコントロールを含む。</p>
<p><br />
</p>
<p>・xojo_menu</p>
<p>デスクトッププロジェクトのメニューを含む。</p>
<p><br />
</p>
<p>・xojo_toolbar</p>
<p>デスクトッププロジェクトのツールバーを含む。</p>
<p><br />
</p>
<p>・xojo_report</p>
<p>デスクトッププロジェクトのレポートを含む。</p>
<p><br />
</p>
<p>・xojo_resources</p>
<p>アイコン、暗号化された項目、その他のバイナリデータなどのバイナリ情報を含む。</p>
<p><br />
</p>
<p>・xojo_uistate</p>
<p>ウィンドウの位置やサイズなどの UI レイアウト設定を含む。</p>
<p><br />
</p>
<p>バージョン管理システムで使用する場合は、xojo_uistate ファイル以外のすべてのファイルをリポジトリーに追加する必要があります。</p>
<p><br />
</p>
<p>テキストプロジェクトフォーマットからファイルやフォルダを削除（またはこれらの名前を変更する）しても、そのファイルやフォルダはバージョン管理ソフトウェアを使用して手動で変更を処理できるようにディスク上に残されます。</p>
<p><br />
</p>
<h4><b>外部項目</b></h4>
<p>常に外部項目として格納され、プロジェクトファイルに含まれないプロジェクト項目もあります。これらは、画像、動画、音声、テキストファイル、およびプロジェクトに追加されたその他のファイルです。</p>
<p><br />
</p>
<p>実際には外部ファイルとして格納されているウィンドウ、クラス、またはモジュールをプロジェクトに含めることも可能です。この機能により、複数のプロジェクトでプロジェクト項目を共有できます。外部プロジェクト項目を変更してプロジェクトを保存すると、変更はディスク上の外部ファイルに書き出されます。同じ共有ファイルを参照する他のプロジェクトを開くと、そのプロジェクトに変更が反映されます。</p>
<p><br />
</p>
<p>プロジェクト項目を外部項目に変換するには、その項目をナビゲーターで選択して右クリック（OS X では［Control］-クリック）し、その項目のコンテキストメニューを表示して［外部参照ファイルにする］を選択します。これにより、［Save File］ダイアログボックスが表示されます。項目を保存するディレクトリにナビゲートし、名前を付け、［保存］をクリックしてください。項目が正常に保存されると、その項目がショートカットバッジとともにナビゲーターに表示されます。名前はイタリックで表示されます。</p>
<p><br />
</p>
<p>プロジェクトに外部項目として項目を追加するには、［Alt］キー（OS X では［Option］+［Command］キー）を押します。［ファイル］→［Import］メニューコマンドが［Import as External］に変わります。このコマンドを選択し、インポートする項目を選択します。ショートカットバッジとともにアイコンがイタリックでナビゲーターに表示され、正しい処理が行なわれたことが確認できます。</p>
<p><br />
</p>
<p>外部プロジェクト項目を書き込み禁止（Windows または Linux）またはロック状態（OS X）に設定すると、その項目を表示することはできますが、プロジェクト内でその項目を変更することはできません。これは、（多くのプロジェクトで共有される場合がある）外部項目を誤って変更しないように保護するために便利です。バージョン管理システムなど Xojo 以外のソフトウェアによってディスク上の外部ファイルが変更された場合は、プロジェクトをいったん閉じた後に再度開いて、その項目を再度読み込む必要があります。</p>
<p><br />
</p>
<h3><b>プロジェクト項目の暗号化</b></h3>
<p>他のユーザーが使用できるようにプロジェクト項目のコピーを配布するが、コードの表示または編集を許可しない場合は、エクスポート前に［暗号化］コマンドを使用してオブジェクトを保護してください。暗号化された項目は、ナビゲーターで右下に小さい鍵が付いたアイコンとともに表示されます。</p>
<p><br />
</p>
<p>プロジェクト内にある場合は、［プロジェクト項目名を暗号化...］コンテキストメニューを使用して、プロジェクト項目を暗号化（保護）または復号（保護を解除）することができます。暗号化された項目は開けず、復号パスワードを知らない場合、その項目に関連付けられたコード（またはレイアウト）にアクセスすることはできません。</p>
<p><br />
</p>
<p><img src="images/000067.jpg" alt="Figure 2.54 [プロジェクト項目の暗号化]ウィンドウ" />
</p>
<p><br />
</p>
<p>項目を暗号化するときは、後で復号するために使用できるパスワードを指定します。パスワードは項目を復号する唯一の方法なので、忘れないようにしてください。</p>
<p><br />
</p>
<h3><b>プロジェクト項目のインポート</b></h3>
<p>プロジェクトで使用するファイルは、デスクトップからドラッグしてナビゲーターにドロップするだけでインポートできます。ファイルが都合の悪いことにデスクトップ上にない場合は、［ファイル］→［Import］を選択します。ファイルへのナビゲートおよびファイルのインポートを可能にする［ファイルを開く］ダイアログボックスが表示されます。</p>
<p><br />
</p>
<p>コードの場合は、コードをインポートするメソッドを開き、デスクトップをドラッグしてメソッドの本体に入れ込みます。［ファイル］→［Import］コマンドを使用してテキストファイルをメソッドの本文にインポートすることはできません。</p>
<p><br />
</p>
<p>プロジェクトにインポートしたファイルを削除するには、削除するファイルをナビゲーターでハイライト表示し、キーボードの［Delete］キーを押すか、［編集］→［削除］を選択します。［Control］を押しながら項目をクリックし、コンテキストメニューで［削除］を選択して、ナビゲーターのファイルを削除することもできます。</p>
<p><br />
</p>
<h3><b>プロジェクト項目のエクスポート</b></h3>
<p>メソッド、イベント、定数、プロパティなどのコードは、デスクトップにテキストクリップとしてドラッグすることや、テキストエディタまたはワープロ（OS X のみ）にドラッグすることができます。当然のことながら、コードをクリップボードにコピーしてテキストエディタまたはワープロに貼り付けることも可能です。</p>
<p><br />
</p>
<p>［エクスポート］メニューコマンドを使用して XML ファイルまたはバイナリファイルフォーマットとしてソースコードをエクスポートすることもできます。これは、コードを共有する場合に便利です。</p>
<p><br />
</p>
<h3><b>テンプレート</b></h3>
<p>すべてのプロジェクトで共通して使用する複数の項目がある場合は、それらを1つのプロジェクトファイルに保存して、そのプロジェクトファイルを新規プロジェクトのテンプレートにすることができます。テンプレートには、カスタムウィンドウ、カスタムクラス、カスタムモジュールなどのプロジェクト項目を含めることができます。</p>
<p><br />
</p>
<p>テンプレートをベースに新規プロジェクトを作成すると、テンプレートの完全なコピーである無題の新しいプロジェクトが作成されます。テンプレートプロジェクト自体は変更されません。このため、元の項目を変更することを心配せずに既存のプロジェクト項目を使用して新規プロジェクトを作成できます。</p>
<p><br />
</p>
<p>テンプレートを最も効率的に使用するには、Xojo と同じディレクトリ内にある「Project Templates」という名前の特別なディレクトリに保存します。この場所に保存した場合、［ファイル］→［新規プロジェクト］を選択すると、テンプレートのリストが［プロジェクト選択］に一覧表示されます。</p>
<p>次にデフォルトで取り込まれるプロジェクトテンプレートについて説明します。これらはビルトインテンプレートですが、これらと同じ名前を付けたテンプレートを Project Templates フォルダに保存すると、ビルトインテンプレートのほうを無効にできます。</p>
<p><br />
</p>
<p>・CGIApplication：Apache サーバーとインタフェース接続するウェブアプリケーションとして機能することに特化したコンソールアプリケーションテンプレートです。このテンプレートの App クラスは、ConsoleApplication クラスをベースとする CGIApplication クラス（プロジェクト内）から派生しています。CGI（共通ゲートウェイインタフェース）は、ウェブアプリケーションが Apache と連動する仕組みです。</p>
<p><br />
</p>
<p>CGIApplication に関するより詳しい注意は、テンプレートプロジェクトの App クラスの「Notes」セクションに記載されています。HTTP モジュールには HTTP 要求を管理するカスタムクラスが含まれています。また、Apache に対するインタフェースを構築するために使用するプロパティとメソッドが含まれています。</p>
<p><br />
</p>
<p>・EmptyService：サービスアプリケーションテンプレートです。この App クラスは、ServiceApplication クラスをベースとしています。また、バックグラウンドで動作し、ユーザーインタフェースはありません。詳細については、言語リファレンスの ServiceApplication クラスの「Notes」セクションを参照してください。</p>
<p><br />
</p>
<p>・Event Driven Console：これもコンソールアプリケーションのテンプレートです。この App クラスも ConsoleApplication クラスがベースです。また、MyApplication というカスタムクラスを含んでいます。このカスタムクラスには、コンソールアプリケーションのシェルメソッドとプロパティが含まれています。コンソールアプリケーションの仕組みについては、言語リファレンスの ConsoleApplication クラスの「Notes」セクションを参照してください。</p>
<p><br />
</p>
<h4><b>デフォルトのデスクトップ、ウェブ、およびコンソールプロジェクトの変更</b></h4>
<p>新しいデスクトップ、ウェブ、またはコンソールプロジェクトを作成すると、作業を開始するための基本事項だけを含む簡単なプロジェクトが開かれます。</p>
<p><br />
</p>
<p>デスクトップ、ウェブ、およびコンソールプロジェクトに使用されるこのシンプルなプロジェクトの代わりに独自のプロジェクトファイルを使用することもできます。</p>
<p><br />
</p>
<p>そのためには、プロジェクトを（バイナリフォーマットで）作成し、デフォルトで含めるプロジェクト項目を追加します。これらは、Project Templates フォルダに次の名前で保存します。</p>
<p><br />
</p>
<div>
<p>・Default Desktop Project</p>
<p>・Default Web Project</p>
<p>・Default Console Project</p>
</div>
<p><br />
</p>
<p>たとえば、2つのウィンドウ、いくつかの標準的なモジュール、およびすべてのプロジェクトで標準的に使用するクラスを持つ Default Desktop Project を作成した場合、［プロジェクト選択］から「Desktop」を選択すればすぐにこれらを使用できます。</p>
</div>
</div>
</div>


<div id="calibre_link-111">
<div>
<div>
<h2 id="calibre_link-17"><b>
<span><b>Section 11</b></span>
<br /><b></b>
環境設定とオプション</b></h2>
<p><br />
</p>
<p>デフォルト動作の変更に使用できる環境設定は複数あります。環境設定は、基本設定、印刷、コード作成、レイアウト、ビルド、およびデバッグにグループ分けされています。</p>
<p><br />
</p>
<p>［環境設定］ウィンドウは、Windows と Linux では［Options］と呼ばれます。</p>
<p><br />
</p>
<h3><b>基本設定</b></h3>
<p>［基本設定］エリアには、最も一般的な環境設定が含まれています。</p>
<p><br />
</p>
<p><img src="images/000016.jpg" alt="Figure 2.55 基本設定" />
</p>
<p><br />
</p>
<h4><b>ライブラリとインスペクタを表示</b></h4>
<p>ライブラリとインスペクタの表示方法を指定します。デフォルトでは、ライブラリとインスペクタはワークスペースの右側に表示され、両方が同じエリアを共有します。画面に両方同時に表示し、ワークスペースのスペースを占有しないように、フローティングパレットとして表示することを選択することもできます。</p>
<p><br />
</p>
<h4><b>標準プロジェクトフォーマット</b></h4>
<p>プロジェクトを保存するとき、デフォルトでは標準的なシングルファイルバイナリフォーマット（xojo_binary_project）が使用されます。このフォーマットは配布しやすいものの、Subversion や Git などのバージョン管理システムでは使用できません。</p>
<p><br />
</p>
<p>この設定は、デフォルトのプロジェクトフォーマットを変更するために使用します。</p>
<p><br />
</p>
<h4><b>ヘルプの検索</b></h4>
<p>Xojo は、言語リファレンスを使用してコマンドを参照します。デフォルトでは、最新情報を得られるようにオンライン言語リファレンスが使用されますが、これにはインターネット接続が必要です。</p>
<p><br />
</p>
<p>言語リファレンスのローカルコピーを使用したい場合は、この設定を変更してください。</p>
<p><br />
</p>
<h4><b>項目のスコープを表示</b></h4>
<p>この設定は、ナビゲーターでプロパティとメソッドのスコープを表示する方法を決定します。［項目文字列の後ろ］を選択すると、スコープの色はナビゲーターで項目の後ろに背景色として表示されます。［アイテムアイコン］を選択すると、ナビゲーターで項目の上にスコープを示すオーバーレイが表示されます。</p>
<p><br />
</p>
<p><img src="images/000031.jpg" alt="Figure 2.56 スコープ:項目文字列の後ろ" />
</p>
<p><br />
</p>
<p><img src="images/000063.jpg" alt="Figure 2.57 スコープ:アイテムアイコン" />
</p>
<p><br />
</p>
<h4><b>最後のウインドウを閉じた時</b></h4>
<p>この設定は、Windows で使用できます。［Xojo はそのまま実行］を選択すると、（システムトレイとも呼ばれる）タスクバーの通知エリアに新しいアイコンが表示され、最後のワークスペースウィンドウを閉じても、Xojo は終了せずに動作し続けます。通知アイコンを右クリックすると、［新規プロジェクト］、［Xojo について］、および［Exit］を含むメニューが表示されます。［新規プロジェクト］は［プロジェクト選択］ウィンドウを開き、［Xojo について］は［Xojo について］ウィンドウを表示し、［Exit］は Xojo を完全に終了します。</p>
<p><br />
</p>
<p><img src="images/000108.jpg" alt="Figure 2.58 [最後のウィンドウを閉じた時]設定" />
</p>
<p><br />
</p>
<p><img src="images/000008.jpg" alt="Figure 2.59 タスクバーの通知エリアに表示される Xojo アイコン" />
</p>
<p><br />
</p>
<h4><b>ナビゲーター</b></h4>
<p>［ダブルクリックで新しいタブに項目を表示］設定は、ナビゲーターでプロジェクト項目をダブルクリックする動作をコントロールします。デフォルト動作は、ジャンプバーを使用したプロジェクト項目の「詳細表示」です。</p>
<p><br />
</p>
<p>ダブルクリック時に新しいタブでプロジェクト項目を開くには、このボックスにチェックを入れてください。</p>
<p><br />
</p>
<p>ナビゲーターでプロパティのデフォルト値を表示するには、［Show default values in navigator］にチェックを入れます。</p>
<p><br />
</p>
<p>［Show types in navigator］にチェックを入れると、ナビゲーターでプロパティの種類が表示されます。</p>
<p><br />
</p>
<h3><b>印刷</b></h3>
<p>［印刷］環境設定は、印刷時にコードがどのように表示されるかをコントロールします。</p>
<p><br />
</p>
<p><img src="images/000044.jpg" alt="Figure 2.60 [印刷]環境設定" />
</p>
<p><br />
</p>
<h4><b>フォント</b></h4>
<p>印刷テキストに使用するフォントを選択します。</p>
<p><br />
</p>
<h4><b>大きさ</b></h4>
<p>印刷テキストに使用するフォントの大きさを選択します。</p>
<p><br />
</p>
<h4><b>カラーで印刷</b></h4>
<p>［コード］環境設定で指定した構文の色を使用してソースコードを印刷する場合は、このボックスにチェックを入れます。</p>
<p><br />
</p>
<h4><b>画面レイアウトの画像も印刷</b></h4>
<p>ユーザーインタフェースレイアウト（ウィンドウとウェブページ）の画像を含めたプリントアウトが必要な場合は、このボックスにチェックを入れます。</p>
<p><br />
</p>
<h3><b>コード</b></h3>
<p>［コード］環境設定は、コードエディタでのコードの表示方法を指定します。</p>
<p><br />
</p>
<p><img src="images/000059.jpg" alt="Figure 2.61 [コード]環境設定" />
</p>
<p><br />
</p>
<h4><b>フォント</b></h4>
<p>使用しているシステムにインストールされている使用可能なフォントのリストから、コードエディタで使用するフォントを選択します。</p>
<p><br />
</p>
<h4><b>大きさ</b></h4>
<p>コードエディタで使用するフォントの大きさを指定します。</p>
<p><br />
</p>
<h4><b>予約語の色</b></h4>
<p>ソースコードの各部分の色をカスタマイズすることができます。特定の構文を選択し、色ボックスをクリックして構文の色を選択します。</p>
<p><br />
</p>
<h4><b>標準のコメント記号</b></h4>
<p>この設定は、［コメント化］ボタンおよびコンテキストメニューのコメント化機能で使用されるコメントのスタイルを決定します。</p>
<p><br />
</p>
<h4><b>自動で補完</b></h4>
<p>この2つのオプションにより、自動補完の機能をコントロールできます。<span>［一般的な大／小文字設定を使用］</span>
 にチェックを入れると、自動補完時に大文字小文字が適切に使い分けられます（たとえば、msgbox ではなく MsgBox となります）。</p>
<p><br />
</p>
<p>
<span>［アイコンを表示］</span>
 にチェックを入れると、自動補完リストの値の横にアイコンが表示されます。</p>
<p><br />
</p>
<h4><b>\"Home\" と \"End\" キー</b></h4>
<p>［Home］キーと［End］キーをどのように機能させるかを決定します。</p>
<p><br />
</p>
<h3><b>レイアウト</b></h3>
<p>［レイアウト］環境設定は、レイアウトエディタの動作を調整します。</p>
<p><br />
</p>
<p><img src="images/000045.jpg" alt="Figure 2.62 [レイアウト]環境設定" />
</p>
<p><br />
</p>
<h4><b>コントロールの標準フォント</b></h4>
<p>デフォルトでは、Xojo はすべてのコントロールのフォントとして System を使用します。この場合、プラットフォームは、実行時に独自のデフォルトフォントを使用できます。特定のフォントを使用する場合は、ここで選択することができます。</p>
<p><br />
</p>
<h4><b>大きさ</b></h4>
<p>デフォルトでは、Xojo はすべてのコントロールのフォントの大きさとして0を使用します。この場合、プラットフォームは、実行時に独自のデフォルトフォントの大きさを使用できます。特定のフォントの大きさを使用する場合は、ここで設定することができます。</p>
<p><br />
</p>
<h4><b>コントロールの選択時</b></h4>
<p>コントロールをネストしている（あるコントロールを別のコントロールの上に重ねている）場合、レイアウトエディタは親コントロールを赤い輪郭線で強調表示します。強調表示をしない場合は、ここでオフにすることができます。</p>
<p><br />
</p>
<h3><b>ビルド</b></h3>
<p>［ビルド］環境設定は、アプリケーションのビルド時または実行時における Xojo の動作をコントロールします。</p>
<p><br />
</p>
<p><img src="images/000057.jpg" alt="Figure 2.63 [ビルド]環境設定" />
</p>
<p><br />
</p>
<h4><b>アプリケーションの表示</b></h4>
<p>アプリケーションをビルドした後、Xojo は Finder または Explorer を使用してビルドしたアプリ内の場所を表示することができます。</p>
<p><br />
</p>
<h4><b>既にファイルがある場合</b></h4>
<p>アプリケーションのビルド時、Xojo は通常ビルドした既存のアプリケーション（と関連ファイル）を自動的に置き換えます。ファイルが上書きされるときにプロンプトを表示させる場合は、ここで設定を変更できます。</p>
<p><br />
</p>
<h4><b>未保存プロジェクトのビルド先</b></h4>
<p>未保存のプロジェクトをビルドしようとすると、ビルドしたアプリケーションがここで指定した場所に格納されます。</p>
<p><br />
</p>
<h3><b>デバッグ</b></h3>
<p>［デバッグ］環境設定は、リモートデバッグをコントロールするために使用します。</p>
<p><br />
</p>
<p><img src="images/000102.jpg" alt="Figure 2.64 [デバッグ]環境設定" />
</p>
<p><br />
</p>
<h4><b>ネットワークインタフェース</b></h4>
<p>リモートデバッガへの接続に使用するネットワーキングインタフェースを指定します。</p>
<p><br />
</p>
<h4><b>リモートデバッグのホスト</b></h4>
<p>ここでは、リモートデバッグを行う場所を追加、編集、または削除することができます。</p>
<p><br />
</p>
<h4><b>変数リストにオブジェクト<span><b>ID</b></span>
 を表示</b></h4>
<p>デバッガ変数エリアにオブジェクト ID を表示します。</p>
<p><br />
</p>
<h3><b>プロキシ</b></h3>
<p>［プロキシ］環境設定は、Xojo がサーバーに接続してライセンスを検証できるように、プロキシ情報を指定するために使用します。この設定は、Xojo に「ログイン」するときに使用します。</p>
<p><br />
</p>
<p><img src="images/000004.jpg" alt="Figure 2.65 [プロキシ]環境設定" />
</p>
<p><br />
</p>
<p>指定されているプロキシサーバーの使用を有効化するには、［プロキシサーバーを利用して接続］チェックボックスを選択します。適切なフィールドに値を入力し、プロキシサーバーの場所、および認証に必要な情報を指定します。</p>
<p><br />
</p>
<h3><b>最新版</b></h3>
<p>［最新版］環境設定では、Xojo が新しいバージョンを確認する頻度を選択できます。サーバーへのシステム情報の送信を許可するかどうかも指定できます。</p>
<p><br />
</p>
<p><img src="images/000027.jpg" alt="Figure 2.66 [最新版]環境設定" />
</p>
</div>
</div>
</div>


<div id="calibre_link-99">
<div>
<div>
<h2 id="calibre_link-18"><b>
<span><b>Section 12</b></span>
<br /><b></b>
キーボードショートカット</b></h2>
<p><br />
</p>
<h3><b>基本設定</b></h3>
<p>IDE のユーザーインタフェースの状態の読み込みを防止するには、［Alt］（Windows）、［Shift］（Linux）、または［Option］（OS X）を押し続けます。この操作により、タブは読み込まれず、Xojo が標準的なウィンドウの大きさに設定されます。</p>
<p><br />
</p>
<h3><b>コードエディタ</b></h3>
<p>コードエディタでの作業時に生産性を高めるうえで有用なキーボードショートカットがいくつか用意されています。</p>
<p><br />
</p>
<div>
<p>・［Shift］+［Enter］（OS X では［⌘］-［Return］）キーは、コードブロックを補完します。たとえば、「If True」と入力して［Shift］+［Enter］キーを押すと、自動的に「Then」と「End」が入力されて、それらの間にカーソルが移動します。これは、Select、While、Do、For など、他のコードブロックでも同様に機能します。</p>
<p><br />
</p>
<p>・［Ctrl］+［Enter］（OS X では［Option］-［Enter］）キーは、自動的に「_」文字を追加して、コードを新しい行まで拡張します。</p>
<p><br />
</p>
<p>・［Ctrl］+［\］（［⌘］-［\］）キーは、行のブレイクポイントのオンとオフを切り替えます。</p>
<p><br />
</p>
<p>・［Ctrl］+［'］（［⌘］-［'］）キーは、選択されているコード行、またはコードが選択されていない場合はカーソルがある行をコメント化するか、コメント化を解除します。</p>
<p><br />
</p>
<p>・［Ctrl］（OS X では［⌘］）キーを押しながらメソッド名をダブルクリックすると、ナビゲーターでそのメソッドに移動します。</p>
<p><br />
</p>
<p>・［Tab］キーは、自動補完機能を実行します。テキストを自動補完するグレーのテキストが表示されている場合または自動補完項目を表示する省略記号が表示されている場合に押します。</p>
</div>
<p><br />
</p>
<h3><b>メニュー</b></h3>
<p>Xojo が使用するメニューのキーボードショートカットすべてを以下に示します。</p>
<p><br />
</p>
<table>
<tr>
<th colspan="3"><b>ファイルメニュー</b></th>
</tr>
<tr>
<th><b>Windows / Linux キー</b></th>
<th><b>OS X<br /><b></b>
キー</b></th>
<th><b>コマンド</b></th>
</tr>
<tr><td></td>
<td>⌘-,</td>
<td>Open Preferences/Options</td>
</tr>
<tr><td></td>
<td>⌘-Q</td>
<td>Quit/Exit Xojo</td>
</tr>
<tr>
<td>Ctrl+N</td>
<td>⌘-N</td>
<td>Open Project Chooser</td>
</tr>
<tr>
<td>Ctrl+Shift+N</td>
<td>⇧-⌘-N</td>
<td>Open New Workspace</td>
</tr>
<tr>
<td>Ctrl+T</td>
<td>⌘-T</td>
<td>Open New Tab</td>
</tr>
<tr>
<td>Ctrl+O</td>
<td>⌘-O</td>
<td>Open Project File</td>
</tr>
<tr>
<td>Ctrl+W</td>
<td>⌘-W</td>
<td>タブを閉じる</td>
</tr>
<tr>
<td>Ctrl+Shift+W</td>
<td>⇧-⌘-W</td>
<td>ウインドウを閉じる</td>
</tr>
<tr>
<td>Ctrl+S</td>
<td>⌘-S</td>
<td>Save Project</td>
</tr>
<tr>
<td>Ctrl+Shift+S</td>
<td>⇧-⌘-S</td>
<td>Save As Project</td>
</tr>
<tr>
<td>Ctrl+P</td>
<td>⌘-P</td>
<td>Print</td>
</tr>
<tr><td></td>
<td>⇧-⌘-P</td>
<td>Print Setup</td>
</tr>
</table>
<p><br />
</p>
<table>
<tr>
<th colspan="3"><b>編集メニュー</b></th>
</tr>
<tr>
<th><b>Windows / Linux キー</b></th>
<th><b>OS X<br /><b></b>
キー</b></th>
<th><b>コマンド</b></th>
</tr>
<tr>
<td>Ctrl+Z</td>
<td>⌘-Z</td>
<td>取り消す</td>
</tr>
<tr>
<td>Ctrl+Y</td>
<td>⇧-⌘-Z</td>
<td>Redo</td>
</tr>
<tr>
<td>Ctrl+X</td>
<td>⌘-X</td>
<td>Cut</td>
</tr>
<tr>
<td>Ctrl+C</td>
<td>⌘-C</td>
<td>コピー</td>
</tr>
<tr>
<td>Ctrl+V</td>
<td>⌘-V</td>
<td>貼り付け</td>
</tr>
<tr>
<td><img src="images/000089.gif" alt="DEL" />
</td>
<td><img src="images/000089.gif" alt="DEL" />
</td>
<td>削除</td>
</tr>
<tr>
<td>Ctrl+D</td>
<td>⌘-D</td>
<td>Duplicate</td>
</tr>
<tr>
<td>Ctrl+A</td>
<td>⌘-A</td>
<td>すべて選択</td>
</tr>
<tr>
<td>Ctrl+Shift+A</td>
<td>⇧-⌘-A</td>
<td>Deselect All</td>
</tr>
<tr>
<td>Ctrl+'</td>
<td>⌘-'</td>
<td>Comment</td>
</tr>
<tr>
<td>⏎（改行）</td>
<td>⏎（改行）</td>
<td>デフォルト値を設定する</td>
</tr>
<tr>
<td>Ctrl+F</td>
<td>⌘-F</td>
<td>検索</td>
</tr>
</table>
<p><br />
</p>
<table>
<tr>
<th colspan="3"><b>挿入メニュー</b></th>
</tr>
<tr>
<th><b>Windows / Linux キー</b></th>
<th><b>OS X キー</b></th>
<th><b>コマンド</b></th>
</tr>
<tr>
<td>Ctrl+Shift+E</td>
<td><img src="images/000115.gif" alt="option" />
 -⌘-E</td>
<td>イベントハンドラ</td>
</tr>
<tr>
<td>Ctrl+Shift+H</td>
<td></td>
<td>メニューハンドラ</td>
</tr>
<tr>
<td>Ctrl+Shift+M</td>
<td><img src="images/000115.gif" alt="option" />
 -⌘-M</td>
<td>メソッド</td>
</tr>
<tr><td></td>
<td><img src="images/000115.gif" alt="option" />
 -⌘-N</td>
<td>メモ</td>
</tr>
<tr>
<td>Ctrl+Shift+P</td>
<td><img src="images/000115.gif" alt="option" />
 -⌘-P</td>
<td>プロパティ</td>
</tr>
<tr>
<td>Ctrl+Shift+C</td>
<td><img src="images/000115.gif" alt="option" />
 -⌘-C</td>
<td>Constant</td>
</tr>
</table>
<p><br />
</p>
<table>
<tr>
<th colspan="3"><b>プロジェクトメニュー</b></th>
</tr>
<tr>
<th><b>Windows / Linux キー</b></th>
<th><b>OS X キー</b></th>
<th><b>コマンド</b></th>
</tr>
<tr>
<td>Ctrl+R</td>
<td>⌘-R</td>
<td>実行</td>
</tr>
<tr>
<td>Ctrl+Shift+R</td>
<td>⇧-⌘-R</td>
<td>デバッグ停止</td>
</tr>
<tr>
<td>Ctrl+Alt+R</td>
<td><img src="images/000115.gif" alt="option" />
 -⌘-R</td>
<td>リモート端末で実行</td>
</tr>
<tr>
<td>Ctrl+Shift+O</td>
<td>⇧-⌘-O</td>
<td>Step Over</td>
</tr>
<tr>
<td>Ctrl+Shift+I</td>
<td>⇧-⌘-I</td>
<td>Step Into</td>
</tr>
<tr>
<td>Ctrl+Shift+T</td>
<td>⇧-⌘-T</td>
<td>ステップアウト</td>
</tr>
<tr>
<td>Ctrl+\</td>
<td>⌘-\</td>
<td>ブレイクポイントを設定する/<br />
ブレイクポイントを解除する</td>
</tr>
<tr>
<td>Ctrl+K</td>
<td>⌘-K</td>
<td>プロジェクトを分析</td>
</tr>
<tr>
<td>Ctrl+B</td>
<td>⌘-B</td>
<td>アプリケーションのビルド</td>
</tr>
<tr><td></td>
<td>Option-⌘-F</td>
<td>検索へ移動</td>
</tr>
<tr>
<td>Ctrl+Shift+L</td>
<td>⇧-⌘-L</td>
<td>場所へ移動</td>
</tr>
</table>
<p><br />
</p>
<table>
<tr>
<th colspan="3"><b>表示メニュー</b></th>
</tr>
<tr>
<th><b>Windows / Linux キー</b></th>
<th><b>OS X キー</b></th>
<th><b>コマンド</b></th>
</tr>
<tr>
<td>Ctrl+E</td>
<td>⌘-E</td>
<td>Go to Layout / Code Editor</td>
</tr>
<tr>
<td>Ctrl+L</td>
<td>⌘-L</td>
<td>ライブラリ</td>
</tr>
<tr>
<td>Ctrl+I</td>
<td>⌘-I</td>
<td>インスペクタ</td>
</tr>
</table>
<p><br />
</p>
<table>
<tr>
<th colspan="3"><b>ウィンドウメニュー</b></th>
</tr>
<tr>
<th><b>Windows / Linux キー</b></th>
<th><b>OS X キー</b></th>
<th><b>コマンド</b></th>
</tr>
<tr><td></td>
<td>⌘-M</td>
<td>Minimize</td>
</tr>
<tr>
<td>Ctrl+Tab</td>
<td>⌘-}</td>
<td>次のタブ</td>
</tr>
<tr>
<td>Ctrl+Shift+Tab</td>
<td>⌘-{</td>
<td>前のタブ</td>
</tr>
<tr><td></td>
<td>⌘-1..5</td>
<td>Select Window</td>
</tr>
</table>
<p><br />
</p>
<table>
<tr>
<th colspan="3"><b>ヘルプメニュー</b></th>
</tr>
<tr>
<th><b>Windows / Linux キー</b></th>
<th><b>OS X キー</b></th>
<th><b>コマンド</b></th>
</tr>
<tr>
<td>F1</td>
<td></td>
<td>言語リファレンス</td>
</tr>
</table>
<hr />
</div>
</div>
</div>


<div id="calibre_link-103">
<div>
<p><img src="images/000093.jpg" alt="" /></p>
</div>
</div>


<div id="calibre_link-92">
<div>
<div>
<p>
<span>CONTENTS</span>
</p>
<p><br />
</p>
<div>
<p>
<a href="#calibre_link-26">3. Xojo プログラミング言語</a>
</p>
</div>
<div>
<div>
<p>
<a href="#calibre_link-84">3.1. 命名規則</a>
</p>
<p>
<a href="#calibre_link-85">3.2. 変数と定数</a>
</p>
<p>
<a href="#calibre_link-86">3.3. データの型と保存</a>
</p>
<p>
<a href="#calibre_link-87">3.4. データのコレクション</a>
</p>
<p>
<a href="#calibre_link-88">3.5. 比較</a>
</p>
<p>
<a href="#calibre_link-89">3.6. 分岐</a>
</p>
<p>
<a href="#calibre_link-90">3.7. ループ</a>
</p>
<p>
<a href="#calibre_link-91">3.8. メソッド</a>
</p>
</div>
</div>
</div>
</div>
</div>


<div id="calibre_link-37">
<div>
<div>
<h2 id="calibre_link-84"><b>
<span><b>Section 1</b></span>
<br /><b></b>
命名規則</b></h2>
<p><br />
</p>
<p>次のセクション以降では、変数、定数、メソッド、モジュール、クラスなどの作成方法を学習します。これらの項目はすべて、次に示される同じ命名標準に従います。</p>
<p><br />
</p>
<div>
<p>・名前の最初の文字は ASCII 文字（A ～ Z）または（a ～ z）にしなければなりません。</p>
<p>・2文字目以降には、次のいずれかの文字を含めることができます。</p>
</div>
<div>
<div>
<p>・英数字の ASCII 文字（A ～ Z、a ～ z、0 ～ 9）</p>
<p>・アンダースコア（_）</p>
<p>・コードポイントが127より大きい Unicode 文字</p>
</div>
</div>
<div>
<p>・名前の長さは自由です。</p>
<p>・名前では大文字と小文字は区別されません（<span>age</span>
 と<span>Age</span>
 は同じです。）</p>
</div>
<p><br />
</p>
<p>無効な文字を使用した場合は、プロジェクトを実行しようとしたときにコンパイルエラーが発生します（通常、構文エラーとして報告されます）。インスペクタを使用して指定した名前の場合は、名前が無効で、前の名前に戻されることを示すプロンプトが表示されます。</p>
</div>
</div>
</div>


<div id="calibre_link-68">
<div>
<div>
<h2 id="calibre_link-85"><b>
<span><b>Section 2</b></span>
<br /><b></b>
変数と定数</b></h2>
<p><br />
</p>
<h3><b>情報の記憶</b></h3>
<p>コンピュータのメモリには、一時メモリと永久メモリの2種類があります。一時メモリは、コンピュータがオンであるかぎり情報を記憶するために使用されます。コンピュータをオフに（または再起動）すると、一時メモリの内容はすべて失われます。一時メモリは、大抵の場合 RAM（ランダムアクセスメモリ）と呼ばれます。</p>
<p><br />
</p>
<p>永久メモリは、コンピュータをオフにした後もデータを記憶します。この種類のメモリは、一般的に、ハードディスク、ソリッドステートディスク、またはフラッシュメモリです。永久メモリには、ファイルを使用してデータを保存します。これについては、『Xojo のフレームワーク』で説明されています。</p>
<p><br />
</p>
<p>プログラム作成時には、データを記憶する必要性がしばしば生じます。一時メモリに情報を格納するには、変数と呼ばれる概念を使用します。変数は、カウンタ値、フィールド値、プログラム実行中に必要な他のすべてのデータなどの情報を保持するのに適しています。</p>
<p><br />
</p>
<p>変数に含まれる値はプログラムによって変更される可能性があり、その結果値が変化し得るため、「変数」という言葉が使用されます。</p>
<p><br />
</p>
<h3><b>変数</b></h3>
<p>変数は値を格納する最もシンプルな方法です。すべての変数は Dim 文を使用してコード内で宣言します。各変数は使用する前に宣言する必要があります。変数を宣言するときには、変数に含めることができるデータの型を指定します。</p>
<p><br />
</p>
<p>変数宣言は、Dim キーワード、変数名、およびデータ型の3つの部分で構成されます。変数宣言の例を次に示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim age As Integer</p>
</div>
<p><br />
</p>
<p>使用可能な単純なデータ型は、<span>文字列、整数、倍精度、通貨、ブール型、</span>
 および<span>色</span>
 です。データ型については、次のセクションの「データの型と保存」で取り上げます。</p>
<p><br />
</p>
<p>変数を宣言した後は、次のように変数に値を代入することができます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim age As Integer</p>
<p>age = 42</p>
</div>
<p><br />
</p>
<p>変数は、最初の使用よりも前である限り、メソッドの内のどこででも宣言できます。</p>
<p><br />
</p>
<p>同じ型の変数が複数ある場合は、次のように1つの Dim 文ですべてを宣言できます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim i, j, k As Integer</p>
</div>
<p><br />
</p>
<p>異なる型の複数の変数を宣言する場合も、1つの Dim 文で宣言できます。たとえば、次の Dim 文は有効です。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim Name, Address as String, ShoeSize As Integer</p>
</div>
<p><br />
</p>
<p>Dim 文で変数を作成するときに、値を割り当てることもできます。このためには、データ型に続けて等号と値を記述します。次に例を示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim i As Integer = 1</p>
<p>Dim Name As String = "Igor", Address As String = "15 Rue de Vallee"</p>
</div>
<p><br />
</p>
<p>初期値のある変数と初期値のない変数を次のように混在させることもできます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim a As Integer, b As Integer = 15</p>
</div>
<p><br />
</p>
<p>この場合は、変数 a を整数として宣言していますが、値は割り当てていません。a の値を調べると、0です。これに対して、変数 b の値は15です。</p>
<p><br />
</p>
<p>また、次の記述も有効です。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim a, b, c As Integer = 15</p>
</div>
<p><br />
</p>
<p>この文は、3つの整数変数を宣言し、すべてに値15を割り当てます。この記述は有効ですが、割り当ての経緯を見失いやすいので、1つの Dim 文で 複数の変数に値を割り当てる場合は注意が必要です。</p>
<p><br />
</p>
<h3><b>変数へのアクセス</b></h3>
<p>変数には、それが宣言されたメソッド内でのみアクセスできます。メソッドが終了すると、変数の値を格納するために使用されていたメモリをその他の用途に使用できるようになります。つまり、この変数値にアプリケーション内の別のメソッドはアクセスできません。</p>
<p><br />
</p>
<p>変数などにアクセスできる範囲を説明するには、「スコープ」という言葉が使用されます。メソッド内で宣言した変数と定数は、そのメソッドのみがローカルに使用できるので、いわゆるローカルスコープを持っています。</p>
<p><br />
</p>
<p>コードブロック内部で変数または定数を宣言する場合（If 文、Select 文、任意のループ文など）、その変数または定数のスコープは、メソッド全体ではなくコードブロックに対してローカルになります。</p>
<p><br />
</p>
<p>たとえば、次のように記述できます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>If x &gt; 5 Then</p>
<p>Dim y As Integer</p>
<p>y = 10</p>
<p>End If</p>
<p><br />
</p>
<p>// y goes out of scope here; the</p>
<p>variable name y can now be reused.</p>
<p>// It is redeclared as a string in the following If statement</p>
<p>If x &lt; 5 Then</p>
<p>Dim y As String</p>
<p>y = "hello"</p>
<p>End If</p>
</div>
<p><br />
</p>
<p>別の変数を使用して変数に値を割り当てることもできます。これによって元の変数が影響を受けることはありません。</p>
<p><br />
</p>
<p>単純なデータ型を使用する場合は、元の変数内のデータのコピーを新しい変数が取得します。新しい変数を変更しても、元の変数の値は変更されません。</p>
<p><br />
</p>
<p>オブジェクト変数でクラス参照を処理する方法については、「クラス」の章を参照してください。</p>
<p><br />
</p>
<p>この例では文字列変数を作成し、作成した変数に値を割り当て、その値を別の文字列変数に割り当てます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim s As String = "hello"</p>
<p><br />
</p>
<p>Dim s2 As String</p>
<p>s2 = s // s2 now contains "hello"</p>
<p>MsgBox(s2)</p>
<p><br />
</p>
<p>// Changing s2 does not affect s</p>
<p>s2 = "world"</p>
<p>MsgBox(s2)</p>
<p><br />
</p>
<p>// s still contains "hello"</p>
<p>MsgBox(s)</p>
</div>
<p><br />
</p>
<h3><b>定数</b></h3>
<p>定数の動作は変数と似ていますが、宣言時に型を指定しないことと、設定後は値を変更できないという2つの大きな違いがあります。</p>
<p><br />
</p>
<p>定数宣言の例を次に示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Const pi = 3.14159</p>
<p>Const value = 256*10</p>
<p><br />
</p>
<p>Const kDefault = "DefaultName"</p>
</div>
<p><br />
</p>
<p>定数には定数値または定数式の結果のみを割り当てることができます。</p>
</div>
</div>
</div>


<div id="calibre_link-23">
<div>
<div>
<h2 id="calibre_link-86"><b>
<span><b>Section 3</b></span>
<br /><b></b>
データの型と保存</b></h2>
<p><br />
</p>
<p>プログラミングコードの実行を高速化したり、プログラミングにかかる時間を短縮する強力なコマンドを提供したりするには、コンピュータが、ユーザーから与えられる情報についてある程度仮定できる必要があります。たとえば、ユーザーがコンピュータに情報を入力した際に、コンピュータはそれが数字、文字列、日付などのどれなのかを判断できる必要があります。コンピュータは、命令「1 + 1」が与えられた場合、それぞれの「1」がどの種類のデータであるかを知る必要があります。それがわからないと、「1 + 1」が2または文字列「11」のどちらを意味するのかを判断できません。この例では、数字を意味していることを指定すると、2つの値が加算されます。これによって「2」という結果が返されます。文字を意味していることを指定すると、2つの値が連結されて「11」という結果が返されます。使用可能なデータ型は多数ありますが、圧倒的によく使用されるデータ型は、<span>テキスト、文字列、整数、倍精度、通貨、ブール型、</span>
 および<span>色</span>
 です。</p>
<p><br />
</p>
<h3><b>テキスト</b></h3>
<p>テキストはh一続きの文字です。テキストは文字列と呼ばれる場合もありますが（次のセクションを参照）テキストは、あらゆる種類の言語のテキストをより高度に処理できるので、テキストを取り扱うのに適切なデータ型です。</p>
<p><br />
</p>
<p>テキストの最大長は空きメモリによってのみ制限されます。</p>
<p><br />
</p>
<p>テキストは次のように宣言します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim t As Text</p>
</div>
<p><br />
</p>
<p>次のように、宣言の一部として値を直接割り当てることもできます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim t As Text = "Hello, World!"</p>
</div>
<p><br />
</p>
<p>基本的には、引用符で囲むだけでどのような種類の情報もテキストとして格納できます。</p>
<p><br />
</p>
<h3><b>文字列</b></h3>
<p>文字列は、テキストを取り扱う比較的古い方法です。本質的に、文字列は一続きの（または一連の）文字（またはバイト）です。</p>
<p><br />
</p>
<p>文字列は主にバイトを取り扱うため、言語によっては使いづらくなる場合もあります。このため、大部分の場合は、テキストデータ型を使用する必要があります。文字列値は、String.ToText を呼び出してテキスト値に変換することができます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim s As String = "Hello, World!"</p>
<p>Dim t As Text = s.ToText</p>
</div>
<p><br />
</p>
<p>文字列は次のように宣言します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim s As String</p>
</div>
<p><br />
</p>
<p>次のように、宣言の一部として値を直接割り当てることもできます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim s As String = "Hello, World!"</p>
</div>
<p><br />
</p>
<p>直接割り当てのない文字列の値は、デフォルトでは空の文字列です。</p>
<p><br />
</p>
<p>基本的に、どのような種類の情報も文字列として格納できます。「Jenni」、「3/17/98」、「45.90」はすべて文字列の例です。</p>
<p><br />
</p>
<p>後ろの2つは文字列に見えないかもしれませんが、文字列です。コード内で情報を引用符で囲んだ場合、そのデータは単に一連の文字であり、それ以外の何物でもないと指定していることになります。文字列の最大長は空きメモリにのみ左右されます。</p>
<p><br />
</p>
<p>2つの文字列は加算記号（+）で連結ができます。たとえば、文「"Big" + "Dog"」は文字列「BigDog」が生成されます。文字列で実行できる「計算」はこれが限度です。ただし、文字列を処理しやすくする組み込み関数は多数存在します。たとえば、<span>Lowercase</span>
 関数は文字列のすべての文字を小文字に変換します。<span>Trim</span>
 関数は、先頭と末尾の空白文字を削除します。</p>
<p><br />
</p>
<h3><b>整数</b></h3>
<p>整数は小数部分のない数字です。小数値や分数は格納できません。</p>
<p><br />
</p>
<div>
<p>
<span>注</span>
 ：整数データ型は、対象プラットフォームのワード長を使用する符号付き整数です。現在は、すべてのサポート対象プラットフォームで4バイト（32ビット）なので、整数の範囲は -2,147,483,648 から 2,147,483,647 になります。</p>
</div>
<p><br />
</p>
<p>整数は数なので、数学計算を行えます。文字列とは違い、コード内で整数値を引用符で囲んではいけません。整数は次のように宣言します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim i As Integer</p>
</div>
<p><br />
</p>
<p>このように宣言した整数のデフォルト値は、0です。次のように、整数を宣言してデフォルト値を指定することもできます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim i As Integer = 100</p>
</div>
<p><br />
</p>
<p>通常は整数型だけを使用する必要がありますが、特定の状況（一般的に、OS API との通信時のみ）で使用できる、より具体的な整数型も各種存在します（符号付き整数データ型と符号なし整数データ型）。たとえば、Int8、Int16、Int32、Int64、UInt8（バイト）、UInt16、UInt32、UInt64 などです。</p>
<p><br />
</p>
<div>
<p>
<span>注</span>
 ：符号付き整数と符号なし整数間の違いは、符号なし整数は正の数字（と 0）だけを含むことができるということです。</p>
</div>
<p><br />
</p>
<h3><b>倍精度</b></h3>
<p>倍精度は、小数値を含むことができる数字です。他の言語では、倍精度は倍精度実数と呼ばれる場合もあります。倍精度は数字なので、倍精度では数学計算を行えます。倍精度は、8バイト分のメモリを使用します。倍精度の範囲は、<span>±1.79769313486231570814527423731704357e+308</span>
 です。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim value As Double</p>
</div>
<p><br />
</p>
<p>このように宣言した倍精度のデフォルト値は、0.0 です。次のように、倍精度を宣言してデフォルト値を指定することもできます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim pi As Double = 3.1415926</p>
</div>
<p><br />
</p>
<h3><b>通貨</b></h3>
<p>通貨は、整数部分が15桁、小数部分が4桁の（64ビット、8バイトの）固定小数点形式です。通貨は、4桁の小数部分を指定するため、10,000 倍されます。通貨は常に小数第4位の精度となります。通貨は、お金の計算や精度が非常に重要な計算に役立ちます。このデータ型は、Visual Basic の一部のバージョンで提供されている通貨データ型と互換性があります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim value As Currency</p>
</div>
<p><br />
</p>
<p>このように宣言した通貨のデフォルト値は、0.0です。次のように、通貨を宣言してデフォルト値を指定することもできます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim value As Currency = 1.23</p>
</div>
<p><br />
</p>
<h3><b>ブール型</b></h3>
<p>ブール型の値は、True または False です。デフォルトのブール値は False です。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim b As Boolean = True</p>
</div>
<p><br />
</p>
<p>ブール型には、True 値を使用して True を設定し、False 値を使用して False に戻すか、またはブール値を返す任意の式を使用して値を設定することができます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim b As Boolean = True</p>
</div>
<p><br />
</p>
<p>この例では、整数値が5より大きいかどうかにより、b に True または False が設定されます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim i As Integer = 10</p>
<p>Dim b As Boolean</p>
<p>b = (i &gt; 5) // b gets set to True</p>
</div>
<p><br />
</p>
<h3><b>色</b></h3>
<p>色は、色の値を格納するデータ型です。色の「値」は、実際には、光の三原色（RGB）、色相-彩度-値（HSV）、またはシアン-マゼンタ-イエロー（CMY）の3つの一般的な色モデルを使用して設定できる3つの数値で構成されます。各 RGB 値は、バイトとして格納されます。つまり、各数字に含まれる可能性がある値は256あります。</p>
<p><br />
</p>
<p>各色関数は、透明度の指定に使用できるオプションの整数引数も含めることができます。透明度はアルファチャネルと呼ばれることもあります。これも、0から255の整数引数です。0は透明度なし（完全に不透明）、255は完全に透明であることを意味します。透明度引数をすべて省略すると、デフォルトは不透明になります。</p>
<p><br />
</p>
<p>接頭辞 &amp;c を使用するか、3つの色モデルに対応する3つの色関数（RGB、HSV、CMY）のいずれかにより、色に値を設定することもできます。</p>
<p>色の宣言の例を次に示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>// Different ways to assign Red</p>
<p>Dim red As Color</p>
<p>red = &amp;cff0000</p>
<p>red = RGB(255, 0, 0)</p>
<p>red = Color.Red</p>
<p>red = &amp;cff000088 // semi-transparent</p>
</div>
<p><br />
</p>
<h3><b>あるデータ型から別のデータ型への値の変更</b></h3>
<p>あるデータ型から別のデータ型に値を変更する必要が生じる場合もあります。一般的な理由は、別のデータ型を使用するように設計されたものに値を使用する必要がある場合です。たとえば、ウィンドウのタイトルに数字を含めたいが、ウィンドウのタイトルは数字ではなく文字列である場合などが考えられます。その結果、ウィンドウのタイトルに数字を割り当てようとすると、アプリケーションの実行時にエラーメッセージが表示されます。エラーでは、2つのデータ型には互換性がない（異なる）ことが示されます。ウィンドウタイトルは文字列なので、ウィンドウタイトルに割り当てる前に、数字を文字列に変更する必要があります。</p>
<p><br />
</p>
<p>幸運なことに、数字を文字列に変更できる<span>Str</span>
 （String（文字列）を表す）という組み込み関数が存在します。詳細については、言語リファレンスの Str 関数を参照してください。文字列を数字に変更するための<span>Val</span>
 （Value（値）の略）という組み込み関数もあります。詳細については、言語リファレンスの Val 関数を参照してください。</p>
<p><br />
</p>
<p>テキストを使用する場合は、一般的にテキスト以外の型の ToText メソッドを使用して、テキスト以外の型をテキスト値に変換します。たとえば、整数は次のようにテキスト値に変換できます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim i As Integer = 42</p>
<p>Dim t As Text = i.ToText</p>
</div>
<p><br />
</p>
<p>テキスト値から整数値を作成するには、FromText メソッドを使用します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim i As Integer = 42</p>
<p>i = Integer.FromText("42")</p>
</div>
<p><br />
</p>
<h3><b>数学演算子</b></h3>
<p>数学計算の実行はプログラミングで非常に一般的なタスクであり、一般的な数学演算はすべてサポートされています。</p>
<p><br />
</p>
<p>
<span>Figure 3.1</span>
 数学演算子</p>
<table>
<tr>
<th><b>実行される演算</b></th>
<th><b>演算子</b></th>
<th><b>例</b></th>
</tr>
<tr>
<td>加算</td>
<td>+</td>
<td>2+3=5</td>
</tr>
<tr>
<td>減算</td>
<td>-</td>
<td>3-2=1</td>
</tr>
<tr>
<td>乗算</td>
<td>*</td>
<td>3*2=6</td>
</tr>
<tr>
<td>浮動小数点除算</td>
<td>/</td>
<td>6/4=1.5</td>
</tr>
<tr>
<td>整数除算</td>
<td>\</td>
<td>6\4=1</td>
</tr>
<tr>
<td>モジュロ</td>
<td>Mod</td>
<td>6 Mod 3 = 0<br />
6 Mod 4 = 2</td>
</tr>
<tr>
<td>累乗</td>
<td>^</td>
<td>2^3=8</td>
</tr>
</table>
<p><br />
</p>
<p>上記以外にも多数の数学関数が用意されており、これらについては言語リファレンスで詳しく説明されています。</p>
<p><br />
</p>
<p>数式では、標準的な数学的優先順位がサポートされています。つまり、カッコ内の式が最初に計算されます。最も外側にあるカッコの内側にあるカッコから計算されます。次に累乗が計算され、続いて左から右に乗算と除算が行われます。最後に、加算と減算が行われます。「数式のサンプル」の表では、カッコの配置により、3つの式が返す結果が異なっています。</p>
<p><br />
</p>
<h3><b>演算子の優先順位</b></h3>
<p>式に複数の演算子が含まれる場合には、演算子の優先順位により演算子が実行される順序が決まります。たとえば、次の式</p>
<p><br />
</p>
<p>5+2/3</p>
<p><br />
</p>
<p>には、除算演算子と加算演算子の両方が含まれています。除算と加算のどちらを先に行うかが重要な意味を持ちます。カッコを使用すると、特定の優先順位を強制的に設定できます。デフォルトでは、加算より除算が優先されるため、この数式では5に2/3が足されます。次のようにカッコを使用して演算子のデフォルトの優先順位を書き換えると、加算を強制的に先に実行できます。</p>
<p><br />
</p>
<p>
<span>Figure 3.2</span>
 数式のサンプル</p>
<table>
<tr>
<th><b>式</b></th>
<th><b>結果</b></th>
</tr>
<tr>
<td>2+3*(5+3)</td>
<td>26</td>
</tr>
<tr>
<td>(2+3)*(5+3)</td>
<td>40</td>
</tr>
<tr>
<td>2+(3*5)+3</td>
<td>20</td>
</tr>
</table>
<p><br />
</p>
<p>(5+2)/3</p>
<p><br />
</p>
<p>式に複数の演算子が含まれる場合、優先順位は左から右となります。たとえば、乗算、浮動小数点除算、整数除算、モジュロの順に優先されます。</p>
<p><br />
</p>
<p>
<span>Figure 3.3</span>
 演算子の優先順位</p>
<table>
<tr>
<th><b>演算子</b></th>
<th><b>説明</b></th>
</tr>
<tr>
<td>.</td>
<td>ドット演算子</td>
</tr>
<tr>
<td>AddressOf</td>
<td>委譲作成</td>
</tr>
<tr>
<td>IsA</td>
<td>型チェック</td>
</tr>
<tr>
<td>^</td>
<td>累乗</td>
</tr>
<tr>
<td>-</td>
<td>単項マイナスの否定</td>
</tr>
<tr>
<td>Not</td>
<td>論理否定</td>
</tr>
<tr>
<td>*, /, \, Mod</td>
<td>乗算と除算の計算</td>
</tr>
<tr>
<td>-, +</td>
<td>減算と加算</td>
</tr>
<tr>
<td>=, &gt;, &lt;, &gt;=, &lt;=, &lt;&gt;, Is</td>
<td>比較</td>
</tr>
<tr>
<td>And</td>
<td>ビット論理積</td>
</tr>
<tr>
<td>Or, Xor</td>
<td>ビット論理和</td>
</tr>
<tr>
<td>:</td>
<td>対生成</td>
</tr>
</table>
<p><br />
</p>
<p>対（:）と指数（^）を除き、すべての演算子は左の数字に結合します。左に結合するということは、(foo or bar or baz) は (foo or (bar or baz)) ではなく ((foo or bar) or baz) になります。反対に、右に結合する場合、(foo:bar:baz) は ((foo:bar):baz) ではなく (foo: (bar: baz)) になります。</p>
<p><br />
</p>
<h3><b>ブール式</b></h3>
<p>ブール式では、True 値 と False 値のみが取り扱われます。True と False は、数字や文字列とまったく同じように Xojo が操作できる値です。</p>
<p><br />
</p>
<p>ブール式には、次の2種類があります。</p>
<p><br />
</p>
<div>
<p>・単純式：ブール式は、一般的に=（イコール）、&lt;&gt;（ノットイコール）、&lt;=（小なりイコール）、&gt;=（大なりイコール）などの演算子を使用し、プログラム内の値について記述します。プログラム内のプロパティなどが実際に単なるブール値である場合もあります。インスペクタのトグルスイッチが良い例です。テキストフィールドの1つをクリックすると、インスペクタで Bold トグルスイッチが表示されるので、Source1.Bold は有効なブール式です。したがって、Source1 の Bold トグルスイッチがオンに設定されている場合、式 Source1.Bold は True になります。</p>
<p><br />
</p>
<p>・複合式：ブール型演算子 Not、And、または Or を使用して他のブール式（これら自体は単純式の場合も複合式の場合もある）で構成されるブール式。</p>
</div>
<div>
<p>ブール式では、他の種類の式と同じように、多くの場合、演算の実行順序を明確化するためにカッコを使用する必要があります。また、やはり他の種類の式と同じように、Xojo は内側から外側に向かって演算を実行して最終値を算出します。</p>
</div>
<p><br />
</p>
<h4><b>複合式の例</b></h4>
<p>次の数式について考察してみましょう。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>(Val(Source1.Text) = 0 And</p>
<p>Source1.Text &lt;&gt; "0") Or</p>
<p>(Val(Source2.Text) = 0 And</p>
<p>Source2.Text &lt;&gt; "0")</p>
</div>
<p><br />
</p>
<p><img src="images/000022.jpg" alt="Image 3.1 Boolean Syntax Tree" />
</p>
<p><br />
</p>
<p>このような複合式は、左から右のルールに従って評価されます。OR 式の2つの分岐は、OR の前に個別に判定されます。</p>
<p><br />
</p>
<p>AND で結合された複合式の場合、False と評価されるサブ数式により、複合式内のそれ以降のサブ数式の判定プロセスが終了します。これは、False のサブ数式が1つあると、AND 複合式全体も False になるためです。</p>
<p><br />
</p>
<p>このような式は、構文ツリーとして表すことができます。この数式の構文ツリーをFigure 3.1 に示します。</p>
<p><br />
</p>
<p>この式は、ツリーの下から上に判定されます。ツリーの各レベルは左から右に判定されます。</p>
<p><br />
</p>
<p>この例では、最初の手順で OR 式の左の分岐を判定します。この式は AND を使用して分岐しているので、それ自体が複合式です。</p>
<p><br />
</p>
<p>最初に次の式を評価します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Val(Source1.Text) = 0</p>
</div>
<p><br />
</p>
<p>この数式が True を返す場合、次に、次の式を評価します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Source1.Text &lt;&gt; "0"</p>
</div>
<p><br />
</p>
<p>最後に、次の式を判定します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Val(Source1.Text) = 0</p>
</div>
<p><br />
</p>
<p>これが False の場合、「AND」を判定する十分な情報があるので、2番目の式を判定することなく、すぐ上のレベルに False が返されます。</p>
<p><br />
</p>
<p>この2つの複合式は OR で結合されているため、左の複合式の判定が False であっても、ツリーの下部分にある右の複合式を判定する必要があります。左の分岐が False でも、右の分岐が True の場合、複合式全体は True になります。</p>
<p><br />
</p>
<p>OR 複合文の右の分岐の判定でも、同じ手順に従います。</p>
<p><br />
</p>
<h3><b>バリアント</b></h3>
<p>バリアントは、どんな型のデータも含めることができる特別なデータ型です。バリアントは、値が必要に応じて他の型に自動的に変換され、意図しない動作につながることも多い、使用に注意が必要な高度な機能です。</p>
<p><br />
</p>
<p>バリアントの詳細については、言語リファレンスを参照してください。</p>
<p><br />
</p>
<h3><b>オート</b></h3>
<p>オート型は、バリアントの代わりに使用されます。オート型にもあらゆる型のデータを含めることができますが、オート型は他の型に自動的に変換されることはありません。代わりに、使用するには適切な型の変数に値を明示的に割り当てる必要があります。</p>
<p><br />
</p>
<p>したがって、型変換による意図しない動作が発生することはないので、オート型を使用するほうがかなり安全です。</p>
<p><br />
</p>
<p>オート型の詳細については、リファレンスガイドを参照してください。</p>
</div>
</div>
</div>


<div id="calibre_link-0">
<div>
<div>
<h2 id="calibre_link-87"><b>
<span><b>Section 4</b></span>
<br /><b></b>
データのコレクション</b></h2>
<p><br />
</p>
<p>多くの場合、プログラムは大量のデータを管理します。データ管理手法には、配列とディクショナリーの2つがあります。配列とディクショナリーはどちらも大量の情報の集合を格納しますが、方法が異なります。</p>
<p><br />
</p>
<h3><b>配列</b></h3>
<p>配列は、同じデータ型の値を複数含む特別な型の変数です。配列内の各変数は、配列の要素と呼ばれます。特定の要素を参照するには、インデックス番号を使用します。</p>
<p><br />
</p>
<p>Dim 文で配列を作成して型を指定することもできます。配列を宣言するときには、配列の要素数を指定します。要素数は、後で変更することができます。</p>
<p><br />
</p>
<h4><b>配列の作成</b></h4>
<p>配列は、配列の最後の要素のインデックスを指定して宣言します。配列には常に要素ゼロが含まれるので、Dim 文で指定するインデックスは、実際には配列の要素数より1つ少ない数になります。このような配列は、ゼロベースの配列と呼ばれることもあります。配列の最初の要素が要素1の場合は、1ベースの配列と呼ばれます。Xojo の配列はゼロベースなので、文は次のようになります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim names(10) As String</p>
</div>
<p><br />
</p>
<p>これにより、要素が11個の文字列配列が作成されます。</p>
<p><br />
</p>
<p>別の文を見てみましょう。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim names(0) As String</p>
</div>
<p><br />
</p>
<p>この記述では、要素が1つ（要素ゼロ）の文字列配列が作成されます。この要素は、正のインデックスを持つすべての要素と同じように読み書きすることができます。</p>
<p><br />
</p>
<p>言い換えると、最後の要素のインデックスを Dim 文に追加するだけで、変数を配列として宣言できます。最後の要素のインデックスは、数字または定数のいずれかである必要があります。この構文で変数を使用することはできません。</p>
<p><br />
</p>
<p>宣言時に必要な配列の大きさが不明である場合は、ヌル配列、つまり、要素を持たない配列として宣言することができます。そのためには、Dim 文で -1 というインデックスを使用するか、中身のないカッコを残します。これは「要素を持たない配列」を意味します。たとえば、次のような文が考えられます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim firstNames(-1) As String</p>
<p>Dim lastNames() As String</p>
</div>
<p><br />
</p>
<p>この記述では、要素を持たない配列が作成されます。後で、<span>Redim</span>
 文を使用して配列の大きさを変更することや、<span>Append</span>
 または<span>Array</span>
 メソッドを使用して要素単位で配列を「拡大」することもできます。</p>
<p><br />
</p>
<h4><b>多次元配列</b></h4>
<p>多次元配列を作成することもできます。たとえば、スプレッドシートのレイアウトは、行 x 列の2次元配列と考えることができます。</p>
<p><br />
</p>
<p>各次元は、独自のインデックスにより参照されます。たとえば、2次元配列の要素は、行のインデックスと列のインデックスにより参照されます。左上の最初の要素は、要素 0,0です。</p>
<p><br />
</p>
<p>多次元配列は、各次元のインデックスを指定することにより作成します。たとえば、次の文</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim names(2, 10) As String</p>
</div>
<p><br />
</p>
<p>は、3行 x 11列の2次元配列を作成します。</p>
<p><br />
</p>
<p>配列の大きさは、Dim 文で定数を使用して設定します。たとえば、次の宣言は、モジュールで定義されているグローバル定数、kLanguages を参照します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim names(10, kLanguages) As String</p>
</div>
<p><br />
</p>
<p>この例では、kLanguages は、アプリケーションがサポートしている言語の数で、アプリケーション内のさまざまな場所で使用されます。変更する場合は、モジュール内の定義のみ変更すれば済みます。</p>
<p><br />
</p>
<h4><b>配列要素の参照</b></h4>
<p>配列の要素は、希望する要素をカッコで囲んで参照します。たとえば、次の文</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>names(1, 1) = "Frank"</p>
</div>
<p><br />
</p>
<p>は、文字列「Frank」を配列要素（1,1）に保存します。</p>
<p><br />
</p>
<h4><b>最後の要素のインデックスの取得</b></h4>
<p>Ubound 関数は、1次元配列の最後の要素のインデックスを返します。たとえば、次の式</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Ubound(names)</p>
</div>
<p><br />
</p>
<p>は、この値を返します。配列には要素ゼロがあるので、要素数はこの数字より1大きくなります。</p>
<p><br />
</p>
<p>たとえば、次の例では変数 i に5が返されます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim i As Integer</p>
<p>Dim names(5) As String</p>
<p>i = Ubound(names)</p>
</div>
<p><br />
</p>
<p>ドット表記構文を使用して配列の最後の要素を取得することもできます。次のコードも同じ内容です。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim i As Integer</p>
<p>Dim names(5) As String</p>
<p>i = names.Ubound</p>
</div>
<p><br />
</p>
<h4><b>配列の初期化</b></h4>
<p>配列を宣言した後は、次に示す最初の例のように個別の代入文を使用する方法に加えて、Array 関数を使用する方法でも、要素に初期値を割り当てることができます。Array 関数は値のリストを使用し、配列の要素に、先頭の要素から順番に、値を代入します。言い換えると、配列の各要素の個別割り当て文と同じ機能を提供します。</p>
<p><br />
</p>
<p>たとえば、次の文は、配列の各要素の個別割り当て文を使用して配列を初期化します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim names(2) As String</p>
<p>// Separate assignment statements</p>
<p>names(0) = "Fred"</p>
<p>names(1) = "Ginger"</p>
<p>names(2) = "Stanley"</p>
</div>
<p><br />
</p>
<p>次の文も Array 関数を使用して同じ処理を行います。Dim 文では配列の正確な大きさを宣言する必要はありません。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim names() As String</p>
<p>names = Array("Fred", "Ginger", "Stanley")</p>
</div>
<p><br />
</p>
<p>Array 関数が、必要な数の要素を配列に追加します。</p>
<p><br />
</p>
<p>固定の大きさの配列を宣言し、指定する値の数が要素の数より少ない場合、Array 関数は要素ゼロから指定された数の要素を使用します。</p>
<p><br />
</p>
<h4><b>配列の割り当て</b></h4>
<p>互換性のあるデータ型の配列が2つある場合は、一方の配列をもう一方の配列に割り当てることができます。カッコなしで割り当て文を使用するだけで実行できます。次に単純な例を示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim names(2), copyNames(2) As String</p>
<p>names = Array("Fred", "Ginger", "Stanley")</p>
<p>copyNames = names</p>
</div>
<p><br />
</p>
<p>最後の文が、<span>names</span>
 の3つの要素すべての値を<span>copyNames</span>
 の最初の3つの要素に割り当てます。<span>copyNames</span>
 の要素が<span>names</span>
 より少ない場合は、まず追加要素が<span>copyNames</span>
 に追加され、<span>names</span>
 のすべての要素の<span>copyNames</span>
 への割り当てが完了します。たとえば、次の例は有効です。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim names(3), copyNames(2) As String</p>
<p>names(0) = "Fred"</p>
<p>names(1) = "Ginger"</p>
<p>names(2) = "Tommy"</p>
<p>names(3) = "Woody"</p>
<p>copyNames = names</p>
</div>
<p><br />
</p>
<p>コード実行後、copyNames 配列には値「Woody」を格納するための4番目の要素が存在します。</p>
<p><br />
</p>
<h4><b>配列の大きさの変更</b></h4>
<p>この言語には、配列の大きさを変更する複数のメソッドがあります。</p>
<p><br />
</p>
<p>・<span>Append</span>
 : Append メソッドは、大きさを1つ増やして配列に要素を追加します。Append を呼び出すときは、追加する値を配列に渡します。たとえば、次のような文が考えられます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>names.Append("Dave")</p>
</div>
<p><br />
</p>
<p>この記述により、配列 names に要素が追加され、この要素の値が文字列「Dave」に設定されます。Append は1次元配列でのみ使用できます。</p>
<p><br />
</p>
<p>・<span>Insert</span>
 : Insert メソッドは追加要素を作成し、指定された場所に挿入します。このメソッドは、要素を挿入するインデックスと新しい要素の値という2つの引数を使用します。次に例を示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>names.Insert(9, "Hal")</p>
</div>
<p><br />
</p>
<p>この文の実行後、names(9) の値は「Hal」になります。また、古い要素（9）は要素（10）にシフトし、それ以降の要素も同様に後方にシフトします。配列の大きさは、Append と同じように1つ増えます。</p>
<p><br />
</p>
<p>Insert も1次元配列でのみ使用できます。</p>
<p><br />
</p>
<p>・<span>Remove</span>
 : Remove メソッドは、指定されたインデックスの要素を削除します。次に例を示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>names.Remove(9)</p>
</div>
<p><br />
</p>
<p>この記述では、インデックス9の要素が削除され、配列の大きさが1つ減り、削除された要素の後の配列要素が1つずつ前方にシフトします。これも1次元配列でのみ使用できます。</p>
<p><br />
</p>
<p>・<span>Redim</span>
 : Redim 文は、既存の配列の大きさを変更します。配列のインデックスの新しい値を渡しますが、データ型は指定しません。データ型は最初の Dim 文で設定されるためです。たとえば、次の文</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>ReDim names(100)</p>
</div>
<p><br />
</p>
<p>は、配列 names の大きさを101要素に変更します。</p>
<p><br />
</p>
<p>Redim は1次元配列と多次元配列の両方で使用できます。多次元配列の場合、既存の次元の大きさのみを変更できます。次元の数自体を増減することはできません。</p>
<p><br />
</p>
<p>Dim と Redim の違いは、Dim が整数または定数のみを受け付けるのに対し、Redim は整数を返すすべての式を受け付けることです。これには、たとえば、整数値を返すユーザー定義関数または単純な変数含まれます。この機能を使用することにより、実行中に配列の大きさを設定できます。</p>
<p><br />
</p>
<p>宣言時に必要な配列の大きさがわからない場合は、ヌル配列、つまり、要素を持たない配列として宣言し、後で Redim コマンドを使用して大きさを変更することができます。ユーザーが入力した名前のリストをプログラムが読み込む必要がある場合は、ユーザーが入力した名前の数を把握してから配列の大きさを設定することができます。関数を作成してこの数を確認し、Redim で使用するか、または Append メソッドを使用して配列に必要な要素を1つずつ追加することができます。</p>
<p><br />
</p>
<h4><b>配列と変数間の変換</b></h4>
<p>2つの関数により、配列をバラバラの変数に分割すること、および1つの文字列変数を配列に変換することができます。</p>
<p><br />
</p>
<div>
<p>・<span>Split</span>
 : Split 関数は文字列変数を受け取り、文字列を要素に分割して1次元配列を作成します。この関数は、区切り文字、つまりある要素の最後と次の要素の最初を示す区切り文字または文字列を使用してこのタスクを実行します。デフォルトの区切り文字はスペースですが、別の区切り文字を指定することもできます。</p>
</div>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim names() As String</p>
<p>// resize using the Split method</p>
<p>Dim s As String</p>
<p>s = "Juliet,Taylor,Casting"</p>
<p>names = Split(s, ",")</p>
</div>
<p><br />
</p>
<p>Split 関数は文字列を1つ目の引数、区切り文字を2つ目の引数として受け取ります。ここでは、文字列の内容を配列要素に分割する例を示します。この例では、コンマが区切り文字に指定されています。この呼び出しの結果作成される配列 names には、次の3つの要素が含まれます。</p>
<p><br />
</p>
<p>names(0) = "Juliet"</p>
<p>names(1) = "Taylor"</p>
<p>names(2) = "Casting"</p>
<p><br />
</p>
<p>・<span>Join</span>
 : Join 関数は1次元配列を受け取り、その配列のすべての要素を含み、区切り文字または文字列で区切った文字列変数を作成します。デフォルトの区切り文字はスペースですが、2つ目の引数として区切り文字を渡すことにより独自の区切り文字を指定することもできます。区切り文字は、2つ目の引数として渡されます。</p>
<p><br />
</p>
<p>たとえば、ある人物の下の名前と姓および電話番号を格納する要素を含む配列がある場合、Join 関数はすべての情報を含む1つの文字列変数を作成します。次に例を示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim names(2) As String</p>
<p>Dim s As String</p>
<p>names(0) = "Anthony"</p>
<p>names(1) = "Aardvark"</p>
<p>names(2) = "(406) 737-8946"</p>
<p><br />
</p>
<p>// "Anthony,Aardvark,(406) 737-8946"</p>
<p>s = Join(names, ",")</p>
</div>
<p><br />
</p>
<p>この例では、Join 関数の呼び出しにより、配列の名前と区切り文字としてのコンマが指定されます。次のような呼び出しだった場合は、</p>
<p><br />
</p>
<p>s = Join(names)</p>
<p><br />
</p>
<p>「Anthony Aardvark (406) 737-8946」のように結果内の各値の間にスペースが入ります。</p>
<p><br />
</p>
<h3><b>ディクショナリー</b></h3>
<p>ディクショナリーは、キーと値のペアのリストで構成されるオブジェクトです。つまり、各値は識別キーとペアになっています。ディクショナリーの興味深い特徴は、キーと値の両方がバリアントであるということです。つまり、ディクショナリーにはデータ型を混在させて格納することができ、キーが単なる整数である必要はありません。ディクショナリーの値は、キーまたはディクショナリー内の連続する位置を指定してルックアップすることができます。</p>
<p><br />
</p>
<p>ディクショナリーは、情報の高速ランダムルックアップに適した方法です。</p>
<p><br />
</p>
<p>ディクショナリーはクラス（第5章参照）なので、New コマンドを使用して次のように作成できます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim d As New Dictionary</p>
</div>
<p><br />
</p>
<p>ディクショナリーには、Value メソッドを使用して値を追加します。インデックスの指定は限定されず、文字列でも構いません。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>d.Value("FirstName") = "Bob"</p>
</div>
<p><br />
</p>
<p>値は、同じようにインデックスを使用してルックアップできます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>MsgBox(d.Value("FirstName")) // Shows Bob</p>
</div>
<p><br />
</p>
<h3><b>ペア</b></h3>
<p>Pair クラスはディクショナリーに類似しています。このクラスには、Left と Right の2つのプロパティがあります。よって、各 Pair インスタンスはキーと値のペアで構成されます。ディクショナリーの場合と同様、ペアの値はバリアントです。Left と Right の値は、ペア宣言時に「:」演算子を使用して割り当てます。次に例を示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim p As Pair = "Telephone Number"&nbsp;:</p>
<p>"(406) 737-8946"</p>
</div>
<p><br />
</p>
<p>これにより、「Telephone Number」がペアの Left プロパティに、番号の値が Right プロパティに割り当てられます。</p>
<p><br />
</p>
<p>次のような項目リストを渡された場合は、リンクされたペアリストを格納することもできます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim p as Pair = 1&nbsp;:2&nbsp;:3&nbsp;:4&nbsp;:5</p>
</div>
<p><br />
</p>
<p>最初のペアは、ペア「1」（Left プロパティ）と2つ目のペアオブジェクト（Right プロパティ）、次のペアは「2」と3つ目のペアなどというように構成されます。</p>
</div>
</div>
</div>


<div id="calibre_link-97">
<div>
<div>
<h2 id="calibre_link-88"><b>
<span><b>Section 5</b></span>
<br /><b></b>
比較</b></h2>
<p><br />
</p>
<p>2つの値を比較し、特定の条件が成立しているかどうかを判断する必要がある場合も多くあります。比較を行う際、実際に行っているのは、True または False になる文の作成です。たとえば、「私の犬は猫です」という文は False と判定される可能性があります。一方、「私の犬は私の猫より体重が重い」という文は True と判定されます。下の表は、使用可能な比較演算子の例を示しています。</p>
<p><br />
</p>
<p>
<span>Figure 3.4</span>
 比較演算子</p>
<table>
<tr>
<th><b>説明</b></th>
<th><b>記号</b></th>
<th><b>例</b></th>
<th><b>結果</b></th>
</tr>
<tr>
<td>等しい</td>
<td>=</td>
<td>5 = 5</td>
<td>True</td>
</tr>
<tr>
<td>等しくない</td>
<td>&lt;&gt;</td>
<td>5 &lt;&gt; 5</td>
<td>False</td>
</tr>
<tr>
<td>より大きい</td>
<td>&gt;</td>
<td>6 &gt; 5</td>
<td>True</td>
</tr>
<tr>
<td>より小さい</td>
<td>&lt;</td>
<td>6 &lt; 5</td>
<td>False</td>
</tr>
<tr>
<td>以上</td>
<td>&gt;=</td>
<td>6 &gt;= 5</td>
<td>True</td>
</tr>
<tr>
<td>以下</td>
<td>&lt;=</td>
<td>6 &lt;= 5</td>
<td>False</td>
</tr>
</table>
<p><br />
</p>
<p>比較には文字列とブール値も使用できます。文字列比較では大文字と小文字は区別されず、アルファベット順に行われます。つまり、「Jeannie」と「jeannie」は等しいと判定されます。また、「Jason」はアルファベット順で「Jeannie」より前になるので、「Jeannie」より小さくなります。大文字と小文字を区別する必要がある場合や、辞書式比較が必要な場合は、<span>StrComp</span>
 関数を使用します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>If StrComp("Jeannie", "jeannie", 0) &lt;&gt; 0 Then</p>
<p>MsgBox("Strings do not match.")</p>
<p>End If</p>
</div>
<p><br />
</p>
<p>詳細については、言語リファレンスの StrComp 関数を参照してください。</p>
<p><br />
</p>
<p>また、浮動小数点の等号演算子もあります。この演算子を使用すると、2つの浮動小数点数は等しいとみなせるほど近いかどうかを判断することができます。浮動小数点除算などの演算の不正確さを考慮する場合に使用してください。浮動小数点の等号演算子は、<span>Equals</span>
 キーワードです。これに対する記号はありません。構文は次のとおりです。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>result = expression.Equals(NumValue, x)</p>
</div>
<p><br />
</p>
<p>expression は比較する浮動小数点値です。NumValue は比較対象の値、x は許容範囲を示す最後の位置の単位数です。結果は、比較結果によって True または False のいずれかになります。</p>
<p><br />
</p>
<p>たとえば、10000 をある値と比較する場合に x=1 を指定すると、許容値は<span>10000.000000000002</span>
 、<span>10000.0</span>
 、および<span>9999.999999999998</span>
 です。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim d As Double = 10000</p>
<p>If d.Equals(compareValue, 1) Then</p>
<p>// take action here..</p>
<p>End if</p>
</div>
<p><br />
</p>
<h3><b>論理比較</b></h3>
<p>And、Or、および Not 演算子を使用して一度に複数の比較をテストすることができます。ブール値を渡すと、これらの演算子は式が true か false かを判断します。</p>
<p><br />
</p>
<h4><b>
<span><b>And</b></span>
 演算子</b></h4>
<p>この演算子は、すべての比較が True 判定かどうかを確認する必要がある場合に使用します。下の例では、変数 x に10が含まれている場合、式は False 判定となります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>x &gt; 1 And x &lt; 5</p>
</div>
<p><br />
</p>
<p>これは10が1より大きく5より小さい値ではないからです。</p>
<p><br />
</p>
<h4><b>
<span><b>Or</b></span>
 演算子</b></h4>
<p>この演算子は、いずれかの比較が True 判定かどうかを確認する必要がある場合に使用します。下の例では、変数 x に10が含まれている場合、式は True 判定となります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>x &gt; 1 Or x &lt; 5</p>
</div>
<p><br />
</p>
<p>これは10が1より大きいからです。比較のうちいずれかが True であるかどうかだけが重要なので、10が5より小さくないことは問題になりません。</p>
<p><br />
</p>
<h4><b>
<span><b>Xor</b></span>
 演算子</b></h4>
<p>この演算子は、いずれかの比較が True 判定だがすべてではないかどうかを確認する必要がある場合に使用します。下の例では、変数 x に10が含まれている場合、式は True 判定となります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>x &gt; 1 Xor x &lt; 5</p>
</div>
<p><br />
</p>
<p>これは比較のうち1つだけが True だからです。しかし x に3が含まれる場合は、両方のサブ式が True になるため、上記の式は False を返します。</p>
<p><br />
</p>
<h4><b>
<span><b>Not</b></span>
 演算子</b></h4>
<p>Not 演算子は、ブール型変数の値を反転する場合に使用します。次に例を示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Not x &lt; 0</p>
</div>
<p><br />
</p>
<p>この式は、x が0以上かどうかを確認します。</p>
<p><br />
</p>
<p>
<span>Figure 3.5</span>
 ブール型判定表（真偽表）</p>
<table>
<tr>
<th><b>Expr1</b></th>
<th><b>Expr2</b></th>
<th><b>Xor</b></th>
<th><b>Or</b></th>
<th><b>And</b></th>
</tr>
<tr>
<td>True</td>
<td>True</td>
<td>False</td>
<td>True</td>
<td>True</td>
</tr>
<tr>
<td>True</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>False</td>
</tr>
<tr>
<td>False</td>
<td>True</td>
<td>True</td>
<td>True</td>
<td>False</td>
</tr>
<tr>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
</table>
<p><br />
</p>
<h3><b>ビット単位の比較</b></h3>
<p>2つの整数の各ビットを比較し、それらが等しいかどうかを判断することもできます。これは、各整数を2進数として表現し直すことで実行されます。次に、2つの整数の同じ位置のビット同士を比較します。各比較の結果である新しい整数を取得できます。</p>
<p><br />
</p>
<p>
<span>Figure 3.6</span>
 ビット単位の比較表</p>
<table>
<tr>
<th><b>Bit 1</b></th>
<th><b>Bit 2</b></th>
<th><b>Xor</b></th>
<th><b>Or</b></th>
<th><b>And</b></th>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</table>
<p><br />
</p>
<p>これは、And、Or、および Xor 演算子を使用して実行できます。これらはオーバーロードされているとみなされます。これは、これらの演算子がブール型（上記のとおり）または整数のいずれかを受け取ることができることを意味します。ブール式が渡されると、前のセクションで説明した論理比較が必要とされていることを演算子が「認識」します。整数が渡されると、2つの整数を構成するビットの比較が必要とされていることを演算子が「認識」します。この場合、各演算子はそれぞれすべてのビット比較の結果で構成される整数を返します。次の表には、渡された整数の各ビットの比較結果をまとめます。</p>
<p>たとえば、数字5と3について検討してみましょう。これらは、2進数で記述すると次のようになります。</p>
<p><br />
</p>
<p>101 (5)</p>
<p>011 (3)</p>
<p><br />
</p>
<p>5 Xor 3 を判定するには、各ビットを比較します。したがって、この例では次のようになります。</p>
<p><br />
</p>
<p>1 Xor 0 = 1</p>
<p>0 Xor 1 = 1</p>
<p>1 Xor 1 = 0</p>
<p><br />
</p>
<p>新しい2進数値は110、つまり6です。</p>
<p>したがって、5 Xor 3 = 6 となります。</p>
<p><br />
</p>
<p>Not 演算子もオーバーロードされています。整数を Not に渡すと、単に各ビット値が反転されます。</p>
<p><br />
</p>
<p>
<span>Figure 3.7</span>
 ビット単位の Not 値の変化</p>
<table>
<tr>
<th><b>Bit 1</b></th>
<th><b>Not Bit 1</b></th>
</tr>
<tr>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
</tr>
</table>
<p><br />
</p>
<p>Bitwise クラスのメソッドを使用してこれらのビット比較を実行することもできます（詳細については、言語リファレンスを参照してください）。</p>
</div>
</div>
</div>


<div id="calibre_link-40">
<div>
<div>
<h2 id="calibre_link-89"><b>
<span><b>Section 6</b></span>
<br /><b></b>
分岐</b></h2>
<p><br />
</p>
<h3><b>分岐による判定</b></h3>
<p>作成したメソッドは、上から下、左から右に1行ずつ実行されます。アプリケーションで特定の条件に基づき（比較を使用して）コードの一部を実行したい場合もあります。アプリケーションのロジックで判定が必要な場合、そのロジックは分岐と呼ばれます。分岐を使用すると、実行するコードと実行タイミングをコントロールできます。分岐文は、If...Then...End If と Select...Case の2つがあります。</p>
<p><br />
</p>
<h3><b>If...Then...End If</b></h3>
<p>If...Then...End If 文は、コードがブール型（True または False）条件を確認し、その条件を基にコードを実行する必要がある場合に使用します。確認する条件が True の場合は、If...Then 行と End If 行の間にあるコード行が実行されます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>If condition Then</p>
<p>// [Your code goes here]</p>
<p>End If</p>
</div>
<p><br />
</p>
<p>たとえば、次のように整数変数 month を確認し、その値が1の場合は、何らかのコードを実行するとします。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>If month = 1 Then</p>
<p>// [Your code goes here]</p>
<p>End If</p>
</div>
<p><br />
</p>
<p>「month = 1」の部分はブール式で、True または False のいずれかです。変数 month は1または1以外となります。</p>
<p><br />
</p>
<p>特定のチェックボックスにチェックを入れている場合に追加タスクを実行するボタンがあるとします。チェックボックスの value プロパティはブール型なので、If 文で次のように簡単に確認できます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>If CheckBox1.Value Then</p>
<p>// [Your code goes here]</p>
<p>End If</p>
</div>
<p><br />
</p>
<p>If 文の内部では、Dim 文を使用してローカル変数を宣言できます。ただし、このような変数は End If 文の後スコープ外となります。次に例を示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>If error = -123 Then</p>
<p>Dim a As String</p>
<p>a = "Oops!An error occurred."</p>
<p>End If</p>
<p>MsgBox(a) // out of scope</p>
</div>
<p><br />
</p>
<p>End If 文の後で変数が必要な場合は、If...End If 文内ではなくメソッド全体に対してローカルに宣言する必要があります。</p>
<p><br />
</p>
<h3><b>If...Then...Else...End If</b></h3>
<p>場合によっては、ブール型条件が True の場合と False の場合で別々の処理を実行する必要がある場合もあります。これらの場合は、If 文のオプションの Else 節を使用できます。Else 節を使用すると、実行するコードを条件が True の場合に実行するコードと条件が False の場合に実行するコードの2つの部分に分割できます。この例では、条件が True の場合と False の場合にそれぞれ別のメッセージが表示されます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>If month = 1 Then</p>
<p>MsgBox("It's January.")</p>
<p>Else</p>
<p>MsgBox("It's not January.")</p>
<p>End If</p>
</div>
<p><br />
</p>
<h3><b>If...Then...ElseIf...End If</b></h3>
<p>場合によっては、初期条件が False の場合に追加の確認を実行する必要があることもあります。オプションの ElseIf 文を使用します。下の例では、変数 month が1でない場合、ElseIf 文は次のような追加の確認を実行します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>If month = 1 Then</p>
<p>MsgBox("It's January.")</p>
<p>ElseIf month &lt; 4 Then</p>
<p>MsgBox("It's still Winter.")</p>
<p>Else</p>
<p>MsgBox("It's not Winter.")</p>
<p>End If</p>
</div>
<p><br />
</p>
<p>当然ながら、最初の If 文の Else 部分の内部で追加の If...Then...End If 文を使用して、別の確認を実行することもできます。ただし、これによりもう1つ End If が追加され、コードが必要以上に複雑になります。代わりに、必要な数だけ ElseIf 文を使用することができます。</p>
<p><br />
</p>
<p>下の例では、追加の確認を実行するために別の ElseIf が追加されています。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>If month = 1 Then</p>
<p>MsgBox("It's January.")</p>
<p>ElseIf month &lt; 4 Then</p>
<p>MsgBox("It's still Winter.")</p>
<p>ElseIf month &lt; 6 Then</p>
<p>MsgBox("It must be Spring.")</p>
<p>End If</p>
</div>
<p><br />
</p>
<p>初期条件が False の場合、True の ElseIf 条件が見つかるまでコードは ElseIf 条件の確認を継続します。見つかったらその ElseIf 文に関連付けられたコードを実行し、End If 文の後のコード行の実行を続けます。</p>
<p><br />
</p>
<h3><b>If...Then...Else</b></h3>
<p>Then 文および（場合によっては）Else 文に続く、すべてのコードを1行に記述できる場合は、If 文を1行に記述することができます。この構文を使用する場合は、End If 文を省略します。たとえば、次の文は有効です。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>If error = 123 Then MsgBox("An error occurred.")</p>
<p><br />
</p>
<p>If error = 123 Then MsgBox("An error occurred.")Else MsgBox("Success")</p>
<p><br />
</p>
<p>If error = 103 Then Break</p>
</div>
<p><br />
</p>
<h3><b>If 演算子</b></h3>
<p>比較に基づく結果を返すことだけが必要な場合は、If 演算子を使用できます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>If(condition, resultIfTrue, resultIfFalse)</p>
</div>
<p><br />
</p>
<p>condition が判定され、判定結果が True の場合は resultIfTrue、False の場合は resultIfFalse が返されます。</p>
<p><br />
</p>
<p>たとえば、次のコードの出力は「Big」です。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim myInteger As Integer = 41</p>
<p>MsgBox(If(myInteger &gt; 40, "Big", "Small"))</p>
</div>
<p><br />
</p>
<h3><b>Select...Case</b></h3>
<p>プロパティまたは変数が複数の取りうる値のうちいずれか1つに一致するかどうかを確認し、その値を基に処理を実行する必要がある場合は、Select...Case 文を使用します。</p>
<p><br />
</p>
<p>次の例について考察してみましょう。この例では、If...ElseIf..End If を使用して変数（dayNumber）を確認し、曜日を表示しています。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim dayName As String</p>
<p>If dayNumber = 2 Then</p>
<p>dayName = "Monday"</p>
<p>ElseIf dayNumber = 3 Then</p>
<p>dayName = "Tuesday"</p>
<p>ElseIf dayNumber = 4 Then</p>
<p>dayName = "Wednesday"</p>
<p>ElseIf dayNumber = 5 Then</p>
<p>dayName = "Thursday"</p>
<p>ElseIf dayNumber = 6 Then</p>
<p>dayName = "Friday"</p>
<p>Else</p>
<p>dayName = "the weekend."</p>
<p>End If</p>
<p>MsgBox("It's " + dayName)</p>
</div>
<p><br />
</p>
<p>これらの条件のうち2つが同時に True になることはありません。このコードの記述方法は有効ですが、読みやすくありません。</p>
<p><br />
</p>
<p>次の例は、Select...Case 文を使用して同じ結果を実現します。このほうがはるかに読みやすくなります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim dayName As String</p>
<p>Select Case dayNumber</p>
<p>Case 2</p>
<p>dayName = "Monday"</p>
<p>Case 3</p>
<p>dayName = "Tuesday"</p>
<p>Case 4</p>
<p>dayName = "Wednesday"</p>
<p>Case 5</p>
<p>dayName = "Thursday"</p>
<p>Case 6</p>
<p>dayName = "Friday"</p>
<p>Else</p>
<p>MsgBox "the weekend."</p>
<p>End Select</p>
<p>MsgBox("It's " + dayName)</p>
</div>
<p><br />
</p>
<p>Select...Case 文は、1行目で渡される変数またはプロパティを Case 文上の各値と比較します。</p>
<p><br />
</p>
<p>一致が見つかると、その Case と次の Case の間のコードが実行されます。</p>
<p><br />
</p>
<p>Select...Case 文には、ケースによって明示的に処理されないその他のすべての値を処理するために Else 文を含めることができます。</p>
<p><br />
</p>
<p>Case 文の内部には、Dim 文を使用してローカル変数を作成できます。ただし、このような変数はその Case 文の終了後にスコープ外となります。次に例を示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Select Case dayNumber</p>
<p>Case 2</p>
<p>Dim day As String</p>
<p>day = "Tuesday"</p>
<p>Else</p>
<p>MsgBox("It's NOT Tuesday!")</p>
<p>End Select</p>
<p><br />
</p>
<p>MsgBox(day) // Error: day out of scope</p>
</div>
<p><br />
</p>
<p>変数「day」は、End Select 文実行後に使用できるように、Select...Case 文の前に宣言する必要があります。</p>
<p><br />
</p>
<p>Select...Case 文は、文字列、整数、単精度、倍精度、ブール、色などの任意のデータ型の変数を扱うことができます。たとえば、次の例のように色を比較することもできます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim c As Color</p>
<p>c = &amp;cFF0000 // pure red</p>
<p><br />
</p>
<p>Select Case c</p>
<p>Case &amp;c00FF00 // green</p>
<p>MsgBox("Green")</p>
<p>Case &amp;cFF0000 // red</p>
<p>MsgBox("Red")</p>
<p>Case &amp;c0000FF // blue</p>
<p>MsgBox("Blue")</p>
<p>End Select</p>
</div>
<p><br />
</p>
<p>Case 文は、コンマで区切られた複数の異なる値を受け付けることができます。たとえば、次の例は有効です。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim c As Color</p>
<p>c = &amp;cFF0000 // red</p>
<p><br />
</p>
<p>Select Case c</p>
<p>Case &amp;c00FF00, &amp;cFF0000 // green, red</p>
<p>MsgBox("Green or Red")</p>
<p>Case &amp;cFF0000 // red</p>
<p>MsgBox("Red")</p>
<p>Case &amp;c0000FF // blue</p>
<p>MsgBox("Blue")</p>
<p>End Select</p>
</div>
<p><br />
</p>
<p>この例では、最初の Case 文が True なので、そのコードが実行されます。Select...Case に渡された色は赤ですが、最初に一致したケースではないので2つ目のケースのコードは実行されません。</p>
<p><br />
</p>
<p>Select Case 文では Else 節を使用できます。Else 節のコードは、それより前のケースがどれも一致しない場合のみ実行されます。Else 節は「Else」または「Case Else」と記述することができます。次の例では、色 FFFF00 はどの Case 文とも一致しないので、Case Else 節が実行されます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim c As Color</p>
<p>c = &amp;cFF0000 // pure red</p>
<p><br />
</p>
<p>Select Case c</p>
<p>Case &amp;c00FF00 // green</p>
<p>MsgBox("Green")</p>
<p>Case &amp;cFF0000 // red</p>
<p>MsgBox("Red")</p>
<p>Case &amp;c0000FF // blue</p>
<p>MsgBox("Blue")</p>
<p>Case Else</p>
<p>MsgBox("None of the above")</p>
<p>End Select</p>
</div>
<p><br />
</p>
<p>Case 文は「To」キーワードを使用して連続する値の範囲を受け付けることもできます。次に例を示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim i As Integer = 53</p>
<p>Select Case i</p>
<p>Case 1 To 25</p>
<p>MsgBox("25 or less")</p>
<p>Case 26 To 50</p>
<p>MsgBox("26 to 50")</p>
<p>Case 51 To 100</p>
<p>MsgBox("51 to 100")</p>
<p>End Select</p>
</div>
<p><br />
</p>
<p>この例では、3つ目のケース「51 to 100」が True です。</p>
<p><br />
</p>
<p>コンマで区切ることにより、次のように範囲を連続しない値と組み合わせることもできます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Case 0, 26 to 50, 75, 100 to 200</p>
</div>
<p><br />
</p>
<p>不等式は、「Is」キーワードと不等号演算子で記述できます。構文は次のとおりです。</p>
<p><br />
</p>
<p>Is ineqalityOperator &lt;value&gt;</p>
<p><br />
</p>
<p>次に例を示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim i As Integer = 10</p>
<p>Select Case i</p>
<p>Case Is &lt;= 10</p>
<p>// this case selected</p>
<p>Case Is &gt; 10</p>
<p>// this case not selected</p>
<p>End Select</p>
</div>
<p><br />
</p>
<p>不等式は、次のように値と組み合わせることができます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim i As Integer = 75</p>
<p>Select Case i</p>
<p>Case 0, Is &lt;= 10, 100</p>
<p>// case not selected</p>
<p>Case Is &gt; 10, Is &lt; 99</p>
<p>// case selected</p>
<p>End Select</p>
</div>
<p><br />
</p>
<p>Case 文では、指定されているデータ型の値を返す関数を使用することもできます。次に簡単な例を示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim i As Integer = 4</p>
<p>Dim a As Integer = 2</p>
<p><br />
</p>
<p>Select Case i</p>
<p>Case CalcSquare(a)</p>
<p>// case 1</p>
<p>Case a</p>
<p>// case 2</p>
<p>Else</p>
<p>// no match</p>
<p>End Select</p>
</div>
<p><br />
</p>
<p>1つ目の Case 文の関数は、次のとおりです。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Function CalcSquare(a As Integer) As Integer</p>
<p>Return a * a</p>
<p>End Function</p>
</div>
<p><br />
</p>
<p>この例では、関数が渡された値を二乗するので、最初の Case 文が一致します。</p>
<p><br />
</p>
<p>このような単純な関数の場合は、Case 文自体の中に式を記述することができます。つまり、次に示す文はまったく同じ一致 Case 文です。</p>
<p><br />
</p>
<h4><b>Case a*a</b></h4>
<p>Select Case 文は、オブジェクトである変数を比較することもできます。</p>
<p><br />
</p>
<p>次の例では、Select...Case 文を使用し、メッセージダイアログボックスでユーザーが押したボタンを判断します。Select Case 文は、MessageDialogButton タイプのオブジェクトを比較し、考えられる3つのダイアログボタンのうちどれが押されたかを判断します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim d As New MessageDialog</p>
<p>Dim b As MessageDialogButton</p>
<p><br />
</p>
<p>d.Icon = MessageDialog.GraphicCaution</p>
<p>d.ActionButton.Caption = "Save"</p>
<p>d.CancelButton.Visible = True</p>
<p>d.AlternateActionButton.Visible = True</p>
<p>d.AlternateActionCaption = "Don't Save"</p>
<p>d.Message = "Save changes before closing?"</p>
<p>d.Explanation = "If you don't save your changes, you will lose your work."</p>
<p><br />
</p>
<p>b = d.ShowModal</p>
<p>Select Case b</p>
<p>Case d.ActionButton</p>
<p>// user pressed Save</p>
<p>Case d.AlternateActionButton</p>
<p>// user pressed Don't Save</p>
<p>Case d.CancelButton</p>
<p>// user pressed Cancel</p>
<p>End Select</p>
</div>
<p><br />
</p>
<p>IsA 演算子を使用して、オブジェクトが特定のクラスかどうかを判断することもできます。文法を次に示します。構文は次のとおりです。</p>
<p><br />
</p>
<h4><b>Case IsA ClassName</b></h4>
<p>次に簡単な例を示します。ウィンドウの PushButton の Action イベントハンドラのコードは次のとおりです。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Select Case Me</p>
<p>Case IsA PushButton</p>
<p>MsgBox("I'm a PushButton.")</p>
<p>Case IsA TextField</p>
<p>MsgBox("Nope!")</p>
<p>End Select</p>
</div>
<p><br />
</p>
<p>「Me」は PushButton を参照するので、最初の Case 文が true を返します。</p>
</div>
</div>
</div>


<div id="calibre_link-59">
<div>
<div>
<h2 id="calibre_link-90"><b>
<span><b>Section 7</b></span>
<br /><b></b>
ループ</b></h2>
<p><br />
</p>
<h3><b>ループによる命令の反復実行</b></h3>
<p>1行以上のコードを複数回実行する必要がある場合もあります。必要なコード実行回数がわかっている場合は、単にその回数コードを繰り返すことができます。たとえば、クリック時に押しボタンが3回メッセージを表示するようにする場合は、次のように単にコードで MsgBox メソッドを3回記述することもできます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>MsgBox("One")</p>
<p>MsgBox("Two")</p>
<p>MsgBox("Three")</p>
</div>
<p><br />
</p>
<p>50回、あるいは特定の条件が成立するまでカウントする必要があるとします。このような場合にコードを単に何度も繰り返すことは、非常に面倒であったり、不可能であったりします。どうすればこの問題を解決できるでしょうか。この答えがループです。</p>
<p><br />
</p>
<p>ループは1行以上のコードを何度も実行します。</p>
<p><br />
</p>
<p>次の種類のループ構造を使用することができます。</p>
<p><br />
</p>
<div>
<p>・<span>While...Wend</span>
 : While 文に指定されている条件が成立するまで、ループが実行されます。</p>
<p><br />
</p>
<p>・<span>Do...Loop</span>
 : Do またはLoop 文に指定されている条件が成立するまで、ループが実行されます。</p>
<p><br />
</p>
<p>・<span>For...Next</span>
 : ループが For 文で指定されている回数実行されます。ループの実行は、ローカルカウンタ変数がコントロールします。</p>
<p><br />
</p>
<p>・<span>For...Each</span>
 : 配列の要素ごとにループが繰り返し実行されます。</p>
</div>
<p><br />
</p>
<p>ループ構造の内部では、ローカル変数を宣言することができます。ループ構造内部でローカル変数を定義すると、そのスコープは、メソッド全体ではなく構造自体に対してローカルになります。このローカル変数は、ループ終了条件が成立するとスコープ外になります。ループ実行後に変数を使用する必要がある場合は、メソッドにローカルになるように変数をループの外で定義します。</p>
<p><br />
</p>
<h3><b>While...Wend</b></h3>
<p>While ループは、While 文と Wend 文間の1行以上のコードを実行します。While 文に渡される条件が True 判定である間は、これらの文の間のコードが繰り返し実行されます。</p>
<p><br />
</p>
<p>次の例について考えてみましょう。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim i As Integer</p>
<p>While i &lt; 10</p>
<p>i = i + 1</p>
<p>Wend</p>
</div>
<p><br />
</p>
<p>Dim 文により作成された場合の変数「i」のデフォルトは0です。0は10より小さいので、実行が While...Wend ループ内部に移ります。変数 i は1ずつ増分され、ループは先頭に戻って While 文で条件がまだ True かどうかを確認し、True の場合は、ループ内部のコードが再度実行されます。この処理は、条件が True ではなくなるまで続きます。変数 i が最初の時点で10以上の場合は、Wend 文の後にあるコード行の実行が継続します。</p>
<p><br />
</p>
<h3><b>Do...Loop</b></h3>
<p>Do ループは While ループに類似していますが、While ループより少し柔軟です。Do ループは、特定の条件が True になるまで、Do 文と Loop 文間のすべてのコード行の実行を続けます。これに対し、While ループは条件が True である限り処理を実行します。Do ループはループの最初または最後で条件を確認できるため、While ループより柔軟性が高くなります。次の例は、条件を最初に確認するループと最後に確認するループの2つのループを示しています。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Do Until i = 10</p>
<p>i = i + 1</p>
<p>Loop</p>
<p><br />
</p>
<p>Do</p>
<p>i = i + 1</p>
<p>Loop Until i = 10</p>
</div>
<p><br />
</p>
<p>ここでは、この2つのループの違いを説明します。最初のループは、変数 i はすでに10に等しい場合は、ループは実行されません。2つ目のループは、ループの最後まで条件が確認されないので、i の値にかかわらず少なくとも1回は実行されます。</p>
<p><br />
</p>
<p>条件をまったく確認しない Do ループを作成できます。次のループについて考察してみましょう。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Do</p>
<p>i = i + 1</p>
<p>Loop</p>
</div>
<p><br />
</p>
<p>確認が行われないため、このループは無限に実行されます。条件を確認する以外の方法でループを強制的に終了するには、Exit メソッドを使用します。ただし、どうなればループが終了するのかを調べるためにコード全体に目を通す必要があるので、こはの方法では一般的に質の悪い設計とみなされます。</p>
<p><br />
</p>
<h3><b>無限ループ</b></h3>
<p>While および Do ループ内部のコードが最終的に条件を満たすことを確認してください。満たすことがない場合、永久に実行される無限ループになってしまいます。無限ループを誤って実行した場合は、デバッガの［停止］ボタンをクリックします。これがうまくいかない場合は、Windows ではタスクマネージャー、OS X では［Force Quit］ウィンドウ、Linux では［Tasks］ウィンドウを使用すると、実行中のアプリケーションを必ず「強制終了」できます。</p>
<p><br />
</p>
<h3><b>長いループ</b></h3>
<p>ループの実行が開始されると、その処理が「占有的」に動作し、ユーザーはメニュー、ボタン、スクロールバーなどのインタフェース要素を操作できません。最新のコンピュータや適度な短さのループでは、ユーザーが別のボタンを押したり、別のメニュー項目を選択したりすることを思いつく前にループが完了するため、こういった問題は発生しません。それ以外の場合は、次のような対処を行うことができます。</p>
<p><br />
</p>
<div>
<p>・ループが終了するまで別の処理の実行を待機する必要がある場合は（ユーザーの操作によりループの結果が無効になる可能性がある場合など）、ループが終了するまでマウスカーソルを「待機」カーソルに変更することにより、長い処理が進行中であることを示すことができます。詳細については、言語リファレンスの MouseCursor クラスに関するセクションを参照してください。</p>
</div>
<div>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Self.MouseCursor = System.Cursors.Wait</p>
</div>
</div>
<p><br />
</p>
<div>
<p>・ループ実行中にユーザーが他のタスクを実行することが許可されている場合は、スレッドの使用を検討してください。スレッドはメインアプリケーション（ユーザー入力を処理し、ユーザーインタフェースを維持管理する）と並行してコードを実行します。しかしコードはバックグラウンドタスクとして実行されるため、フォアグラウンドではユーザー操作を実行できます。『Xojo のフレームワーク』にはスレッドに関する詳細が記載されています。</p>
</div>
<p><br />
</p>
<h3><b>For...Next</b></h3>
<p>ループを実行する必要がある回数が条件に応じて変わるので確定できない場合は While ループおよび Do ループが最適です。For ループは、ループ実行回数を確定できる場合に適しています。たとえば、リストボックスに1から10の数字を追加する必要があるとします。コードの実行回数が厳密にわかっているので、For ループが最適な選択肢です。For ループにはループカウンタ変数、およびループカウンタ変数の開始値と終了値があるという面でも、For ループは While および Do ループとは異なります。For ループの基本構成は次のとおりです。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim Counter As Integer</p>
<p>For Counter = 0 To 100</p>
<p>// [your code goes here]</p>
<p>Next</p>
</div>
<p><br />
</p>
<p>Dim 文は、整数としてカウンタを宣言しています。整数はカウンタ変数を定義する最も一般的な方法ですが、単精度または倍精度として宣言することもできます。</p>
<p><br />
</p>
<p>この例では、Dim 文を使用して通常の方法でカウンタ変数を宣言しました。For ループ外部でカウンタ変数が必要になることは稀なので、For 文内部でカウンタ変数を宣言することもできます。言い換えると、この例は次のように変更できます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>For Counter As Integer = 0 To 100</p>
<p>// [your code goes here]</p>
<p>Next</p>
</div>
<p><br />
</p>
<p>この例からは Dim 文が削除されていることに注目してください。このように宣言したカウンタ変数は、For ループ内でのみ使用できます。For ループ終了後は、この変数はスコープ外になります。これが、推奨されるカウンタ変数宣言方法です。For ループの外でカウンタ変数の値を読み取ったり変更したりする必要がある場合は（必要になることはほとんどありませんが）、当然のことながら Dim 文を代わりに使用してください。</p>
<p><br />
</p>
<p>前の例では、開始値と終了値が数値として指定されています。この例に示されているように変数を使用することもできます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim startingValue, endingValue As Integer</p>
<p>startingValue = 0</p>
<p>endingValue = 100</p>
<p><br />
</p>
<p>For counter As Integer = startingValue To endingValue</p>
<p>// [your code goes here]</p>
<p>Next</p>
</div>
<p><br />
</p>
<p>ループが初めて実行されると、カウンタ変数が StartingValue に設定されます。ループが Next 文に到達すると、カウンタ変数が1ずつ増分されます。Next 文に到達し、カウンタ変数が EndingValue と等しい場合、カウンタが増分されてループが終了します。</p>
<p><br />
</p>
<p>上記の例を振り返ってみましょう。リストボックスに1から10の数字を追加します。次のコードでそれを達成します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>For i As Integer = 1 To 10</p>
<p>ListBox1.AddRow(Str(i))</p>
<p>Next</p>
</div>
<p><br />
</p>
<p>ListBox1 の AddRow メソッドに渡すことができるように、カウンタ変数（この場合、i）を Str 関数に渡して文字列に変換します。</p>
<p><br />
</p>
<div>
<p>
<span>注</span>
 ：歴史的な慣習として、文字「i」はループカウンタとしてよく使用されます。FORTRAN では、文字 I から N はデフォルトでは整数です。したがって、FORTRAN プログラマーはこれらの文字をアルファベット順にカウンタとして使用するようになりました。つまり、FORTRAN プログラマーがあるループを別のループの中にネストする必要がある場合は、内部ループのカウンタとして j を使用します。この慣習により、FORTRAN プログラマーは多次元配列を処理したコードのロジックを簡単にたどることができます。</p>
</div>
<p><br />
</p>
<p>デフォルトでは、For ループはカウンタを1増分します。Step 文を使用すると、別の増分値を指定できます。この例では、1ではなく5ずつカウンタ変数を増分するために Step 文が追加されています。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>For i As Integer = 5 To 100 Step 5</p>
<p>ListBox1.AddRow(Str(i))</p>
<p>Next</p>
</div>
<p><br />
</p>
<p>この例では、For ループが100でカウンタを開始し、5ずつ減分されます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>For i As Integer = 100 DownTo 1 Step 5</p>
<p>ListBox1.AddRow(Str(i))</p>
<p>Next</p>
</div>
<p><br />
</p>
<h4><b>性能に関する考慮事項</b></h4>
<p>これまでは、StartingValue と EndingValue が整数である例を見てきました。StartingValue または EndingValue のいずれかを整数として判定する必要がある式である場合は、式が常に同じ整数として判定される場合でも、カウンタを増分するごとに、For ループが判定を実行します。</p>
<p><br />
</p>
<p>したがって、性能上の理由から、ループを入力する前に判定を実行することをお勧めします。たとえば、ユーザーのコンピュータにインストールされているすべてのフォントを処理する必要があるループを考えてみましょう。フォントの数をあらかじめ把握することはできませんが、フォントの合計を取得するために使用できる FontCount という組み込み関数があります。この関数を For 文で使用して EndingValue を計算すると、次のようになります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>For i As Integer = 0 To FontCount-1</p>
<p>.</p>
<p>.</p>
<p>Next</p>
</div>
<p><br />
</p>
<p>ループの実行速度は、値を1回だけ計算する場合より遅くなります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim numFonts As Integer = FontCount-1</p>
<p>For i As Integer = 0 To numFonts</p>
<p>.</p>
<p>.</p>
<p>Next</p>
</div>
<p><br />
</p>
<p>ただし、非常に長いループでない限り、実質的には速度の違いがない場合もあります。一般的なコンピュータでは、この2つのループ間の違いは極めて小さく、気になるほどではありません。</p>
<p><br />
</p>
<h4><b>ネストされたループ</b></h4>
<p>For ループ（およびその他の種類のループ）は、内部に別のループを含めることができます。For ループの場合、注意が必要なのは、ループが互いに混乱しないようにカウンタ変数が異なることを確認することだけです。下の例では、別の For ループの内部に組み込まれている For ループにより、複数の列を持つリストボックスのすべてのセルを確認して、「Hello」という言葉が含まれるセルの数がカウントされます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim count As Integer</p>
<p>For row As Integer = 0 To ListBox1.ListCount-1</p>
<p>For column As Integer = 0 To ListBox1.ColumnCount-1</p>
<p>If ListBox1.Cell(row, column) = "hello" Then</p>
<p>count = count + 1</p>
<p>End If</p>
<p>Next</p>
<p>Next</p>
<p>MsgBox(Str(count))</p>
</div>
<p><br />
</p>
<p>これを正常に保つもう1つの方法は、「i」以降のアルファベット文字をカウンタとして使用するという、FORTRAN プログラマーが始めた命名規則を使用することです。それにより、ループが実行すべき内容の把握を試みることなく、どのループが別のループの内部にあるかを常に把握できます。</p>
<p><br />
</p>
<h3><b>For...Each 文</b></h3>
<p>値のまとまりをループ処理する必要がある別の状況は、配列の処理です。 For...Each 文はカウンタの値ごとに一連の文をループ処理するのではなく、渡された配列の各要素を処理します。</p>
<p><br />
</p>
<p>カウンタ変数を使用し、配列の値を合計する例を見てみましょう。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim values() As Double</p>
<p>values = Array(2.2, 1.1, 3.3, 4.4)</p>
<p><br />
</p>
<p>Dim sum As Double</p>
<p>Dim element As Double</p>
<p><br />
</p>
<p>For i As Integer = 0 To values.Ubound</p>
<p>sum = sum + values(i)</p>
<p>Next</p>
</div>
<p><br />
</p>
<p>For...Each を使用した同じ処理の例を次に示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim values() As Double</p>
<p>values = Array(2.2,1.1,3.3,4.4)</p>
<p><br />
</p>
<p>Dim sum As Double</p>
<p>Dim element As Double</p>
<p><br />
</p>
<p>For Each element In values</p>
<p>sum = sum + element</p>
<p>Next</p>
</div>
<p><br />
</p>
<p>For...Each 文では、カウンタ変数の代わりに、配列の各要素の値を自動的に取得する変数があります。上の例では、要素変数は、ループを通るたびに values 配列の次の値を取得します。</p>
<p><br />
</p>
<p>配列を使用する場合は、For...Each を使用して、より単純なコードを作成できます。</p>
<p><br />
</p>
<p>配列は必ずしも数字である必要はないので、この文を使用すると、どの型のオブジェクトのグループでも処理できます。たとえば、画像、色、ドキュメント、データベースレコードのセットなどが考えられます。</p>
<p><br />
</p>
<p>For...Next ループの場合と同じように、別の Dim 文ではなく、For...Each 文内部で要素変数のデータ型を宣言できます。たとえば、前の例を次のように書き換えることができます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim values() As Double</p>
<p>values = Array(2.2, 1.1, 3.3, 4.4)</p>
<p><br />
</p>
<p>Dim sum As Double</p>
<p><br />
</p>
<p>For Each element As Double In values</p>
<p>sum = sum + element</p>
<p>Next</p>
</div>
<p><br />
</p>
<h3><b>コードエディタを使用したループの追加</b></h3>
<p>コードエディタのコンテキストメニューは、コードにループを追加する、非常に便利な方法を提供します。コンテキストメニューの最後の3項目は、選択したコード行をある種類のループで囲みます。これらのメニュー項目を使用するには、ループ内部に入るコードを作成して行を選択し、コンテキストメニューからループの種類を選択するだけです。選択肢は、If...End If、Do...Loop、および While...Wend です。</p>
<p><br />
</p>
<p>コードエディタはループ内の選択行を囲むことができますが、ループを終了する条件は把握していません。したがって、プレースホルダーテキスト<span>_condition_</span>
 をループ文に挿入します。この条件はすでに選択されているので、ほかに何も操作する必要はなく、そのまま必要な条件の入力を開始してプレースホルダーテキストを置き換えることができます。</p>
</div>
</div>
</div>


<div id="calibre_link-39">
<div>
<div>
<h2 id="calibre_link-91"><b>
<span><b>Section 8</b></span>
<br /><b></b>
メソッド</b></h2>
<p><br />
</p>
<p>メソッドは、アプリケーションのビルディングブロックです。作成するコードはそのほとんどがメリットに存在します。</p>
<p><br />
</p>
<p>メソッドは、特定のタスク、つまりある種のアクションを達成するために実行される1つ以上の命令です。組み込みメソッドは多数存在します。たとえば、Quit メソッドはアプリケーションを終了します。ほとんどのクラスには組み込みメソッドがあります。たとえば、ListBox クラスには、AddRow と呼ばれるメソッドがあり、名前が暗示するように、行を追加します。</p>
<p><br />
</p>
<p>独自のカスタムメソッドを作成することもできます。</p>
<p><br />
</p>
<p>メソッドには、インスペクタを使用して設定する次の4つの値が含まれます。</p>
<p><br />
</p>
<p><img src="images/000050.jpg" alt="Figure 3.8 コードエディタでのメソッドの編集" />
</p>
<p><br />
</p>
<h5><b>・メソッド名</b></h5>
<div>
<p>メソッドの名前。変数と同じように、メソッドにも内容を表す名前が付けられており、同じルールが適用されます。つまり、名前の長さに制限はありませんが、文字で始める必要があり、英数字（a 〜 z、A 〜 Z、0 〜 9）またはアンダースコア（_）だけを含めることができます。</p>
</div>
<p><br />
</p>
<h5><b>・引数</b></h5>
<div>
<p>引数は、メソッドが使用できるよう、メソッドに渡す値です。</p>
</div>
<p><br />
</p>
<h5><b>・戻り型</b></h5>
<div>
<p>戻り型を指定しないメソッドを<span>サブルーチン</span>
 と呼びます。戻り型を指定するメソッドを<span>関数</span>
 と呼びます。</p>
<p>戻り型は、クラスを含む有効なデータ型のうちのどの型でもあり得ます。</p>
</div>
<p><br />
</p>
<h5><b>・スコープ</b></h5>
<div>
<p>スコープは、メソッドの呼び出し元に関する条件を示します。パブリック、保護、およびプライベートという値があります。</p>
<p><br />
</p>
<div>
<p>・パブリックメソッドは、すべてのユーザーが何の制限もなく呼び出すことができます。</p>
<p>・保護メソッドには、メソッドの場所（クラスまたはモジュール）によって異なるいくつかの制限があります。</p>
<p>・プライベートメソッドを呼び出せるのは、そのメソッドを含むモジュールまたはクラスのみです。</p>
</div>
<p><br />
</p>
<p><img src="images/000078.jpg" alt="Figure 3.9 クラスのメソッド(保護、プライベート、およびパブリック)を表示するナビゲータ" />
</p>
<p><br />
</p>
</div>
<h4><b>メソッドに値を渡す</b></h4>
<p>機能を実行するためには1つ以上の情報が必要なメソッドもあります。この情報を引数と呼びます。引数は、メソッド名の右側に記述して、メソッドに渡します。次の例では、ListBox1 と呼ばれるリストボックスの AddRow メソッドが呼び出されます。AddRow はリストボックスの最後に1行追加し、新しい行でテキストを書き込みます。これを実行するために、引数としてテキストを AddRow に渡す必要があります。次に例を示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>ListBox1.AddRow("January")</p>
</div>
<p><br />
</p>
<p>引数を渡すときには、正しいデータ型の値を渡す必要があります。たとえば、AddRow では文字列が必要です。リストボックスに数字を追加する必要がある場合は、数字を文字列に変換する必要があります。たとえば、数字 12.7 をリストボックスに追加する必要がある場合は、次のように記述します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>ListBox1.AddRow("12.7")</p>
</div>
<p><br />
</p>
<p>または、渡された数字を文字列に変換する組み込み Str 関数を使用することもできます。次の記述も機能します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>ListBox1.AddRow(Str(12.7))</p>
</div>
<p><br />
</p>
<p>Str 関数自体は、数字である引数を1つ受け取って、文字列を返すメソッドです。したがってこの数式は、表示する数字を受け取って文字列に変換し、その文字列を AddRow メソッドに渡します。</p>
<p><br />
</p>
<p>メソッドで複数の引数が必要な場合は、コンマを使用して複数の引数区切ります。ListBox クラスには、リストボックスの任意の位置に新しい行を挿入するために使用する InsertRow と呼ばれるメソッドがあります。InsertRow メソッドには、新しい行の行番号、および新しい行に表示する文字列値の2つの値が必要です。複数の引数が必要な場合は、これらの引数をコンマで区切ります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>ListBox1.InsertRow(3, "January")</p>
</div>
<p><br />
</p>
<p>引数は変数または定数の場合もあります。変数が引数として渡される場合は、変数の現在の値が渡されます。下の例では、変数に値が割り当てられ、引数として渡されます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim month As String</p>
<p>month = "January"</p>
<p>ListBox1.InsertRow(3, month)</p>
</div>
<p><br />
</p>
<h4><b>引数として配列を渡す</b></h4>
<p>配列は、メソッドまたは関数への呼び出しで引数として渡すことができます。1次元配列と多次元配列の両方を渡すことができます。引数が1次元配列であることを指定するには、宣言の名前の後に空のカッコを置きます。次に例を示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>names() As String</p>
</div>
<p><br />
</p>
<p>この記述は、文字列の配列をサブルーチンに渡す場合の宣言で使用できます。渡す配列の要素数を指定する必要はないので、コードの複数の場所で異なる数の要素を渡すことができます。メソッドまたは関数に配列を渡すときは、配列内のカッコを省略します。次に例を示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>PrintLabels(allNames)</p>
</div>
<p><br />
</p>
<p>PrintLabels は、文字列配列を引数として受け取るメソッドの名前です。</p>
<p><br />
</p>
<p>各次元の要素数を指定せずに多次元配列を渡すことができますが、次元数は指定する必要があります。そのためには、次元より1つ少ないコンマをカッコ内に記述します。たとえば、names が2次元文字列配列の場合は、次のように宣言します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>names(,) As String</p>
</div>
<p><br />
</p>
<p>メソッドまたは関数に多次元配列を渡す場合は、次のようにカッコを記述することはできますが、コンマは記述しません。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>PrintLabels(allNames())</p>
</div>
<p><br />
</p>
<h4><b>メソッドから値を返す</b></h4>
<p>値を返すメソッドもあります。これらのメソッドを関数と呼びます。メソッドが値を返す場合、その値はメソッドからメソッドを呼び出したコード行に渡されます。たとえば、グローバルメソッド<span>Ticks</span>
 は、コンピュータをオンにしてから経過したティック数（ティックは1秒の60分の1）を返します。メソッドによって返された値は、値を割り当てるのと同じように割り当てることができます。下の例では、Ticks によって返される値が変数 elapsed に割り当てられます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>elapsed = Ticks</p>
</div>
<p><br />
</p>
<p>引数を要求して値を返すメソッドもあります。たとえば、<span>Chr</span>
 関数は渡された ASCII コードが表す文字を返します。値を返すメソッドに引数を渡す場合は、引数をカッコで囲む必要があります。下の例では、Chr 関数が13（Return の ASCII コード）を渡され、変数 carriageReturn に ASCII コードを返します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>carriageReturn = Chr(13)</p>
</div>
<p><br />
</p>
<p>下の例では、（渡された文字列の文字数を返す）Len 関数によって返された数値が、（数値を文字列に変換する）Str 関数に渡されます。Str 関数によって返される文字列は、リストボックスの InsertRow メソッドに引数として渡されます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>ListBox1.InsertRow(3, Str(Len("Hello")))</p>
</div>
<p><br />
</p>
<h4><b>値と参照により引数を渡す</b></h4>
<p>デフォルトでは、値は値によりメソッドに渡します。この場合、メソッドは渡すデータのコピーを受け取るため、メソッドは元の値に影響を与えることなくデータを変更することができます。</p>
<p><br />
</p>
<p>値によって渡される引数は、Dim 文を使用して作成される変数同様、メソッド内部ではローカル変数として取り扱われます。つまり、先に引数をローカル変数に代入しなくても、引数自体の値を変更できます。たとえば、引数「x」で値を渡す場合は、Dim を使用して作成するローカル変数に x の値を割り当てずに、x の値を増分または減分できます。</p>
<p><br />
</p>
<p>次の例では、引数を変更し、結果を表示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Sub SquareIt(d As Integer)</p>
<p>d = d * d</p>
<p>MsgBox(Str(d))</p>
<p>End Sub</p>
</div>
<p><br />
</p>
<p>独自のメソッドを作成する場合は、参照により情報を渡すという選択肢もあります。参照により情報を渡す場合、実際に渡すのは、情報を含むオブジェクトへのポインターです。この手法の実用面での利点は、メソッドは各引数の値を変更でき、各引数の値を変更後の値と置き換えられるということです。これは、値により引数を渡す場合は実行できません。なぜなら、その場合は引数は値自体のコピーを表しているだけだからです。</p>
<p><br />
</p>
<div>
<p>
<span>注</span>
 ：メソッド宣言で指定されている内容に関わらず、すべての配列およびオブジェクト型は常に参照により渡されます。</p>
</div>
<p><br />
</p>
<p>このように動作する組み込みメソッドはほとんどありません。その1つが ParseDate 関数です。ParseDate はテキストとして記述された日付を取り、Date オブジェクトを返します。ParseDate が特殊なのは、渡される引数に Date を返す点です。ParseDate 関数自体は、関数が成功したかどうかを示すブール値を返します。</p>
<p><br />
</p>
<p>参照で引数を渡すメソッドまたは関数は、その構文でキーワード ByRef を使用します。この場合、ParseDate の構文は次のとおりです。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>result = ParseDate(Text, ByRef Parsedate)</p>
</div>
<p><br />
</p>
<div>
<p>・Text には、構文解析により Date 型を生成する文字列が含まれます。</p>
<p>・ParseDate には、この関数の呼び出しが動作した場合に、Date が格納されます。</p>
<p>・result は、関数呼び出しの成否を示すブール値です。</p>
</div>
<p><br />
</p>
<p>ParseDate を使用するには、Dim 文で Date 変数とブール型変数を宣言します。.次に、構文解析される文字列とともに新しい Date 変数を渡します。呼び出し後、結果を確認し、関数の成否を判断します。次に例を示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim theDate As New Date</p>
<p>Dim success As Boolean</p>
<p>success = ParseDate("12/14/1991", theDate)</p>
<p>If success Then</p>
<p>MsgBox(thedate.AbbreviatedDate)</p>
<p>Else</p>
<p>MsgBox("Invalid Date format!")</p>
<p>End If</p>
</div>
<p><br />
</p>
<h4><b>オプションの引数とデフォルト値</b></h4>
<p>引数をオプションにする方法は2つあり、どちらも宣言を記述するときに実行します。宣言で引数に値を割り当てること、あるいは宣言で Optional キーワードを使用することができます。</p>
<p><br />
</p>
<p>引数の明示的なステータスを明確化するには、Optional キーワードを使用します。この修飾子は引数名の前に配置され、デフォルト値ありでもなしでも使用できます。呼び出し側でこの引数を省略すると、宣言でデフォルト値が指定されていない場合、そのデータ型のデフォルト値が引数として渡されます。次に例を示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>MyMethod(a As Integer, b As Integer, Optional c As Integer)</p>
</div>
<p><br />
</p>
<p>引数 c はオプションです。メソッド呼び出しから省略すると、整数のデフォルト値である0が渡されます。</p>
<p><br />
</p>
<p>特定のデフォルト値を指定したい場合は、次のようにそれを割り当てます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>MyMethod(a As Integer, b As Integer, Optional c As Integer = 5)</p>
</div>
<p><br />
</p>
<p>この例でも引数 c はオプションのままですが、メソッド呼び出しから引数 c を省略すると、値5が渡されます。</p>
<p><br />
</p>
<p>最後に、次のようにデフォルト値を指定すると、<span>Optional</span>
 キーワードを省略できます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>MyMethod(a As Integer, b As Integer, c As Integer = 5)</p>
</div>
<p><br />
</p>
<h4><b>コードでのメソッド名の取得</b></h4>
<p>ロギング目的では、現在実行中のメソッドの名前がわかると便利なことが多々あります。現在実行中のメソッドの名前を取得するには、コード内で CurrentMethodName 定数を使用します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>MsgBox(CurrentMethodName)</p>
</div>
<p><br />
</p>
<h4><b>セッター</b></h4>
<p>メソッドに渡す値は、通常、次のようにメソッド名の後のカッコ内で指定します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>MyMethod(10)</p>
</div>
<p><br />
</p>
<p>場合によっては、次のように引数を割り当てるために、メソッド呼び出しの動作を変えたほうが好ましいこともあります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>MyMethod = 10</p>
</div>
<p><br />
</p>
<p>MyMethod に引数として10を渡すのではなく、MyMethod 値に10を設定しているように見えるので、これはセッターと呼ばれます。この代わりの構文は、引数宣言で Assigns キーワードを使用して有効化できます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Sub MyMethod(Assigns value As Integer)</p>
</div>
<p><br />
</p>
<h3><b>イベント</b></h3>
<p>イベントは、コントロールクラスとよく使用される特別な種類のメソッドです。ただし、コントロールクラス以外の独自のクラスでも実装できます。イベントは、そのイベントを宣言しているクラスによってのみ呼び出すことができます。一般的に言って、イベントはサブクラスが追加機能を実現する方法を提供するために使用されます。</p>
<p><br />
</p>
<p>現時点でイベントについて頭を悩ませる必要はありません。サブクラスとイベントはどちらも、「クラス」の章でより詳細に説明されています。</p>
</div>
</div>
</div>


<div id="calibre_link-56">
<div>
<p><img src="images/000086.jpg" alt="" /></p>
</div>
</div>


<div id="calibre_link-70">
<div>
<div>
<p>
<span>CONTENTS</span>
</p>
<p><br />
</p>
<div>
<p>
<a href="#calibre_link-71">4. モジュール</a>
</p>
</div>
<div>
<div>
<p>
<a href="#calibre_link-72">4.1. モジュールについて</a>
</p>
<p>
<a href="#calibre_link-73">4.2. プロジェクト項目のグループ化（名前空間）</a>
</p>
<p>
<a href="#calibre_link-74">4.3. 拡張メソッド</a>
</p>
</div>
</div>
</div>
</div>
</div>


<div id="calibre_link-25">
<div>
<div>
<h2 id="calibre_link-72"><b>
<span><b>Section 1</b></span>
<br /><b></b>
モジュールについて</b></h2>
<p><br />
</p>
<h3><b>モジュールの理解</b></h3>
<p>モジュールはプロジェクト項目のコレクションです。この場合のプロジェクト項目は、通常メソッドプロパティと定数です。ただし、モジュールには、クラスなどのその他のプロジェクト項目や、その他のモジュールさえ含めることができます。実際には、モジュールには、ウィンドウとコンテナコントロールを除くすべてを含めることができます。</p>
<p><br />
</p>
<p>モジュールはグローバルとみなされ、プロジェクト内のどこでもアクセスできます。</p>
<p><br />
</p>
<p>ただし、モジュールに追加する項目のスコープはコントロールすることができます。</p>
<p><br />
</p>
<h3><b>モジュールを使用する場合</b></h3>
<p>一般的に、Xojo などのオブジェクト指向言語では、モジュールはあまり使わないようにする必要があります。ほとんどの場合は、クラスのほうが役立ちます。</p>
<p>これを前提として、モジュールの一般的な（かつ有効な）用途を次に示します。</p>
<p><br />
</p>
<div>
<p>・グローバル定数（特にローカリゼーション目的）</p>
<p>・名前空間へのプロジェクト項目のグループ化</p>
<p>・クラスの拡張</p>
<p>・グローバルプロパティとメソッド（ただし、最小限に抑える）</p>
</div>
<p><br />
</p>
<p>ここでまずモジュールを取り上げるのは、使用と学習が容易で、（次章で取り上げる）クラスにスムーズに移行できるためです。</p>
<p><br />
</p>
<h3><b>モジュールの追加</b></h3>
<p>プロジェクトに新しいモジュールを追加するには、ツールバーの［挿入］ボタンをクリックして［モジュール］を選択します（または、メニューの［挿入］→［モジュール］またはコンテキストメニューを使用します）。新しいモジュールは、デフォルトの名前でナビゲーターに表示されます（たとえば、最初に追加するモジュールの名前は<span>Module1</span>
 となります）。インスペクタを使用すると、モジュールの名前をより適切なものに変更することができます。たとえば、モジュールに財務関数が含まれる場合は、<span>Financial</span>
 という名前にすることができます。</p>
<p><br />
</p>
<p>モジュールは、コードエディタを使用して編集します。ナビゲーターでモジュールの名前をクリックするだけです。モジュールは、ナビゲーターで特別なアイコン（<img src="images/000079.jpg" alt="" />
 ）によって識別されます。</p>
<p><br />
</p>
<p>モジュールには、主にプロパティ、定数、およびメソッドが含まれます。</p>
<p><br />
</p>
<h3><b>モジュールへのプロパティの追加</b></h3>
<p>プロパティは、1つのメソッドではなくモジュール全体に属する変数です。</p>
<p><br />
</p>
<p>モジュールにプロパティを追加するには、コードエディタツールバーの［追加］ボタン、メニューの［挿入］→［プロパティ］、コンテキストメニュー、またはキーボードショートカット（OS X では［Option］-［Command］-［P］、Windows と Linux では［Ctrl］+［Shift］+［P］）を使用します。)</p>
<p><br />
</p>
<p>プロパティ名、型、デフォルト値、およびスコープは、インスペクタのフィールドを使用して設定できます。</p>
<p><br />
</p>
<div>
<p>
<span>注</span>
 ：簡単にプロパティを作成する方法として、その名前と型を［名前］フィールドに「PropertyName As DataType」のように１行で入力します。このフィールドから移動すると、入力した型が［型］フィールドに設定されます。</p>
</div>
<p><br />
</p>
<h3><b>モジュールへのメソッドの追加</b></h3>
<p>モジュールにメソッドを追加するには、コードエディタツールバーの［追加］ボタン、メニューの［挿入］→［メソッド］、コンテキストメニュー、またはキーボードショートカット（OS X では［Option］-［Command］-［M］、Windows と Linux では［Ctrl］+［Shift］+［M］）を使用します。</p>
<p><br />
</p>
<p>インスペクタを使用して、メソッドの名前、引数、戻り型、およびスコープを設定できます。</p>
<p><br />
</p>
<p><img src="images/000000.jpg" alt="Figure 4.1 モジュールのメソッド(保護、プライベート、およびパブリック)を表示するナビゲータ" />
</p>
<p><br />
</p>
<h3><b>モジュールへの定数の追加</b></h3>
<p>「<a href="#calibre_link-26">第3章 Xojo プログラミング</a>
 」で前述したとおり、定数はプログラム実行中に値を変更できない変数のようなものです。</p>
<p><br />
</p>
<p>モジュールに定数を追加できた場合、その定数は1つのメソッドではなくモジュールに属しています。</p>
<p><br />
</p>
<p>モジュールに定数を追加するには、コードエディタツールバーの［追加］ボタン、メニューの［挿入］→［定数］、コンテキストメニュー、またはキーボードショートカット（OS X では［Option］-［Command］-［C］、Windows と Linux では［Ctrl］+［Shift］+［C］）を使用します。</p>
<p><br />
</p>
<p>残念ながら、メソッドで Const キーワードを使用して作成した場合と異なり、この方法で作成した定数には関数からの値を割り当てることはできません。この動作をシミュレートする方法の1つは、代わりに希望する値を返すメソッドをモジュールに追加するというものです。</p>
<p><br />
</p>
<p>たとえば、モジュールに次のメソッドを追加すると、復帰改行文字（ASCII 13）を返すメソッドを作成できます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Function CR as String</p>
<p>Return Chr(13)</p>
<p>End Function</p>
</div>
<p><br />
</p>
<h3><b>モジュールの項目のスコープ</b></h3>
<p>モジュールに項目を追加する場合は、インスペクタで Scope プロパティを使用してそのスコープを設定する必要があります。スコープは、ナビゲーターでも示されます。項目のスコープにより、プロジェクト内のその他の項目に対するアクセス性が決まります。次の3つの選択肢があります。</p>
<p><br />
</p>
<div>
<p>・<span>グローバル</span>
 : グローバル項目は、アプリケーション全体のコードで使用できます。グローバルスコープは、モジュール内の項目に対してのみ使用できます。たとえば、グローバルプロパティを使用すると、ウィンドウが1つも開いてない場合でも、複数の異なるウィンドウおよびアプリケーション全体からアクセスできる必要がある情報を格納することができます（OS X のみ）。コードがグローバル項目にアクセスする必要がある場合は、アプリケーションのどこからでも名前で参照するだけです。ネストされたモジュール内の項目に対して、グローバルスコープを使用することはできません。</p>
<p><br />
</p>
<p>・<span>パブリック</span>
 : パブリック項目も、アプリケーション全体でコードからアクセスできます。モジュール外部にあるパブリック項目にアクセスする必要がある場合は、「ドット」表記を使用し、名前の前にモジュール名を記述します。たとえば、Module1 でパブリックプロパティ MyPublicProperty を宣言している場合、Module1 の外部では、Module1.MyPublicProperty という構文を使用してアクセスします。ネストされたモジュールでパブリックプロパティを作成する場合、モジュールの外部で参照するときはプロパティへのフルパスを含める必要があります。たとえば、Module1 内にネストされている Module2 でパブリックプロパティ myPublicProperty を宣言している場合、Module1 の外部では、Module1.Module2.MyPublicProperty と参照します。</p>
<p><br />
</p>
<p>・<span>プライベート</span>
 : プライベート項目は、そのモジュール内でのみアクセスできます。アプリケーションの他の部分からは「見えません」。プライベート項目を作成したモジュール内部でその項目にアクセスする必要がある場合は、名前で参照するだけです。ネストされたモジュールで作成したプライベート項目は、その上位のモジュールからアクセスできません。しかし、上位のモジュール内のプライベート項目は、ネストされたモジュールからアクセスできます。</p>
</div>
</div>
</div>
</div>


<div id="calibre_link-36">
<div>
<div>
<h2 id="calibre_link-73"><b>
<span><b>Section 2</b></span>
<br /><b></b>
プロジェクト項目のグループ化（名前空間）</b></h2>
<p><br />
</p>
<h3><b>モジュールへのプロジェクト項目の追加</b></h3>
<p>モジュールには、クラス、クラスインタフェースなどのその他のプロジェクト項目や、その他のモジュールさえ含めることができます。モジュールに、ウィンドウ、ウェブページ、iOS ビュー、またはコンテナを含めることはできません。</p>
<p><br />
</p>
<p>クラス、クラスインタフェース、およびその他のモジュールを含めることができるというモジュールが備える機能は、モジュール名前空間システムを表します。クラス、インタフェース、およびモジュールは、モジュールの名前空間内に「存在」します。モジュールの名前空間は、プロジェクト自体によって表されるルート名前空間と対照的です。ナビゲーターに一覧表示されるクラス、クラスインタフェース、およびモジュールは、技術的にプロジェクトのルート名前空間内にあります。</p>
<p><br />
</p>
<p><img src="images/000065.jpg" alt="Figure 4.2 クラスを含むモジュールを表示するナビゲータ" />
</p>
<p><br />
</p>
<p>モジュール内のクラスは、モジュール内部に「存在」します。モジュールの外部では、モジュールクラスはドット表記によって参照されます。次に例を示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim c As New Module1.Class1</p>
<p>c.MethodCall</p>
</div>
<p><br />
</p>
<p>上の例では、Class1 は Module1 に含まれています。</p>
<p><br />
</p>
<p>モジュールがその他のプロジェクト項目を含む場合、ナビゲーターのモジュールに開示ウィジェット（小さい三角形）が表示されます。</p>
<p><br />
</p>
<h4><b>
<span><b>Using</b></span>
 文</b></h4>
<p>Using 文を使用すると、名前空間内に含まれる項目にアクセスしようとするたびに完全な名前空間名を記述しなくて済みます。たとえば、次のようなコードを作成すると、完全なドット表記を使用せずに Module1 内のクラスにアクセスできます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Using Module1</p>
<p>Dim c As New Class1 // Module1 内</p>
<p>c.MethodCall</p>
</div>
<p><br />
</p>
<h3><b>モジュールクラスへのプロジェクトクラスの変換</b></h3>
<p>プロジェクトクラスはモジュールクラスに変更できます。プロジェクトクラスはナビゲーターに表示され、プロジェクトでグローバルに使用できます。</p>
<p><br />
</p>
<p>ナビゲーターでモジュールクラスにプロジェクトクラスを変換するには、モジュール名にクラスをドラッグします。</p>
<p><br />
</p>
<p>モジュール名が青いハイライト表示ボックスに囲まれていることに注意してください。これは、クラスがモジュールに追加されることを示しています。</p>
<p><br />
</p>
<p>ドラッグが成功すると、インデントが付けられたクラスがモジュール内に表示されます。</p>
<p><br />
</p>
<h3><b>モジュール内でのモジュールのネスト</b></h3>
<p>モジュールには他のモジュールを含めることができます。別のモジュールでネストされたモジュールには、最上位レベルのモジュールとまったく同じように、クラス、クラスインタフェース、メソッド、プロパティ、定数、構造体、および列挙型を含めることができます。項目のスコープにより、モジュール外部での参照方法が決まります。ただし、より上位のモジュールはネストされたモジュール内の項目を「見る」ことはできません。</p>
<p><br />
</p>
<p>モジュール内の項目は、モジュール名に接頭辞を付けることにより参照します。</p>
<p><br />
</p>
<p>ネストされた新しいモジュールには他のモジュールを含めることができます。モジュールのネストは無制限に続けることができます。</p>
<p><br />
</p>
<p>モジュール内部のクラス内にあるメソッドは、モジュール直下にあるメソッドと同じように、モジュールのメンバーを認識します。含まれるクラスはすべてのプライベートモジュールメンバーにアクセスでき、モジュール名を指定する必要なく、パブリックモジュールメンバーを参照できます。</p>
<p><br />
</p>
<h3><b>ネストされたモジュールの項目のスコープ</b></h3>
<p>ネストされたモジュールに項目を追加する場合は、その Scope 属性を設定する必要があります。項目のスコープにより、その項目にアクセスできるプロジェクト内の他の項目が決まります。次の2つの値が考えられます。</p>
<p><br />
</p>
<p><img src="images/000029.jpg" alt="Figure 4.3 プライベートクラスを含むモジュール" />
</p>
<p><br />
</p>
<div>
<p>・パブリック：パブリック項目は、アプリケーション全体のコードからもアクセスできます。ネストされたモジュールでパブリック項目を作成する場合は、参照するときに項目へのフルパスを含める必要があります。たとえば、Module1 内にネストされている Module2 にあるパブリックプロパティ MyPublicProperty を宣言する場合は、それ自身が属するモジュールの外部で Module1.Module2.MyPublicProperty と参照します。Module1 でパブリックプロパティを宣言している場合、Module2 では Module1.MyPublicProperty としてアクセスできます。</p>
<p><br />
</p>
<p>・プライベート：プライベート項目は、そのモジュール内でのみアクセスできます。アプリケーションの他の部分からは「見えません」。モジュール内部のコードがプライベートメソッド、プロパティ、または定数にアクセスする必要がある場合は、名前で参照するだけです。ネストされたモジュールで作成したプライベート項目は、その上位のモジュールからアクセスできません。しかし、上位のモジュール内のプライベート項目は、ネストされたモジュールからアクセスできます。</p>
</div>
</div>
</div>
</div>


<div id="calibre_link-110">
<div>
<div>
<h2 id="calibre_link-74"><b>
<span><b>Section 3</b></span>
<br /><b></b>
拡張メソッド</b></h2>
<p><br />
</p>
<p>クラス拡張メソッドは、別のオブジェクトに属することを示す構文を使用して呼び出すことができるメソッドです。たとえば、特定のフォーマットで何かを保存するために、FolderItem オブジェクトから呼び出すメソッドを追加することができます。クラス拡張メソッドは、モジュールに追加した後、FolderItem クラスに組み込んだかのように呼び出すことができます。</p>
<p><br />
</p>
<p>この特長は、ソースコードにアクセスできないクラスを拡張する必要がある場合に便利です。特に、組み込みフレームワーククラスの機能を拡張できます。</p>
<p><br />
</p>
<p>メソッドをクラス拡張メソッドとして定義するには、1つ目の引数の前に<span>Extends</span>
 キーワードを使用します。1つ目の引数のデータ型は、このメソッドを呼び出す際に指定する必要があるオブジェクト型です。言い換えると、Extends キーワードを使用すると、その引数をこのメソッドを呼び出す文でドット（「.」）演算子の左側に使用することを指定します。Extends キーワードを使用する場合、その型のオブジェクトをメソッドに渡す必要はありません。「通常の」引数は、引数宣言のExtends を指定した引数の後に追加することができます。</p>
<p><br />
</p>
<p>Extends キーワードは、モジュールに常駐するグローバルメソッドでのみ使用できます。モジュールがプロジェクト内にある限り、プロジェクトのどこからでもこのクラス拡張メソッドを呼び出すことができます。</p>
<p><br />
</p>
<p>このクラス拡張メソッドを別のプロジェクトで使用するために必要な手順は、そのプロジェクトにモジュールをインポートするだけです。</p>
<p><br />
</p>
<h3><b>クラス拡張メソッドの記述</b></h3>
<p>たとえば、テキストエリアオブジェクトから呼び出すことができるメソッドを追加することができます。テキストエリアのテキストを消去する<span>Clear</span>
 メソッドが必要だとします。モジュールがまだない場合はプロジェクト内で作成し、そのモジュールに<span>Clear</span>
 メソッドを追加します。</p>
<p><br />
</p>
<p>次のような引数となります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Extends ta As TextArea</p>
</div>
<p><br />
</p>
<p>この拡張のコードは次のように単純です。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>ta.Text = ""</p>
</div>
<p><br />
</p>
<p>Extends キーワードは、プロジェクト内にあるどのテキストエリアオブジェクトからもこのメソッドを呼び出すことができることを示します。クラス拡張メソッドのスコープはグローバルでなければならない点も注意してください。</p>
<p><br />
</p>
<h4><b>クラス拡張メソッドの呼び出し</b></h4>
<p>このメソッドは、プロジェクトのどこからでも呼び出すことができます。ウィンドウのどこかで次の行を使用するだけです。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>TextArea1.Clear</p>
</div>
<p><br />
</p>
<p><img src="images/000113.jpg" alt="Figure 4.4 Clear 拡張メソッド" />
</p>
<p><br />
</p>
<p>この記述は、TextArea1 という名前のテキストエリアがあることを前提にしています。</p>
<p><br />
</p>
<p>このクラス拡張メソッドを別のプロジェクトで使用するために必要な手順は、クラス拡張メソッドの定義を含むモジュールをそのプロジェクトにコピーするだけです。</p>
</div>
</div>
</div>


<div id="calibre_link-69">
<div>
<p><img src="images/000112.jpg" alt="" /></p>
</div>
</div>


<div id="calibre_link-27">
<div>
<div>
<p>
<span>CONTENTS</span>
</p>
<p><br />
</p>
<div>
<p>
<a href="#calibre_link-28">5. クラス</a>
</p>
</div>
<div>
<div>
<p>
<a href="#calibre_link-29">5.1. クラスについて</a>
</p>
<p>
<a href="#calibre_link-30">5.2. オブジェクト指向設計の概念</a>
</p>
<p>
<a href="#calibre_link-31">5.3. プロパティ、メソッド、およびイベント</a>
</p>
<p>
<a href="#calibre_link-32">5.4. コンストラクタとデストラクタ</a>
</p>
<p>
<a href="#calibre_link-33">5.5. インタフェース</a>
</p>
<p>
<a href="#calibre_link-34">5.6. サブクラスの例</a>
</p>
<p>
<a href="#calibre_link-35">5.7. クラスの応用機能</a>
</p>
</div>
</div>
</div>
</div>
</div>


<div id="calibre_link-55">
<div>
<div>
<h2 id="calibre_link-29"><b>
<span><b>Section 1</b></span>
<br /><b></b>
クラスについて</b></h2>
<p><br />
</p>
<h3><b>クラスとは</b></h3>
<p>簡単に言うと、クラスはコードのコンテナでモジュールに類似しています。ただし、モジュールと異なる点として、クラスを使用した方が、コードを再利用しやすくなります。</p>
<p><br />
</p>
<p>クラスは、オブジェクト指向プログラミングの基本的なビルディングブロックです。</p>
<p><br />
</p>
<h4><b>クラスの利点</b></h4>
<p>クラスは、次に示す例を含む多数の利点を提供します。</p>
<p><br />
</p>
<h5><b>・再利用可能なコード</b></h5>
<div>
<p>押しボタンコントロールにコードを追加してその動作をカスタマイズする場合、追加したコードはその押しボタンでのみ使用できます。別の押しボタンで同じコードを使用する場合は、コードをコピーし、元の押しボタンを参照していた場合はコードを変更する必要があります（新しい押しボタンと元の押しボタンの名前は異なるため）。</p>
<p><br />
</p>
<p>クラスは一度だけコードを格納し、変更を行わずに何度でも同じコードを再利用できるように、一般にはオブジェクト（PushButton など）を参照します。押しボタンコントロールを基にしてクラスを作成し、そのクラスにコードを追加すると、そのカスタムクラスのすべてのインスタンスに追加されたコードが含まれます。</p>
</div>
<p><br />
</p>
<h5><b>・プロジェクトとアプリケーションのコンパクト化</b></h5>
<div>
<p>クラスを使用すると、一度だけコードを格納しプロジェクト内で何度も使用できるため、プロジェクトおよび結果的に作成されるアプリケーションはコンパクト化され、必要メモリも縮小できる場合があります。</p>
</div>
<p><br />
</p>
<h5><b>・コードの保守性の向上</b></h5>
<div>
<p>コードが減るということは、保守も減るということです。基本的にアプリケーションの複数の場所に同じコードがある場合は、変更を加えるときやバグを修正するときに、それを忘れないようにする必要があります。コードのコピーを1つ格納することにより、プロジェクト内で同じコードを使用している場所をすべて追跡するために必要な時間が減ります。クラス内のコードを変更すると、クラスが使用されているすべての場所が自動的に更新されます。</p>
</div>
<p><br />
</p>
<h5><b>・デバッグの容易化</b></h5>
<div>
<p>コードが減れば減るほど、デバッグが必要なコードも減ります。</p>
</div>
<p><br />
</p>
<h5><b>・コントロールの拡大</b></h5>
<div>
<p>ウィンドウのコントロールのイベントハンドラにコードを追加する場合よりも、クラスを使用する場合のほうが、コントロールできる対象が広がります。実際、メニューまで管理できるクラスもあります。クラスを使用してカスタムコントロールを作成することもできます。また、クラスを使用すると、クラスのソースコードへのアクセスを許可しないバージョンを作成できるので、他人と共有または販売できるクラスを作成することもできます。</p>
</div>
<p><br />
</p>
<h3><b>プロジェクトでのクラスの使用</b></h3>
<p>プロジェクトでクラスを使用する前に、クラス自体、クラスのインスタンス、およびクラスへの参照という3つの概念の違いを理解することが重要です。</p>
<p><br />
</p>
<h4><b>クラス</b></h4>
<p>クラスは、モジュールによく似た、情報コンテナのテンプレートと考えてください。モジュールと同じように、各クラスはプロジェクト内に1回だけ存在します。ただし、モジュールとは異なり、クラスは複数のインスタンスを持つことができます。</p>
<p><br />
</p>
<h4><b>インスタンス</b></h4>
<p>クラスを使用すると、インスタンスと呼ばれる概念により、コードを再利用しやすくなります。アプリケーション内に1回だけ存在するモジュールと異なり、クラスは複数のインスタンスを持つことができます。（オブジェクトとも呼ばれる）各インスタンスは、クラスおよびクラスのすべてのメソッドとプロパティの独立したコピーです。</p>
<p><br />
</p>
<p>たとえば、インタフェースコントロールには、PushButton、WebButton、Label、WebLabel、TextField、WebTextField、ListBox、WebListBox などの多数のビルトインクラスが存在します。</p>
<p><br />
</p>
<p>コントロールクラスは単なる抽象的なテンプレートで、それだけではあまり役立ちません。ただし、ウィンドウにコントロールクラスを追加するたびに、そのクラスのインスタンスが生成されます。各ボタンは独立したインスタンスなので、それぞれ互いに完全に独立した複数のボタンを1つのウィンドウに配置できます。</p>
<p><br />
</p>
<p>これらのインスタンスは、プログラマーがウィンドウでコードを作成するときに操作し、ユーザーがアプリケーションを使用するときに操作する対象です。</p>
<p><br />
</p>
<p>たとえば、ライブラリからウィンドウにテキストエリアをドラッグすると、ウィンドウにテキストエリアの使用可能なインスタンスが作成されます。新しいインスタンスには、TextArea クラスに組み込まれているすべてのプロパティとメソッドが含まれます。スタイル設定したテキスト、複数の行、スクロールバーなどのすべてを手に入れることができます。テキストエリアの特定のインスタンスをカスタマイズするには、そのインスタンスのプロパティの値を変更します。</p>
<p><br />
</p>
<p>ウィンドウ（またはウェブページ）にコントロールを追加すると、レイアウトエディタが自動的に参照を作成します（コントロールの名前が付けられます）。</p>
<p><br />
</p>
<p>コードを作成するときは、次のように New キーワードを使用してクラスのインスタンスを作成します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim car As New Vehicle</p>
</div>
<p><br />
</p>
<h4><b>参照</b></h4>
<p>参照は、クラスのインスタンスを参照する変数またはプロパティです。</p>
<p><br />
</p>
<p>上のコード例では、car 変数が Vehicle クラスのインスタンスへの参照です。</p>
<p><br />
</p>
<p>クラスのプロパティとメソッドとは、次のようにドット表記を使用して操作します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim car As New Vehicle</p>
<p>car.Brand = "Ford"</p>
<p>car.Model = "Focus"</p>
</div>
<p><br />
</p>
<p>ここで、Brand と Model は Vehicle クラスのプロパティとして定義されており、特定のインスタンスの値が指定されています。</p>
<p><br />
</p>
<p>この変数またはプロパティがインスタンスへの参照を指していることを念頭に置いてください。これは、別の変数に参照を割り当てるときに重要な考慮事項です。</p>
<p><br />
</p>
<p>ある参照変数から別の参照変数に割り当てる場合、2つ目の変数は1つ目の変数と同じ参照を指します。つまり、クラスのコピーではなくクラスの同じインスタンスが参照されるということを意味します。いずれかの変数でクラスのプロパティを変更すると、そのプロパティは両方に対して変更されます。次の例を参照してください。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim car As New Vehicle</p>
<p>car.Brand = "Ford"</p>
<p>car.Model = "Focus"</p>
<p><br />
</p>
<p>Dim truck As Vehicle</p>
<p>truck = car</p>
<p>// truck.Model = "Focus"</p>
<p><br />
</p>
<p>car.Model = "Mustang"</p>
<p>// truck.Model is now also "Mustang"</p>
<p><br />
</p>
<p>truck.Model = "F-150"</p>
<p>// car.Model is now also "F-150"</p>
</div>
<p><br />
</p>
<p>Figure 5.1 を見ると、car と truck の両方の変数が Vehicle の同じインスタンスを指していることがわかります。したがって、どちらかを変更すると両方が変更されます。</p>
<p><br />
</p>
<p><img src="images/000072.jpg" alt="Figure 5.1 同一のインスタンスを指す2つの変数" />
</p>
<p><br />
</p>
<p>クラスのコピーを作成する場合は、代わりに（New キーワードを使用して）新しいインスタンスを作成し、次のように個々のプロパティをコピーする必要があります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim car As New Vehicle</p>
<p>car.Brand = "Ford"</p>
<p>car.Model = "Focus"</p>
<p><br />
</p>
<p>Dim truck As New Vehicle</p>
<p>truck.Brand = car.Brand</p>
<p>trunk.Model = car.Model</p>
<p><br />
</p>
<p>// truck.Model is now also "Focus"</p>
<p>truck.Model = "F-150"</p>
<p><br />
</p>
<p>// car.Model remains "Focus"</p>
</div>
<p><br />
</p>
<p>このように実行すると、2つの別々のインスタンスが生成されます。￼</p>
<p><br />
</p>
<p><img src="images/000026.jpg" alt="" />
</p>
<p><br />
</p>
<h3><b>クラスの作成</b></h3>
<p>クラスはプロジェクトに容易に追加できます。新しいクラスを追加するには、ツールバーの［挿入］ボタンをクリックして［クラス］を選択するか、［挿入］メニューで［クラス］を選択します。これにより、新しいクラスがデフォルトの名前（最初のクラスの場合は Class1）でナビゲーターに追加されます。</p>
<p><br />
</p>
<p>クラスの名前を変更するには、インスペクタを使用します。</p>
<p><br />
</p>
<p>モジュールのように、クラスには主にプロパティとメソッドが含まれます。</p>
<p><br />
</p>
<h3><b>クラスへのプロパティの追加</b></h3>
<p>プロパティは、1つのメソッドではなくクラスインスタンス全体に属する変数です。</p>
<p><br />
</p>
<p>クラスにプロパティを追加するには、コードエディタツールバーの［追加］ボタン、メニューの［挿入］→［プロパティ］、コンテキストメニュー、またはキーボードショートカット（OS X では［Option］-［Command］-［P］、Windows と Linux では［Ctrl］+［Shift］+［P］）を使用します。</p>
<p><br />
</p>
<p>プロパティ名、型、デフォルト値、およびスコープは、インスペクタを使用して設定できます。</p>
<p><br />
</p>
<div>
<p>
<span>注</span>
 ：簡単にプロパティを作成する方法として、その名前と型を［名前］フィールドに「PropertyName As DataType」のように１行で入力できます。このフィールドから移動すると、入力した型が［型］フィールドに設定されます。</p>
</div>
<p><br />
</p>
<p>このように追加したプロパティは、クラスのインスタンスでのみ使用できるので、<span>インスタンスプロパティ</span>
 と呼ばれる場合もあります。</p>
<p><br />
</p>
<p>インスタンスを使用せずにクラス自体を通してアクセスできるプロパティを追加することもできます。これらは共有プロパティと呼ばれます。</p>
<p><br />
</p>
<h4><b>共有プロパティ</b></h4>
<p>共有プロパティ（<span>クラスプロパティ</span>
 と呼ばれる場合もある）は、クラスのインスタンスではなくクラスに属することを除き、「通常の」プロパティと同じです。共有プロパティはグローバルで、スコープによる許容範囲のどこからでもアクセスできます。さまざまな点で、モジュールプロパティのように機能します。</p>
<p><br />
</p>
<p>共有プロパティは文字通り共有されるということを理解することが重要です。共有プロパティの値を変更すると、共有プロパティは基本的にすべての場所で変更されます。</p>
<p><br />
</p>
<p>一般的に言うと、共有プロパティは特別な場合でのみ必要な応用機能です。</p>
<p><br />
</p>
<h3><b>クラスへのメソッドの追加</b></h3>
<p>クラスにメソッドを追加するには、コードエディタツールバーの［追加］ボタン、メニューの［挿入］→［メソッド］、コンテキストメニュー、またはキーボードショートカット（OS X では［Option］-［Command］-［M］、Windows と Linux では［Ctrl］+［Shift］+［M］）を使用します。</p>
<p><br />
</p>
<p>インスペクタを使用して、メソッドの名前、引数、戻り型、およびスコープを設定できます。</p>
<p><br />
</p>
<div>
<p>
<span>注</span>
 ：メソッド名を入力すると、フィールドはスーパークラスの任意のメソッドの名前で自動的に補完されます。</p>
</div>
<p><br />
</p>
<p>このように追加したメソッドは、クラスのインスタンスでのみ使用できるので、<span>インスタンスメソッド</span>
 と呼ばれます。</p>
<p><br />
</p>
<p>クラス自体を通してアクセスできるメソッドを追加することもできます。これらは共有メソッドと呼ばれます。</p>
<p><br />
</p>
<h4><b>共有メソッド</b></h4>
<p>共有メソッド（<span>クラスメソッド</span>
 と呼ばれる場合もある）は、クラスのインスタンスではなくクラスに属することを除き、通常のメソッドと同じです。共有メソッドはグローバルで、スコープによる許容範囲のどこからでも呼び出せます。さまざまな点で、モジュールメソッドのように機能します。</p>
<p><br />
</p>
<p>共有メソッドは文字通り共有されるということを理解することが重要です。インスタンスを認識しないので、クラスの他の共有メソッドまたはプロパティにのみアクセスできます。</p>
<p><br />
</p>
<p>一般的に言うと、共有メソッドは特別な場合でのみ必要な応用機能です。たとえば、クラスのインスタンスを使用して項目（人、商品、売買取引など）を追跡する場合は、カウンタとして共有プロパティを使用できます。クラスのインスタンスを作成または破棄するたびに、コンストラクタでは共有プロパティの値を増分し、デストラクタでは共有プロパティの値を減分することによって実現できます（コンストラクタとデストラクタについては、「コンストラクタとデストラクタ」のセクションを参照してください）。これにアクセスすると、クラスの現在のインスタンス数を把握できます。</p>
</div>
</div>
</div>


<div id="calibre_link-112">
<div>
<div>
<h2 id="calibre_link-30"><b>
<span><b>Section 2</b></span>
<br /><b></b>
オブジェクト指向設計の概念</b></h2>
<p><br />
</p>
<p>このセクションでは、クラスに適用されるオブジェクト指向設計の重要な概念であるカプセル化、オーバーロード、継承、および多様性を取り上げます。</p>
<p><br />
</p>
<h3><b>カプセル化</b></h3>
<p>カプセル化は、開示する必要がない情報を隠すプロセスです。クラスにより、プロパティとメソッドのスコープを使用してカプセル化をコントロールすることができます。可視性の低いものから高いものまで順番に、プライベート、保護、パブリックがあります。</p>
<p><br />
</p>
<h4><b>プライベート</b></h4>
<p>スコープをプライベートに設定すると、その項目には現在のクラスインスタンス（または共有項目の場合はクラス）からのみアクセスできます。コードの残りの部分からその項目を見ることはできません。</p>
<p><br />
</p>
<p>これは最も制限が厳しい設定です。実際のコーディングでは、クラスインスタンス外部で必要ない場合は、項目をプライベートに設定する習慣を付けることをお勧めします。</p>
<p><br />
</p>
<p>慣行として、プライベートプロパティの前には、次のように「m」を付けます。</p>
<p><br />
</p>
<p>mUserName As String</p>
<p><br />
</p>
<h4><b>保護</b></h4>
<p>スコープが保護であるとは、その項目には現在のクラスインスタンス（または共有項目の場合はクラス）とそのサブクラスからアクセスできることを意味します。</p>
<p><br />
</p>
<p><img src="images/000037.jpg" alt="Figure 3.9 クラスのメソッド(保護、プライベート、およびパブリック)を表示するナビゲータ" />
</p>
<p><br />
</p>
<p>保護メソッド、プロパティ、または定数は、そのクラスとそのクラスに基づくサブクラス内の他のコードでのみ使用できます。アプリケーションの他の部分からは「見えません」。クラス内の他のコードが保護メソッド、プロパティ、または定数にアクセスする必要がある場合は、名前で参照するだけです。クラスの外部で保護メソッド、プロパティ、または定数にアクセスしようとした場合、プロジェクトを実行しようとしたときに、項目がスコープ外になることを示す情報エラーメッセージが表示されます。</p>
<p><br />
</p>
<h4><b>パブリック</b></h4>
<p>パブリックメソッド、プロパティ、または定数は、アプリケーション全体でコードからアクセスできます。パブリック項目は、car.Model などのような、クラス参照と名前で表されるドット表記を使用して参照します。</p>
<p><br />
</p>
<h3><b>オーバーロード</b></h3>
<p>オーバーロードは、名前が同じだが、メソッドシグネチャーが異なる（引数の数が異なる、引数のデータ型が異なる、サブクラスに属するなど）メソッドを意味する用語です。</p>
<p><br />
</p>
<div>
<p>
<span>注</span>
 ：戻り値を基にメソッドをオーバーロードすることはできません。</p>
</div>
<p><br />
</p>
<p><img src="images/000014.jpg" alt="Figure 5.2 オーバーロードされた計算メソッド" />
</p>
<p><br />
</p>
<p>独自のクラスのメソッドをオーバーロードするには、クラスに新しいメソッドを追加し、異なる引数を指定するだけです。このメソッドは、区別のためメソッドの下にオーバーロードした引数を示した状態で、ナビゲーターに表示されます。</p>
<p><br />
</p>
<p>組み込みフレームワーククラスのメソッドをオーバーロードするには、まず継承を使用してサブクラスを作成する必要があります。</p>
<p><br />
</p>
<p>特別に実装されている各種関数を使用し、演算子をオーバーロードすることもできます。オーバーロードされている組み込み型演算子の好例として、「+」演算子があります。引数が数の場合は、合計値が計算されます。引数が文字列の場合は、文字列が連結されます。この章の「クラスの応用機能」セクションには、この件の例があります。</p>
<p><br />
</p>
<h3><b>継承（サブクラス化）</b></h3>
<p>既存のクラスに基づいて新しいクラスを作成するオブジェクト指向プログラミングの機能を継承しています。この新しいクラスをサブクラスと呼び、既存のクラスをスーパークラスと呼びます。</p>
<p><br />
</p>
<p>継承はなぜ便利なのでしょうか。組み込みクラスの1つをわずかに変更したバージョンのオブジェクトが必要になる場合もあります。たとえば、ユーザーが機密データをクリップボードに保存することを防止するために、［編集］メニューの［カット］と［コピー］を無効化するバージョンの TextArea コントロールが必要な場合などが考えられます。また、デフォルトでは1年の各月が含まれるリストボックスを作成したい場合もあります。このような組み込みクラスの独自のバージョンを作成するには、サブクラスを作成してプロジェクトに追加します。</p>
<p><br />
</p>
<p>TextField のインスタンスをウィンドウに追加することと、TextField をベースにしたサブクラスをプロジェクトに追加することの間には、重要な違いがあります。TextField ベースのサブクラスをプロジェクトに追加する場合、TextField 自体に基づいてサブクラスをカスタマイズし、カスタマイズしたサブクラスのインスタンスをアプリケーションのさまざまな場所で使用できます。カスタマイズしたサブクラスは、他のプロジェクトでも再利用できるように保存することもできます。</p>
<p><br />
</p>
<h4><b>サブクラスとは</b></h4>
<p>サブクラスとは、単に<span>スーパークラス</span>
 を持つクラスです。スーパークラスはサブクラスがベースとするクラスで、<span>上位</span>
 クラスと呼ばれる場合もあります。サブクラスは、親のプロパティ、メソッド、定数、およびイベントをすべて継承します。サブクラスは継承後これらを変更することができます。実際には、変更を始めるまでサブクラスはスーパークラスとまったく同じです。その後、プロパティを追加し、イベントを変更し、メソッドを追加または変更することで変えた部分だけが、スーパークラスとの違いになります。</p>
<p><br />
</p>
<h4><b>既存のクラスからのサブクラスの作成</b></h4>
<p>プロジェクトの既存のクラスまたは既存のフレームワーククラスからサブクラスを作成する方法はいくつかあります。</p>
<p><br />
</p>
<div>
<p>1. 組み込みコントロールクラスをサブクラス化する場合は、ライブラリからナビゲーターにコントロールをドラッグするだけです。</p>
<p><br />
</p>
<p>2. ナビゲーターでクラスを選択し、コンテキストメニューオプション［新規サブクラス］を使用して、選択したクラスを基に新しいサブクラスを作成します。</p>
<p><br />
</p>
<p>3. （ツールバーの［挿入］ボタンまたは［挿入］メニューを使用して）プロジェクトにクラスを追加し、［スーパークラス選択］ダイアログを使用して、Super プロパティをベースとするクラスの名前に手動で変更できます。</p>
</div>
<p><br />
</p>
<p><img src="images/000122.jpg" alt="Figure 5.3 [スーパークラス選択]ダイアログ" />
</p>
<p><br />
</p>
<h4><b>既存のクラスからのスーパークラスの作成</b></h4>
<p>明らかにサブクラスであるべきだと判断した既存のクラスがある場合は、そのクラスからスーパークラスを作成できます。クラスのコンテキストメニューを使用し、［スーパークラス選択］を選択します。これにより、スーパークラスの名前を指定し、クラスからスーパークラスに移動するメソッドとプロパティを選択するためのダイアログ（Figure 5.3）が開かれます。</p>
<p><br />
</p>
<p><img src="images/000100.jpg" alt="Figure 5.4 [スーパークラス選択]ダイアログ" />
</p>
<p><br />
</p>
<h4><b>仮想メソッド（オーバーライド）</b></h4>
<p>仮想メソッドは、スーパークラスが持つメソッドの独自のバージョンをサブクラスがオーバーライドする方法を提供します。通常、サブクラスは親に属するメソッドを継承します。</p>
<p><br />
</p>
<p>サブクラスがスーパークラスのメソッドと同じ名前（と引数）を持つメソッドを含む場合は、サブクラスメソッドが代わりに呼び出されます。これは「オーバーライド」と呼ばれます。この場合も、次のように、メソッド呼び出しで Super 接頭辞を特に使用して呼び出すことにより、スーパークラスのメソッドを呼び出すことができます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Super.MethodName</p>
</div>
<p><br />
</p>
<h3><b>多様性</b></h3>
<p>多様性は、完全に異なるデータ型（一般的にクラス）を同じように動作させることができる機能です。そのためには、継承とオーバーライド、継承とイベントまたはクラスインタフェース（この章の後半で説明）を使用します。</p>
<p><br />
</p>
<p>この一般的な例は、動物、猫、および犬の関係です。猫または犬のどちらが含まれるかによって「ニャオ」または「ワン」という鳴き方を知っている一般的な動物オブジェクトが必要な場合は、継承とオーバーロードを使用して実装できます。</p>
<p><br />
</p>
<p>まず、Animal と呼ばれる新しいクラスを作成します。String を返す Speak メソッドをそこに追加します。</p>
<p><br />
</p>
<p>次に、Cat と呼ばれる Animal のサブクラスを作成します。String を返す Speak メソッドをそこに追加します。これは、Animal で未実装の Speak メソッドをオーバーライドすることを意味します。このメソッドのコードは次のようになります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Return "Meow!"</p>
</div>
<p><br />
</p>
<p>次に、Dog と呼ばれる Animal のサブクラスを作成します。次のコードで String を返す Speak メソッドをそこに追加します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Return "Woof!"</p>
</div>
<p><br />
</p>
<p>これをテストするために、ウィンドウ上にボタンを作成します。ボタンの Action イベントに、Animal の配列を作成するコードを追加します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim animals() As Animal</p>
<p>animals.Append(New Cat)</p>
<p>animals.Append(New Dog)</p>
<p><br />
</p>
<p>For Each a As Animal In animals</p>
<p>MsgBox(a.Speak)</p>
<p>Next</p>
</div>
<p><br />
</p>
<p>このコードを実行すると、最初に「Meow!」、次に「Woof!」が表示されます。</p>
<p><br />
</p>
<p>Cat と Dog はどちらも Animal のサブクラスなので、型が Animal の変数（animals 配列）に代入できます。</p>
<p><br />
</p>
<p>（ループで）Animal の Speak メソッドを呼び出すと、多様性により、コードが、配列に追加された実際のサブクラス型の Speak メソッドを呼び出します。</p>
<p><br />
</p>
<p>後のセクションでは、イベントおよびクラスインタフェースの継承を使用して同じことをどのように実現できるかも示されています。</p>
</div>
</div>
</div>


<div id="calibre_link-57">
<div>
<div>
<h2 id="calibre_link-31"><b>
<span><b>Section 3</b></span>
<br /><b></b>
プロパティ、メソッド、およびイベント</b></h2>
<p><br />
</p>
<h3><b>プロパティ</b></h3>
<p>プロパティは、オブジェクトについての何かを示す特徴です。</p>
<p><br />
</p>
<p>プロパティを、クラスインスタンスが値を格納する方法として使用します。クラスには、プロパティ、計算型プロパティ、共有プロパティ、および共有計算型プロパティの4種類のプロパティを追加できます。</p>
<p><br />
</p>
<p>クラスにプロパティを追加すると、スーパークラスが格納していない値を格納できます。たとえば、ユーザーが入力した最後の値を格納する TextField コントロールのサブクラスを作成する必要がある場合もあります。これにより、現在の入力を選択的に拒絶し、最後の入力を復旧できます。</p>
<p><br />
</p>
<h4><b>プロパティ</b></h4>
<p>プロパティ（インスタンスプロパティ）については、セクション1で説明されています。これらは、クラスインスタンスに属するプロパティです。</p>
<p><br />
</p>
<h4><b>計算型プロパティ</b></h4>
<p>計算型プロパティは値を格納せず、アクセスするたびに計算するプロパティです。</p>
<p><br />
</p>
<p>計算型プロパティには、ゲッターとセッターの2つの部分があります。このプロパティは、ナビゲーターでプロパティ名の下に Get および Set ノードとして表示されます。Get ノードには、プロパティの値を取得するためにコードを追加します。Set ノードには、プロパティの値を設定するためにコードを追加します。Set にコードを含めない場合、プロパティは書き込み禁止プロパティとなります。</p>
<p><br />
</p>
<p><img src="images/000081.jpg" alt="Figure 5.5 計算型プロパティ" />
</p>
<p><br />
</p>
<p>Get ノードのコードを削除して、プロパティを書き込み専用にすることもできますが、そうしても役立つことはほとんどありません。</p>
<p><br />
</p>
<p>計算型プロパティの例は、Product クラスの TotalPrice プロパティです。</p>
<p><br />
</p>
<p>Get で次のコードを使用して TotalPrice を実装できます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Return Price * Quantity</p>
</div>
<p><br />
</p>
<p>計算型プロパティに値を保持する必要があるときには、多くの場合、（通常、「m」を前に付けて）対応するプライベートプロパティを作成して値を保持します。つまり、次のように記述します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Get:</p>
<p>Return mName</p>
<p><br />
</p>
<p>Set:</p>
<p>mName = Value</p>
</div>
<p><br />
</p>
<h4><b>共有プロパティ</b></h4>
<p>セクション1で説明されているように、共有プロパティ（クラスプロパティとも呼ばれる）は、インスタンスではなくクラスに属するプロパティです。</p>
<p><br />
</p>
<h4><b>共有計算型プロパティ</b></h4>
<p>共有計算型プロパティの機能は、期待を裏切りません。これらは、計算型プロパティの共有バージョンです。</p>
<p><br />
</p>
<h3><b>メソッド</b></h3>
<p>メソッドは、クラスに機能を提供します。メソッドは通常、データの読み込みや値の計算などの処理を実行します。</p>
<p><br />
</p>
<p>第3章のセクション8では、メソッドがより詳細に説明されています。</p>
<p><br />
</p>
<h4><b>メソッド</b></h4>
<p>メソッド（インスタンスメソッド）については、セクション1で説明されています。これらは、クラスインスタンスに属するメソッドです。</p>
<p><br />
</p>
<h4><b>共有メソッド</b></h4>
<p>セクション1で説明されているように、共有メソッド（クラスメソッドとも呼ばれる）は、インスタンスではなくクラスに属するメソッドです。</p>
<p><br />
</p>
<h3><b>イベント</b></h3>
<p>イベントは、発生した処理（またはイベント）に呼び出される種類のメソッドです。これらのイベントは、「イベント駆動プログラミング」の「イベント」とはまったく関係ありません。</p>
<p><br />
</p>
<p>多くのクラスとコントロールには独自の組み込みイベント（『Xojo のユーザーインタフェース』と『Xojo のフレームワーク』で説明）がありますが、イベント定義を使用して独自のイベントを作成することもできます。</p>
<p><br />
</p>
<p>イベント定義は、クラスに独自のイベントハンドラを追加する手段を提供します。イベント定義はクラス自体からしか呼び出せませんが、サブクラスによってのみ実装できます。</p>
<p><br />
</p>
<p>クラスにイベント定義を追加するには、コードエディタツールバーの［追加］ボタン、メニューの［挿入］→［イベント定義］、またはコンテキストメニューを使用します。</p>
<p><br />
</p>
<p>たとえば、あるクラス上に Save メソッドがある場合、保存前後に処理を実行する手段をサブクラスに提供する必要がある場合もあります。これを実行する方法の1つは、次のようにサブクラスで Save メソッドをオーバーライドすることです。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Sub Save</p>
<p>PreSave</p>
<p>Super.Save</p>
<p>PostSave</p>
<p>End Sub</p>
</div>
<p><br />
</p>
<p>この記述でも機能しますが、すべてを適切に定義および実装する必要があります。イベントを使用してこれを実行すれば、エラーが生じる可能性がなくなります。</p>
<p><br />
</p>
<p>スーパークラスで PreSave と PostSave の2つのイベント定義を作成します。</p>
<p><br />
</p>
<p><img src="images/000061.jpg" alt="Figure 5.6 イベントハンドラを表示するサブクラス" />
</p>
<p><br />
</p>
<p>スーパークラスの Save メソッドでは、最初に PreSave、最後に PostSave を呼び出します。</p>
<p><br />
</p>
<p>サブクラスを作成すると、作成したサブクラスに追加できるイベントハンドラが2つ（PreSave と PostSave）あることを確認できます。これらのイベントハンドラを追加し、必要に応じて実装するだけです。</p>
<p><br />
</p>
<p><img src="images/000002.jpg" alt="Figure 5.7 イベント定義" />
</p>
<p><br />
</p>
<p>組み込みコントロールクラスのすべてには、すべてこのように機能する幅広いイベントハンドラ（Open など）が含まれています。</p>
<p><br />
</p>
<p>イベントハンドラは実装すると、サブクラスに表示されなくなります。追加のサブクラスでもそのままイベントハンドラが使用できるようにするには、（名前と引数が一致する）サブクラスで新しいイベント定義を作成し、実装したイベント定義で呼び出す必要があります。</p>
<p><br />
</p>
<h4><b>
<span><b>Animal</b></span>
 の例</b></h4>
<p>Animal の例を振り返ります。これは、イベントを使用する場合の記述方法を示しています。</p>
<p><br />
</p>
<p>Animal と呼ばれる新しいクラスを作成します。次のコードで String を返す Speak メソッドをそこに追加します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Return SpeakSound</p>
</div>
<p><br />
</p>
<p>Animal クラスに SpeakSound と呼ばれるイベント定義を追加し、戻り値に文字列を設定します。</p>
<p><br />
</p>
<p>次に、Cat と呼ばれる Animal のサブクラスを作成します。ツールバーの［+］ボタンをクリックし、［イベントハンドラの追加］を選択します。ダイアログでは、SpeakSound イベントハンドラが表示されます。［OK］を選択して押します。</p>
<p><br />
</p>
<p>このイベントハンドラのコードは次のようになります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Return "Meow!"</p>
</div>
<p><br />
</p>
<p>次に、Dog と呼ばれる Animal のサブクラスを作成し、さらに次のコードで SpeakSound イベントハンドラを追加します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Return "Woof!"</p>
</div>
<p><br />
</p>
<p>これをテストするために、ウィンドウ上にボタンを作成します。ボタンのAction イベントに、Animal の配列を作成するコードを追加します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim animals() As Animal</p>
<p>animals.Append(New Cat)</p>
<p>animals.Append(New Dog)</p>
<p><br />
</p>
<p>For Each a As Animal In animals</p>
<p>MsgBox(a.Speak)</p>
<p>Next</p>
</div>
<p><br />
</p>
<p>このコードを実行すると、最初に「Meow!」、次に「Woof!」が表示されます。</p>
<p><br />
</p>
<p>Cat と Dog はどちらも Animal のサブクラスなので、型が Animal の変数（animals 配列）に代入できます。</p>
<p><br />
</p>
<p>（ループで）Animal の Speak メソッドを呼び出すと、配列に追加されたサブクラスの SpeakSound イベントハンドラが次に呼び出されます。</p>
</div>
</div>
</div>


<div id="calibre_link-101">
<div>
<div>
<h2 id="calibre_link-32"><b>
<span><b>Section 4</b></span>
<br /><b></b>
コンストラクタとデストラクタ</b></h2>
<p><br />
</p>
<p>新しいオブジェクトを作成するときには、ある種の初期化をオブジェクトで実行する必要がある場合があります。コンストラクタは、これを実行するためのメカニズムです。オブジェクトのコンストラクタは、クラスのインスタンス作成時に自動的に実行されるメソッドです。</p>
<p><br />
</p>
<p>反対に、オブジェクトをメモリから削除するときには、デストラクタが呼び出されます。</p>
<p><br />
</p>
<h3><b>コンストラクタ</b></h3>
<p>クラスに Constructor という名前でメソッドを追加することにより、コンストラクタをクラスに追加します。便宜上「Constructor」は、コードエディタの［メソッド名］ポップアップメニューの選択肢となっています。</p>
<p><br />
</p>
<p>New 演算子によりインスタンスが作成されると、コンストラクタが自動的に呼び出されます。コンストラクタが引数を受け付ける場合、要求される数の引数を渡す必要があります。また、引数は正しいデータ型である必要があります。</p>
<p><br />
</p>
<p>サブクラスのコンストラクタを作成するたびに、コードエディタは、コードエディタでスーパークラスのコンストラクタへの呼び出しを自動的に追加し、処理を説明するコメントを追加します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>// Calling the overridden superclass constructor</p>
<p>Super.Constructor</p>
</div>
<p><br />
</p>
<p>これが追加されるのは、作成するコンストラクタがスーパークラスのコンストラクタをオーバーライドするためです。しかし、スーパークラスのコンストラクタが実行されない限り、新しいオブジェクトは正しく初期化されないこともあります。Super メソッドは、サブクラスのメソッドによりオーバーライドされたスーパークラスのメソッドを呼び出す方法です。</p>
<p><br />
</p>
<p>ここでコンストラクタのシンプルな例を紹介します。たとえば、月額購読を販売するサービスを管理しているとします。インスタンスがインスタンス化されたときに、終了期限の値を自動的に受け取る Date クラスのカスタムバージョンが必要です。まず、プロジェクトに新しいクラスを追加し、そのスーパークラスを Date に設定し、「ExpirationDate」に名前を変更します。次に、「Constructor」というメソッドを追加できます。コンストラクタは、顧客が契約している月数である整数引数、numMonths を受け取ります。したがって、コンストラクタには次の1行のコードしか含まれません。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Self.Month = Self.Month + numMonths</p>
</div>
<p><br />
</p>
<p>「通常の」Date オブジェクトのインスタンスが作成されると、現在の日付に初期化されるため、この行は、現在の月数に引数として渡される月数を加算します。</p>
<p><br />
</p>
<p>半年間契約する顧客の終了期限を取得する必要がある場合は、次のように取得できます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim expDate As New ExpirationDate(6)</p>
<p>MsgBox(expDate.ShortDate)</p>
</div>
<p><br />
</p>
<p>月数が引数として渡され、新しいインスタンスは現在の日付ではなく終了期限を保持します。</p>
<p><br />
</p>
<h4><b>コントロールサブクラスの初期化</b></h4>
<p>コントロールサブクラスのインスタンスを初期化する必要がある場合は、コンストラクタを使用しないでください。代わりに、初期化を実行するコードをコントロールの Open イベントハンドラに保存します。</p>
<p><br />
</p>
<p>コンストラクタのインスペクタプロパティにアクセスする場合、インスペクタプロパティはインスペクタで指定されているデフォルト値ではなく、データ型のデフォルト値を持ちます。これらのパブリックプロパティに値を割り当てる場合、値はインスペクタで指定されている内容でオーバーライドされます。</p>
<p><br />
</p>
<h3><b>デストラクタ</b></h3>
<p>必要になる場合はあまりありませんが、デストラクタを作成することもできます。たとえばユーザーがウィンドウを閉じる場合に親クラスのインスタンスが削除されるときや、スコープ外に出るとき、デストラクタが自動的に呼び出されます。新しいメソッドに「Destructor」という名前を付けます。デストラクタは引数を取らず、値を返しません。</p>
<p><br />
</p>
<p>デストラクタは、オブジェクトへの最後の参照が削除されると、別のオブジェクトのデストラクタで処理が実行されている場合でも、呼び出されます。つまり、深い反復でデストラクタが他のデストラクタをトリガーする場合、スタックのオーバーフローを発生する可能性があります。ただし、オブジェクトのプロパティが自動的にクリーンアップされている限り、このようなオーバーフローは発生しません。したがって、デストラクタでプロパティに Nil を設定せずに、自動的にクリーンアップすることを一般的にはお勧めします。</p>
<p><br />
</p>
<h3><b>メモリ管理</b></h3>
<p>メモリは、<span>参照カウント</span>
 と呼ばれるものを使用して、自動的に管理されます。カウンタは、作成する各インスタンス（オブジェクト）によって使用され、オブジェクトへの参照を記録します。参照のたびにカウンタを増分します。オブジェクトへの参照を削除すると、カウンタが減分されます。参照は、Nil に設定したり、インスタンスのあるウィンドウを閉じるなどの方法でスコープから外したりして、削除します。参照カウンタがゼロに到達すると、オブジェクトがメモリから即座に削除されます。</p>
<p><br />
</p>
<p>つまり、クラスのインスタンスは、使用されなくなると、メモリから自動的に削除されます。リストボックスをベースにクラスを作成するとします。次に、ウィンドウでそのクラスのインスタンスを作成します。ウィンドウを開くと、クラスのインスタンスがメモリ内に自動的に作成されます。ウィンドウを閉じると、クラスのインスタンスがメモリから自動的に削除されます。ローカル変数にクラスへの参照を格納すると、メソッドまたはイベントハンドラ実行終了時に、クラスのインスタンスがメモリから削除されます。プロパティにクラスのインスタンスへの参照を格納した場合は、プロパティを所有するオブジェクトをメモリから削除すると、インスタンスがメモリから削除されます。</p>
</div>
</div>
</div>


<div id="calibre_link-20">
<div>
<div>
<h2 id="calibre_link-33"><b>
<span><b>Section 5</b></span>
<br /><b></b>
インタフェース</b></h2>
<p><br />
</p>
<p>クラスインタフェースは、スーパークラスを共有しないが、アプリケーション内で何らかの共通点を持つクラスをまとめるために使用できるコンストラクトです。クラスインタフェースは、オブジェクトの処理について、方法は指定せずに内容を指定するために使用します。</p>
<p><br />
</p>
<p>クラスインタフェースをより良く理解するためには、クラスは、クラスとの（パブリック）インタフェースと実装の2つのコンポーネントで構成されると考えるとわかりやすいでしょう。インタフェースはクラスのパブリックメソッド呼び出しで構成されており、実装はメソッドを実装するコードです。インタフェースがクラスによって実行される処理を、実装が処理方法を示します。</p>
<p><br />
</p>
<p>オブジェクト階層では、サブクラスがスーパークラスからインタフェースと実装の両方を継承します。つまり、メソッド呼び出しとメソッドの具体的な実装の両方を取得します。</p>
<p><br />
</p>
<p>クラスインタフェースを使用すると、2つのコンストラクトを区別することができます。2つ以上のクラスが同じことを実行するが異なる方法で実行する必要がある場合は、スーパークラスではなくインタフェースを使用します。</p>
<p><br />
</p>
<p>クラスインタフェースは、プロジェクト内のカスタムクラスが使用するメソッドのリストを含む「仕様」として動作します。実際には、メソッド自体のコードは含まれません。</p>
<p><br />
</p>
<p>クラスインタフェースのメソッドは、クラスインタフェースを「実装」する各カスタムクラスに実際に含まれるメソッドのプレースホルダーです。また、1つのカスタムクラスは複数のクラスインタフェースを実装することができます。</p>
<p><br />
</p>
<p>「実装」という用語は、クラスインタフェースにあるメソッドと名前と宣言が同じメソッドをクラスが持つことを意味するにすぎません。クラスインタフェースはメソッドと宣言を指定しますが、コードは指定しません。</p>
<p><br />
</p>
<p>複数のクラスインタフェースがフレームワークに組み込まれます。これらのいずれかをクラスに実装することや、独自のものを追加して実装することができます。たとえば、Readable および Writeable インタフェースは、データを読み書きする方法を指定します。Readable またはWriteable インタフェースを使用する各クラスは、実装を提供します。たとえば、シリアルポートからデータを読み取るクラスは、バイナリファイルからデータを読み取るクラスとは別の実装を使用します。</p>
<p><br />
</p>
<p>クラスがクラスインタフェースを実装することを指定する場合、そのクラスはクラスインタフェースのすべてのメソッドを実装し、メソッド宣言が一致する必要があります。ただし、クラスは異なる方法で自由にメソッドを実装できます。たとえば、ラベルのフォントを変更するメソッドは、Graphics クラスを呼び出してテキストを表示する Canvas コントロールのフォントを変更するメソッドとは別の方法で実装されます。</p>
<p><br />
</p>
<p>このプロセスは、次の3つの基本フェーズで構成されます。</p>
<p><br />
</p>
<div>
<p>・クラスインタフェースの作成</p>
<p><br />
</p>
<p>・クラスインタフェースを実装するクラスの作成</p>
<p><br />
</p>
<p>・プロジェクトへのクラスの追加、およびプログラムでのクラスインタフェースメソッドの呼び出し。一般的に、これは、クラスがクラスインタフェースを実装しているかどうかを確認する汎用的なコードの作成、および必要に応じたクラスインタフェースメソッドの実行を意味します。</p>
</div>
<p><br />
</p>
<p>新しいクラスインタフェースを追加するには、ツールバーの［挿入］ボタンをクリックして［クラスインタフェース］を選択するか、［挿入］メニューで［クラスインタフェース］を選択します。これにより、新しいクラスインタフェースがデフォルトの名前（最初のクラスインタフェースの場合は Interface1）でナビゲーターに追加されます。</p>
<p><br />
</p>
<p>クラスインタフェースの名前を変更するには、インスペクタを使用します。</p>
<p>クラスインタフェースにはメソッドだけを追加できます。クラスインタフェースにメソッドを追加するには、コードエディタツールバーの［追加］ボタン、メニューの［挿入］→［メソッド］、コンテキストメニュー、またはキーボードショートカット（OS X では［Option］-［Command］-［M］、Windows と Linux では［Ctrl］+［Shift］+［M］）を使用します。クラスインタフェースではコードを指定できないので、コードエディタが無効化されます。メソッド名と引数を指定するには、インスペクタを使用します。</p>
<p><br />
</p>
<h3><b>クラスでのインタフェースメソッドの実装</b></h3>
<p>クラスインタフェースのメソッドを実装するには、クラスにクラスインタフェースを割り当てる必要があります。そのためには、ナビゲーターでクラスを選択し、インスペクタでインタフェースラベルの横にある［選択］ボタンを選択します。ナビゲーターでメソッドのコンテキストメニューから［インタフェース実装］オプションを使用することもできます。</p>
<p><br />
</p>
<p><img src="images/000025.jpg" alt="Figure 5.8 インスペクタでインタフェースを選択するボタン" />
</p>
<p><br />
</p>
<p>［選択］をクリックすると、［インターフェース実装］ダイアログが表示され、使用できるすべてのクラスインタフェースの名前が示されます。インタフェースには組み込み型のものや、ユーザーが作成したものがあります。クラスに割り当てるインタフェースを1つ以上選択してください。</p>
<p><br />
</p>
<p>［Include "#pragma error" in the source of each method］を選択し、メッセージ「このメソッドを実装し忘れないでください！」とともにコンパイラーエラーが強制的に生成されるようにすることもできます。コードを追加してインタフェースメソッドを実装した後は、プラグマを削除します。</p>
<p><br />
</p>
<p>「OK」を押すと、コードエディタは自動的にインタフェースのメソッドを所属先のインタフェースを示すコメント付きで（オプションのプラグマとともに）、クラスに追加します。</p>
<p><br />
</p>
<p><img src="images/000006.jpg" alt="Figure 5.10 [インタフェース実装] ダイアログ" />
</p>
<p><br />
</p>
<p>クラスにすでに適用した後でクラスインタフェースを修正または変更する場合は、クラスを手動で更新する必要があります。</p>
<p><br />
</p>
<p>インタフェースとクラスを含むプロジェクトをコンパイルしようとするとき、クラスが一部のインタフェースメソッドを実装しない場合は、「このクラスは実装しているインタフェースのメソッドが1つ以上不足しています」というコンパイルエラーが発生します。</p>
<p><br />
</p>
<p><img src="images/000099.jpg" alt="Figure 5.9 インタフェースメソッドの欠落に起因するコンパイルエラー" />
</p>
<p><br />
</p>
<h4><b>インタフェースの変更と削除</b></h4>
<p>インタフェースを削除または置換する必要が生じた場合は、インタフェースを追加したときと同じ手順を実行します。［インタフェース］ダイアログが表示されたら、不要となったインタフェースのチェックを外します。</p>
<p><br />
</p>
<div>
<p>
<span>注</span>
 ：インタフェース実装中にクラスに追加されたメソッドは、メソッドが属するインタフェースを削除しても、変更または削除されません。つまり、［インタフェース実装］ダイアログでインタフェースを追加すると、インタフェース自体を削除しても、そのインタフェースによって指定されているメソッドは、そのクラスの一部として残ります。ユーザーが「クリーンアップ」処理を実行する必要があります。</p>
</div>
<p><br />
</p>
<h4><b>実装しているインタフェースの指定</b></h4>
<p>稀に、名前が同じでクラスインタフェースが異なる複数のメソッドをクラスが実装している場合があります。メソッドが2つのインターフェースを実装していて、その両方に同じ名前と宣言を共有しているメソッドがある場合もあります。通常、これらを見分けることはできません。ただし、各メソッドが属するクラスインタフェースを指定する方法はあります。それには、メソッドの「実装されているものを表示する」コンテキストメニューを使用して使用できるメソッド宣言ダイアログボックスのオプションの［インタフェース］フィールドを使用します。</p>
<p><br />
</p>
<p>これを使用するために、引数を持たない「wahoo」という名前のメソッドを含む Foo と Bar という2つのクラスインタフェースがあるとします。両方のメソッドを個別に実装する Baz というクラスを持つことができます。</p>
<p><br />
</p>
<p>wahoo メソッドを Baz に追加します。次にメソッド名を右クリック（OS X では［Control］+クリック）し、［実装されているものを表示する］を選択します。インスペクタに［Implements］という追加フィールドが表示されます。ここには、インタフェースの名前とこのメソッド実際に実装するメソッドを「Foo.wahoo」と指定することができます。</p>
<p><br />
</p>
<p>次に、wahoo という別のメソッドを追加し、それに対して［実装されているものを表示する］を選択します。「Bar.wahoo」を指定します。実装するインタフェースメソッドを正確にクラスに伝えることができました。</p>
<p><br />
</p>
<h3><b>既存のクラスからの新しいクラスインタフェースの作成</b></h3>
<p>クラスインタフェースとして抽出するメソッドがプロジェクト内の既存のクラスに含まれる場合は、ナビゲーターから新しいクラスインタフェースを生成できます。そのためには、ナビゲーターでメソッドのコンテキストメニューから［インタフェースを抽出］を選択します。</p>
<p><br />
</p>
<p>新しいクラスインタフェースがプロジェクトに追加され、現在のクラスが新しいインタフェースのインプリメンタになります。</p>
<p><br />
</p>
<h3><b>多様性</b></h3>
<p>多様性は、完全に異なるデータ型（一般的にクラス）を同じように動作させる機能です。多様性は、クラスインタフェースを使用して実行できます。</p>
<p><br />
</p>
<p>ここでは、クラスインタフェースを使用して Animal、Dog、および Cat の例を実装する方法を示します。</p>
<p><br />
</p>
<p>まず、（Animal と呼ばれる）新しいクラスインタフェースを作成します。String を返す Speak メソッドをそこに追加します。</p>
<p><br />
</p>
<p>次に、新しいクラス（Cat）を作成し、インタフェースとして Animal を選択します。コードエディタが、Speak メソッドを自動的に追加します。それに次のコードを追加します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Return "Meow!"</p>
</div>
<p><br />
</p>
<p>次に、新しいクラス（Dog）を追加し、インタフェースとして Animal を選択します。コードエディタが、Speak メソッドを追加します。それに次のコードを追加できます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Return "Woof!"</p>
</div>
<p><br />
</p>
<p>これをテストするために、ウィンドウ上にボタンを作成します。ボタンのAction イベントに、Animal の配列を作成するコードを追加します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim animals() As Animal</p>
<p>animals.Append(New Cat)</p>
<p>animals.Append(New Dog)</p>
<p><br />
</p>
<p>For Each a As Animal In animals</p>
<p>MsgBox(a.Speak)</p>
<p>Next</p>
</div>
<p><br />
</p>
<p>このコードを実行すると、最初に「Meow!」、次に「Woof!」が表示されます。</p>
<p><br />
</p>
<p>Cat と Dog はどちらも Animal を実装するので、型が Animal の変数（animals 配列）に代入できます。</p>
<p><br />
</p>
<p>Animal の Speak メソッドを（ループで）呼び出すと、多様性により、コードが、配列に追加された実際の種類の Speak メソッドを呼び出します。</p>
</div>
</div>
</div>


<div id="calibre_link-3">
<div>
<div>
<h2 id="calibre_link-34"><b>
<span><b>Section 6</b></span>
<br /><b></b>
サブクラスの例</b></h2>
<p><br />
</p>
<h3><b>SelectablePopupMenu の例</b></h3>
<p>例として、ポップアップメニューで既存の項目を選択するために使用できるメソッドを追加する PopupMenu サブクラスを作成することができます。</p>
<p><br />
</p>
<p>SelectablePopupMenu という新しいクラスを作成し、その親に PopupMenu を設定します。このクラス上で、新しいパブリックメソッドを追加して「SelectRow」と名付け、引数として「value As String」を指定します。</p>
<p><br />
</p>
<p>このメソッドはポップアップメニューのすべての行をループし、行のテキストが指定された値に一致するかどうかを確認します。テキストが一致する場合は、その行を選択して戻ります。一致が見つからない場合は、何も選択されません。</p>
<p><br />
</p>
<p><img src="images/000092.jpg" alt="Figure 5.11 SelectablePopupMenuクラスのSelectRowメソッド" />
</p>
<p><br />
</p>
<p>SelectRow メソッドのコードは、次のとおりです。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>For i As Integer = 0 To Self.ListCount-1</p>
<p>If Self.List(i) = value Then</p>
<p>// Found a row with matching</p>
<p>// text, so select it</p>
<p>Self.ListIndex = i</p>
<p>Return</p>
<p>End If</p>
<p>Next</p>
<p><br />
</p>
<p>// Select nothing</p>
<p>Self.ListIndex = -1</p>
</div>
<p><br />
</p>
<h3><b>例: MonthPopup</b></h3>
<p>次に別の例を示します。デフォルトでは、現在の月を選択した状態で年の各月の名前を表示するポップアップメニューを作成するとします。新しいクラスを作成し、MonthPopup と名付け、スーパークラスとして PopupMenu を選択します。</p>
<p><br />
</p>
<p>これで、MonthPopup に Open イベントハンドラを追加し、月の名前、見出し、およびリスト内の適切な月を選択するコードを追加できます。この場合、Open イベントハンドラは次のようになります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Self.HasHeading = True</p>
<p>Self.InitialValue = "Months"</p>
<p>Self.AddRow("January")</p>
<p>Self.AddRow("February")</p>
<p>Self.AddRow("March")</p>
<p>Self.AddRow("April")</p>
<p>Self.AddRow("May")</p>
<p>Self.AddRow("June")</p>
<p>Self.AddRow("July")</p>
<p>Self.AddRow("August")</p>
<p>Self.AddRow("September")</p>
<p>Self.AddRow("October")</p>
<p>Self.AddRow("November")</p>
<p>Self.AddRow("December")</p>
<p><br />
</p>
<p>// Select the current month</p>
<p>Dim d As New Date</p>
<p>Self.ListIndex = d.Month-1)</p>
</div>
<p><br />
</p>
<p>ウィンドウに MonthPopup クラスのインスタンスを追加するには、ウィンドウのウィンドウエディタに切り替え、ナビゲーターからウィンドウエディタに MonthPopup をドラッグします。アプリケーションを実行すると、Open イベントハンドラが動作して、ポップアップメニューに年の各月を取り込み、現在の月を選択します。</p>
<p><br />
</p>
<div>
<p>
<span>注</span>
 ：作成後、カスタムコントロールクラスは、他のプロジェクトで使用できる自己完結型オブジェクトとしてエクスポートできます。ナビゲーターでカスタムコントロールクラスを右クリック（OS X では［Control］+クリック）し、コンテキストメニューから［エクスポート...］を選択するだけです。</p>
</div>
<p><br />
</p>
<h3><b>サブクラスはクラス</b></h3>
<p>サブクラスはクラスです。これらのクラスは、元のクラスと区別し、親クラスのプロパティ、イベント、およびメソッドを継承する点を強調するため、サブクラスと呼ばれます。サブクラスはクラスなので、他のサブクラスのスーパークラスになることができます。たとえば、NumbersOnlyTextField サブクラスは存在していて、特定の範囲内の数字のみを許可するテキストフィールドが必要になったとします。NumbersOnlyTextField サブクラスを複製し、コードを変更することができます。ただし、これを行うと、プロジェクトが大型化し、保守しづらくなります。NumbersOnlyTextField のコードにバグが見つかった場合は、他の場所でもコードを使用したことを忘れず、追跡して修正しなければなりません。新しいサブクラスを作成し、スーパークラスとして NumbersOnlyTextField を選択する方法の方が効率的です。新しいサブクラス（「NumberRangeTextField」という名前にします）は、スーパークラスのすべてのプロパティ、イベント、およびメソッドを使用します。</p>
</div>
</div>
</div>


<div id="calibre_link-22">
<div>
<div>
<h2 id="calibre_link-35"><b>
<span><b>Section 7</b></span>
<br /><b></b>
クラスの応用機能</b></h2>
<p><br />
</p>
<p>このセクションでは、クラスのより高度な機能を取り上げます。これらの機能は頻繁には必要ありませんが、有用であることは間違いありません。</p>
<p><br />
</p>
<h3><b>メソッドへの値の割り当て</b></h3>
<p>構文の観点から、割り当て演算子を使用して値を取得するメソッドがあると便利な場合もあります。</p>
<p><br />
</p>
<p>次のように記述せずに</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>order.Quantity(2)</p>
</div>
<p><br />
</p>
<p>次のように作成します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>order.Quantity = 2</p>
</div>
<p><br />
</p>
<p>これは、プロパティに類似しています。引数リストで Assigns キーワードを使用することにより、メソッドを使用するプロパティの構文動作を取得できます。</p>
<p><br />
</p>
<p>宣言は次のようになります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Sub Quantity(Assigns amount As Integer)</p>
</div>
<p><br />
</p>
<p>単純なプロパティとは異なり、複数の引数を持つこともできます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Sub Quantity(productName As String, Assigns amount As Integer)</p>
</div>
<p><br />
</p>
<p>このコマンドは、次のように使用します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>order.Quantity("Book") = 2</p>
</div>
<p><br />
</p>
<p>この手法を使用する場合、実際にはメソッドを取り扱っていますが、プロパティを設定しているように見えます。これはクラス設計時に便利で、コードが読みやすくなります。</p>
<p><br />
</p>
<h3><b>演算子のオーバーロード</b></h3>
<p>クラスではメソッドを簡単にオーバーロードできますが、どうすればクラスで演算子をオーバーロードできるのでしょうか。たとえば、SalesOrder クラスのインスタンスが2つあり、一方が他方より大きいかどうかを確認したい場合はどうなるでしょうか。</p>
<p><br />
</p>
<p>これは、SalesOrder クラスで演算子オーバーロードメソッド（Figure 5.12）のいずれか、この場合 Operator_Compare を実装することにより、実行します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Sub Operator_Compare(rightOrder As SalesOrder)</p>
<p>If Self.TotalAmount &gt; rightOrder.TotalAmount Then</p>
<p>Return 1</p>
<p>ElseIf Self.TotalAmount &lt; rightOrder.TotalAmount Then</p>
<p>Return -1</p>
<p>Else</p>
<p>Return 0</p>
<p>End If</p>
<p>End Sub</p>
</div>
<p><br />
</p>
<p>カスタムクラスの演算子オーバーロードについては、言語リファレンスの各 Operator_ キーワードに関するセクションを参照してください。</p>
<p><br />
</p>
<p>
<span>Figure 5.12</span>
 演算子のオーバーロードメソッド</p>
<table>
<tr>
<th><b>Operator</b></th>
<th><b>Functions</b></th>
</tr>
<tr>
<td>+</td>
<td>Operator_Add<br />
Operator_AddRight</td>
</tr>
<tr>
<td>-</td>
<td>Operator_Subtract<br />
Operator_SubtractRight</td>
</tr>
<tr>
<td>*</td>
<td>Operator_Multiply<br />
Operator_MultiplyRight</td>
</tr>
<tr>
<td>/</td>
<td>Operator_Divide<br />
Operator_DivideRight</td>
</tr>
<tr>
<td>\</td>
<td>Operator_IntegerDivide<br />
Operator_IntegerDivideRight</td>
</tr>
<tr>
<td>Mod</td>
<td>Operator_Modulo<br />
Operator_ModuloRight</td>
</tr>
<tr>
<td>And</td>
<td>Operator_And<br />
Operator_AndRight</td>
</tr>
<tr>
<td>Or</td>
<td>Operator_Or<br />
Operator_OrRight</td>
</tr>
<tr>
<td>Not</td>
<td>Operator_Not</td>
</tr>
<tr>
<td>=, &lt;, &gt;, &lt;=, &gt;=</td>
<td>Operator_Compare</td>
</tr>
<tr>
<td>(lookup)</td>
<td>Operator_Lookup</td>
</tr>
<tr>
<td>(negation)</td>
<td>Operator_Negate</td>
</tr>
<tr>
<td>(convert)</td>
<td>Operator_Convert</td>
</tr>
<tr>
<td>Subscript</td>
<td>Operator_Subscript</td>
</tr>
<tr>
<td>Redim</td>
<td>Operator_Redim</td>
</tr>
</table>
<p><br />
</p>
<h3><b>演算子ルックアップ</b></h3>
<p>ドット表記は、クラスインスタンスのメソッドとプロパティにアクセスするために使用します。存在しないメソッドにアクセスしようとすると、コンパイルエラーが発生します。</p>
<p><br />
</p>
<p>演算子ルックアップは、クラスの実際のメソッドまたはプロパティではない「.」に続くものが使用されるときに呼ばれる特別なクラスメソッドです。</p>
<p><br />
</p>
<p>この機能の1つの用途は、実行時までわからない可能性がある値のルックアップです。アプリケーション環境設定を保存するために使用される Preferences クラスを作成しているとします。通常は、保存する各環境設定のプロパティを作成する必要があります。新しい環境設定値があることがわかった場合は、使用する前にクラスに戻りプロパティを追加する必要があります。</p>
<p><br />
</p>
<p>ただし、この代わりに演算子ルックアップを使用することもできます。</p>
<p><br />
</p>
<p>演算子ルックアップでは、メソッドを使用して、「.」の後に入力された内容を確認し、環境設定の名前にします。これで、（場合によってはディクショナリーを使用して）割り当てる値を格納できます。</p>
<p><br />
</p>
<p>値を保存するコードは次のようになります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Sub Operator_Lookup(name As String, Assigns value As String)</p>
<p>If mPreferenceDict = Nil Then</p>
<p>mPreferenceDict = New Dictionary</p>
<p>End If</p>
<p>mPreferenceDict.Value(name) = value</p>
<p>End Sub</p>
</div>
<p><br />
</p>
<p>また、値を取得するコードは次のようになります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Function Operator_Lookup(name As String) As String</p>
<p>If mPreferenceDict = Nil Then Return ""</p>
<p><br />
</p>
<p>If mPreferenceDict.HasKey(name) Then</p>
<p>Return mPreferenceDict.Value(name)</p>
<p>End If</p>
<p>End Sub</p>
</div>
<p><br />
</p>
<p>これを記述すると、環境設定の特定のプロパティまたはメソッドを定義していなくても、環境設定値を保存するコードを作成できます。App クラスで、Prefs というプロパティを Preference として追加します。App.Open イベントで次のようにこのプロパティを初期化します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Prefs = New Preferences</p>
</div>
<p><br />
</p>
<p>これで、プロジェクトのどこでも、環境設定値を格納するために、次のようなコードを作成できます。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>App.Prefs.UserName = "Bob Roberts"</p>
<p>App.Prefs.UserEmail = "bob@gmail.com"</p>
</div>
<p><br />
</p>
<p>環境設定値を取得するコードは次のようになります。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim userName As String</p>
<p>userName = App.Prefs.UserName</p>
</div>
<p><br />
</p>
<h3><b>属性</b></h3>
<p>属性は、イントロスペクションの使用により、実行時に確認できる値をクラスに与えることができる、クラスの応用機能です。この機能については、『Xojo のフレームワーク』の応用に関する章で説明されています。</p>
<p><br />
</p>
<h3><b>キャスト</b></h3>
<p>一般的で再利用可能なコードを作成する非常に強力な方法は、クラスのインスタンスをサブクラスのインスタンスに変換する機能を活用することです。</p>
<p><br />
</p>
<p>この考え方は、例を使用することで最もわかりやすく説明できます。作成するオブジェクトはベースクラスのサブクラスであるため、オブジェクトが特定のサブクラスのメンバーかどうかを常に確認することができます。これは、<span>IsA</span>
 演算子で実行します。</p>
<p><br />
</p>
<p>IsA 演算子を使用して、オブジェクトが特定のサブクラスかどうかを確認します。オブジェクトが特定のサブクラスの場合は、その型としてキャストし、それに固有の処理を実行します。オブジェクトは、インスタンスを操作する関数としてクラス名を使用することによりキャストします。</p>
<p><br />
</p>
<p>インスタンスをキャストする場合、コンパイル時エラーチェックでは、正しいオブジェクト型にキャストしていることを保証できません。キャストするインスタンスは、指定する型である必要があります。キャストは、キャストするクラスのインスタンスとしてオブジェクトを取り扱うようようにコードに伝えるだけです。クラス間の変換は行いません。誤ってキャストすると、実行時に IllegalCastException が発生します。</p>
<p><br />
</p>
<p>次は、ウィンドウ内のすべてのコントロールを循環するために For ループを使用する例です。これは各コントロールをチェックしてラベルかどうかを確認し、ラベルの場合はコントロールをキャストしてテキストを表示します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim labelText As String</p>
<p>// Loop through controls in window</p>
<p>For i As Integer = 0 To Self.ControlCount-1</p>
<p>If Self.Control(i) IsA Label Then</p>
<p>// Cast the control to a Label</p>
<p>// and gets its Text property</p>
<p>labelText = Label(control(i)).Text</p>
<p>MsgBox(labelText)</p>
<p>End If</p>
<p>Next</p>
</div>
<p><br />
</p>
<p>ご覧のように、コードは、特定のウィンドウ、ラベルなどを参照しません。したがって、このルーチンを1回作成すると、どのプロジェクトのどのウィンドウでも使用できます。</p>
<p><br />
</p>
<h3><b>静的変数</b></h3>
<p>静的変数は、ローカル変数のスコープを持つグローバル変数です。</p>
<p><br />
</p>
<p>静的変数はメソッドで宣言します。また、通常のローカル変数の場合とは異なり、それを宣言しているメソッドが次回呼び出されるまで値が保持されます。この値は、そのクラスのすべてのインスタンスで、それらが既存か後で作成されるかに関係なく、そのメソッドに保存されます。</p>
<p><br />
</p>
<p>静的変数は、Dim の代わりに Static キーワードを使用することにより宣言します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Static myValue As Integer</p>
</div>
<hr />
</div>
</div>
</div>


<div id="calibre_link-42">
<div>
<p><img src="images/000073.jpg" alt="" /></p>
</div>
</div>


<div id="calibre_link-61">
<div>
<div>
<p>
<span>CONTENTS</span>
</p>
<p><br />
</p>
<div>
<p>
<a href="#calibre_link-62">6. アプリケーション構造</a>
</p>
</div>
<div>
<div>
<p>
<a href="#calibre_link-63">6.1. デスクトップアプリケーション</a>
</p>
<p>
<a href="#calibre_link-64">6.2. ウェブアプリケーション</a>
</p>
<p>
<a href="#calibre_link-65">6.3. コンソールアプリケーション</a>
</p>
<p>
<a href="#calibre_link-66">6.4. iOS アプリケーション</a>
</p>
<p>
<a href="#calibre_link-52">6.5. アイコンエディタ</a>
</p>
</div>
</div>
</div>
</div>
</div>


<div id="calibre_link-79">
<div>
<div>
<h2 id="calibre_link-63"><b>
<span><b>Section 1</b></span>
<br /><b></b>
デスクトップアプリケーション</b></h2>
<p><br />
</p>
<p>デスクトップアプリケーションにはグラフィカルユーザーインタフェースがあり、ユーザーのコンピュータで直接実行されます。</p>
<p><br />
</p>
<h3><b>Application クラス</b></h3>
<p>Application クラスは、アプリケーションを表すサブクラスを作成するために使用します。新しいデスクトッププロジェクトを作成すると、 Application クラスベースのサブクラスがプロジェクトに自動的に追加されます。ナビゲーターの App クラスがそれにあたります。インスペクタは、親が Application であることを示します。</p>
<p><br />
</p>
<p><img src="images/000056.jpg" alt="Figure 6.1 アプリケーションプロパティ" />
</p>
<p><br />
</p>
<p>この App サブクラスでは、アプリケーション起動時に開かれるデフォルトウィンドウ、アプリケーションで使用されるデフォルトメニューバー、およびアプリケーション<a href="#calibre_link-52">アイコン</a>
 を指定します。</p>
<p><br />
</p>
<p>必要に応じて、App からサブクラスを作成することもできます。これを実行すると、新しいサブクラスはデフォルトウィンドウ、メニューバー、およびアイコンのプロパティを受け取ります。</p>
<p><br />
</p>
<h4><b>イベントハンドラ</b></h4>
<p>デスクトップアプリケーションの Application クラスには、次のようなイベントハンドラが含まれます。</p>
<p><br />
</p>
<div>
<p>・<span>Open</span>
 : このイベントハンドラは、アプリケーションを（デバッグモードで）直接実行するか、ビルドされたアプリケーションを実行することにより、アプリケーションを最初に起動したときに呼び出されます。</p>
<p><br />
</p>
<p>・<span>Close</span>
 : この終了イベントは、ユーザーがアプリケーションを終了すると呼び出されます。</p>
<p><br />
</p>
<p>・<span>NewDocument</span>
 : このイベントは、ドキュメントを渡さずにビルドされたアプリケーションを実行すると呼び出されます。</p>
<p><br />
</p>
<p>・<span>OpenDocument</span>
 : このイベントは、デスクトップでアプリケーションのドキュメントのいずれかをダブルクリックしてアプリケーションを起動すると呼び出されます。ドキュメントをアプリケーションにドロップしても呼び出されます。</p>
<p><br />
</p>
<p>・<span>EnableMenuItems</span>
 : このイベントは、ユーザーがメニューバーをクリックした後、メニュー項目が表示される前に、呼び出されます。EnableMenuItems イベントハンドラは、最前面のウィンドウにインスタンスが存在するあらゆるクラスの EnableMenuItems イベントハンドラ、およびウィンドウの EnableMenuItems イベントハンドラの後で実行されます。このイベントハンドラは、ウィンドウが開いているかいない（OS X アプリケーションでありえる）かにかかわらず有効にすべきメニュー項目を有効化するために使用してください。メニュー項目を常に有効にすべき場合は、EnableMenuItems イベントハンドラではなく AutoEnable プロパティを使用してください。</p>
<p><br />
</p>
<p>・<span>HandleAppleEvent</span>
 : アプリケーションが AppleEvent を受信した場合に実行されます。</p>
<p><br />
</p>
<p>・<span>Activate</span>
 : アプリケーションが有効化されているところです。この処理は、アプリケーションを開いているときと最前面に移動されているときに行われます。</p>
<p><br />
</p>
<p>・<span>Deactivate</span>
 : アプリケーションが無効化されているところです。この処理は、別のアプリケーションまたはデスクトップウィンドウが最前面に移動されたとき、またはアプリケーションを終了したときに行われます。</p>
<p><br />
</p>
<p>・<span>UnhandledException</span>
 : ユーザーコードで捕捉されないランタイムエラーが発生したときに呼び出されます。このイベントは、ランタイムエラーがアプリケーションを終了させる前にそのエラーを捕捉する「最後のチャンス」として使用できます。</p>
</div>
<p><br />
</p>
<h4><b>プロパティ</b></h4>
<div>
<p>・<span>DefaultWindow</span>
 : アプリケーション起動時に自動的に開かれるウィンドウです。</p>
<p><br />
</p>
<p>・<span>MenuBar</span>
 : アプリケーションの主要メニューバーです。新しく作成したウィンドウのデフォルトメニューバーとして使用されます。このプロパティは、App 関数（次のトピックを参照）によってアクセスできます。</p>
<p><br />
</p>
<p>・<span>Icon</span>
 :<a href="#calibre_link-52">アイコンエディタ</a>
 が開いて、アプリケーションで使用するさまざまなサイズのアイコンを指定できます。</p>
</div>
<p><br />
</p>
<h4><b>
<span><b>App</b></span>
 クラスのプロパティ、メソッド、および定数のスコープ</b></h4>
<p>他のクラスと同じルールを使用して、App サブクラスのプロパティ、メソッド、および定数のスコープを設定できます（第5章参照）。</p>
<p><br />
</p>
<p>パブリックプロパティ、メソッド、および定数にアクセスできるように、グローバル App 関数をプロジェクトの App クラスの参照として使用できます。App にサブクラスを作成している場合、App 関数をそのサブクラスへの参照として使用できます。</p>
<p><br />
</p>
<p>プロジェクト内でパブリックプロパティにアクセスするには、次のように記述します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>value = App.MyProperty</p>
</div>
<p><br />
</p>
<h3><b>ビルドの設定</b></h3>
<p>ナビゲーターの［ビルドの設定］セクションには、アプリケーションのビルド固有の設定が含まれます。各ターゲットの横のチェックボックスをオンにすると、そのターゲット向けのアプリケーションをビルドできます。</p>
<p><br />
</p>
<p><img src="images/000038.jpg" alt="Figure 6.2 [共有]ビルド設定" />
</p>
<p><br />
</p>
<div>
<p>
<span>注</span>
 ：App 関数でアクセスできるこのセクションのプロパティは、名前の後の「*」によって示されます。</p>
</div>
<p><br />
</p>
<h4><b>共有</b></h4>
<p>［共有］設定のインスペクタには、次のプロパティが表示されます。</p>
<p><br />
</p>
<div>
<p>・<span>Major Version*</span>
 : アプリケーションのメジャーバージョン。バージョン番号は通常は 1.2.3.4 のように記述され、「1」がメジャーバージョンを示します。</p>
<p><br />
</p>
<p>・<span>Minor Version*</span>
 : アプリケーションのマイナーバージョン。バージョン番号は通常は 1.2.3.4 のように記述され、「2」がマイナーバージョンを示します。</p>
<p><br />
</p>
<p>・<span>Bug Version*</span>
 : アプリケーションのバグバージョン。バージョン番号は通常は 1.2.3.4 のように記述され、「3」がバグバージョンを示します。</p>
<p><br />
</p>
<p>・<span>Stage Code*</span>
 : ビルドするアプリケーションのタイプ（［Development］、［Alpha］、［Beta］、［Final］）を示します。</p>
<p><br />
</p>
<p>・<span>Non Release Version*</span>
 : アプリケーションの製品版ではない（ビルド）バージョン。バージョン番号は通常は 1.2.3.4 のように記述され、「4」が製品版ではないバージョンを示します。</p>
<p><br />
</p>
<p>・<span>Auto Increment Version Info</span>
 :［ON］の場合、ビルドを実行するたびに［Non Release Version］が1ずつ増えます（実行時は増えません）。</p>
<p><br />
</p>
<p>・<span>Short Version*</span>
 : アプリケーションの簡単な説明。通常ここにはバージョン番号（1.2.3.4 など）のみが格納され、一部のオペレーティングシステムではアプリケーションの［Get Info］ウィンドウまたは［プロパティ］ウィンドウに表示されます。</p>
<p><br />
</p>
<p>・<span>Long Version*</span>
 : アプリケーションの詳細な説明。通常ここは、アプリケーション名、著作権、バージョンなどの情報が含まれます。一部のオペレーティングシステムでアプリケーションの［Get Info］ウィンドウまたは［プロパティ］ウィンドウに表示されます。</p>
<p><br />
</p>
<p>・<span>Package Info*</span>
 : アプリケーションの説明。一部のオペレーティングシステムでアプリケーションの［Get Info］ウィンドウまたは［プロパティ］ウィンドウに表示される可能性があります。</p>
<p><br />
</p>
<p>・<span>Use Builds Folder</span>
 :［ON］の場合、プロジェクトファイルと同じ位置に別のフォルダが配置されます。このビルドフォルダには、ビルドされた各プラットフォーム（OS X、Windows、Linux）の独自のサブフォルダも作成されます。</p>
<p><br />
</p>
<p>・<span>Include Function Names</span>
 :［ON］の場合、関数呼び出しの実際の名前が、ビルドされたアプリケーションに組み込まれます。デバッグ目的およびスタックトレースの取得に便利です。</p>
<p><br />
</p>
<p>・<span>言語</span>
 : 動的定数を解決するために使用する言語を指定できます。</p>
<p><br />
</p>
<p>・<span>プロファイルコード</span>
 : コードプロファイル機能を有効または無効にします。第3巻『Xojo のフレームワーク』の第5章を参照してください。</p>
<p><br />
</p>
<p>・<span>Command Line Arguments</span>
 : デバッグモードで実行したときに、アプリケーションに渡されるコマンドライン引数です。</p>
<p><br />
</p>
<p>・<span>Destination</span>
 : アプリケーションをデバッグモードで実行するときに、アプリケーションを配置するパスを指定します。指定しない場合、アプリケーションはプロジェクトファイルと同じパスに配置されます。</p>
</div>
<p><br />
</p>
<h4><b>
<span><b>OS X</b></span>
</b></h4>
<p>［OS X］セクションでは、OS X アプリケーションのビルド時に使用される設定を指定できます。</p>
<p><br />
</p>
<p><img src="images/000024.jpg" alt="Figure 6.3 [OS X]ビルド設定" />
</p>
<p><br />
</p>
<div>
<p>・<span>Mac App Name</span>
 : OS X アプリケーションの実際のファイル名。指定しない場合は、アプリのビルド時に接尾辞「.app」が自動的に追加されます。</p>
<p><br />
</p>
<p>・<span>Framework</span>
 : Carbon または Cocoa を選択します。Cocoa が現在の OS X フレームワークで、デフォルトで選択されています。Carbon は古い OS X フレームワークです。</p>
<p><br />
</p>
<p>・<span>Creator Code</span>
 : ドキュメントからアプリケーションにリンクするための古いメカニズム。OS X の現在のリリースでは一部サポートされていません。代わりに（『Xojo での開発』で説明されている）UTI を使用してください。</p>
<p><br />
</p>
<p>・<span>File Types</span>
 : ［受け入れるファイルタイプ］ダイアログを開き、アプリがサポートする許容可能なファイルタイプを指定します。ファイルタイプごとに、None、Viewer、Editor、または Shell として役割を指定できます。</p>
</div>
<p><br />
</p>
<p><img src="images/000123.jpg" alt="Figure 6.4 [受け入れるファイルタイプ]ウィンドウ" />
</p>
<p><br />
</p>
<div>
<div>
<p>・None：アプリは該当ファイルタイプを処理できません。</p>
<p><br />
</p>
<p>・Viewer：アプリは、該当ファイルタイプを開いて読み取ることができますが、保存することはできません。</p>
<p><br />
</p>
<p>・Editor：アプリは該当ファイルタイプを使用して開き、読み取り、編集、および書き込むことができます。通常は、これを選択してください。</p>
<p><br />
</p>
<p>・Shel：Apple によって文書化されていません。</p>
</div>
</div>
<p><br />
</p>
<div>
<p>
<span>・Bundle Identifier</span>
 : バンドル識別子は、アプリケーションの一意の記述として OS X によって使用されます。通常は、com.xojo.myapplication のように、逆引きドメイン名として指定します。これは、アプリケーションの plist の CFBundleIdentifier セクションに追加されます。</p>
</div>
<p>OS X アプリケーションのバンドル識別子を必ず指定してください。Cocoa アプリケーションにはバンドル識別子が必要です。</p>
<p><br />
</p>
<h4><b>
<span><b>Windows</b></span>
</b></h4>
<p>［Windows］セクションでは、Windows アプリケーションのビルド時に使用される設定を指定できます。</p>
<p><br />
</p>
<p><img src="images/000046.jpg" alt="Figure 6.5 [Windows]ビルド設定" />
</p>
<p><br />
</p>
<div>
<p>・<span>Windows App Name</span>
 : Windows アプリケーションの実際のファイル名。指定しない場合は、アプリのビルド時に接尾辞「.exe」が自動的に追加されます。</p>
<p><br />
</p>
<p>・<span>会社名</span>
 : Windows 7 では、［Details］タブのアプリケーションプロパティの［Copyright］セクションに、［会社名］が表示されます。</p>
<p><br />
</p>
<p>・<span>Product Name</span>
 : Windows の［スタート］→［すべてのプログラム］に表示される製品名。アプリケーションプロパティの［Details］タブの［Product Name］にも表示されます。</p>
<p><br />
</p>
<p>・<span>Internal Name</span>
 : 製品に、その外部名とは異なる内部名が存在する場合に有用です。これは、アプリケーションプロパティの［Details］タブには表示されません。</p>
<p><br />
</p>
<p>・<span>MDI</span>
 :［ON］の場合、アプリケーションのウィンドウは「親」MDI ウィンドウで囲まれます。MDI は Multiple Document Interface の略です。 Windows は現在も MDI をサポートしていますが、あまり使用されていません。</p>
<p><br />
</p>
<p>・<span>MDI Caption</span>
 : MDI が［ON］の場合は、MDI ウィンドウのタイトルバーに表示されるキャプションを入力できます。</p>
<p><br />
</p>
<p>・<span>Use GDI Plus*</span>
 : ［ON］の場合、透明性をサポートするより新しい GDI+ グラフィックサブシステムが有効化されます。</p>
</div>
<p><br />
</p>
<h4><b>
<span><b>Linux</b></span>
</b></h4>
<p>［Linux］セクションでは、Linux アプリケーションのビルド時に使用される設定を指定できます。</p>
<p><br />
</p>
<div>
<p>・<span>Linux App Name</span>
 : Linux アプリケーションの実際のファイル名。</p>
</div>
<p><br />
</p>
<h4><b>このコンピュータ</b></h4>
<p>［このコンピュータ］セクションには、現在使用中のプラットフォームに該当するセクション（OS X、Windows、または Linux）が表示されます。たとえば、Xojo を OS X で実行している場合、［このコンピュータ］には OS X の設定が表示されます。</p>
<p><br />
</p>
<h3><b>展開</b></h3>
<p>デスクトップアプリケーションを展開するには、コンピュータにインストールして、そのコンピュータで実行します。</p>
<p><br />
</p>
<h4><b>
<span><b>OS X</b></span>
</b></h4>
<p>OS X アプリケーションは「バンドル」と呼ばれます。バンドルは、アプリケーションとして動作する特別なフォルダです。バンドルにはサポートファイルを実際に配置できるため、OS X アプリケーションは多くの場合、ユーザーがアプリケーションフォルダにドラッグする1つのアプリケーションバンドルとして展開されます。</p>
<p><br />
</p>
<p>一般的ではありませんが、OS X でインストーラーを作成することもできます。Apple は、開発ツールにインストーラーを作成するための PackageMaker ツールを追加しています。</p>
<p><br />
</p>
<p>作成する OS X アプリケーションは、Mac App Store で販売および配布することもできます。</p>
<p><br />
</p>
<div>
<p>
<span>注</span>
 ：Windows で OS X アプリケーションをコンパイルすると、結果のアプリケーションは tar アーカイブファイルとして作成されます。このファイルを OS X に転送し、アーカイブを展開して実行することができます。</p>
</div>
<p><br />
</p>
<h4><b>
<span><b>Windows</b></span>
</b></h4>
<p>Windows アプリケーションは、メイン実行可能ファイルとそのライブラリ（対応する Libs フォルダに格納）の少なくとも2つの部分で構成されます。アプリケーションを実行するには、両方が必要です。ローカリゼーションファイル（またはビルドオートメーションを使用してそこにコピーすることを選択した他のファイル）を含む可能性がある Resources フォルダがある場合もあります。</p>
<p><br />
</p>
<div>
<p>
<span>注</span>
 ：Resources フォルダは「AppName Resources」に名前を変更することができます。AppName はアプリの名前です。1つのフォルダに複数のアプリをパッケージ化する必要がある場合は、有用であることがあります。</p>
</div>
<p><br />
</p>
<p>一般的に、Windows アプリケーションはインストーラーを使用して展開します。インストーラーを使用して、［スタート］メニューまたはデスクトップでショートカットを作成し、適切な場所にファイルをコピーできます。Windows アプリケーション用のインストーラーを作成するために使用できる製品は多数存在します。InnoSetup と Advanced Installer の2つは、Xojo アプリケーションと適切に機能します。</p>
<p><br />
</p>
<p>単純な方法が求められる場合は、Windows アプリケーションとその Lib フォルダを圧縮して簡単に配布することもできます。</p>
<p><br />
</p>
<h4><b>
<span><b>Linux</b></span>
</b></h4>
<p>Linux アプリケーションは、メイン実行可能ファイルとそのライブラリ（対応する Libs フォルダに格納）の2つの部分で構成されます。アプリケーションを実行するには、両方が必要です。</p>
<p><br />
</p>
<p>Linux アプリケーションを展開する方法は、サポートする Linux ディストリビューションよって異なります。ディストリビューションが異なると、パッケージ化のフォーマットも異なります。</p>
<p><br />
</p>
<p>単純な方法が求められる場合は、Linux アプリケーションとその Lib フォルダを圧縮圧縮して簡単に配布することもできます。</p>
</div>
</div>
</div>


<div id="calibre_link-51">
<div>
<div>
<h2 id="calibre_link-64"><b>
<span><b>Section 2</b></span>
<br /><b></b>
ウェブアプリケーション</b></h2>
<p><br />
</p>
<p>ウェブアプリケーションには、ウェブブラウザの内部で動作するグラフィカルユーザーインタフェース、およびウェブサーバーで（またはウェブサーバーとして）動作する付属のサーバーアプリケーションがあります。</p>
<p><br />
</p>
<h3><b>WebApplication クラス</b></h3>
<p>WebApplication クラスは、ウェブアプリケーションを表すサブクラスを作成するために使用します。新しいウェブプロジェクトを作成すると、WebApplication クラスベースのサブクラスがプロジェクトに自動的に追加されます。ナビゲーターの App クラスがそれにあたります。インスペクタは、親が WebApplication であることを示します。</p>
<p><br />
</p>
<p>この App サブクラスでは、アプリケーション起動時に開かれるデフォルトのデフォルトのウェブページ、アプリケーションで使用されるデフォルトの起動メッセージ、デフォルトの切断メッセージ、HTML ヘッダー、<a href="#calibre_link-52">アイコン</a>
 などのアプリケーションのプロパティを指定します。</p>
<p><br />
</p>
<p>必要に応じて、App からサブクラスを作成することもできます。これを実行すると、新しいサブクラスはアプリケーションのプロパティを受け取ります。</p>
<p><br />
</p>
<h4><b>イベントハンドラ</b></h4>
<p>ウェブアプリケーションの WebApplication クラスには、次のようなイベントハンドラが含まれます。具体的には次のとおりです。</p>
<p><br />
</p>
<div>
<p>・<span>Close</span>
 : この終了イベントは、アプリケーション終了時に呼び出されます。</p>
<p><br />
</p>
<p>・<span>HandleSpecialURL</span>
 : このイベントは、特別な URL、/special/value を使用してウェブアプリケーションにアクセスすると呼び出されます。Request 引数では、URL についての情報を取得し、情報を返すことができます。これは、ウェブアプリケーションでウェブサービスを実装するために使用できます。URL「/api/value」もサポートされており、この URL の結果として次のイベントハンドラが呼び出されます。</p>
<p><br />
</p>
<p>・<span>Open</span>
 : このイベントハンドラは、アプリケーションを初めて起動するときに呼び出されます。</p>
<p><br />
</p>
<p>・<span>UnhandledException</span>
 : ユーザーコードで捕捉されないランタイムエラーが発生したときに呼び出されます。このイベントは、ランタイムエラーがアプリケーションを終了させる前にそのエラーを捕捉する「最後のチャンス」として使用できます。</p>
</div>
<p><br />
</p>
<h4><b>プロパティ</b></h4>
<div>
<p>・<span>DefaultWebPage</span>
 : アプリケーション起動時に自動的に表示されるウェブページです。</p>
<p><br />
</p>
<p>・<span>LaunchMessage</span>
 : アプリケーションのロード時には、進行状況バー、アプリケーションアイコン、および起動メッセージがすべてロード画面に表示されます。</p>
<p><br />
</p>
<p>・<span>DisconnectMessage</span>
 : このメッセージは、クライアントがサーバーから切断されると表示されます。</p>
<p><br />
</p>
<p>・<span>HTMLHeader</span>
 : 各ページに静的 HTML コードを追加するために使用できます。</p>
<p><br />
</p>
<p>・<span>Icon</span>
 :<a href="#calibre_link-52">アイコンエディタ</a>
 が開いて、アプリケーションで使用するさまざまなサイズのアイコンを指定できます。これらのアイコンは、ロード画面によって、およびブラウザの favicon として使用されます。</p>
</div>
<p><br />
</p>
<h4><b>
<span><b>App</b></span>
 クラスのプロパティ、メソッド、および定数のスコープ</b></h4>
<p>他のクラスと同じルールを使用して、App サブクラスのプロパティ、メソッド、および定数のスコープを設定できます（第5章参照）。</p>
<p><br />
</p>
<p>パブリックのプロパティ、メソッド、および定数にアクセスするには、App クラスへの参照が必要です。グローバル App 関数は、プロジェクトの App クラスの参照として使用できます。App にサブクラスを作成している場合、App 関数をそのサブクラスへの参照として使用できます。</p>
<p><br />
</p>
<p>したがって、プロジェクト内でパブリックプロパティにアクセスするには、次のように記述します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>value = App.MyProperty</p>
</div>
<p><br />
</p>
<h3><b>ウェブアプリケーションの設計上の考慮事項</b></h3>
<h4><b>クライアント/サーバー</b></h4>
<p>すべてのウェブアプリケーションは、クライアント／サーバー設計を使用します。つまり、ウェブアプリケーションには、クライアントユーザーインタフェース、およびサーバーで動作するアプリケーションの2つの部分があります。</p>
<p><br />
</p>
<p>クライアントは、ユーザーが操作する部分です。ウェブアプリケーションの場合、ウェブブラウザで動作するユーザーインタフェースです。ウェブアプリケーションは、Safari、Chrome、Firefox、Internet Explorer などの最新のウェブブラウザの最新バージョンをサポートしています。</p>
<p><br />
</p>
<p>アプリケーションでは、コードが実行され、サーバーで一般的に実行されます。クライアントとウェブアプリケーションコンポーネントは同じコンピュータに常駐できますが、通常は、ウェブブラウザ／ユーザーインタフェース用のユーザーコンピュータと、アプリケーションを実行しているサーバーという別々のコンピュータです。</p>
<p><br />
</p>
<h4><b>レイテンシ</b></h4>
<p>ウェブアプリケーションをローカルでテストする場合、クライアント（ウェブブラウザ）とサーバー（アプリケーション）の両方がローカルのコンピュータで動作します。この状況では、クライアントとサーバーの間の通信は高速です。しかし、ウェブサーバーにアプリケーションを展開すると、ウェブブラウザはインターネット経由でサーバー上のアプリケーションに通信する必要があるため、今までより長い遅延が発生する可能性があります。この遅延はレイテンシと呼ばれ、その要因にはユーザーのインターネット接続速度、一般的なインターネット輻輳、サーバーの応答性といった多数のものがあります。</p>
<p><br />
</p>
<p>アプリケーション設計時には、レイテンシを念頭に置くことが重要です。</p>
<p><br />
</p>
<h4><b>複数のユーザーとセッション</b></h4>
<p>ウェブアプリケーションは、一般的に、一度に複数のユーザーと接続されます。この接続は、セッションと呼ばれる概念を使用して処理されます。セッションは WebSession のサブクラスで、すべてのウェブプロジェクトに自動的に追加されます。ウェブアプリケーションに接続される各ユーザーは、Session グローバル関数を使用してアクセスできる独自の Session サブクラスを受け取ります。</p>
<p><br />
</p>
<h4><b>クッキー</b></h4>
<p>クッキーは、セッション固有のデータを保存できるブラウザの機能です。ウェブアプリケーションには、WebSession クラスのメソッドとしてクッキーのサポートが組み込まれています。</p>
<p><br />
</p>
<h3><b>セッション</b></h3>
<h4><b>イベント</b></h4>
<p>
<span>AllowUnsupportedBrowser</span>
</p>
<p>サポート対象外のブラウザがウェブアプリケーションに接続されると呼び出されます。</p>
<p><br />
</p>
<p>
<span>Close</span>
</p>
<p>セッションを閉じているときに呼び出されます。</p>
<p><br />
</p>
<p>
<span>HashTagChanged</span>
</p>
<p>ハッシュタグが変更されると呼び出されます。</p>
<p><br />
</p>
<p>
<span>JavaScriptError</span>
</p>
<p>JavaScript エラー発生時に呼び出されます。</p>
<p><br />
</p>
<p>
<span>Open</span>
</p>
<p>セッション開始時に呼び出されます。</p>
<p><br />
</p>
<p>
<span>PrepareSession</span>
</p>
<p>ブラウザが初めてウェブアプリケーションに接続したときに呼び出されます。</p>
<p><br />
</p>
<p>
<span>TimedOut</span>
</p>
<p>TimeOut プロパティで指定されている時間の間ブラウザがアイドル状態の場合、呼び出されます。</p>
<p><br />
</p>
<p>
<span>UnhandledException</span>
</p>
<p>他の方法では処理されない例外を取得するために使用します。</p>
<p><br />
</p>
<h4><b>プロパティ</b></h4>
<p>
<span>ActiveConnectionCount</span>
</p>
<p>ファイルアップロード、ダウンロード、要求などのアクティブ接続数を返します。</p>
<p><br />
</p>
<p>
<span>Browser</span>
</p>
<p>このセッションで使用されるブラウザを識別します。次のような種類があります。</p>
<p><br />
</p>
<div>
<p>・Safari</p>
<p>・Chrome</p>
<p>・Firefox</p>
<p>・Internet Explorer</p>
<p>・Opera</p>
<p>・ChromeOS</p>
<p>・SafariMobile</p>
<p>・Android</p>
<p>・Blackberry</p>
<p>・不明</p>
</div>
<p><br />
</p>
<p>
<span>ClientTime</span>
</p>
<p>ユーザーの日時を返します。ユーザーはどこからでもウェブアプリケーションに接続できるため、サーバーの時間とは異なる可能性があります。</p>
<p><br />
</p>
<p>
<span>ConfirmMessage</span>
</p>
<p>ウェブアプリケーションを閉じると、ブラウザにはこのメッセージとともにユーザーへの警告が表示されます。</p>
<p><br />
</p>
<p>
<span>CurrentPage</span>
</p>
<p>現在のウェブページを取得または設定できます。</p>
<p><br />
</p>
<p>
<span>GMTOffset</span>
</p>
<p>ユーザーのいるタイムゾーンの GMTOffset を返します。</p>
<p><br />
</p>
<p>
<span>HashTag</span>
</p>
<p>ハッシュタグを取得または設定できます。</p>
<p><br />
</p>
<p>
<span>HeaderCount</span>
</p>
<p>セッション作成時に送信した HTTP ヘッダーの数を返します。</p>
<p><br />
</p>
<p>
<span>Identifier</span>
</p>
<p>一意のセッション識別子文字列を返します。</p>
<p><br />
</p>
<p>
<span>PageCount</span>
</p>
<p>セッション内で開いているページの数を返します。</p>
<p><br />
</p>
<p>
<span>Platform</span>
</p>
<p>ブラウザによって使用されているプラットフォームを識別します。次のタイプがあります。</p>
<p><br />
</p>
<div>
<p>・Macintosh</p>
<p>・Windows</p>
<p>・Linux</p>
<p>・Wii</p>
<p>・Playstation</p>
<p>・iPhone</p>
<p>・iPod touch</p>
<p>・iPad</p>
<p>・Blackberry</p>
<p>・WebOS</p>
<p>・不明</p>
</div>
<p><br />
</p>
<p>
<span>RemoteAddress</span>
</p>
<p>クライアント IP アドレスです。</p>
<p><br />
</p>
<p>
<span>RenderingEngine</span>
</p>
<p>ブラウザによって使用されているレンダリングエンジンを識別します。次のタイプがあります。</p>
<p><br />
</p>
<div>
<p>・WebKit</p>
<p>・Gecko</p>
<p>・Trident</p>
<p>・Presto</p>
<p>・不明</p>
</div>
<p><br />
</p>
<p>
<span>Secure</span>
</p>
<p>ウェブページの SSL ステータスを取得します。</p>
<p><br />
</p>
<p>
<span>StatusMessage</span>
</p>
<p>このメッセージは、サポート対象のブラウザのステータスバーに表示されます。</p>
<p><br />
</p>
<p>
<span>Timeout</span>
</p>
<p>TimedOut イベントハンドラが呼び出されるまでブラウザがアイドル状態でいられる秒数です。タイムアウトを無効化するには、0を設定します。</p>
<p><br />
</p>
<p>
<span>Title</span>
</p>
<p>ブラウザタイトルを取得または設定します。ウェブページのタイトルがオーバーライドされます。</p>
<p><br />
</p>
<p>
<span>URL</span>
</p>
<p>セッションに URL を返します。</p>
<p><br />
</p>
<h4><b>メソッド</b></h4>
<p>
<span>Header, HeaderName</span>
</p>
<p>HTTP ヘッダー情報にアクセスするために使用します。</p>
<p><br />
</p>
<p>
<span>PageAtIndex, PageWithID, PageWithName</span>
</p>
<p>セッションでウェブページをルックアップするために使用します。</p>
<p><br />
</p>
<p>
<span>Quit</span>
</p>
<p>セッションを終了します。</p>
<p><br />
</p>
<p>
<span>URLParameter, URLParameterCount, URLParameterExists, URLParameterName</span>
</p>
<p>URL 引数（クエリ文字列）をルックアップするために使用します。</p>
<p><br />
</p>
<h4><b>共有メソッド</b></h4>
<p>
<span>Available</span>
</p>
<p>セッションが使用可能かどうかを確認するために使用します。セッションは、WebApplication などで動作するコードに対して使用可能ではない可能性もあります。</p>
<p><br />
</p>
<h3><b>クッキー</b></h3>
<p>クッキーは、ウェブブラウザがセッション関連の情報を保持する標準的な方法です。たとえば、ユーザーが UserID を使用してウェブアプリケーションにログインする場合、UserID をクッキーとして保存できます。ウェブアプリを次回開くときは、クッキーを検索し、使用可能な場合は、UserID 名を事前に入力します。</p>
<p><br />
</p>
<p>クッキー値は次のように設定します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Session.Cookies.Set("UserName", "BobRoberts")</p>
</div>
<p><br />
</p>
<p>クッキー値は次のように検索します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>Dim userName As String</p>
<p>userName = Session.Cookies.Value("UserName")</p>
</div>
<p><br />
</p>
<h3><b>ハッシュタグ</b></h3>
<p>ハッシュタグは、ウェブアプリケーションのさまざまなエリアを識別する手段です。異なるウェブページにナビゲートするときでも、ウェブアプリケーションは常に同じブラウザ URL を示します。ハッシュタグは、ユーザーが後で直接返すことができるように異なるページ（またはデータ）を識別する手段として使用できます。</p>
<p><br />
</p>
<p>ハッシュタグは、次のように「#」文字を使用して記述します。</p>
<p><br />
</p>
<p>
<a href="http://www.mywebsite.com/#details">
<span>http://www.mywebsite.com/#details</span>
</a>
</p>
<p><br />
</p>
<p>ハッシュタグがユーザーによって変更されると、Session.HashTagChanged イベントが呼び出されます。このイベントでは、新しい値を取得し、別のページにナビゲートすることや、異なるデータを表示することを選択できます。</p>
<p><br />
</p>
<h3><b>ビルド設定</b></h3>
<p>ナビゲーターの［ビルドの設定］セクションには、アプリケーションのビルド固有の設定が含まれます。各ターゲットの横のチェックボックスをオンにすると、そのターゲット向けのアプリケーションをビルドできます。</p>
<p><br />
</p>
<h4><b>共有</b></h4>
<p>［共有］設定のインスペクタには、次のプロパティが表示されます。</p>
<p><br />
</p>
<p><img src="images/000082.jpg" alt="Figure 6.6 [共有]ビルド設定" />
</p>
<p><br />
</p>
<div>
<p>・<span>Major Version</span>
 : アプリケーションのメジャーバージョン。バージョン番号は通常は 1.2.3.4 のように記述され、「1」がメジャーバージョンを示します。</p>
<p><br />
</p>
<p>・<span>Minor Version</span>
 : アプリケーションのマイナーバージョン。バージョン番号は通常は 1.2.3.4 のように記述され、「2」がマイナーバージョンを示します。</p>
<p><br />
</p>
<p>・<span>Bug Version</span>
 : アプリケーションのバグバージョン。バージョン番号は通常は 1.2.3.4 のように記述され、「3」がバグバージョンを示します。</p>
<p><br />
</p>
<p>・<span>Stage Code</span>
 : ビルドするアプリケーションのタイプ（［Development］、［Alpha］、［Beta］、［Final］）を示します。</p>
<p><br />
</p>
<p>・<span>Non Release Version</span>
 : アプリケーションの製品版ではない（ビルド）バージョン。バージョン番号は通常は 1.2.3.4 のように記述され、「4」が製品版ではないバージョンを示します。</p>
<p><br />
</p>
<p>・<span>Auto Increment Version Info</span>
 :［ON］の場合、ビルドを実行するたびに［Non Release Version］が１ずつ増えます。</p>
<p><br />
</p>
<p>・<span>Short Version</span>
 : アプリケーションの簡単な説明。通常はバージョン番号（1.2.3.4 など）のみが格納され、一部のオペレーティングシステムではアプリケーションの［Get Info］ウィンドウまたは［プロパティ］ウィンドウに表示されます。</p>
<p><br />
</p>
<p>・<span>Long Version</span>
 : アプリケーションの詳細な説明。通常は、アプリケーション名、著作権、バージョンなどの情報が含まれます。通常は、アプリケーション名、著作権、バージョンなどの情報が含まれます。</p>
<p><br />
</p>
<p>・<span>Package Info</span>
 : アプリケーションの説明。一部のオペレーティングシステムでアプリケーションの［Get Info］ウィンドウまたは［プロパティ］ウィンドウに表示される可能性があります。</p>
<p><br />
</p>
<p>・<span>Use Builds Folder</span>
 :［ON］の場合、ビルドはプロジェクトファイルとともに別のフォルダに保存されます。このビルドフォルダに、各プラットフォーム（OS X、Windows、Linux）のサブフォルダも作成されます。</p>
<p><br />
</p>
<p>・<span>Include Function Names</span>
 :［ON］の場合、関数呼び出しの実際の名前が、ビルドされたアプリケーションに含まれます。デバッグ目的およびスタックトレースの取得に便利です。</p>
<p><br />
</p>
<p>・<span>言語</span>
 : 動的定数を解決するために使用する言語を指定できます。</p>
<p><br />
</p>
<p>・<span>プロファイルコード</span>
 : コードプロファイル機能を有効または無効にします。第3巻『Xojo のフレームワーク』の第5章を参照してください。</p>
<p><br />
</p>
<p>・<span>展開の種類</span>
 : ウェブアプリケーションは、CGI またはスタンドアロンアプリケーションのいずれかとして展開できます。</p>
<p><br />
</p>
<p>・<span>ポート</span>
 : ウェブアプリケーションへの接続に使用する特定のポートを選択するか、またはウェブアプリケーションにポートを自動的に選択させます。</p>
<p><br />
</p>
<p>・<span>アプリケーション識別子</span>
 : CGI アプリケーションに対して必要な場合、ウェブアプリケーションの一意の識別子です。</p>
<p><br />
</p>
<p>・<span>Command Line Arguments</span>
 : デバッグモードで実行したときに、アプリケーションに渡されるコマンドライン引数です。</p>
<p><br />
</p>
<p>・<span>Destination</span>
 : アプリケーションをデバッグモードで実行するときに、アプリケーションを配置するパスを指定します。指定しない場合、アプリケーションはプロジェクトファイルと同じパスに配置されます。</p>
<p><br />
</p>
<p>・<span>Debug Port</span>
 : デバッグモードでウェブアプリケーションを実行中に使用されるポートです。</p>
</div>
<div>
<div>
<p>
<span>注</span>
 ：ウェブアプリケーションのデバッグがうまくいかない場合は、デバッグポートを別のアプリケーションが使用していないことを確認してください。</p>
</div>
</div>
<p><br />
</p>
<h4><b>
<span><b>Xojo Cloud</b></span>
</b></h4>
<p>［Xojo Cloud］セクションは、Xojo Cloud サーバーにウェブアプリを展開するために使用します。.Xojo Cloud サーバーは Xojo Store で購入できます。</p>
<p><br />
</p>
<p>
<span>Application Name</span>
 : ウェブアプリケーションの名前。ウェブアプリは、この名前のフォルダに展開されます。</p>
<p><br />
</p>
<p>
<span>Server</span>
 : 展開先の Xojo Cloud サーバー。サーバーを表示するには、Xojo Cloud サーバーを購入し、Xojo のアカウントにログインする必要があります。</p>
<p><br />
</p>
<h4><b>
<span><b>OS X</b></span>
</b></h4>
<p>［OS X］セクションでは、OS X アプリケーションの設定を指定できます。</p>
<p><br />
</p>
<div>
<p>・<span>Mac App Name</span>
 : OS X アプリケーションの実際のファイル名。</p>
</div>
<p><br />
</p>
<h4><b>
<span><b>Windows</b></span>
</b></h4>
<p>［Windows］セクションには、Windows アプリケーションのビルドの設定が含まれます。</p>
<p><br />
</p>
<div>
<p>・<span>Windows App Name</span>
 : Windows アプリケーションの実際のファイル名。</p>
<p><br />
</p>
<p>・<span>会社名</span>
 : Windows 7 では、［Details］タブのアプリケーションプロパティの［Copyright］セクションに、［会社名］が表示されます。</p>
<p><br />
</p>
<p>・<span>Product Name</span>
 : Windows の［スタート］→［すべてのプログラム］に表示される製品名。アプリケーションプロパティの［Details］タブの［Product Name］にも表示されます。</p>
</div>
<p><br />
</p>
<h4><b>
<span><b>Linux</b></span>
</b></h4>
<p>［Linux］セクションには、Linux アプリケーションのビルドの設定が含まれます。</p>
<p><br />
</p>
<div>
<p>・<span>Linux App Name</span>
 : Linux アプリケーションの実際のファイル名。</p>
</div>
<p><br />
</p>
<h3><b>展開</b></h3>
<p>ウェブアプリケーションを展開する方法に、スタンドアロンと CGI の2種類があります。</p>
<p><br />
</p>
<div>
<p>
<span>注</span>
 ：Xojo Cloud を使用して展開する場合は、このセクションの内容に気を配る必要はありません。</p>
</div>
<p><br />
</p>
<h4><b>スタンドアロン</b></h4>
<p>スタンドアロンのウェブアプリケーションは、サーバー上で手動で実行するアプリケーションです。ユーザーがウェブアプリにアクセスするには、アプリケーションを起動し（通常コマンドラインから）、実行状態にしておく必要があります。また、スタンドアロンのウェブアプリケーションには、アプリのビルド時に指定するポート経由でアクセスします。基本的に、スタンドアロンのウェブアプリケーションは、ウェブサーバーとウェブアプリケーションの両方で構成されます。</p>
<p><br />
</p>
<p>展開したスタンドアロンのウェブアプリには、次に示す URL でアクセスします。</p>
<p><br />
</p>
<p>
<a href="http://www.mywebsite.com:8080">
<span>http://www.mywebsite.com:8080</span>
</a>
</p>
<p><br />
</p>
<p>スタンドアロンのウェブアプリケーションは、通常バックグラウンドで実行します。OS X または Linux では、スタンドアロンアプリケーションを<a href="#calibre_link-53">デーモン</a>
 して実行することでバックグラウンド実行を実現します。Windows では、スタンドアロンアプリケーションを<a href="#calibre_link-54">サービス</a>
 として実行することで、バックグラウンドで実行されます。</p>
<p><br />
</p>
<h4><b>
<span><b>CGI</b></span>
</b></h4>
<p>CGI（共通ゲートウェイインタフェース）を使用するためにビルドされたウェブアプリケーションは、既存のウェブサーバー（通常は Apache）をウェブサーバーとして使用します。ウェブサーバーは、CGI を使用してウェブアプリケーションと通信します。これを容易にするために、（アプリケーションをビルドする際に提供される）付属の Perl スクリプトが、ウェブサーバーとウェブアプリケーション間の通信を処理します。</p>
<p><br />
</p>
<p>ウェブページが読み込みを終了しても、読み込みインジケーターを表示し続けるウェブブラウザもあります（特に Safari）。これは、ウェブアプリケーションと通信するためにウェブサーバーが使用するメソッドが原因です。</p>
<p><br />
</p>
<p>CGI の展開では既存のウェブサーバーソフトウェアを使用するため、ウェブアプリケーションにアクセスするときにポートを指定する必要はありません。一般的な URL は次のとおりです。</p>
<p><br />
</p>
<p>
<a href="http://www.mywebsite.com/cgi-bin/mywebapp.cgi">
<span>http://www.mywebsite.com/cgi-bin/mywebapp.cgi</span>
</a>
</p>
<p><br />
</p>
<h4><b>プラットフォーム</b></h4>
<p>ウェブアプリケーションは、サポート対象のデスクトッププラットフォームのいずれに対してもコンパイルできます。ウェブサーバーに関して、Linux が最もよく使用される OS プラットフォームであり、これに Windows、OS X が続きます。</p>
<p><br />
</p>
<div>
<p>
<span>LINUX</span>
</p>
</div>
<p>デスクトップでの状況とはまったく異なり、ウェブサーバーの大部分では何らかの形で Linux が使用されています。</p>
<p><br />
</p>
<p>ウェブアプリケーションを展開するには、そのウェブアプリケーションをサーバーでホスティングする必要があります。最も一般的なホスティングタイプは、共有と VPS（仮想プライベートサーバー）の2つです。通常は共有ホスティングのほうが低コストですが、多くの場合、制限が厳しくなります。大部分の共有ホスティングプロバイダーとの相性がもっともよいものは、静的ウェブサイト、または事前に構成しているツール（WordPress など）で、汎用アプリケーションを実行することはできません。Xojo ウェブアプリケーションには適さないことがほとんどです。</p>
<p><br />
</p>
<p>ウェブアプリケーションのホスティングには、VPS（仮想プライベートサーバー）を使用することが最適です。VPS は、独自のサーバーを提供します。多くの場合は Apache ウェブサーバーを実行し、独自の仕様を仮想マシン（VM）内部で実行します。VPS を使用すると、サーバーを完全にコントロールし、Xojo ウェブアプリケーションを実行できるように構成することができます。</p>
<p><br />
</p>
<p>ウェブアプリケーションの実行を目的とした Apache の構成に関する最新情報については、Documentation Wiki を参照してください。</p>
<p><br />
</p>
<div>
<p>
<span>WINDOWS</span>
</p>
</div>
<p>Windows ウェブサーバーは主に IIS（Microsoft インターネット情報サービス）を使用します。Windows サーバーは、Linux サーバーと比べるとまったく一般的ではありません。Windows サーバーを提供するホスティング会社の数も比較的少なく、コストは通常よりかかります。また、IIS は Apache より構成が困難である場合があります。</p>
<p><br />
</p>
<div>
<p>
<span>OS X</span>
</p>
</div>
<p>OS X ウェブサーバーは一般的に Apache を使用し、セットアップは Linux の場合とほとんど同じです。OS X サーバーは Windows サーバーよりさらに少ないのですが、構成はより簡単な場合があります。OS X ホスティングを提供するホスティング会社は確認されていませんが、独自の Mac ハードウェア用のコロケーションサービスを提供する会社はいくつか存在します。</p>
<p><br />
</p>
<p>ウェブアプリケーションを実行するための Apache の構成に関する最新情報については、Documentation Wiki を参照してください。</p>
</div>
</div>
</div>


<div id="calibre_link-109">
<div>
<div>
<h2 id="calibre_link-65"><b>
<span><b>Section 3</b></span>
<br /><b></b>
コンソールアプリケーション</b></h2>
<p><br />
</p>
<p>デスクトップおよびウェブアプリケーションとは異なり、コンソールアプリケーションはイベントベースではありません。コンソールアプリケーションにはグラフィカルユーザーインタフェースがなく、端末、コマンドラインから、またはバックグラウンドプロセスとしてで実行するように設計されています。</p>
<p><br />
</p>
<h3><b>ConsoleApplication クラス</b></h3>
<p>ConsoleApplication クラスは、アプリケーションを表すサブクラスを作成するために使用します。新しいコンソールプロジェクトを作成すると、ConsoleApplication クラスベースのサブクラスがプロジェクトに自動的に追加されます。ナビゲーターの App クラスがそれにあたります。インスペクタは、親が ConsoleApplication であることを示します。</p>
<p><br />
</p>
<p>必要に応じて、App からサブクラスを作成できます。</p>
<p><br />
</p>
<h4><b>イベントハンドラ</b></h4>
<p>コンソールアプリケーションの Application クラスには、次のようなイベントハンドラが含まれます。具体的には次のとおりです。</p>
<p><br />
</p>
<div>
<p>・<span>Run</span>
 : このイベントハンドラは、アプリケーションを Xojo から実行するか、ビルドされたアプリケーションを実行することにより、アプリケーションを最初に起動したときに呼び出されます。Run イベントを終了すると、アプリケーションが終了されます。</p>
<p><br />
</p>
<p>・<span>UnhandledException</span>
 : ユーザーコードで捕捉されないランタイムエラーが発生したときに実行されます。このイベントは、ランタイムエラーがアプリケーションを終了させる前にそのエラーを捕捉する「最後のチャンス」として使用できます。</p>
</div>
<p><br />
</p>
<h4><b>
<span><b>App</b></span>
 クラスのプロパティ、メソッド、および定数のスコープ</b></h4>
<p>他のクラスと同じルールを使用して、App サブクラスのプロパティ、メソッド、および定数のスコープを設定できます（第5章参照）。</p>
<p><br />
</p>
<p>パブリックのプロパティ、メソッド、および定数にアクセスするには、App クラスへの参照が必要です。グローバル App 関数は、プロジェクトの App クラスの参照として使用できます。App にサブクラスを作成している場合、App 関数をそのサブクラスへの参照として使用できます。</p>
<p><br />
</p>
<p>したがって、プロジェクト内でパブリックプロパティにアクセスするには、次のように記述します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>App.MyProperty</p>
</div>
<p><br />
</p>
<h3><b>バックグラウンドアプリケーション</b></h3>
<p>コンソールアプリケーションは、多くの場合、バックグラウンドアプリケーションを作成するために使用されます。OS X と Linux では、バックグラウンドアプリケーションをデーモンと呼びます。Windows では、バックグラウンドアプリケーションをサービスと呼びます。</p>
<p><br />
</p>
<h4 id="calibre_link-53"><b>デーモン</b></h4>
<p>コンソールアプリケーションをバックグラウンドで実行できるデーモンにする手順は、ConsoleApplication クラスの Daemonize メソッドを呼び出すだけです。</p>
<p><br />
</p>
<p>OS X でも Daemonize メソッドを使用できますが、Apple は<span>launchd</span>
 を使用してデーモンプロセスを起動する方法のほうを推奨しています。</p>
<p><br />
</p>
<h4 id="calibre_link-54"><b>
<span><b>ServiceApplication</b></span>
</b></h4>
<p>サービスとして実行できるコンソールアプリケーションを作成するには、ServiceApplication クラスを使用する必要があります。コンソールアプリケーションを作成するには、アプリの親を ConsoleApplication から ServiceApplication に変更します。または、［プロジェクト選択］でテンプレートから ServiceApplication を選択できます。</p>
<p><br />
</p>
<p>サービスアプリケーションは、サービス起動時、停止時、または一時停止時に処理の管理に役立つ追加イベントを提供します。これらのイベントの詳細については、言語リファレンスを参照してください。</p>
<p><br />
</p>
<h3><b>ビルド設定</b></h3>
<p>ナビゲーターの［ビルドの設定］セクションには、アプリケーションのビルド固有の設定が含まれます。各ターゲットの横のチェックボックスをオンにすると、そのターゲット向けのアプリケーションをビルドできます。</p>
<p><br />
</p>
<h4><b>共有</b></h4>
<p>［共有］設定のインスペクタには、次のプロパティが表示されます。</p>
<p><br />
</p>
<div>
<p>・<span>Major Version</span>
 : アプリケーションのメジャーバージョン。バージョン番号は通常は 1.2.3.4 のように記述され、「1」がメジャーバージョンを示します。</p>
<p><br />
</p>
<p>・<span>Minor Version</span>
 : アプリケーションのマイナーバージョン。バージョン番号は通常は 1.2.3.4 のように記述され、「2」がマイナーバージョンを示します。</p>
<p><br />
</p>
<p>・<span>Bug Version</span>
 : アプリケーションのバグバージョン。バージョン番号は通常は 1.2.3.4 のように記述され、「3」がバグバージョンを示します。</p>
<p><br />
</p>
<p>・<span>Stage Code</span>
 : ビルドするアプリケーションのタイプ（［Development］、［Alpha］、［Beta］、［Final］）を示します。</p>
<p><br />
</p>
<p>・<span>Non Release Version</span>
 : アプリケーションの製品版ではない（ビルド）バージョン。バージョン番号は通常は 1.2.3.4 のように記述され、「4」が製品版ではないバージョンを示します。</p>
<p><br />
</p>
<p>・<span>Auto Increment Version Info</span>
 :［ON］の場合、ビルドを実行するたびに［Non Release Version］が1ずつ増えます。</p>
<p><br />
</p>
<p>・<span>Short Version</span>
 : アプリケーションの簡単な説明。通常はバージョン番号（1.2.3.4 など）のみが格納され、一部のオペレーティングシステムではアプリケーションの［Get Info］ウィンドウまたは［プロパティ］ウィンドウに表示されます。</p>
<p><br />
</p>
<p>・<span>Long Version</span>
 : アプリケーションの詳細な説明。通常は、アプリケーション名、著作権、バージョンなどの情報が含まれます。一部のオペレーティングシステムでアプリケーションの［Get Info］ウィンドウまたは［プロパティ］ウィンドウに表示されます。</p>
<p><br />
</p>
<p>・<span>Package Info</span>
 : アプリケーションの説明。一部のオペレーティングシステムでアプリケーションの［Get Info］ウィンドウまたは［プロパティ］ウィンドウに表示される場合があります。</p>
<p><br />
</p>
<p>・<span>Use Builds Folder</span>
 : ON の場合、プロジェクトファイルと同じ位置に別のフォルダが作成されます。このビルドフォルダに、各プラットフォーム（OS X、Windows、Linux）のサブフォルダも作成されます。</p>
<p><br />
</p>
<p>・<span>Include Function Names</span>
 : ［ON］の場合、関数呼び出しの実際の名前が、ビルドされたアプリケーションに含まれます。デバッグ目的およびスタックトレースの取得に便利です。</p>
<p><br />
</p>
<p>・<span>Command Line Arguments</span>
 : Xojo からアプリケーションを実行したときに、アプリケーションに渡されるコマンドライン引数です。</p>
<p><br />
</p>
<p>・<span>Destination</span>
 : 動作中のアプリケーションが配置されるパスを指定します。通常はプロジェクトと同じ位置に配置されますが、別の位置を選択できます。</p>
</div>
<p><br />
</p>
<h4><b>
<span><b>OS X</b></span>
</b></h4>
<p>［OS X］セクションでは、OS X アプリケーションの設定を指定できます。</p>
<p><br />
</p>
<div>
<p>・<span>Mac App Name</span>
 : OS X アプリケーションの実際のファイル名。</p>
</div>
<p><br />
</p>
<h4><b>
<span><b>Windows</b></span>
</b></h4>
<p>［Windows］セクションには、Windows アプリケーションのビルドの設定が含まれます。</p>
<p><br />
</p>
<div>
<p>・<span>Windows App Name</span>
 : Windows アプリケーションの実際のファイル名。</p>
<p><br />
</p>
<p>・<span>会社名</span>
 : Windows 7 では、［Details］タブのアプリケーションプロパティの［Copyright］セクションに、［会社名］が表示されます。</p>
<p><br />
</p>
<p>・<span>Product Name</span>
 : Windows の［スタート］→［すべてのプログラム］に表示される製品名。アプリケーションプロパティの［Details］タブの［Product Name］にも表示されます。</p>
<p><br />
</p>
<p>・<span>Internal Name</span>
 : 製品に、その外部名とは異なる内部名が存在する場合に便利です。これは、アプリケーションプロパティの［Details］タブには表示されません。</p>
</div>
<p><br />
</p>
<h4><b>
<span><b>Linux</b></span>
</b></h4>
<p>［Linux］セクションには、Linux アプリケーションのビルドの設定が含まれます。</p>
<p><br />
</p>
<div>
<p>・<span>Linux App Name</span>
 : Linux アプリケーションの実際のファイル名。</p>
</div>
<p><br />
</p>
<h4><b>このコンピュータ</b></h4>
<p>［このコンピュータ］セクションには、現在使用中のプラットフォームに該当するセクション（OS X、Windows、または Linux）が表示されます。たとえば、Xojo を OS X で実行している場合、［このコンピュータ］には OS X の設定が表示されます。</p>
<p><br />
</p>
<h3><b>展開</b></h3>
<p>コンソールアプリケーションを展開するには、コンピュータにインストールして、そこで実行します。</p>
<p><br />
</p>
<p>コンソールアプリケーションは、メイン実行可能ファイルとそのライブラリ（Libs フォルダに格納）の2つの部分で構成されます。アプリケーションを実行するには、両方が必要です。</p>
<p><br />
</p>
<p>コンソールアプリケーションとその Lib フォルダを圧縮すると、簡単に配布できます。</p>
<p><br />
</p>
</div>
</div>
</div>


<div id="calibre_link-2">
<div>
<div>
<h2 id="calibre_link-66"><b>
<span><b>Section 4</b></span>
<br /><b></b>
iOS アプリケーション</b></h2>
<p><br />
</p>
<p>iOS アプリケーションは、iPhone や iPad などの iOS デバイスで動作します。</p>
<p><br />
</p>
<h3><b>The IOSApplication クラス</b></h3>
<p>IOSApplication クラスは、ユーザーの iOS アプリケーションを表すサブクラスを作成するために使用します。新しい iOS プロジェクトを作成すると、IOSApplication クラスベースのサブクラスがプロジェクトに自動的に追加されます。ナビゲーターの App クラスがそれにあたります。インスペクタは、親が IOSApplication であることを示します。</p>
<p><br />
</p>
<p>必要に応じて、App からサブクラスを作成できます。</p>
<p><br />
</p>
<h4><b>イベントハンドラ</b></h4>
<p>iOS アプリケーションの Application クラスには、次のようなイベントハンドラが含まれます。具体的には次のとおりです。</p>
<p><br />
</p>
<div>
<p>・<span>LowMemoryWarning</span>
 : iOS がメモリの残量が少ないことをアプリに知らせると呼び出されます。アプリは、大量のメモリを使用している可能性のあるキャッシュやデータ構造を消去してメモリを解放する必要があります。</p>
<p><br />
</p>
<p>・<span>Open</span>
 : アプリケーションを初めて起動するときに呼び出されます。</p>
<p><br />
</p>
<p>・<span>UnhandledException</span>
 : ユーザーコードで捕捉されないランタイムエラーが発生したときに呼び出されます。このイベントは、ランタイムエラーがアプリケーションを終了する前にそのエラーを捕捉する「最後のチャンス」として使用できます。</p>
</div>
<p><br />
</p>
<h4><b>
<span><b>App</b></span>
 クラスのプロパティ、メソッド、および定数のスコープ</b></h4>
<p>他のクラスと同じルールを使用して、App サブクラスのプロパティ、メソッド、および定数のスコープを設定できます（第5章参照）。</p>
<p><br />
</p>
<p>パブリックのプロパティ、メソッド、および定数にアクセスするには、App クラスへの参照が必要です。グローバル App 関数は、プロジェクトの App クラスの参照として使用できます。App にサブクラスを作成している場合、App 関数をそのサブクラスへの参照として使用できます。</p>
<p><br />
</p>
<p>したがって、プロジェクト内でパブリックプロパティにアクセスするには、次のように記述します。</p>
<p><br />
</p>
<div {http://www.w3.org/XML/1998/namespace}lang="en" lang="en">
<p>App.MyProperty</p>
</div>
<p><br />
</p>
<h3><b>画面</b></h3>
<p>アプリケーションのインスペクタでは、iPhone または iPad でアプリを実行するときに使用するデフォルトの画面を指定できます。</p>
<p><br />
</p>
<p><img src="images/000107.jpg" alt="Figure 6.7 インスペクタのアイコン設定" />
</p>
<p><br />
</p>
<p>画面は、レイアウトの種類とサポート対象の向きを指定するプロジェクト項目です。デフォルトでは、Screen1 がプロジェクトに追加されます。いずれかのデバイスに画面が必要ない場合は、そのデバイスのデフォルト画面を［なし］に設定することもできます（両方のデバイスには設定できません）。［Default iPhone］を［なし］に設定すると、アプリは iPhone では動作しません。［Default iPad Screen］を［なし］に設定すると、アプリは iPad で iPhone 画面を実行しません。</p>
<p><br />
</p>
<h4><b>画面の表示</b></h4>
<p>画面をクリックすると、iPhone において縦方向モードでどのように表示されるかのプレビューが示されます。プレビューは、向きとデバイスの種類のツールバーボタンを使用して変更できます。</p>
<p><br />
</p>
<p><img src="images/000114.jpg" alt="Figure 6.8 [画面レイアウト]および[サポート対象の向き]プロパティ" />
</p>
<p><br />
</p>
<div>
<p>・Orientation：ボタンをクリックすると、縦方向と横方向が切り替えられます。</p>
<p><br />
</p>
<p>・Device Type：［Device Type］をクリックすると、［View as iPhone］または［View as iPad］を選択できるメニューが表示されます。</p>
</div>
<p><br />
</p>
<p>インスペクタでは、画面レイアウトとサポート対象の向きを指定できます。</p>
<p><br />
</p>
<h4><b>画面プロパティ</b></h4>
<p>画面レイアウトのデフォルトは View1 ですが、プロジェクトのどのビューでも選択できます。［Split］または［Tabs］も選択できます。</p>
<p><br />
</p>
<div>
<p>
<span>SPLIT</span>
</p>
</div>
<p>［Split］は iPad で、メールアプリの動作のように左にマスターエリア、右に詳細エリアを表示する横方向モードで使用されます。</p>
<p><br />
</p>
<p><img src="images/000041.jpg" alt="Figure 6.9 [Split]の[画面レイアウト]プロパティ" />
</p>
<p><br />
</p>
<p>［Split］を選択すると、2つの追加プロパティ（左 - マスターと右 - 詳細）がインスペクタに示されています。これらのプロパティは、各セクション（［Views］または［Tabs］）での表示内容を指定するために使用します。［Tabs］を選択すると、追加プロパティが表示されます（下記参照）。</p>
<p><br />
</p>
<div>
<p>
<span>タブ</span>
</p>
</div>
<p>タブは、他のビューまたは分割ビューを表示するために使用できる画面の下部にあるボタンです。［Tabs］を選択すると、インスペクタに［Tabs］および［Tab 0 Content］プロパティが表示されます。［Tabs］プロパティには、［編集］ボタンがあり、これをクリックするとタブエディタが表示されます。ここでは、名前、順序、アイコンなど、表示するタブを管理できます。表示するビュー（または分割ビュー）を設定するには、画面の各タブをクリックします。</p>
<p><br />
</p>
<p><img src="images/000007.jpg" alt="Figure 6.10 [タブ]の[画面レイアウト]プロパティ" />
</p>
<p><br />
</p>
<h4><b>サポート対象の向き</b></h4>
<p>画面の有効な向きも指定できます。これらは単なる ON/OFF スイッチです。</p>
<p><br />
</p>
<div>
<p>・Portrait (Home on Bottom)</p>
<p><br />
</p>
<p>・Landscape (Home on Left)</p>
<p><br />
</p>
<p>・Landscape (Home on Right)</p>
<p><br />
</p>
<p>・Portrait (Home on Top)</p>
</div>
<p><br />
</p>
<p>アプリによっては意味のない設定もあるため、サポートする必要がないスイッチはオフにしてください。</p>
<p><br />
</p>
<p>たとえば、［Portrait (Home on Bottom)］以外をすべてオフにすると、デバイスを回転しても、アプリの画面は回転しません。</p>
<p><br />
</p>
<h3><b>ビルドの設定</b></h3>
<p>ナビゲーターの［ビルドの設定］セクションには、アプリケーションのビルド固有の設定が含まれます。各ターゲットの横のチェックボックスをオンにすると、そのターゲット向けのアプリケーションをビルドできます。</p>
<p><br />
</p>
<h4><b>共有</b></h4>
<p>設定のインスペクタには、次のプロパティが表示されます。</p>
<p><br />
</p>
<div>
<p>・<span>Major Version</span>
 : アプリケーションのメジャーバージョン。バージョン番号は通常は 1.2.3.4 のように記述され、「1」がメジャーバージョンを示します。</p>
<p><br />
</p>
<p>・<span>Minor Version</span>
 : アプリケーションのマイナーバージョン。バージョン番号は通常は 1.2.3.4 のように記述され、「2」がマイナーバージョンを示します。</p>
<p><br />
</p>
<p>・<span>Bug Version</span>
 : アプリケーションのバグバージョン。バージョン番号は通常は 1.2.3.4 のように記述され、「3」がバグバージョンを示します。</p>
<p><br />
</p>
<p>・<span>Stage Code</span>
 : ビルドするアプリケーションのタイプ（［Development］、［Alpha］、［Beta］、［Final］）を示します。</p>
<p><br />
</p>
<p>・<span>Non Release Version</span>
 : アプリケーションの製品版ではない（ビルド）バージョン。バージョン番号は通常は 1.2.3.4 のように記述され、「4」が製品版ではないバージョンを示します。</p>
<p><br />
</p>
<p>・<span>Auto Increment Version Info</span>
 : ［ON］の場合、ビルドを実行するたびに［Non Release Version］が1ずつ増えます。</p>
<p><br />
</p>
<p>・<span>Short Version</span>
 : アプリケーションの簡単な説明。通常はバージョン番号（1.2.3.4 など）のみが格納され、一部のオペレーティングシステムではアプリケーションの［Get Info］ウィンドウまたは［プロパティ］ウィンドウに表示されます。これは、App Store 向けのビルド時に必要です。</p>
<p><br />
</p>
<p>・<span>Long Version</span>
 : アプリケーションの詳細な説明。通常は、アプリケーション名、著作権、バージョンなどの情報が含まれます。一部のオペレーティングシステムでアプリケーションの［Get Info］ウィンドウまたは［プロパティ］ウィンドウに表示されます。</p>
<p><br />
</p>
<p>・<span>Package Info</span>
 : アプリケーションの説明。一部のオペレーティングシステムでアプリケーションの［Get Info］ウィンドウまたは［プロパティ］ウィンドウに表示される可能性があります。</p>
<p><br />
</p>
<p>・<span>Use Builds Folder</span>
 : ON の場合、プロジェクトファイルと同じ位置に別のフォルダが作成されます。このビルドフォルダに、各プラットフォーム（OS X、Windows、Linux）のサブフォルダも作成されます。</p>
<p><br />
</p>
<p>・<span>Include Function Names</span>
 : ［ON］の場合、関数呼び出しの実際の名前が、ビルドされたアプリケーションに含まれます。デバッグ目的およびスタックトレースの取得に便利です。</p>
<p><br />
</p>
<p>・<span>Command Line Arguments</span>
 : Xojo からアプリケーションを実行したときに、アプリケーションに渡されるコマンドライン引数です。</p>
<p><br />
</p>
<p>・<span>Destination</span>
 : 動作中のアプリケーションが配置されるパスを指定します。通常はプロジェクトと同じ位置に配置されますが、別の位置を選択できます。</p>
</div>
<p><br />
</p>
<h4><b>
<span><b>iOS</b></span>
</b></h4>
<p>［iOS］セクションでは、iOS アプリの設定を指定できます。</p>
<p><br />
</p>
<div>
<p>・<span>iOS App Name</span>
 : iOS アプリケーションの実際の名前。Springboard のアイコンの下に表示される名前です。</p>
<p><br />
</p>
<p>・<span>Bundle Identifier</span>
 : バンドル識別子は、アプリケーションの一意の記述として iOS によって使用されます。通常は、com.xojo.myapplication のように、逆引きドメイン名として指定します。App Store での配布のためには、App ID を使用する必要があります。</p>
</div>
<p><br />
</p>
<div>
<p>
<span>コードの署名</span>
</p>
</div>
<div>
<p>・<span>チーム</span>
 : ここでは、アプリを展開するためのプロビジョニングプロファイルを持つチームを選択します。</p>
<p><br />
</p>
<p>・<span>Entitlements</span>
 : アプリの使用資格を含む plist ファイルを指定します。</p>
<p><br />
</p>
<p>・<span>Build for App Store</span>
 : iTunes Connect を使用して App Store に提出する IPA（iOS アプリアーカイブ）を作成する場合は、これを ON にします。</p>
</div>
<p><br />
</p>
<div>
<p>
<span>iOS デバッグ</span>
</p>
</div>
<div>
<p>・<span>Simulator Device</span>
 : デバッグ時に起動するシミュレーターデバイスの種類を選択します。</p>
</div>
<p><br />
</p>
<h3><b>展開</b></h3>
<p>コンソールアプリケーションを展開するには、コンピュータにインストールして、そこで実行します。</p>
<p><br />
</p>
<p>コンソールアプリケーションは、メイン実行可能ファイルとそのライブラリ（Libs フォルダに格納）の2つの部分で構成されます。アプリケーションを実行するには、両方が必要です。</p>
<p><br />
</p>
<p>コンソールアプリケーションとその Lib フォルダを圧縮すると、簡単に配布できます。</p>
</div>
</div>
</div>


<div id="calibre_link-21">
<div>
<div>
<h2 id="calibre_link-52"><b>
<span><b>Section 5</b></span>
<br /><b></b>
アイコンエディタ</b></h2>
<p><br />
</p>
<h3><b>アイコンエディタ</b></h3>
<p>アイコンエディタは、アプリケーションアイコンを追加するために使用します。ウェブアプリケーションは、ロード画面の一部としてアプリケーションアイコンを使用します。</p>
<p><br />
</p>
<p><img src="images/000116.jpg" alt="Figure 6.11 インスペクタのアイコン設定" />
</p>
<p><br />
</p>
<p>アイコンエディタを開くには、ナビゲーターでアプリオブジェクトを選択しインスペクタでアイコンを選択します。</p>
<p><br />
</p>
<p>アイコンエディタを開くと、ウィンドウにさまざまな大きさのアイコン用の空のエリアが表示されます。アイコンファイルをこのエリアにドラッグすることで、その大きさにアイコンを設定できます。大きさ間でアイコンをコピーして貼り付けすることもできます。それにより、アイコンが自動的に拡大縮小されます。</p>
<p><br />
</p>
<p>アイコンイメージの各種コンポーネントを表示するには、Images/Masks/Preview コントロールを使用します。イメージとマスクの両方を含むアイコン（大部分の PNG ファイルなど）をドラッグインすると、イメージとマスクの両方が追加されます。</p>
<p><br />
</p>
<p><img src="images/000094.jpg" alt="Figure 6.12 アイコンエディタ" />
</p>
<p><br />
</p>
<p>最適な結果を得るには、すべての使用できる大きさのアイコン（およびマスク）を必ず追加してください。プラットフォームによって使用される大きさが異なります。マスクがない場合、一部のプラットフォームではアイコンが表示されない場合があります。</p>
<p><br />
</p>
<p>ICNS ファイルを（イメージエリアの代わりに）ウィンドウのバックグラウンドにドラッグして読み込み、一度にすべてのイメージの大きさを追加することもできます。</p>
</div>
</div>
</div>


<div id="calibre_link-104">
<div>
<div>
<p>書名　　　　Xojoユーザーガイド Book1 基礎</p>
<p>著者　　　　Xojo, Inc.</p>
<p>発行　　　　グレープシティ株式会社</p>
<p>電子書籍発行日　　2016年9月30日</p>
<p>電子書籍制作会社　三陽社メディア開発室</p>
</div>
</div>
</div>


<script>function myFunction(){document.getElementById("tateyoko").classList.toggle("tateread")}</script></body></html>